/*! For license information please see reader.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("luaparse")):"function"==typeof define&&define.amd?define("reader",["luaparse"],t):"object"==typeof exports?exports.reader=t(require("luaparse")):e.reader=t(e.luaparse)}(self,(e=>(()=>{var t={4184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},8820:e=>{"use strict";var t={}.hasOwnProperty,n=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,i=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,o=function e(o,a){"single"!=(a=function(e,n){if(!e)return n;var r={};for(var i in n)r[i]=t.call(e,i)?e[i]:n[i];return r}(a,e.options)).quotes&&"double"!=a.quotes&&(a.quotes="single");for(var s="double"==a.quotes?'"':"'",l=a.isIdentifier,u=o.charAt(0),c="",d=0,h=o.length;d<h;){var p=o.charAt(d++),f=p.charCodeAt(),m=void 0;if(f<32||f>126){if(f>=55296&&f<=56319&&d<h){var g=o.charCodeAt(d++);56320==(64512&g)?f=((1023&f)<<10)+(1023&g)+65536:d--}m="\\"+f.toString(16).toUpperCase()+" "}else m=a.escapeEverything?n.test(p)?"\\"+p:"\\"+f.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(p)?"\\"+f.toString(16).toUpperCase()+" ":"\\"==p||!l&&('"'==p&&s==p||"'"==p&&s==p)||l&&r.test(p)?"\\"+p:p;c+=m}return l&&(/^-[-\d]/.test(c)?c="\\-"+c.slice(1):/\d/.test(u)&&(c="\\3"+u+" "+c.slice(1))),c=c.replace(i,(function(e,t,n){return t&&t.length%2?e:(t||"")+n})),!l&&a.wrap?s+c+s:c};o.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},o.version="3.0.0",e.exports=o},1804:(e,t,n)=>{"use strict";var r=n(5618),i=n(7205),o=n(7191),a=n(5516),s=n(9981);(e.exports=function(e,t){var n,i,l,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],r(e)?(n=s.call(e,"c"),i=s.call(e,"e"),l=s.call(e,"w")):(n=l=!0,i=!1),c={value:t,configurable:n,enumerable:i,writable:l},u?o(a(u),c):c}).gs=function(e,t,n){var l,u,c,d;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],r(t)?i(t)?r(n)?i(n)||(c=n,n=void 0):n=void 0:(c=t,t=n=void 0):t=void 0,r(e)?(l=s.call(e,"c"),u=s.call(e,"e")):(l=!0,u=!1),d={get:t,set:n,configurable:l,enumerable:u},c?o(a(c),d):d}},430:e=>{"use strict";e.exports=function(){}},7191:(e,t,n)=>{"use strict";e.exports=n(6560)()?Object.assign:n(7346)},6560:e=>{"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},7346:(e,t,n)=>{"use strict";var r=n(5103),i=n(2745),o=Math.max;e.exports=function(e,t){var n,a,s,l=o(arguments.length,2);for(e=Object(i(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<l;++a)r(t=arguments[a]).forEach(s);if(void 0!==n)throw n;return e}},6914:(e,t,n)=>{"use strict";var r=n(430)();e.exports=function(e){return e!==r&&null!==e}},5103:(e,t,n)=>{"use strict";e.exports=n(7446)()?Object.keys:n(6137)},7446:e=>{"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},6137:(e,t,n)=>{"use strict";var r=n(6914),i=Object.keys;e.exports=function(e){return i(r(e)?Object(e):e)}},5516:(e,t,n)=>{"use strict";var r=n(6914),i=Array.prototype.forEach,o=Object.create;e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)})),t}},1290:e=>{"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},2745:(e,t,n)=>{"use strict";var r=n(6914);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},9981:(e,t,n)=>{"use strict";e.exports=n(3591)()?String.prototype.contains:n(6042)},3591:e=>{"use strict";var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&!0===t.contains("dwa")&&!1===t.contains("foo")}},6042:e=>{"use strict";var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}},8370:(e,t,n)=>{"use strict";var r,i,o,a,s,l,u,c=n(1804),d=n(1290),h=Function.prototype.apply,p=Function.prototype.call,f=Object.create,m=Object.defineProperty,g=Object.defineProperties,v=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var n,i;return d(t),i=this,r.call(this,e,n=function(){o.call(i,e,n),h.call(t,this,arguments)}),n.__eeOnceListener__=t,this},s={on:r=function(e,t){var n;return d(t),v.call(this,"__ee__")?n=this.__ee__:(n=y.value=f(null),m(this,"__ee__",y),y.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:i,off:o=function(e,t){var n,r,i,o;if(d(t),!v.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,r,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)h.call(r,this,o)}else switch(arguments.length){case 1:p.call(i,this);break;case 2:p.call(i,this,arguments[1]);break;case 3:p.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];h.call(i,this,o)}}},l={on:c(r),once:c(i),off:c(o),emit:c(a)},u=g({},l),e.exports=t=function(e){return null==e?f(u):g(Object(e),l)},t.methods=s},7187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,a,u;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var u=l.length,c=f(l,u);for(n=0;n<u;++n)r(c[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8679:(e,t,n)=>{"use strict";var r=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?a:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var a=c(n);d&&(a=a.concat(d(n)));for(var s=l(t),m=l(n),g=0;g<a.length;++g){var v=a[g];if(!(o[v]||r&&r[v]||m&&m[v]||s&&s[v])){var y=h(n,v);try{u(t,v,y)}catch(e){}}}}return t}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},2502:(e,t,n)=>{e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,a,s,l,u,c=[],d=0,h=e.length,p=h,f="string"!==r.getTypeOf(e);d<e.length;)p=h-d,f?(t=e[d++],n=d<h?e[d++]:0,i=d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,i=d<h?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|n>>4,l=p>1?(15&n)<<2|i>>6:64,u=p>2?63&i:64,c.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(u));return c.join("")},n.decode=function(e){var t,n,r,a,s,l,u=0,c=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&p--,e.charAt(e.length-2)===o.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|p):new Array(0|p);u<e.length;)t=o.indexOf(e.charAt(u++))<<2|(a=o.indexOf(e.charAt(u++)))>>4,n=(15&a)<<4|(s=o.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(l=o.indexOf(e.charAt(u++))),h[c++]=t,64!==s&&(h[c++]=n),64!==l&&(h[c++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils");var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var o=i,a=r+n;e=~e;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^t[s])];return~e}(0|t,e,e.length,0):function(e,t,n,r){var o=i,a=r+n;e=~e;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^t.charCodeAt(s))];return~e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker"),o=e("../utf8"),a=e("../crc32"),s=e("../signature"),l=function(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r},u=function(e,t,n,i,u,c){var d,h,p=e.file,f=e.compression,m=c!==o.utf8encode,g=r.transformTo("string",c(p.name)),v=r.transformTo("string",o.utf8encode(p.name)),y=p.comment,b=r.transformTo("string",c(y)),_=r.transformTo("string",o.utf8encode(y)),w=v.length!==p.name.length,S=_.length!==y.length,C="",E="",x="",A=p.dir,k=p.date,D={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(D.crc32=e.crc32,D.compressedSize=e.compressedSize,D.uncompressedSize=e.uncompressedSize);var P=0;t&&(P|=8),m||!w&&!S||(P|=2048);var T,F,R,I=0,O=0;A&&(I|=16),"UNIX"===u?(O=798,I|=(T=p.unixPermissions,F=A,R=T,T||(R=F?16893:33204),(65535&R)<<16)):(O=20,I|=63&(p.dosPermissions||0)),d=k.getUTCHours(),d<<=6,d|=k.getUTCMinutes(),d<<=5,d|=k.getUTCSeconds()/2,h=k.getUTCFullYear()-1980,h<<=4,h|=k.getUTCMonth()+1,h<<=5,h|=k.getUTCDate(),w&&(E=l(1,1)+l(a(g),4)+v,C+="up"+l(E.length,2)+E),S&&(x=l(1,1)+l(a(b),4)+_,C+="uc"+l(x.length,2)+x);var B="";return B+="\n\0",B+=l(P,2),B+=f.magic,B+=l(d,2),B+=l(h,2),B+=l(D.crc32,4),B+=l(D.compressedSize,4),B+=l(D.uncompressedSize,4),B+=l(g.length,2),B+=l(C.length,2),{fileRecord:s.LOCAL_FILE_HEADER+B+g+C,dirRecord:s.CENTRAL_FILE_HEADER+l(O,2)+B+l(b.length,2)+"\0\0\0\0"+l(I,4)+l(i,4)+g+C+b}},c=function(e){return s.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function d(e,t,n,r){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(d,i),d.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=u(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=u(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:c(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var a=r.transformTo("string",o(i));return s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(n,4)+l(a.length,2)+a}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},d.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var o=new i(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,n){a++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}r.prototype=e("./object"),r.prototype.loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),o=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function u(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new a(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(u(r[o]));return i.Promise.all(n)})).then((function(e){for(var i=e.shift(),o=i.files,a=0;a<o.length;a++){var s=o[a],l=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(u).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,i),o.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";var r=e("./utf8"),i=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),s=e("./defaults"),l=e("./compressedObject"),u=e("./zipObject"),c=e("./generate"),d=e("./nodejsUtils"),h=e("./nodejs/NodejsStreamInputAdapter"),p=function(e,t,n){var r,a=i.getTypeOf(t),c=i.extend(n||{},s);c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),"string"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(e=m(e)),c.createFolders&&(r=f(e))&&g.call(this,r,!0);var p="string"===a&&!1===c.binary&&!1===c.base64;n&&void 0!==n.binary||(c.binary=!p),(t instanceof l&&0===t.uncompressedSize||c.dir||!t||0===t.length)&&(c.base64=!1,c.binary=!0,t="",c.compression="STORE",a="string");var v;v=t instanceof l||t instanceof o?t:d.isNode&&d.isStream(t)?new h(e,t):i.prepareContent(e,t,c.binary,c.optimizedBinaryString,c.base64);var y=new u(e,v,c);this.files[e]=y},f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:s.createFolders,e=m(e),this.files[e]||p.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1===arguments.length){if(v(e)){var r=e;return this.filter((function(e,t){return!t.dir&&r.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,p.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(v(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var s=n.comment||this.comment||"";t=c.generateWorker(this,n,s)}catch(e){(t=new o("error")).error(e)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),u=null;if(s.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t){return new l.Promise((function(n,i){var o=[],s=e._internalType,l=e._outputType,u=e._mimeType;e.on("data",(function(e,n){o.push(e),t&&t(n)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),u);n(e)}catch(e){i(e)}o=[]})).resume()}))}function d(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,r.checkSupport(a),this._worker=e.pipe(new i(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1;function u(){a.call(this,"utf-8 decode"),this.leftOver=null}function c(){a.call(this,"utf-8 encode")}n.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,o,a=e.length,l=new Array(2*a);for(n=0,t=0;t<a;)if((i=e[t++])<128)l[n++]=i;else if((o=s[i])>4)l[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&t<a;)i=i<<6|63&e[t++],o--;o>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,a),u.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;a!==t.length&&(i.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=u,r.inherits(c,a),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),a=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;t>1;)try{return u.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=c;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},h.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},h.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return o.newBufferFrom(e)}},h.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,o,s,u){return a.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var c,d=n.getTypeOf(t);return d?("arraybuffer"===d?t=n.transformTo("uint8array",t):"string"===d&&(u?t=i.decode(t):o&&!0!==s&&(t=l(c=t,r.uint8array?new Uint8Array(c.length):new Array(c.length)))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),a=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(r>0)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),u=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";var r=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),o=e("./utf8"),a=e("./compressedObject"),s=e("./stream/GenericWorker"),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var i="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!i&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&i&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new s("error")).error(e)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof s?this._data:new i(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)l.prototype[u[d]]=c;t.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(c),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,n=function(){l.port2.postMessage(0)}}var u=[];function c(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}t.exports=function(e){1!==u.push(e)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var a=f((function(){t(i,r)}));"error"===a.status&&r(a.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=u,u.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){o.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=f(h,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,u=new this(i);++l<n;)c(e[l],l);return u;function c(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||r||(r=!0,o.resolve(u,a))}),(function(e){r||(r=!0,o.reject(u,e))}))}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n,r=e.length,a=!1;if(!r)return this.resolve([]);for(var s=-1,l=new this(i);++s<r;)n=e[s],t.resolve(n).then((function(e){a||(a=!0,o.resolve(l,e))}),(function(e){a||(a=!0,o.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,u=0,c=-1,d=0,h=8;function p(e){if(!(this instanceof p))return new p(e);this.options=i.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,f))!==u)throw new Error(a[n]);this._dict_set=!0}}function f(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}p.prototype.push=function(e,t){var n,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,a))&&n!==u)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==a||(this.onEnd(u),s.avail_out=0,!0)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=p,n.deflate=f,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),u=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,u,d,h,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?p.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(f),p.next_out=0,p.avail_out=f),(n=r.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(h="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===a.Z_BUF_ERROR&&!0===g&&(n=a.Z_OK,g=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&n!==a.Z_STREAM_END&&(0!==p.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),u=p.next_out-l,d=o.buf2string(p.output,l),p.next_out=u,p.avail_out=f-u,u&&i.arraySet(p.output,p.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((p.avail_in>0||0===p.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),p.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,a;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,o,s=t||e.length,u=new Array(2*s);for(r=0,n=0;n<s;)if((i=e[n++])<128)u[r++]=i;else if((o=a[i])>4)u[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<s;)i=i<<6|63&e[n++],o--;o>1?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e,o=e>>>16&65535,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var o=r,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return~e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),o=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),u=0,c=4,d=0,h=-2,p=-1,f=4,m=2,g=8,v=9,y=286,b=30,_=19,w=2*y+1,S=15,C=3,E=258,x=E+C+1,A=42,k=103,D=113,P=666,T=1,F=2,R=3,I=4;function O(e,t){return e.msg=l[t],t}function B(e){return(e<<1)-(e>4?9:0)}function M(e){for(var t=e.length;--t>=0;)e[t]=0}function L(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function N(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,L(e.strm)}function V(e,t){e.pending_buf[e.pending++]=t}function z(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function U(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+E,p=u[o+a-1],f=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+a]===f&&u[n+a-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<h);if(r=E-(h-o),o=h-E,r>a){if(e.match_start=t,a=r,r>=s)break;p=u[o+a-1],f=u[o+a]}}}while((t=d[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function H(e){var t,n,r,o,l,u,c,d,h,p,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-x)){i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=f?r-f:0}while(--n);t=n=f;do{r=e.prev[--t],e.prev[t]=r>=f?r-f:0}while(--n);o+=f}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,d=e.strstart+e.lookahead,h=o,p=void 0,(p=u.avail_in)>h&&(p=h),n=0===p?0:(u.avail_in-=p,i.arraySet(c,u.input,u.next_in,p,d),1===u.state.wrap?u.adler=a(u.adler,c,p,d):2===u.state.wrap&&(u.adler=s(u.adler,c,p,d)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=C)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+C-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<C)););}while(e.lookahead<x&&0!==e.strm.avail_in)}function W(e,t){for(var n,r;;){if(e.lookahead<x){if(H(e),e.lookahead<x&&t===u)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-x&&(e.match_length=U(e,n)),e.match_length>=C)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-C),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=C){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(N(e,!1),0===e.strm.avail_out))return T}return e.insert=e.strstart<C-1?e.strstart:C-1,t===c?(N(e,!0),0===e.strm.avail_out?R:I):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?T:F}function j(e,t){for(var n,r,i;;){if(e.lookahead<x){if(H(e),e.lookahead<x&&t===u)return T;if(0===e.lookahead)break}if(n=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=C-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-x&&(e.match_length=U(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===C&&e.strstart-e.match_start>4096)&&(e.match_length=C-1)),e.prev_length>=C&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-C,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-C),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=C-1,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return T}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return T}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<C-1?e.strstart:C-1,t===c?(N(e,!0),0===e.strm.avail_out?R:I):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?T:F}function $(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function G(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*w),this.dyn_dtree=new i.Buf16(2*(2*b+1)),this.bl_tree=new i.Buf16(2*(2*_+1)),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(S+1),this.heap=new i.Buf16(2*y+1),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*y+1),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function q(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?A:D,e.adler=2===t.wrap?0:1,t.last_flush=u,o._tr_init(t),d):O(e,h)}function K(e){var t,n=q(e);return n===d&&((t=e.state).window_size=2*t.w_size,M(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=C-1,t.match_available=0,t.ins_h=0),n}function Y(e,t,n,r,o,a){if(!e)return h;var s=1;if(t===p&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>v||n!==g||r<8||r>15||t<0||t>9||a<0||a>f)return O(e,h);8===r&&(r=9);var l=new G;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+C-1)/C),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,K(e)}r=[new $(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(H(e),0===e.lookahead&&t===u)return T;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,N(e,!1),0===e.strm.avail_out))return T;if(e.strstart-e.block_start>=e.w_size-x&&(N(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===c?(N(e,!0),0===e.strm.avail_out?R:I):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out),T)})),new $(4,4,8,4,W),new $(4,5,16,8,W),new $(4,6,32,32,W),new $(4,4,16,16,j),new $(8,16,32,32,j),new $(8,16,128,128,j),new $(8,32,128,256,j),new $(32,128,258,1024,j),new $(32,258,258,4096,j)],n.deflateInit=function(e,t){return Y(e,t,g,15,8,0)},n.deflateInit2=Y,n.deflateReset=K,n.deflateResetKeep=q,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,d):h},n.deflate=function(e,t){var n,i,a,l;if(!e||!e.state||t>5||t<0)return e?O(e,h):h;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===P&&t!==c)return O(e,0===e.avail_out?-5:h);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===A)if(2===i.wrap)e.adler=0,V(i,31),V(i,139),V(i,8),i.gzhead?(V(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),V(i,255&i.gzhead.time),V(i,i.gzhead.time>>8&255),V(i,i.gzhead.time>>16&255),V(i,i.gzhead.time>>24&255),V(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),V(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(V(i,255&i.gzhead.extra.length),V(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(V(i,0),V(i,0),V(i,0),V(i,0),V(i,0),V(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),V(i,3),i.status=D);else{var p=g+(i.w_bits-8<<4)<<8;p|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(p|=32),p+=31-p%31,i.status=D,z(i,p),0!==i.strstart&&(z(i,e.adler>>>16),z(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),L(e),a=i.pending,i.pending!==i.pending_buf_size));)V(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),L(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,V(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),L(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,V(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=k)}else i.status=k;if(i.status===k&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&L(e),i.pending+2<=i.pending_buf_size&&(V(i,255&e.adler),V(i,e.adler>>8&255),e.adler=0,i.status=D)):i.status=D),0!==i.pending){if(L(e),0===e.avail_out)return i.last_flush=-1,d}else if(0===e.avail_in&&B(t)<=B(n)&&t!==c)return O(e,-5);if(i.status===P&&0!==e.avail_in)return O(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==u&&i.status!==P){var f=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(H(e),0===e.lookahead)){if(t===u)return T;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===c?(N(e,!0),0===e.strm.avail_out?R:I):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?T:F}(i,t):3===i.strategy?function(e,t){for(var n,r,i,a,s=e.window;;){if(e.lookahead<=E){if(H(e),e.lookahead<=E&&t===u)return T;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=C&&e.strstart>0&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=e.strstart+E;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=E-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=C?(n=o._tr_tally(e,1,e.match_length-C),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(N(e,!1),0===e.strm.avail_out))return T}return e.insert=0,t===c?(N(e,!0),0===e.strm.avail_out?R:I):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?T:F}(i,t):r[i.level].func(i,t);if(f!==R&&f!==I||(i.status=P),f===T||f===R)return 0===e.avail_out&&(i.last_flush=-1),d;if(f===F&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(M(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),L(e),0===e.avail_out))return i.last_flush=-1,d}return t!==c?d:i.wrap<=0?1:(2===i.wrap?(V(i,255&e.adler),V(i,e.adler>>8&255),V(i,e.adler>>16&255),V(i,e.adler>>24&255),V(i,255&e.total_in),V(i,e.total_in>>8&255),V(i,e.total_in>>16&255),V(i,e.total_in>>24&255)):(z(i,e.adler>>>16),z(i,65535&e.adler)),L(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?d:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==A&&69!==t&&73!==t&&91!==t&&t!==k&&t!==D&&t!==P?O(e,h):(e.state=null,t===D?O(e,-3):d):h},n.deflateSetDictionary=function(e,t){var n,r,o,s,l,u,c,p,f=t.length;if(!e||!e.state)return h;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==A||n.lookahead)return h;for(1===s&&(e.adler=a(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(M(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new i.Buf8(n.w_size),i.arraySet(p,t,f-n.w_size,n.w_size,0),t=p,f=n.w_size),l=e.avail_in,u=e.next_in,c=e.input,e.avail_in=f,e.next_in=0,e.input=t,H(n);n.lookahead>=C;){r=n.strstart,o=n.lookahead-(C-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+C-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=C-1,H(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=C-1,n.match_available=0,e.next_in=u,e.input=c,e.avail_in=l,n.wrap=s,d},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,o,a,s,l,u,c,d,h,p,f,m,g,v,y,b,_,w,S,C,E,x,A;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),o=e.next_out,A=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,u=n.wsize,c=n.whave,d=n.wnext,h=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=x[r++]<<f,f+=8,p+=x[r++]<<f,f+=8),b=m[p&v];t:for(;;){if(p>>>=_=b>>>24,f-=_,0==(_=b>>>16&255))A[o++]=65535&b;else{if(!(16&_)){if(64&_){if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}b=m[(65535&b)+(p&(1<<_)-1)];continue t}for(w=65535&b,(_&=15)&&(f<_&&(p+=x[r++]<<f,f+=8),w+=p&(1<<_)-1,p>>>=_,f-=_),f<15&&(p+=x[r++]<<f,f+=8,p+=x[r++]<<f,f+=8),b=g[p&y];;){if(p>>>=_=b>>>24,f-=_,16&(_=b>>>16&255)){if(S=65535&b,f<(_&=15)&&(p+=x[r++]<<f,(f+=8)<_&&(p+=x[r++]<<f,f+=8)),(S+=p&(1<<_)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=_,f-=_,S>(_=o-a)){if((_=S-_)>c&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(C=0,E=h,0===d){if(C+=u-_,_<w){w-=_;do{A[o++]=h[C++]}while(--_);C=o-S,E=A}}else if(d<_){if(C+=u+d-_,(_-=d)<w){w-=_;do{A[o++]=h[C++]}while(--_);if(C=0,d<w){w-=_=d;do{A[o++]=h[C++]}while(--_);C=o-S,E=A}}}else if(C+=d-_,_<w){w-=_;do{A[o++]=h[C++]}while(--_);C=o-S,E=A}for(;w>2;)A[o++]=E[C++],A[o++]=E[C++],A[o++]=E[C++],w-=3;w&&(A[o++]=E[C++],w>1&&(A[o++]=E[C++]))}else{C=o-S;do{A[o++]=A[C++],A[o++]=A[C++],A[o++]=A[C++],w-=3}while(w>2);w&&(A[o++]=A[C++],w>1&&(A[o++]=A[C++]))}break}if(64&_){e.msg="invalid distance code",n.mode=30;break e}b=g[(65535&b)+(p&(1<<_)-1)]}}break}}while(r<i&&o<s);r-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=f}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=1,u=2,c=0,d=-2,h=1,p=12,f=30,m=852,g=592;function v(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(m),t.distcode=t.distdyn=new r.Buf32(g),t.sane=1,t.back=-1,c):d}function _(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,b(e)):d}function w(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?d:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,_(e))):d}function S(e,t){var n,r;return e?(r=new y,e.state=r,r.window=null,(n=w(e,t))!==c&&(e.state=null),n):d}var C,E,x=!0;function A(e){if(x){var t;for(C=new r.Buf32(512),E=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,C,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,E,0,e.work,{bits:5}),x=!1}e.lencode=C,e.lenbits=9,e.distcode=E,e.distbits=5}function k(e,t,n,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),r.arraySet(a.window,t,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}n.inflateReset=_,n.inflateReset2=w,n.inflateResetKeep=b,n.inflateInit=function(e){return S(e,15)},n.inflateInit2=S,n.inflate=function(e,t){var n,m,g,y,b,_,w,S,C,E,x,D,P,T,F,R,I,O,B,M,L,N,V,z,U=0,H=new r.Buf8(4),W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;(n=e.state).mode===p&&(n.mode=13),b=e.next_out,g=e.output,w=e.avail_out,y=e.next_in,m=e.input,_=e.avail_in,S=n.hold,C=n.bits,E=_,x=w,N=c;e:for(;;)switch(n.mode){case h:if(0===n.wrap){n.mode=13;break}for(;C<16;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(2&n.wrap&&35615===S){n.check=0,H[0]=255&S,H[1]=S>>>8&255,n.check=o(n.check,H,2,0),S=0,C=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&S)<<8)+(S>>8))%31){e.msg="incorrect header check",n.mode=f;break}if(8!=(15&S)){e.msg="unknown compression method",n.mode=f;break}if(C-=4,L=8+(15&(S>>>=4)),0===n.wbits)n.wbits=L;else if(L>n.wbits){e.msg="invalid window size",n.mode=f;break}n.dmax=1<<L,e.adler=n.check=1,n.mode=512&S?10:p,S=0,C=0;break;case 2:for(;C<16;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(n.flags=S,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=f;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=f;break}n.head&&(n.head.text=S>>8&1),512&n.flags&&(H[0]=255&S,H[1]=S>>>8&255,n.check=o(n.check,H,2,0)),S=0,C=0,n.mode=3;case 3:for(;C<32;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.head&&(n.head.time=S),512&n.flags&&(H[0]=255&S,H[1]=S>>>8&255,H[2]=S>>>16&255,H[3]=S>>>24&255,n.check=o(n.check,H,4,0)),S=0,C=0,n.mode=4;case 4:for(;C<16;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.head&&(n.head.xflags=255&S,n.head.os=S>>8),512&n.flags&&(H[0]=255&S,H[1]=S>>>8&255,n.check=o(n.check,H,2,0)),S=0,C=0,n.mode=5;case 5:if(1024&n.flags){for(;C<16;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.length=S,n.head&&(n.head.extra_len=S),512&n.flags&&(H[0]=255&S,H[1]=S>>>8&255,n.check=o(n.check,H,2,0)),S=0,C=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((D=n.length)>_&&(D=_),D&&(n.head&&(L=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,m,y,D,L)),512&n.flags&&(n.check=o(n.check,m,D,y)),_-=D,y+=D,n.length-=D),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===_)break e;D=0;do{L=m[y+D++],n.head&&L&&n.length<65536&&(n.head.name+=String.fromCharCode(L))}while(L&&D<_);if(512&n.flags&&(n.check=o(n.check,m,D,y)),_-=D,y+=D,L)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===_)break e;D=0;do{L=m[y+D++],n.head&&L&&n.length<65536&&(n.head.comment+=String.fromCharCode(L))}while(L&&D<_);if(512&n.flags&&(n.check=o(n.check,m,D,y)),_-=D,y+=D,L)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;C<16;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(S!==(65535&n.check)){e.msg="header crc mismatch",n.mode=f;break}S=0,C=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=p;break;case 10:for(;C<32;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}e.adler=n.check=v(S),S=0,C=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=S,n.bits=C,2;e.adler=n.check=1,n.mode=p;case p:if(5===t||6===t)break e;case 13:if(n.last){S>>>=7&C,C-=7&C,n.mode=27;break}for(;C<3;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}switch(n.last=1&S,C-=1,3&(S>>>=1)){case 0:n.mode=14;break;case 1:if(A(n),n.mode=20,6===t){S>>>=2,C-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=f}S>>>=2,C-=2;break;case 14:for(S>>>=7&C,C-=7&C;C<32;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if((65535&S)!=(S>>>16^65535)){e.msg="invalid stored block lengths",n.mode=f;break}if(n.length=65535&S,S=0,C=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(D=n.length){if(D>_&&(D=_),D>w&&(D=w),0===D)break e;r.arraySet(g,m,y,D,b),_-=D,y+=D,w-=D,b+=D,n.length-=D;break}n.mode=p;break;case 17:for(;C<14;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(n.nlen=257+(31&S),S>>>=5,C-=5,n.ndist=1+(31&S),S>>>=5,C-=5,n.ncode=4+(15&S),S>>>=4,C-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=f;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;C<3;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.lens[W[n.have++]]=7&S,S>>>=3,C-=3}for(;n.have<19;)n.lens[W[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,V={bits:n.lenbits},N=s(0,n.lens,0,19,n.lencode,0,n.work,V),n.lenbits=V.bits,N){e.msg="invalid code lengths set",n.mode=f;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;R=(U=n.lencode[S&(1<<n.lenbits)-1])>>>16&255,I=65535&U,!((F=U>>>24)<=C);){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(I<16)S>>>=F,C-=F,n.lens[n.have++]=I;else{if(16===I){for(z=F+2;C<z;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(S>>>=F,C-=F,0===n.have){e.msg="invalid bit length repeat",n.mode=f;break}L=n.lens[n.have-1],D=3+(3&S),S>>>=2,C-=2}else if(17===I){for(z=F+3;C<z;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}C-=F,L=0,D=3+(7&(S>>>=F)),S>>>=3,C-=3}else{for(z=F+7;C<z;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}C-=F,L=0,D=11+(127&(S>>>=F)),S>>>=7,C-=7}if(n.have+D>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=f;break}for(;D--;)n.lens[n.have++]=L}}if(n.mode===f)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=f;break}if(n.lenbits=9,V={bits:n.lenbits},N=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,V),n.lenbits=V.bits,N){e.msg="invalid literal/lengths set",n.mode=f;break}if(n.distbits=6,n.distcode=n.distdyn,V={bits:n.distbits},N=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,V),n.distbits=V.bits,N){e.msg="invalid distances set",n.mode=f;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(_>=6&&w>=258){e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=S,n.bits=C,a(e,x),b=e.next_out,g=e.output,w=e.avail_out,y=e.next_in,m=e.input,_=e.avail_in,S=n.hold,C=n.bits,n.mode===p&&(n.back=-1);break}for(n.back=0;R=(U=n.lencode[S&(1<<n.lenbits)-1])>>>16&255,I=65535&U,!((F=U>>>24)<=C);){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(R&&!(240&R)){for(O=F,B=R,M=I;R=(U=n.lencode[M+((S&(1<<O+B)-1)>>O)])>>>16&255,I=65535&U,!(O+(F=U>>>24)<=C);){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}S>>>=O,C-=O,n.back+=O}if(S>>>=F,C-=F,n.back+=F,n.length=I,0===R){n.mode=26;break}if(32&R){n.back=-1,n.mode=p;break}if(64&R){e.msg="invalid literal/length code",n.mode=f;break}n.extra=15&R,n.mode=22;case 22:if(n.extra){for(z=n.extra;C<z;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.length+=S&(1<<n.extra)-1,S>>>=n.extra,C-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;R=(U=n.distcode[S&(1<<n.distbits)-1])>>>16&255,I=65535&U,!((F=U>>>24)<=C);){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(!(240&R)){for(O=F,B=R,M=I;R=(U=n.distcode[M+((S&(1<<O+B)-1)>>O)])>>>16&255,I=65535&U,!(O+(F=U>>>24)<=C);){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}S>>>=O,C-=O,n.back+=O}if(S>>>=F,C-=F,n.back+=F,64&R){e.msg="invalid distance code",n.mode=f;break}n.offset=I,n.extra=15&R,n.mode=24;case 24:if(n.extra){for(z=n.extra;C<z;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}n.offset+=S&(1<<n.extra)-1,S>>>=n.extra,C-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=f;break}n.mode=25;case 25:if(0===w)break e;if(D=x-w,n.offset>D){if((D=n.offset-D)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=f;break}D>n.wnext?(D-=n.wnext,P=n.wsize-D):P=n.wnext-D,D>n.length&&(D=n.length),T=n.window}else T=g,P=b-n.offset,D=n.length;D>w&&(D=w),w-=D,n.length-=D;do{g[b++]=T[P++]}while(--D);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;g[b++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;C<32;){if(0===_)break e;_--,S|=m[y++]<<C,C+=8}if(x-=w,e.total_out+=x,n.total+=x,x&&(e.adler=n.check=n.flags?o(n.check,g,x,b-x):i(n.check,g,x,b-x)),x=w,(n.flags?S:v(S))!==n.check){e.msg="incorrect data check",n.mode=f;break}S=0,C=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;C<32;){if(0===_)break e;_--,S+=m[y++]<<C,C+=8}if(S!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=f;break}S=0,C=0}n.mode=29;case 29:N=1;break e;case f:N=-3;break e;case 31:return-4;default:return d}return e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=S,n.bits=C,(n.wsize||x!==e.avail_out&&n.mode<f&&(n.mode<27||4!==t))&&k(e,e.output,e.next_out,x-e.avail_out)?(n.mode=31,-4):(E-=e.avail_in,x-=e.avail_out,e.total_in+=E,e.total_out+=x,n.total+=x,n.wrap&&x&&(e.adler=n.check=n.flags?o(n.check,g,x,e.next_out-x):i(n.check,g,x,e.next_out-x)),e.data_type=n.bits+(n.last?64:0)+(n.mode===p?128:0)+(20===n.mode||15===n.mode?256:0),(0===E&&0===x||4===t)&&N===c&&(N=-5),N)},n.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,c},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?(n.head=t,t.done=!1,c):d},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?d:11===n.mode&&i(1,t,r,0)!==n.check?-3:k(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,c):d},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,u,c,d,h,p){var f,m,g,v,y,b,_,w,S,C=p.bits,E=0,x=0,A=0,k=0,D=0,P=0,T=0,F=0,R=0,I=0,O=null,B=0,M=new r.Buf16(16),L=new r.Buf16(16),N=null,V=0;for(E=0;E<=i;E++)M[E]=0;for(x=0;x<u;x++)M[t[n+x]]++;for(D=C,k=i;k>=1&&0===M[k];k--);if(D>k&&(D=k),0===k)return c[d++]=20971520,c[d++]=20971520,p.bits=1,0;for(A=1;A<k&&0===M[A];A++);for(D<A&&(D=A),F=1,E=1;E<=i;E++)if(F<<=1,(F-=M[E])<0)return-1;if(F>0&&(0===e||1!==k))return-1;for(L[1]=0,E=1;E<i;E++)L[E+1]=L[E]+M[E];for(x=0;x<u;x++)0!==t[n+x]&&(h[L[t[n+x]]++]=x);if(0===e?(O=N=h,b=19):1===e?(O=o,B-=257,N=a,V-=257,b=256):(O=s,N=l,b=-1),I=0,x=0,E=A,y=d,P=D,T=0,g=-1,v=(R=1<<D)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){_=E-T,h[x]<b?(w=0,S=h[x]):h[x]>b?(w=N[V+h[x]],S=O[B+h[x]]):(w=96,S=0),f=1<<E-T,A=m=1<<P;do{c[y+(I>>T)+(m-=f)]=_<<24|w<<16|S}while(0!==m);for(f=1<<E-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,x++,0==--M[E]){if(E===k)break;E=t[n+h[x]]}if(E>D&&(I&v)!==g){for(0===T&&(T=D),y+=A,F=1<<(P=E-T);P+T<k&&!((F-=M[P+T])<=0);)P++,F<<=1;if(R+=1<<P,1===e&&R>852||2===e&&R>592)return 1;c[g=I&v]=D<<24|P<<16|y-d}}return 0!==I&&(c[y+I]=E-T<<24|64<<16),p.bits=D,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common"),i=0,o=1;function a(e){for(var t=e.length;--t>=0;)e[t]=0}var s=0,l=29,u=256,c=u+1+l,d=30,h=19,p=2*c+1,f=15,m=16,g=7,v=256,y=16,b=17,_=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(c+2));a(x);var A=new Array(2*d);a(A);var k=new Array(512);a(k);var D=new Array(256);a(D);var P=new Array(l);a(P);var T,F,R,I=new Array(d);function O(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function B(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function M(e){return e<256?k[e]:k[256+(e>>>7)]}function L(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function N(e,t,n){e.bi_valid>m-n?(e.bi_buf|=t<<e.bi_valid&65535,L(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=n-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function V(e,t,n){N(e,n[2*t],n[2*t+1])}function z(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function U(e,t,n){var r,i,o=new Array(f+1),a=0;for(r=1;r<=f;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=z(o[s]++,s))}}function H(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function W(e){e.bi_valid>8?L(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function $(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&j(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!j(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function G(e,t,n){var r,i,o,a,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?V(e,i,t):(V(e,(o=D[i])+u+1,t),0!==(a=w[o])&&N(e,i-=P[o],a),V(e,o=M(--r),n),0!==(a=S[o])&&N(e,r-=I[o],a))}while(s<e.last_lit);V(e,v,t)}function q(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=p,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)$(e,o,n);i=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,$(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,v=0;for(o=0;o<=f;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<p;n++)(o=l[2*l[2*(r=e.heap[n])+1]+1]+1)>g&&(o=g,v++),l[2*r+1]=o,r>u||(e.bl_count[o]++,a=0,r>=m&&(a=h[r-m]),s=l[2*r],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(c[2*r+1]+a)));if(0!==v){do{for(o=g-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[g]--,v-=2}while(v>0);for(o=g;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),r--)}}(e,t),U(o,u,e.bl_count)}function K(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*y]++):s<=10?e.bl_tree[2*b]++:e.bl_tree[2*_]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function Y(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<l&&i===a)){if(s<u)do{V(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(V(e,i,e.bl_tree),s--),V(e,y,e.bl_tree),N(e,s-3,2)):s<=10?(V(e,b,e.bl_tree),N(e,s-3,3)):(V(e,_,e.bl_tree),N(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}}a(I);var X=!1;function Z(e,t,n,i){N(e,(s<<1)+(i?1:0),3),function(e,t,n,i){W(e),i&&(L(e,n),L(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){X||(function(){var e,t,n,r,i,o=new Array(f+1);for(n=0,r=0;r<l-1;r++)for(P[r]=n,e=0;e<1<<w[r];e++)D[n++]=r;for(D[n-1]=r,i=0,r=0;r<16;r++)for(I[r]=i,e=0;e<1<<S[r];e++)k[i++]=r;for(i>>=7;r<d;r++)for(I[r]=i<<7,e=0;e<1<<S[r]-7;e++)k[256+i++]=r;for(t=0;t<=f;t++)o[t]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,o[8]++;for(;e<=255;)x[2*e+1]=9,e++,o[9]++;for(;e<=279;)x[2*e+1]=7,e++,o[7]++;for(;e<=287;)x[2*e+1]=8,e++,o[8]++;for(U(x,c+1,o),e=0;e<d;e++)A[2*e+1]=5,A[2*e]=z(e,5);T=new O(x,w,u+1,c,f),F=new O(A,S,0,d,f),R=new O(new Array(0),C,0,h,g)}(),X=!0),e.l_desc=new B(e.dyn_ltree,T),e.d_desc=new B(e.dyn_dtree,F),e.bl_desc=new B(e.bl_tree,R),e.bi_buf=0,e.bi_valid=0,H(e)},n._tr_stored_block=Z,n._tr_flush_block=function(e,t,n,r){var a,s,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<u;t++)if(0!==e.dyn_ltree[2*t])return o;return i}(e)),q(e,e.l_desc),q(e,e.d_desc),l=function(e){var t;for(K(e,e.dyn_ltree,e.l_desc.max_code),K(e,e.dyn_dtree,e.d_desc.max_code),q(e,e.bl_desc),t=h-1;t>=3&&0===e.bl_tree[2*E[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=n+5,n+4<=a&&-1!==t?Z(e,t,n,r):4===e.strategy||s===a?(N(e,2+(r?1:0),3),G(e,x,A)):(N(e,4+(r?1:0),3),function(e,t,n,r){var i;for(N(e,t-257,5),N(e,n-1,5),N(e,r-4,4),i=0;i<r;i++)N(e,e.bl_tree[2*E[i]+1],3);Y(e,e.dyn_ltree,t-1),Y(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),G(e,e.dyn_ltree,e.dyn_dtree)),H(e),r&&W(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(D[n]+u+1)]++,e.dyn_dtree[2*M(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){N(e,2,3),V(e,v,x),function(e){16===e.bi_valid?(L(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r=1,i={},o=!1,a=e.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(e);s=s&&s.setTimeout?s:e,"[object process]"==={}.toString.call(e.process)?n=function(e){process.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(c="setImmediate$"+Math.random()+"$",d=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(c)&&p(+t.data.slice(c.length))},e.addEventListener?e.addEventListener("message",d,!1):e.attachEvent("onmessage",d),n=function(t){e.postMessage(c+t,"*")}):e.MessageChannel?((u=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){u.port2.postMessage(e)}):a&&"onreadystatechange"in a.createElement("script")?(l=a.documentElement,n=function(e){var t=a.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,l.removeChild(t),t=null},l.appendChild(t)}):n=function(e){setTimeout(p,0,e)},s.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var a={callback:e,args:t};return i[r]=a,n(r),r++},s.clearImmediate=h}var l,u,c,d;function h(e){delete i[e]}function p(e){if(o)setTimeout(p,0,e);else{var n=i[e];if(n){o=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{h(e),o=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9294:e=>{"use strict";if(!t)var t={cwd:function(){return"/"}};function n(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+e)}function r(e,t){for(var n,r="",i=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(i===a-1||1===o);else if(i!==a-1&&2===o){if(r.length<2||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){for(var s=r.length-1,l=s;l>=0&&47!==r.charCodeAt(l);--l);if(l!==s){r=-1===l?"":r.slice(0,l),i=a,o=0;continue}}else if(2===r.length||1===r.length){r="",i=a,o=0;continue}t&&(r.length>0?r+="/..":r="..")}else r.length>0?r+="/"+e.slice(i+1,a):r=e.slice(i+1,a);i=a,o=0}else 46===n&&-1!==o?++o:o=-1}return r}var i={resolve:function(){for(var e,i="",o=!1,a=arguments.length-1;a>=-1&&!o;a--){var s;a>=0?s=arguments[a]:(void 0===e&&(e=t.cwd()),s=e),n(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=r(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(n(e),0===e.length)return".";var t=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!t)).length||t||(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];n(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":i.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=i.resolve(e))===(t=i.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var o=e.length,a=o-r,s=1;s<t.length&&47===t.charCodeAt(s);++s);for(var l=t.length-s,u=a<l?a:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(47===t.charCodeAt(s+d))return t.slice(s+d+1);if(0===d)return t.slice(s+d)}else a>u&&(47===e.charCodeAt(r+d)?c=d:0===d&&(c=0));break}var h=e.charCodeAt(r+d);if(h!==t.charCodeAt(s+d))break;47===h&&(c=d)}var p="";for(d=r+c+1;d<=o;++d)d!==o&&47!==e.charCodeAt(d)||(0===p.length?p+="..":p+="/..");return p.length>0?p+t.slice(s+c):(s+=c,47===t.charCodeAt(s)&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,i=-1,o=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!o){i=a;break}}else o=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');n(e);var r,i=0,o=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,l=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!a){i=r+1;break}}else-1===l&&(a=!1,l=r+1),s>=0&&(u===t.charCodeAt(s)?-1==--s&&(o=r):(s=-1,o=l))}return i===o?o=l:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else-1===o&&(a=!1,o=r+1);return-1===o?"":e.slice(i,o)},extname:function(e){n(e);for(var t=-1,r=0,i=-1,o=!0,a=0,s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(47!==l)-1===i&&(o=!1,i=s+1),46===l?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!o){r=s+1;break}}return-1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,i=e.charCodeAt(0),o=47===i;o?(t.root="/",r=1):r=0;for(var a=-1,s=0,l=-1,u=!0,c=e.length-1,d=0;c>=r;--c)if(47!==(i=e.charCodeAt(c)))-1===l&&(u=!1,l=c+1),46===i?-1===a?a=c:1!==d&&(d=1):-1!==a&&(d=-1);else if(!u){s=c+1;break}return-1===a||-1===l||0===d||1===d&&a===l-1&&a===s+1?-1!==l&&(t.base=t.name=0===s&&o?e.slice(1,l):e.slice(s,l)):(0===s&&o?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(s,a),t.base=e.slice(s,l)),t.ext=e.slice(a,l)),s>0?t.dir=e.slice(0,s-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null};e.exports=i},3410:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(7786))&&r.__esModule?r:{default:r},o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(7755));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=function(e){return new i.default(e)};Object.assign(s,o),delete s.__esModule;var l=s;t.default=l,e.exports=t.default},8510:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i,o=E(n(2778)),a=E(n(3318)),s=E(n(9876)),l=E(n(3414)),u=E(n(8038)),c=E(n(9868)),d=E(n(2822)),h=E(n(3751)),p=C(n(8918)),f=E(n(7436)),m=E(n(1875)),g=E(n(6528)),v=E(n(1217)),y=C(n(7563)),b=C(n(9704)),_=C(n(1420)),w=n(9532);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}function C(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function E(e){return e&&e.__esModule?e:{default:e}}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=((r={})[b.space]=!0,r[b.cr]=!0,r[b.feed]=!0,r[b.newline]=!0,r[b.tab]=!0,r),k=Object.assign({},A,((i={})[b.comment]=!0,i));function D(e){return{line:e[y.FIELDS.START_LINE],column:e[y.FIELDS.START_COL]}}function P(e){return{line:e[y.FIELDS.END_LINE],column:e[y.FIELDS.END_COL]}}function T(e,t,n,r){return{start:{line:e,column:t},end:{line:n,column:r}}}function F(e){return T(e[y.FIELDS.START_LINE],e[y.FIELDS.START_COL],e[y.FIELDS.END_LINE],e[y.FIELDS.END_COL])}function R(e,t){if(e)return T(e[y.FIELDS.START_LINE],e[y.FIELDS.START_COL],t[y.FIELDS.END_LINE],t[y.FIELDS.END_COL])}function I(e,t){var n=e[t];if("string"==typeof n)return-1!==n.indexOf("\\")&&((0,w.ensureObject)(e,"raws"),e[t]=(0,w.unesc)(n),void 0===e.raws[t]&&(e.raws[t]=n)),e}function O(e,t){for(var n=-1,r=[];-1!==(n=e.indexOf(t,n+1));)r.push(n);return r}var B=function(){function e(e,t){void 0===t&&(t={}),this.rule=e,this.options=Object.assign({lossy:!1,safe:!1},t),this.position=0,this.css="string"==typeof this.rule?this.rule:this.rule.selector,this.tokens=(0,y.default)({css:this.css,error:this._errorGenerator(),safe:this.options.safe});var n=R(this.tokens[0],this.tokens[this.tokens.length-1]);this.root=new o.default({source:n}),this.root.errorGenerator=this._errorGenerator();var r=new a.default({source:{start:{line:1,column:1}}});this.root.append(r),this.current=r,this.loop()}var t,n,r=e.prototype;return r._errorGenerator=function(){var e=this;return function(t,n){return"string"==typeof e.rule?new Error(t):e.rule.error(t,n)}},r.attribute=function(){var e=[],t=this.currToken;for(this.position++;this.position<this.tokens.length&&this.currToken[y.FIELDS.TYPE]!==b.closeSquare;)e.push(this.currToken),this.position++;if(this.currToken[y.FIELDS.TYPE]!==b.closeSquare)return this.expected("closing square bracket",this.currToken[y.FIELDS.START_POS]);var n=e.length,r={source:T(t[1],t[2],this.currToken[3],this.currToken[4]),sourceIndex:t[y.FIELDS.START_POS]};if(1===n&&!~[b.word].indexOf(e[0][y.FIELDS.TYPE]))return this.expected("attribute",e[0][y.FIELDS.START_POS]);for(var i=0,o="",a="",s=null,l=!1;i<n;){var u=e[i],c=this.content(u),d=e[i+1];switch(u[y.FIELDS.TYPE]){case b.space:if(l=!0,this.options.lossy)break;if(s){(0,w.ensureObject)(r,"spaces",s);var h=r.spaces[s].after||"";r.spaces[s].after=h+c;var f=(0,w.getProp)(r,"raws","spaces",s,"after")||null;f&&(r.raws.spaces[s].after=f+c)}else o+=c,a+=c;break;case b.asterisk:d[y.FIELDS.TYPE]===b.equals?(r.operator=c,s="operator"):r.namespace&&("namespace"!==s||l)||!d||(o&&((0,w.ensureObject)(r,"spaces","attribute"),r.spaces.attribute.before=o,o=""),a&&((0,w.ensureObject)(r,"raws","spaces","attribute"),r.raws.spaces.attribute.before=o,a=""),r.namespace=(r.namespace||"")+c,(0,w.getProp)(r,"raws","namespace")&&(r.raws.namespace+=c),s="namespace"),l=!1;break;case b.dollar:if("value"===s){var m=(0,w.getProp)(r,"raws","value");r.value+="$",m&&(r.raws.value=m+"$");break}case b.caret:d[y.FIELDS.TYPE]===b.equals&&(r.operator=c,s="operator"),l=!1;break;case b.combinator:if("~"===c&&d[y.FIELDS.TYPE]===b.equals&&(r.operator=c,s="operator"),"|"!==c){l=!1;break}d[y.FIELDS.TYPE]===b.equals?(r.operator=c,s="operator"):r.namespace||r.attribute||(r.namespace=!0),l=!1;break;case b.word:if(d&&"|"===this.content(d)&&e[i+2]&&e[i+2][y.FIELDS.TYPE]!==b.equals&&!r.operator&&!r.namespace)r.namespace=c,s="namespace";else if(!r.attribute||"attribute"===s&&!l)o&&((0,w.ensureObject)(r,"spaces","attribute"),r.spaces.attribute.before=o,o=""),a&&((0,w.ensureObject)(r,"raws","spaces","attribute"),r.raws.spaces.attribute.before=a,a=""),r.attribute=(r.attribute||"")+c,(0,w.getProp)(r,"raws","attribute")&&(r.raws.attribute+=c),s="attribute";else if(!r.value&&""!==r.value||"value"===s&&!l&&!r.quoteMark){var g=(0,w.unesc)(c),v=(0,w.getProp)(r,"raws","value")||"",_=r.value||"";r.value=_+g,r.quoteMark=null,(g!==c||v)&&((0,w.ensureObject)(r,"raws"),r.raws.value=(v||_)+c),s="value"}else{var S="i"===c||"I"===c;!r.value&&""!==r.value||!r.quoteMark&&!l?(r.value||""===r.value)&&(s="value",r.value+=c,r.raws.value&&(r.raws.value+=c)):(r.insensitive=S,S&&"I"!==c||((0,w.ensureObject)(r,"raws"),r.raws.insensitiveFlag=c),s="insensitive",o&&((0,w.ensureObject)(r,"spaces","insensitive"),r.spaces.insensitive.before=o,o=""),a&&((0,w.ensureObject)(r,"raws","spaces","insensitive"),r.raws.spaces.insensitive.before=a,a=""))}l=!1;break;case b.str:if(!r.attribute||!r.operator)return this.error("Expected an attribute followed by an operator preceding the string.",{index:u[y.FIELDS.START_POS]});var C=(0,p.unescapeValue)(c),E=C.unescaped,x=C.quoteMark;r.value=E,r.quoteMark=x,s="value",(0,w.ensureObject)(r,"raws"),r.raws.value=c,l=!1;break;case b.equals:if(!r.attribute)return this.expected("attribute",u[y.FIELDS.START_POS],c);if(r.value)return this.error('Unexpected "=" found; an operator was already defined.',{index:u[y.FIELDS.START_POS]});r.operator=r.operator?r.operator+c:c,s="operator",l=!1;break;case b.comment:if(s)if(l||d&&d[y.FIELDS.TYPE]===b.space||"insensitive"===s){var A=(0,w.getProp)(r,"spaces",s,"after")||"",k=(0,w.getProp)(r,"raws","spaces",s,"after")||A;(0,w.ensureObject)(r,"raws","spaces",s),r.raws.spaces[s].after=k+c}else{var D=r[s]||"",P=(0,w.getProp)(r,"raws",s)||D;(0,w.ensureObject)(r,"raws"),r.raws[s]=P+c}else a+=c;break;default:return this.error('Unexpected "'+c+'" found.',{index:u[y.FIELDS.START_POS]})}i++}I(r,"attribute"),I(r,"namespace"),this.newNode(new p.default(r)),this.position++},r.parseWhitespaceEquivalentTokens=function(e){e<0&&(e=this.tokens.length);var t=this.position,n=[],r="",i=void 0;do{if(A[this.currToken[y.FIELDS.TYPE]])this.options.lossy||(r+=this.content());else if(this.currToken[y.FIELDS.TYPE]===b.comment){var o={};r&&(o.before=r,r=""),i=new l.default({value:this.content(),source:F(this.currToken),sourceIndex:this.currToken[y.FIELDS.START_POS],spaces:o}),n.push(i)}}while(++this.position<e);if(r)if(i)i.spaces.after=r;else if(!this.options.lossy){var a=this.tokens[t],s=this.tokens[this.position-1];n.push(new d.default({value:"",source:T(a[y.FIELDS.START_LINE],a[y.FIELDS.START_COL],s[y.FIELDS.END_LINE],s[y.FIELDS.END_COL]),sourceIndex:a[y.FIELDS.START_POS],spaces:{before:r,after:""}}))}return n},r.convertWhitespaceNodesToSpace=function(e,t){var n=this;void 0===t&&(t=!1);var r="",i="";return e.forEach((function(e){var o=n.lossySpace(e.spaces.before,t),a=n.lossySpace(e.rawSpaceBefore,t);r+=o+n.lossySpace(e.spaces.after,t&&0===o.length),i+=o+e.value+n.lossySpace(e.rawSpaceAfter,t&&0===a.length)})),i===r&&(i=void 0),{space:r,rawSpace:i}},r.isNamedCombinator=function(e){return void 0===e&&(e=this.position),this.tokens[e+0]&&this.tokens[e+0][y.FIELDS.TYPE]===b.slash&&this.tokens[e+1]&&this.tokens[e+1][y.FIELDS.TYPE]===b.word&&this.tokens[e+2]&&this.tokens[e+2][y.FIELDS.TYPE]===b.slash},r.namedCombinator=function(){if(this.isNamedCombinator()){var e=this.content(this.tokens[this.position+1]),t=(0,w.unesc)(e).toLowerCase(),n={};t!==e&&(n.value="/"+e+"/");var r=new m.default({value:"/"+t+"/",source:T(this.currToken[y.FIELDS.START_LINE],this.currToken[y.FIELDS.START_COL],this.tokens[this.position+2][y.FIELDS.END_LINE],this.tokens[this.position+2][y.FIELDS.END_COL]),sourceIndex:this.currToken[y.FIELDS.START_POS],raws:n});return this.position=this.position+3,r}this.unexpected()},r.combinator=function(){var e=this;if("|"===this.content())return this.namespace();var t=this.locateNextMeaningfulToken(this.position);if(!(t<0||this.tokens[t][y.FIELDS.TYPE]===b.comma)){var n,r=this.currToken,i=void 0;if(t>this.position&&(i=this.parseWhitespaceEquivalentTokens(t)),this.isNamedCombinator()?n=this.namedCombinator():this.currToken[y.FIELDS.TYPE]===b.combinator?(n=new m.default({value:this.content(),source:F(this.currToken),sourceIndex:this.currToken[y.FIELDS.START_POS]}),this.position++):A[this.currToken[y.FIELDS.TYPE]]||i||this.unexpected(),n){if(i){var o=this.convertWhitespaceNodesToSpace(i),a=o.space,s=o.rawSpace;n.spaces.before=a,n.rawSpaceBefore=s}}else{var l=this.convertWhitespaceNodesToSpace(i,!0),u=l.space,c=l.rawSpace;c||(c=u);var d={},h={spaces:{}};u.endsWith(" ")&&c.endsWith(" ")?(d.before=u.slice(0,u.length-1),h.spaces.before=c.slice(0,c.length-1)):u.startsWith(" ")&&c.startsWith(" ")?(d.after=u.slice(1),h.spaces.after=c.slice(1)):h.value=c,n=new m.default({value:" ",source:R(r,this.tokens[this.position-1]),sourceIndex:r[y.FIELDS.START_POS],spaces:d,raws:h})}return this.currToken&&this.currToken[y.FIELDS.TYPE]===b.space&&(n.spaces.after=this.optionalSpace(this.content()),this.position++),this.newNode(n)}var p=this.parseWhitespaceEquivalentTokens(t);if(p.length>0){var f=this.current.last;if(f){var g=this.convertWhitespaceNodesToSpace(p),v=g.space,_=g.rawSpace;void 0!==_&&(f.rawSpaceAfter+=_),f.spaces.after+=v}else p.forEach((function(t){return e.newNode(t)}))}},r.comma=function(){if(this.position===this.tokens.length-1)return this.root.trailingComma=!0,void this.position++;this.current._inferEndPosition();var e=new a.default({source:{start:D(this.tokens[this.position+1])}});this.current.parent.append(e),this.current=e,this.position++},r.comment=function(){var e=this.currToken;this.newNode(new l.default({value:this.content(),source:F(e),sourceIndex:e[y.FIELDS.START_POS]})),this.position++},r.error=function(e,t){throw this.root.error(e,t)},r.missingBackslash=function(){return this.error("Expected a backslash preceding the semicolon.",{index:this.currToken[y.FIELDS.START_POS]})},r.missingParenthesis=function(){return this.expected("opening parenthesis",this.currToken[y.FIELDS.START_POS])},r.missingSquareBracket=function(){return this.expected("opening square bracket",this.currToken[y.FIELDS.START_POS])},r.unexpected=function(){return this.error("Unexpected '"+this.content()+"'. Escaping special characters with \\ may help.",this.currToken[y.FIELDS.START_POS])},r.unexpectedPipe=function(){return this.error("Unexpected '|'.",this.currToken[y.FIELDS.START_POS])},r.namespace=function(){var e=this.prevToken&&this.content(this.prevToken)||!0;return this.nextToken[y.FIELDS.TYPE]===b.word?(this.position++,this.word(e)):this.nextToken[y.FIELDS.TYPE]===b.asterisk?(this.position++,this.universal(e)):void this.unexpectedPipe()},r.nesting=function(){if(this.nextToken&&"|"===this.content(this.nextToken))this.position++;else{var e=this.currToken;this.newNode(new g.default({value:this.content(),source:F(e),sourceIndex:e[y.FIELDS.START_POS]})),this.position++}},r.parentheses=function(){var e=this.current.last,t=1;if(this.position++,e&&e.type===_.PSEUDO){var n=new a.default({source:{start:D(this.tokens[this.position-1])}}),r=this.current;for(e.append(n),this.current=n;this.position<this.tokens.length&&t;)this.currToken[y.FIELDS.TYPE]===b.openParenthesis&&t++,this.currToken[y.FIELDS.TYPE]===b.closeParenthesis&&t--,t?this.parse():(this.current.source.end=P(this.currToken),this.current.parent.source.end=P(this.currToken),this.position++);this.current=r}else{for(var i,o=this.currToken,s="(";this.position<this.tokens.length&&t;)this.currToken[y.FIELDS.TYPE]===b.openParenthesis&&t++,this.currToken[y.FIELDS.TYPE]===b.closeParenthesis&&t--,i=this.currToken,s+=this.parseParenthesisToken(this.currToken),this.position++;e?e.appendToPropertyAndEscape("value",s,s):this.newNode(new d.default({value:s,source:T(o[y.FIELDS.START_LINE],o[y.FIELDS.START_COL],i[y.FIELDS.END_LINE],i[y.FIELDS.END_COL]),sourceIndex:o[y.FIELDS.START_POS]}))}if(t)return this.expected("closing parenthesis",this.currToken[y.FIELDS.START_POS])},r.pseudo=function(){for(var e=this,t="",n=this.currToken;this.currToken&&this.currToken[y.FIELDS.TYPE]===b.colon;)t+=this.content(),this.position++;return this.currToken?this.currToken[y.FIELDS.TYPE]!==b.word?this.expected(["pseudo-class","pseudo-element"],this.currToken[y.FIELDS.START_POS]):void this.splitWord(!1,(function(r,i){t+=r,e.newNode(new h.default({value:t,source:R(n,e.currToken),sourceIndex:n[y.FIELDS.START_POS]})),i>1&&e.nextToken&&e.nextToken[y.FIELDS.TYPE]===b.openParenthesis&&e.error("Misplaced parenthesis.",{index:e.nextToken[y.FIELDS.START_POS]})})):this.expected(["pseudo-class","pseudo-element"],this.position-1)},r.space=function(){var e=this.content();0===this.position||this.prevToken[y.FIELDS.TYPE]===b.comma||this.prevToken[y.FIELDS.TYPE]===b.openParenthesis||this.current.nodes.every((function(e){return"comment"===e.type}))?(this.spaces=this.optionalSpace(e),this.position++):this.position===this.tokens.length-1||this.nextToken[y.FIELDS.TYPE]===b.comma||this.nextToken[y.FIELDS.TYPE]===b.closeParenthesis?(this.current.last.spaces.after=this.optionalSpace(e),this.position++):this.combinator()},r.string=function(){var e=this.currToken;this.newNode(new d.default({value:this.content(),source:F(e),sourceIndex:e[y.FIELDS.START_POS]})),this.position++},r.universal=function(e){var t=this.nextToken;if(t&&"|"===this.content(t))return this.position++,this.namespace();var n=this.currToken;this.newNode(new f.default({value:this.content(),source:F(n),sourceIndex:n[y.FIELDS.START_POS]}),e),this.position++},r.splitWord=function(e,t){for(var n=this,r=this.nextToken,i=this.content();r&&~[b.dollar,b.caret,b.equals,b.word].indexOf(r[y.FIELDS.TYPE]);){this.position++;var o=this.content();if(i+=o,o.lastIndexOf("\\")===o.length-1){var a=this.nextToken;a&&a[y.FIELDS.TYPE]===b.space&&(i+=this.requiredSpace(this.content(a)),this.position++)}r=this.nextToken}var l=O(i,".").filter((function(e){var t="\\"===i[e-1],n=/^\d+\.\d+%$/.test(i);return!t&&!n})),d=O(i,"#").filter((function(e){return"\\"!==i[e-1]})),h=O(i,"#{");h.length&&(d=d.filter((function(e){return!~h.indexOf(e)})));var p=(0,v.default)(function(){var e=Array.prototype.concat.apply([],arguments);return e.filter((function(t,n){return n===e.indexOf(t)}))}([0].concat(l,d)));p.forEach((function(r,o){var a,h=p[o+1]||i.length,f=i.slice(r,h);if(0===o&&t)return t.call(n,f,p.length);var m=n.currToken,g=m[y.FIELDS.START_POS]+p[o],v=T(m[1],m[2]+r,m[3],m[2]+(h-1));if(~l.indexOf(r)){var b={value:f.slice(1),source:v,sourceIndex:g};a=new s.default(I(b,"value"))}else if(~d.indexOf(r)){var _={value:f.slice(1),source:v,sourceIndex:g};a=new u.default(I(_,"value"))}else{var w={value:f,source:v,sourceIndex:g};I(w,"value"),a=new c.default(w)}n.newNode(a,e),e=null})),this.position++},r.word=function(e){var t=this.nextToken;return t&&"|"===this.content(t)?(this.position++,this.namespace()):this.splitWord(e)},r.loop=function(){for(;this.position<this.tokens.length;)this.parse(!0);return this.current._inferEndPosition(),this.root},r.parse=function(e){switch(this.currToken[y.FIELDS.TYPE]){case b.space:this.space();break;case b.comment:this.comment();break;case b.openParenthesis:this.parentheses();break;case b.closeParenthesis:e&&this.missingParenthesis();break;case b.openSquare:this.attribute();break;case b.dollar:case b.caret:case b.equals:case b.word:this.word();break;case b.colon:this.pseudo();break;case b.comma:this.comma();break;case b.asterisk:this.universal();break;case b.ampersand:this.nesting();break;case b.slash:case b.combinator:this.combinator();break;case b.str:this.string();break;case b.closeSquare:this.missingSquareBracket();case b.semicolon:this.missingBackslash();default:this.unexpected()}},r.expected=function(e,t,n){if(Array.isArray(e)){var r=e.pop();e=e.join(", ")+" or "+r}var i=/^[aeiou]/.test(e[0])?"an":"a";return n?this.error("Expected "+i+" "+e+', found "'+n+'" instead.',{index:t}):this.error("Expected "+i+" "+e+".",{index:t})},r.requiredSpace=function(e){return this.options.lossy?" ":e},r.optionalSpace=function(e){return this.options.lossy?"":e},r.lossySpace=function(e,t){return this.options.lossy?t?" ":"":e},r.parseParenthesisToken=function(e){var t=this.content(e);return e[y.FIELDS.TYPE]===b.space?this.requiredSpace(t):t},r.newNode=function(e,t){return t&&(/^ +$/.test(t)&&(this.options.lossy||(this.spaces=(this.spaces||"")+t),t=!0),e.namespace=t,I(e,"namespace")),this.spaces&&(e.spaces.before=this.spaces,this.spaces=""),this.current.append(e)},r.content=function(e){return void 0===e&&(e=this.currToken),this.css.slice(e[y.FIELDS.START_POS],e[y.FIELDS.END_POS])},r.locateNextMeaningfulToken=function(e){void 0===e&&(e=this.position+1);for(var t=e;t<this.tokens.length;){if(!k[this.tokens[t][y.FIELDS.TYPE]])return t;t++}return-1},t=e,(n=[{key:"currToken",get:function(){return this.tokens[this.position]}},{key:"nextToken",get:function(){return this.tokens[this.position+1]}},{key:"prevToken",get:function(){return this.tokens[this.position-1]}}])&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=B,e.exports=t.default},7786:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8510))&&r.__esModule?r:{default:r},o=function(){function e(e,t){this.func=e||function(){},this.funcRes=null,this.options=t}var t=e.prototype;return t._shouldUpdateSelector=function(e,t){return void 0===t&&(t={}),!1!==Object.assign({},this.options,t).updateSelector&&"string"!=typeof e},t._isLossy=function(e){return void 0===e&&(e={}),!1===Object.assign({},this.options,e).lossless},t._root=function(e,t){return void 0===t&&(t={}),new i.default(e,this._parseOptions(t)).root},t._parseOptions=function(e){return{lossy:this._isLossy(e)}},t._run=function(e,t){var n=this;return void 0===t&&(t={}),new Promise((function(r,i){try{var o=n._root(e,t);Promise.resolve(n.func(o)).then((function(r){var i=void 0;return n._shouldUpdateSelector(e,t)&&(i=o.toString(),e.selector=i),{transform:r,root:o,string:i}})).then(r,i)}catch(e){return void i(e)}}))},t._runSync=function(e,t){void 0===t&&(t={});var n=this._root(e,t),r=this.func(n);if(r&&"function"==typeof r.then)throw new Error("Selector processor returned a promise to a synchronous call.");var i=void 0;return t.updateSelector&&"string"!=typeof e&&(i=n.toString(),e.selector=i),{transform:r,root:n,string:i}},t.ast=function(e,t){return this._run(e,t).then((function(e){return e.root}))},t.astSync=function(e,t){return this._runSync(e,t).root},t.transform=function(e,t){return this._run(e,t).then((function(e){return e.transform}))},t.transformSync=function(e,t){return this._runSync(e,t).transform},t.process=function(e,t){return this._run(e,t).then((function(e){return e.string||e.root.toString()}))},t.processSync=function(e,t){var n=this._runSync(e,t);return n.string||n.root.toString()},e}();t.default=o,e.exports=t.default},8918:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0,t.unescapeValue=g;var r,i=l(n(8820)),o=l(n(406)),a=l(n(1607)),s=n(1420);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}var d=n(4927),h=/^('|")([^]*)\1$/,p=d((function(){}),"Assigning an attribute a value containing characters that might need to be escaped is deprecated. Call attribute.setValue() instead."),f=d((function(){}),"Assigning attr.quoted is deprecated and has no effect. Assign to attr.quoteMark instead."),m=d((function(){}),"Constructing an Attribute selector with a value without specifying quoteMark is deprecated. Note: The value should be unescaped now.");function g(e){var t=!1,n=null,r=e,i=r.match(h);return i&&(n=i[1],r=i[2]),(r=(0,o.default)(r))!==e&&(t=!0),{deprecatedUsage:t,unescaped:r,quoteMark:n}}var v=function(e){var t,n;function r(t){var n;return void 0===t&&(t={}),n=e.call(this,function(e){if(void 0!==e.quoteMark)return e;if(void 0===e.value)return e;m();var t=g(e.value),n=t.quoteMark,r=t.unescaped;return e.raws||(e.raws={}),void 0===e.raws.value&&(e.raws.value=e.value),e.value=r,e.quoteMark=n,e}(t))||this,n.type=s.ATTRIBUTE,n.raws=n.raws||{},Object.defineProperty(n.raws,"unquoted",{get:d((function(){return n.value}),"attr.raws.unquoted is deprecated. Call attr.value instead."),set:d((function(){return n.value}),"Setting attr.raws.unquoted is deprecated and has no effect. attr.value is unescaped by default now.")}),n._constructed=!0,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var o,a,l=r.prototype;return l.getQuotedValue=function(e){void 0===e&&(e={});var t=this._determineQuoteMark(e),n=y[t];return(0,i.default)(this._value,n)},l._determineQuoteMark=function(e){return e.smart?this.smartQuoteMark(e):this.preferredQuoteMark(e)},l.setValue=function(e,t){void 0===t&&(t={}),this._value=e,this._quoteMark=this._determineQuoteMark(t),this._syncRawValue()},l.smartQuoteMark=function(e){var t=this.value,n=t.replace(/[^']/g,"").length,o=t.replace(/[^"]/g,"").length;if(n+o===0){var a=(0,i.default)(t,{isIdentifier:!0});if(a===t)return r.NO_QUOTE;var s=this.preferredQuoteMark(e);if(s===r.NO_QUOTE){var l=this.quoteMark||e.quoteMark||r.DOUBLE_QUOTE,u=y[l];if((0,i.default)(t,u).length<a.length)return l}return s}return o===n?this.preferredQuoteMark(e):o<n?r.DOUBLE_QUOTE:r.SINGLE_QUOTE},l.preferredQuoteMark=function(e){var t=e.preferCurrentQuoteMark?this.quoteMark:e.quoteMark;return void 0===t&&(t=e.preferCurrentQuoteMark?e.quoteMark:this.quoteMark),void 0===t&&(t=r.DOUBLE_QUOTE),t},l._syncRawValue=function(){var e=(0,i.default)(this._value,y[this.quoteMark]);e===this._value?this.raws&&delete this.raws.value:this.raws.value=e},l._handleEscapes=function(e,t){if(this._constructed){var n=(0,i.default)(t,{isIdentifier:!0});n!==t?this.raws[e]=n:delete this.raws[e]}},l._spacesFor=function(e){var t=this.spaces[e]||{},n=this.raws.spaces&&this.raws.spaces[e]||{};return Object.assign({before:"",after:""},t,n)},l._stringFor=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=b);var r=this._spacesFor(t);return n(this.stringifyProperty(e),r)},l.offsetOf=function(e){var t=1,n=this._spacesFor("attribute");if(t+=n.before.length,"namespace"===e||"ns"===e)return this.namespace?t:-1;if("attributeNS"===e)return t;if(t+=this.namespaceString.length,this.namespace&&(t+=1),"attribute"===e)return t;t+=this.stringifyProperty("attribute").length,t+=n.after.length;var r=this._spacesFor("operator");t+=r.before.length;var i=this.stringifyProperty("operator");if("operator"===e)return i?t:-1;t+=i.length,t+=r.after.length;var o=this._spacesFor("value");t+=o.before.length;var a=this.stringifyProperty("value");return"value"===e?a?t:-1:(t+=a.length,t+=o.after.length,t+=this._spacesFor("insensitive").before.length,"insensitive"===e&&this.insensitive?t:-1)},l.toString=function(){var e=this,t=[this.rawSpaceBefore,"["];return t.push(this._stringFor("qualifiedAttribute","attribute")),this.operator&&(this.value||""===this.value)&&(t.push(this._stringFor("operator")),t.push(this._stringFor("value")),t.push(this._stringFor("insensitiveFlag","insensitive",(function(t,n){return!(t.length>0)||e.quoted||0!==n.before.length||e.spaces.value&&e.spaces.value.after||(n.before=" "),b(t,n)})))),t.push("]"),t.push(this.rawSpaceAfter),t.join("")},o=r,(a=[{key:"quoted",get:function(){var e=this.quoteMark;return"'"===e||'"'===e},set:function(e){f()}},{key:"quoteMark",get:function(){return this._quoteMark},set:function(e){this._constructed?this._quoteMark!==e&&(this._quoteMark=e,this._syncRawValue()):this._quoteMark=e}},{key:"qualifiedAttribute",get:function(){return this.qualifiedName(this.raws.attribute||this.attribute)}},{key:"insensitiveFlag",get:function(){return this.insensitive?"i":""}},{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=g(e),n=t.deprecatedUsage,r=t.unescaped,i=t.quoteMark;if(n&&p(),r===this._value&&i===this._quoteMark)return;this._value=r,this._quoteMark=i,this._syncRawValue()}else this._value=e}},{key:"insensitive",get:function(){return this._insensitive},set:function(e){e||(this._insensitive=!1,!this.raws||"I"!==this.raws.insensitiveFlag&&"i"!==this.raws.insensitiveFlag||(this.raws.insensitiveFlag=void 0)),this._insensitive=e}},{key:"attribute",get:function(){return this._attribute},set:function(e){this._handleEscapes("attribute",e),this._attribute=e}}])&&u(o.prototype,a),Object.defineProperty(o,"prototype",{writable:!1}),r}(a.default);t.default=v,v.NO_QUOTE=null,v.SINGLE_QUOTE="'",v.DOUBLE_QUOTE='"';var y=((r={"'":{quotes:"single",wrap:!0},'"':{quotes:"double",wrap:!0}}).null={isIdentifier:!0},r);function b(e,t){return""+t.before+e+t.after}},9876:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=s(n(8820)),i=n(9532),o=s(n(8846)),a=n(1420);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}var c=function(e){var t,n,o,s;function c(t){var n;return(n=e.call(this,t)||this).type=a.CLASS,n._constructed=!0,n}return n=e,(t=c).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),c.prototype.valueToString=function(){return"."+e.prototype.valueToString.call(this)},o=c,(s=[{key:"value",get:function(){return this._value},set:function(e){if(this._constructed){var t=(0,r.default)(e,{isIdentifier:!0});t!==e?((0,i.ensureObject)(this,"raws"),this.raws.value=t):this.raws&&delete this.raws.value}this._value=e}}])&&l(o.prototype,s),Object.defineProperty(o,"prototype",{writable:!1}),c}(o.default);t.default=c,e.exports=t.default},1875:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.COMBINATOR,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},3414:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.COMMENT,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},4212:(e,t,n)=>{"use strict";t.__esModule=!0,t.universal=t.tag=t.string=t.selector=t.root=t.pseudo=t.nesting=t.id=t.comment=t.combinator=t.className=t.attribute=void 0;var r=m(n(8918)),i=m(n(9876)),o=m(n(1875)),a=m(n(3414)),s=m(n(8038)),l=m(n(6528)),u=m(n(3751)),c=m(n(2778)),d=m(n(3318)),h=m(n(2822)),p=m(n(9868)),f=m(n(7436));function m(e){return e&&e.__esModule?e:{default:e}}t.attribute=function(e){return new r.default(e)},t.className=function(e){return new i.default(e)},t.combinator=function(e){return new o.default(e)},t.comment=function(e){return new a.default(e)},t.id=function(e){return new s.default(e)},t.nesting=function(e){return new l.default(e)},t.pseudo=function(e){return new u.default(e)},t.root=function(e){return new c.default(e)},t.selector=function(e){return new d.default(e)},t.string=function(e){return new h.default(e)},t.tag=function(e){return new p.default(e)},t.universal=function(e){return new f.default(e)}},4608:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(1420));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}var c=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).nodes||(n.nodes=[]),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var i,a,c=r.prototype;return c.append=function(e){return e.parent=this,this.nodes.push(e),this},c.prepend=function(e){return e.parent=this,this.nodes.unshift(e),this},c.at=function(e){return this.nodes[e]},c.index=function(e){return"number"==typeof e?e:this.nodes.indexOf(e)},c.removeChild=function(e){var t;for(var n in e=this.index(e),this.at(e).parent=void 0,this.nodes.splice(e,1),this.indexes)(t=this.indexes[n])>=e&&(this.indexes[n]=t-1);return this},c.removeAll=function(){for(var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.nodes);!(e=t()).done;)e.value.parent=void 0;return this.nodes=[],this},c.empty=function(){return this.removeAll()},c.insertAfter=function(e,t){t.parent=this;var n,r=this.index(e);for(var i in this.nodes.splice(r+1,0,t),t.parent=this,this.indexes)r<=(n=this.indexes[i])&&(this.indexes[i]=n+1);return this},c.insertBefore=function(e,t){t.parent=this;var n,r=this.index(e);for(var i in this.nodes.splice(r,0,t),t.parent=this,this.indexes)(n=this.indexes[i])<=r&&(this.indexes[i]=n+1);return this},c._findChildAtPosition=function(e,t){var n=void 0;return this.each((function(r){if(r.atPosition){var i=r.atPosition(e,t);if(i)return n=i,!1}else if(r.isAtPosition(e,t))return n=r,!1})),n},c.atPosition=function(e,t){return this.isAtPosition(e,t)?this._findChildAtPosition(e,t)||this:void 0},c._inferEndPosition=function(){this.last&&this.last.source&&this.last.source.end&&(this.source=this.source||{},this.source.end=this.source.end||{},Object.assign(this.source.end,this.last.source.end))},c.each=function(e){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach++;var t=this.lastEach;if(this.indexes[t]=0,this.length){for(var n,r;this.indexes[t]<this.length&&(n=this.indexes[t],!1!==(r=e(this.at(n),n)));)this.indexes[t]+=1;return delete this.indexes[t],!1!==r&&void 0}},c.walk=function(e){return this.each((function(t,n){var r=e(t,n);if(!1!==r&&t.length&&(r=t.walk(e)),!1===r)return!1}))},c.walkAttributes=function(e){var t=this;return this.walk((function(n){if(n.type===o.ATTRIBUTE)return e.call(t,n)}))},c.walkClasses=function(e){var t=this;return this.walk((function(n){if(n.type===o.CLASS)return e.call(t,n)}))},c.walkCombinators=function(e){var t=this;return this.walk((function(n){if(n.type===o.COMBINATOR)return e.call(t,n)}))},c.walkComments=function(e){var t=this;return this.walk((function(n){if(n.type===o.COMMENT)return e.call(t,n)}))},c.walkIds=function(e){var t=this;return this.walk((function(n){if(n.type===o.ID)return e.call(t,n)}))},c.walkNesting=function(e){var t=this;return this.walk((function(n){if(n.type===o.NESTING)return e.call(t,n)}))},c.walkPseudos=function(e){var t=this;return this.walk((function(n){if(n.type===o.PSEUDO)return e.call(t,n)}))},c.walkTags=function(e){var t=this;return this.walk((function(n){if(n.type===o.TAG)return e.call(t,n)}))},c.walkUniversals=function(e){var t=this;return this.walk((function(n){if(n.type===o.UNIVERSAL)return e.call(t,n)}))},c.split=function(e){var t=this,n=[];return this.reduce((function(r,i,o){var a=e.call(t,i);return n.push(i),a?(r.push(n),n=[]):o===t.length-1&&r.push(n),r}),[])},c.map=function(e){return this.nodes.map(e)},c.reduce=function(e,t){return this.nodes.reduce(e,t)},c.every=function(e){return this.nodes.every(e)},c.some=function(e){return this.nodes.some(e)},c.filter=function(e){return this.nodes.filter(e)},c.sort=function(e){return this.nodes.sort(e)},c.toString=function(){return this.map(String).join("")},i=r,(a=[{key:"first",get:function(){return this.at(0)}},{key:"last",get:function(){return this.at(this.length-1)}},{key:"length",get:function(){return this.nodes.length}}])&&l(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),r}(i.default);t.default=c,e.exports=t.default},5430:(e,t,n)=>{"use strict";t.__esModule=!0,t.isComment=t.isCombinator=t.isClassName=t.isAttribute=void 0,t.isContainer=function(e){return!(!a(e)||!e.walk)},t.isIdentifier=void 0,t.isNamespace=function(e){return l(e)||y(e)},t.isNesting=void 0,t.isNode=a,t.isPseudo=void 0,t.isPseudoClass=function(e){return f(e)&&!_(e)},t.isPseudoElement=_,t.isUniversal=t.isTag=t.isString=t.isSelector=t.isRoot=void 0;var r,i=n(1420),o=((r={})[i.ATTRIBUTE]=!0,r[i.CLASS]=!0,r[i.COMBINATOR]=!0,r[i.COMMENT]=!0,r[i.ID]=!0,r[i.NESTING]=!0,r[i.PSEUDO]=!0,r[i.ROOT]=!0,r[i.SELECTOR]=!0,r[i.STRING]=!0,r[i.TAG]=!0,r[i.UNIVERSAL]=!0,r);function a(e){return"object"==typeof e&&o[e.type]}function s(e,t){return a(t)&&t.type===e}var l=s.bind(null,i.ATTRIBUTE);t.isAttribute=l;var u=s.bind(null,i.CLASS);t.isClassName=u;var c=s.bind(null,i.COMBINATOR);t.isCombinator=c;var d=s.bind(null,i.COMMENT);t.isComment=d;var h=s.bind(null,i.ID);t.isIdentifier=h;var p=s.bind(null,i.NESTING);t.isNesting=p;var f=s.bind(null,i.PSEUDO);t.isPseudo=f;var m=s.bind(null,i.ROOT);t.isRoot=m;var g=s.bind(null,i.SELECTOR);t.isSelector=g;var v=s.bind(null,i.STRING);t.isString=v;var y=s.bind(null,i.TAG);t.isTag=y;var b=s.bind(null,i.UNIVERSAL);function _(e){return f(e)&&e.value&&(e.value.startsWith("::")||":before"===e.value.toLowerCase()||":after"===e.value.toLowerCase()||":first-letter"===e.value.toLowerCase()||":first-line"===e.value.toLowerCase())}t.isUniversal=b},8038:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.ID,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r.prototype.valueToString=function(){return"#"+e.prototype.valueToString.call(this)},r}(i.default);t.default=s,e.exports=t.default},7755:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(1420);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||(t[e]=r[e]))}));var i=n(4212);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||(t[e]=i[e]))}));var o=n(5430);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===o[e]||(t[e]=o[e]))}))},1607:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=o(n(8820)),i=n(9532);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}var l=function(e){var t,n;function o(){return e.apply(this,arguments)||this}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var l,u,c=o.prototype;return c.qualifiedName=function(e){return this.namespace?this.namespaceString+"|"+e:e},c.valueToString=function(){return this.qualifiedName(e.prototype.valueToString.call(this))},l=o,(u=[{key:"namespace",get:function(){return this._namespace},set:function(e){if(!0===e||"*"===e||"&"===e)return this._namespace=e,void(this.raws&&delete this.raws.namespace);var t=(0,r.default)(e,{isIdentifier:!0});this._namespace=e,t!==e?((0,i.ensureObject)(this,"raws"),this.raws.namespace=t):this.raws&&delete this.raws.namespace}},{key:"ns",get:function(){return this._namespace},set:function(e){this.namespace=e}},{key:"namespaceString",get:function(){if(this.namespace){var e=this.stringifyProperty("namespace");return!0===e?"":e}return""}}])&&a(l.prototype,u),Object.defineProperty(l,"prototype",{writable:!1}),o}(o(n(8846)).default);t.default=l,e.exports=t.default},6528:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.NESTING,n.value="&",n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},8846:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=n(9532);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function e(t,n){if("object"!=typeof t||null===t)return t;var r=new t.constructor;for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];"parent"===i&&"object"==typeof o?n&&(r[i]=n):r[i]=o instanceof Array?o.map((function(t){return e(t,r)})):e(o,r)}return r},a=function(){function e(e){void 0===e&&(e={}),Object.assign(this,e),this.spaces=this.spaces||{},this.spaces.before=this.spaces.before||"",this.spaces.after=this.spaces.after||""}var t,n,a=e.prototype;return a.remove=function(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this},a.replaceWith=function(){if(this.parent){for(var e in arguments)this.parent.insertBefore(this,arguments[e]);this.remove()}return this},a.next=function(){return this.parent.at(this.parent.index(this)+1)},a.prev=function(){return this.parent.at(this.parent.index(this)-1)},a.clone=function(e){void 0===e&&(e={});var t=o(this);for(var n in e)t[n]=e[n];return t},a.appendToPropertyAndEscape=function(e,t,n){this.raws||(this.raws={});var r=this[e],i=this.raws[e];this[e]=r+t,i||n!==t?this.raws[e]=(i||r)+n:delete this.raws[e]},a.setPropertyAndEscape=function(e,t,n){this.raws||(this.raws={}),this[e]=t,this.raws[e]=n},a.setPropertyWithoutEscape=function(e,t){this[e]=t,this.raws&&delete this.raws[e]},a.isAtPosition=function(e,t){if(this.source&&this.source.start&&this.source.end)return!(this.source.start.line>e||this.source.end.line<e||this.source.start.line===e&&this.source.start.column>t||this.source.end.line===e&&this.source.end.column<t)},a.stringifyProperty=function(e){return this.raws&&this.raws[e]||this[e]},a.valueToString=function(){return String(this.stringifyProperty("value"))},a.toString=function(){return[this.rawSpaceBefore,this.valueToString(),this.rawSpaceAfter].join("")},t=e,(n=[{key:"rawSpaceBefore",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.before;return void 0===e&&(e=this.spaces&&this.spaces.before),e||""},set:function(e){(0,r.ensureObject)(this,"raws","spaces"),this.raws.spaces.before=e}},{key:"rawSpaceAfter",get:function(){var e=this.raws&&this.raws.spaces&&this.raws.spaces.after;return void 0===e&&(e=this.spaces.after),e||""},set:function(e){(0,r.ensureObject)(this,"raws","spaces"),this.raws.spaces.after=e}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=a,e.exports=t.default},3751:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(4608))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.PSEUDO,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r.prototype.toString=function(){var e=this.length?"("+this.map(String).join(",")+")":"";return[this.rawSpaceBefore,this.stringifyProperty("value"),e,this.rawSpaceAfter].join("")},r}(i.default);t.default=s,e.exports=t.default},2778:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(4608))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}var l=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.ROOT,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var i,l,u=r.prototype;return u.toString=function(){var e=this.reduce((function(e,t){return e.push(String(t)),e}),[]).join(",");return this.trailingComma?e+",":e},u.error=function(e,t){return this._error?this._error(e,t):new Error(e)},i=r,(l=[{key:"errorGenerator",set:function(e){this._error=e}}])&&a(i.prototype,l),Object.defineProperty(i,"prototype",{writable:!1}),r}(i.default);t.default=l,e.exports=t.default},3318:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(4608))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.SELECTOR,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},2822:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(8846))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.STRING,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},9868:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(1607))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.TAG,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},1420:(e,t)=>{"use strict";t.__esModule=!0,t.UNIVERSAL=t.TAG=t.STRING=t.SELECTOR=t.ROOT=t.PSEUDO=t.NESTING=t.ID=t.COMMENT=t.COMBINATOR=t.CLASS=t.ATTRIBUTE=void 0,t.TAG="tag",t.STRING="string",t.SELECTOR="selector",t.ROOT="root",t.PSEUDO="pseudo",t.NESTING="nesting",t.ID="id",t.COMMENT="comment",t.COMBINATOR="combinator",t.CLASS="class",t.ATTRIBUTE="attribute",t.UNIVERSAL="universal"},7436:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(1607))&&r.__esModule?r:{default:r},o=n(1420);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var s=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).type=o.UNIVERSAL,n.value="*",n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n),r}(i.default);t.default=s,e.exports=t.default},1217:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){return e.sort((function(e,t){return e-t}))},e.exports=t.default},9704:(e,t)=>{"use strict";t.__esModule=!0,t.word=t.tilde=t.tab=t.str=t.space=t.slash=t.singleQuote=t.semicolon=t.plus=t.pipe=t.openSquare=t.openParenthesis=t.newline=t.greaterThan=t.feed=t.equals=t.doubleQuote=t.dollar=t.cr=t.comment=t.comma=t.combinator=t.colon=t.closeSquare=t.closeParenthesis=t.caret=t.bang=t.backslash=t.at=t.asterisk=t.ampersand=void 0,t.ampersand=38,t.asterisk=42,t.at=64,t.comma=44,t.colon=58,t.semicolon=59,t.openParenthesis=40,t.closeParenthesis=41,t.openSquare=91,t.closeSquare=93,t.dollar=36,t.tilde=126,t.caret=94,t.plus=43,t.equals=61,t.pipe=124,t.greaterThan=62,t.space=32,t.singleQuote=39,t.doubleQuote=34,t.slash=47,t.bang=33,t.backslash=92,t.cr=13,t.feed=12,t.newline=10,t.tab=9,t.str=39,t.comment=-1,t.word=-2,t.combinator=-3},7563:(e,t,n)=>{"use strict";t.__esModule=!0,t.FIELDS=void 0,t.default=function(e){var t,n,r,i,a,s,l,u,c,h,p,f,m=[],g=e.css.valueOf(),v=g.length,y=-1,b=1,_=0,w=0;function S(t,n){if(!e.safe)throw e.error("Unclosed "+t,b,_-y,_);u=(g+=n).length-1}for(;_<v;){switch((t=g.charCodeAt(_))===o.newline&&(y=_,b+=1),t){case o.space:case o.tab:case o.newline:case o.cr:case o.feed:u=_;do{u+=1,(t=g.charCodeAt(u))===o.newline&&(y=u,b+=1)}while(t===o.space||t===o.newline||t===o.tab||t===o.cr||t===o.feed);f=o.space,r=b,n=u-y-1,w=u;break;case o.plus:case o.greaterThan:case o.tilde:case o.pipe:u=_;do{u+=1,t=g.charCodeAt(u)}while(t===o.plus||t===o.greaterThan||t===o.tilde||t===o.pipe);f=o.combinator,r=b,n=_-y,w=u;break;case o.asterisk:case o.ampersand:case o.bang:case o.comma:case o.equals:case o.dollar:case o.caret:case o.openSquare:case o.closeSquare:case o.colon:case o.semicolon:case o.openParenthesis:case o.closeParenthesis:f=t,r=b,n=_-y,w=(u=_)+1;break;case o.singleQuote:case o.doubleQuote:p=t===o.singleQuote?"'":'"',u=_;do{for(i=!1,-1===(u=g.indexOf(p,u+1))&&S("quote",p),a=u;g.charCodeAt(a-1)===o.backslash;)a-=1,i=!i}while(i);f=o.str,r=b,n=_-y,w=u+1;break;default:t===o.slash&&g.charCodeAt(_+1)===o.asterisk?(0===(u=g.indexOf("*/",_+2)+1)&&S("comment","*/"),(s=(l=g.slice(_,u+1).split("\n")).length-1)>0?(c=b+s,h=u-l[s].length):(c=b,h=y),f=o.comment,b=c,r=c,n=u-h):t===o.slash?(f=t,r=b,n=_-y,w=(u=_)+1):(u=d(g,_),f=o.word,r=b,n=u-y),w=u+1}m.push([f,b,_-y,r,n,_,w]),h&&(y=h,h=null),_=w}return m};var r,i,o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(9704));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}for(var s=((r={})[o.tab]=!0,r[o.newline]=!0,r[o.cr]=!0,r[o.feed]=!0,r),l=((i={})[o.space]=!0,i[o.tab]=!0,i[o.newline]=!0,i[o.cr]=!0,i[o.feed]=!0,i[o.ampersand]=!0,i[o.asterisk]=!0,i[o.bang]=!0,i[o.comma]=!0,i[o.colon]=!0,i[o.semicolon]=!0,i[o.openParenthesis]=!0,i[o.closeParenthesis]=!0,i[o.openSquare]=!0,i[o.closeSquare]=!0,i[o.singleQuote]=!0,i[o.doubleQuote]=!0,i[o.plus]=!0,i[o.pipe]=!0,i[o.tilde]=!0,i[o.greaterThan]=!0,i[o.equals]=!0,i[o.dollar]=!0,i[o.caret]=!0,i[o.slash]=!0,i),u={},c=0;c<22;c++)u["0123456789abcdefABCDEF".charCodeAt(c)]=!0;function d(e,t){var n,r=t;do{if(n=e.charCodeAt(r),l[n])return r-1;n===o.backslash?r=h(e,r)+1:r++}while(r<e.length);return r-1}function h(e,t){var n=t,r=e.charCodeAt(n+1);if(s[r]);else if(u[r]){var i=0;do{n++,i++,r=e.charCodeAt(n+1)}while(u[r]&&i<6);i<6&&r===o.space&&n++}else n++;return n}t.FIELDS={TYPE:0,START_LINE:1,START_COL:2,END_LINE:3,END_COL:4,START_POS:5,END_POS:6}},6879:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(;n.length>0;){var i=n.shift();e[i]||(e[i]={}),e=e[i]}},e.exports=t.default},3541:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(;n.length>0;){var i=n.shift();if(!e[i])return;e=e[i]}return e},e.exports=t.default},9532:(e,t,n)=>{"use strict";t.__esModule=!0,t.unesc=t.stripComments=t.getProp=t.ensureObject=void 0;var r=s(n(406));t.unesc=r.default;var i=s(n(3541));t.getProp=i.default;var o=s(n(6879));t.ensureObject=o.default;var a=s(n(1749));function s(e){return e&&e.__esModule?e:{default:e}}t.stripComments=a.default},1749:(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e){for(var t="",n=e.indexOf("/*"),r=0;n>=0;){t+=e.slice(r,n);var i=e.indexOf("*/",n+2);if(i<0)return t;r=i+2,n=e.indexOf("/*",r)}return t+e.slice(r)},e.exports=t.default},406:(e,t)=>{"use strict";function n(e){for(var t=e.toLowerCase(),n="",r=!1,i=0;i<6&&void 0!==t[i];i++){var o=t.charCodeAt(i);if(r=32===o,!(o>=97&&o<=102||o>=48&&o<=57))break;n+=t[i]}if(0!==n.length){var a=parseInt(n,16);return a>=55296&&a<=57343||0===a||a>1114111?["",n.length+(r?1:0)]:[String.fromCodePoint(a),n.length+(r?1:0)]}}t.__esModule=!0,t.default=function(e){if(!r.test(e))return e;for(var t="",i=0;i<e.length;i++)if("\\"!==e[i])t+=e[i];else{var o=n(e.slice(i+1,i+7));if(void 0!==o){t+=o[0],i+=o[1];continue}if("\\"===e[i+1]){t+="\\",i++;continue}e.length===i+1&&(t+=e[i])}return t};var r=/\\/;e.exports=t.default},9189:(e,t,n)=>{var r=n(5717),i=n(7187).EventEmitter;function o(e){if(!(this instanceof o))return new o(e);i.call(this),e=e||{},this.concurrency=e.concurrency||1/0,this.timeout=e.timeout||0,this.autostart=e.autostart||!1,this.results=e.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}function a(){for(var e in this.timers){var t=this.timers[e];delete this.timers[e],clearTimeout(t)}}function s(e){var t=this;function n(e){t.end(e)}this.on("error",n),this.on("end",(function r(i){t.removeListener("error",n),t.removeListener("end",r),e(i,this.results)}))}function l(e){this.session++,this.running=!1,this.emit("end",e)}e.exports=o,e.exports.default=o,r(o,i),["pop","shift","indexOf","lastIndexOf"].forEach((function(e){o.prototype[e]=function(){return Array.prototype[e].apply(this.jobs,arguments)}})),o.prototype.slice=function(e,t){return this.jobs=this.jobs.slice(e,t),this},o.prototype.reverse=function(){return this.jobs.reverse(),this},["push","unshift","splice"].forEach((function(e){o.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this.autostart&&this.start(),t}})),Object.defineProperty(o.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),o.prototype.start=function(e){if(e&&s.call(this,e),this.running=!0,!(this.pending>=this.concurrency))if(0!==this.jobs.length){var t=this,n=this.jobs.shift(),r=!0,i=this.session,o=null,a=!1,u=null,c=n.hasOwnProperty("timeout")?n.timeout:this.timeout;c&&(o=setTimeout((function(){a=!0,t.listeners("timeout").length>0?t.emit("timeout",h,n):h()}),c),this.timers[o]=o),this.results&&(u=this.results.length,this.results[u]=null),this.pending++,t.emit("start",n);var d=n(h);d&&d.then&&"function"==typeof d.then&&d.then((function(e){return h(null,e)})).catch((function(e){return h(e||!0)})),this.running&&this.jobs.length>0&&this.start()}else 0===this.pending&&l.call(this);function h(e,s){r&&t.session===i&&(r=!1,t.pending--,null!==o&&(delete t.timers[o],clearTimeout(o)),e?t.emit("error",e,n):!1===a&&(null!==u&&(t.results[u]=Array.prototype.slice.call(arguments,1)),t.emit("success",s,n)),t.session===i&&(0===t.pending&&0===t.jobs.length?l.call(t):t.running&&t.start()))}},o.prototype.stop=function(){this.running=!1},o.prototype.end=function(e){a.call(this),this.jobs.length=0,this.pending=0,l.call(this,e)}},4448:(e,t,n)=>{"use strict";var r=n(7294),i=n(3840);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),k=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function B(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,L=Object.assign;function N(e){if(void 0===M)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function z(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function U(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return z(e.type,!1);case 11:return z(e.type.render,!1);case 1:return z(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case C:return"Fragment";case S:return"Portal";case x:return"Profiler";case E:return"StrictMode";case P:return"Suspense";case T:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case D:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return H(e(t))}catch(e){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function j(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function $(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=$(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=j(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){Z(e,t);var n=j(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,j(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+j(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:j(n)}}function oe(e,t){var n=j(t.value),r=j(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ce=null,Ee=null;function xe(e){if(e=bi(e)){if("function"!=typeof Se)throw Error(o(280));var t=e.stateNode;t&&(t=wi(t),Se(e.stateNode,e.type,t))}}function Ae(e){Ce?Ee?Ee.push(e):Ee=[e]:Ce=e}function ke(){if(Ce){var e=Ce,t=Ee;if(Ee=Ce=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function De(e,t){return e(t)}function Pe(){}var Te=!1;function Fe(e,t,n){if(Te)return e(t,n);Te=!0;try{return De(e,t,n)}finally{Te=!1,(null!==Ce||null!==Ee)&&(Pe(),ke())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(o(231,t,typeof n));return n}var Ie=!1;if(c)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ce){Ie=!1}function Be(e,t,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(e){this.onError(e)}}var Me=!1,Le=null,Ne=!1,Ve=null,ze={onError:function(e){Me=!0,Le=e}};function Ue(e,t,n,r,i,o,a,s,l){Me=!1,Le=null,Be.apply(ze,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function je(e){if(He(e)!==e)throw Error(o(188))}function $e(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return je(i),e;if(a===r)return je(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var qe=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Ze=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null,at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2,ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=dt(s):0!=(o&=a)&&(r=dt(o))}else 0!=(a=n&~i)?r=dt(a):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&!(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&4194240&o))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return!(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,St,Ct,Et,xt,At=!1,kt=[],Dt=null,Pt=null,Tt=null,Ft=new Map,Rt=new Map,It=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bt(e,t){switch(e){case"focusin":case"focusout":Dt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Mt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&null!==(t=bi(t))&&St(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=yi(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void xt(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Vt(e,t,n){Nt(e)&&n.delete(t)}function zt(){At=!1,null!==Dt&&Nt(Dt)&&(Dt=null),null!==Pt&&Nt(Pt)&&(Pt=null),null!==Tt&&Nt(Tt)&&(Tt=null),Ft.forEach(Vt),Rt.forEach(Vt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Ht(e){function t(t){return Ut(t,e)}if(0<kt.length){Ut(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Dt&&Ut(Dt,e),null!==Pt&&Ut(Pt,e),null!==Tt&&Ut(Tt,e),Ft.forEach(t),Rt.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Lt(n),null===n.blockedOn&&It.shift()}var Wt=_.ReactCurrentBatchConfig,jt=!0;function $t(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Gt(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function qt(e,t,n,r){if(jt){var i=Yt(e,t,n,r);if(null===i)jr(e,t,r,Kt,n),Bt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Dt=Mt(Dt,e,t,n,r,i),!0;case"dragenter":return Pt=Mt(Pt,e,t,n,r,i),!0;case"mouseover":return Tt=Mt(Tt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Ft.set(o,Mt(Ft.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rt.set(o,Mt(Rt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Bt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&wt(o),null===(o=Yt(e,t,n,r))&&jr(e,t,r,Kt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else jr(e,t,r,null,n)}}var Kt=null;function Yt(e,t,n,r){if(Kt=null,null!==(e=yi(e=we(r))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,Qt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Qt,r=n.length,i="value"in Zt?Zt.value:Zt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),dn=L({},un,{view:0,detail:0}),hn=on(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(L({},pn,{dataTransfer:0})),gn=on(L({},dn,{relatedTarget:0})),vn=on(L({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),_n=on(L({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function xn(){return En}var An=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=on(An),Dn=on(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=on(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Tn=on(L({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=on(Fn),In=[9,13,27,32],On=c&&"CompositionEvent"in window,Bn=null;c&&"documentMode"in document&&(Bn=document.documentMode);var Mn=c&&"TextEvent"in window&&!Bn,Ln=c&&(!On||Bn&&8<Bn&&11>=Bn),Nn=String.fromCharCode(32),Vn=!1;function zn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1,Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function $n(e,t,n,r){Ae(r),0<(t=Gr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,qn=null;function Kn(e){Nr(e,0)}function Yn(e){if(q(_i(e)))return e}function Xn(e,t){if("change"===e)return t}var Zn=!1;if(c){var Qn;if(c){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"==typeof er.oninput}Qn=Jn}else Qn=!1;Zn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),qn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(qn)){var t=[];$n(t,qn,e,we(e)),Fe(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(qn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(sr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||(r="selectionStart"in(r=gr)&&pr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Cr={},Er={};function xr(e){if(Cr[e])return Cr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Cr[e]=n[t];return e}c&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Ar=xr("animationend"),kr=xr("animationiteration"),Dr=xr("animationstart"),Pr=xr("transitionend"),Tr=new Map,Fr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Tr.set(e,t),l(t,[e])}for(var Ir=0;Ir<Fr.length;Ir++){var Or=Fr[Ir];Rr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Rr(Ar,"onAnimationEnd"),Rr(kr,"onAnimationIteration"),Rr(Dr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Pr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Br));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,l,u){if(Ue.apply(this,arguments),Me){if(!Me)throw Error(o(198));var c=Le;Me=!1,Le=null,Ne||(Ne=!0,Ve=c)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Lr(i,s,u),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Lr(i,s,u),o=l}}}if(Ne)throw e=Ve,Ne=!1,Ve=null,e}function Vr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[Ur]){e[Ur]=!0,a.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Xt(t)){case 1:var i=$t;break;case 4:i=Gt;break;default:i=qt}n=i.bind(null,t,n,e),i=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function jr(e,t,n,r,i){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}Fe((function(){var r=o,i=we(n),a=[];e:{var s=Tr.get(e);if(void 0!==s){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ar:case kr:case Dr:l=vn;break;case Pr:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Dn}var c=!!(4&t),d=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&null!=(m=Re(f,h))&&c.push($r(f,m,p))),d)break;f=f.return}0<c.length&&(s=new l(s,u,null,n,i),a.push({event:s,listeners:c}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===_e||!(u=n.relatedTarget||n.fromElement)||!yi(u)&&!u[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?yi(u):null)&&(u!==(d=He(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=Dn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?s:_i(l),p=null==u?s:_i(u),(s=new c(m,f+"leave",l,n,i)).target=d,s.relatedTarget=p,m=null,yi(i)===r&&((c=new c(h,f+"enter",u,n,i)).target=p,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,f=0,p=c=l;p;p=qr(p))f++;for(p=0,m=h;m;m=qr(m))p++;for(;0<f-p;)c=qr(c),f--;for(;0<p-f;)h=qr(h),p--;for(;f--;){if(c===h||null!==h&&c===h.alternate)break e;c=qr(c),h=qr(h)}c=null}else c=null;null!==l&&Kr(a,s,l,c,!1),null!==u&&null!==d&&Kr(a,d,u,c,!0)}if("select"===(l=(s=r?_i(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Xn;else if(jn(s))if(Zn)g=ar;else{g=ir;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?$n(a,g,n,i):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?_i(r):window,e){case"focusin":(jn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,_r(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":_r(a,n,i)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(y=en()):(Qt="value"in(Zt=i)?Zt.value:Zt.textContent,Hn=!0)),0<(v=Gr(r,b)).length&&(b=new _n(b,e,null,n,i),a.push({event:b,listeners:v}),(y||null!==(y=Un(n)))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Vn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!On&&zn(e,t)?(e=en(),Jt=Qt=Zt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=Gr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y)}Nr(a,t)}))}function $r(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Re(e,n))&&r.unshift($r(e,o,i)),null!=(o=Re(e,t))&&r.push($r(e,o,i))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=Re(n,o))&&a.unshift($r(n,l,s)):i||null!=(l=Re(n,o))&&a.push($r(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Zr(e){return("string"==typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function Qr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(o(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,oi="function"==typeof Promise?Promise:void 0,ai="function"==typeof queueMicrotask?queueMicrotask:void 0!==oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ht(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ht(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,fi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wi(e){return e[pi]||null}var Si=[],Ci=-1;function Ei(e){return{current:e}}function xi(e){0>Ci||(e.current=Si[Ci],Si[Ci]=null,Ci--)}function Ai(e,t){Ci++,Si[Ci]=e.current,e.current=t}var ki={},Di=Ei(ki),Pi=Ei(!1),Ti=ki;function Fi(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ri(e){return null!=e.childContextTypes}function Ii(){xi(Pi),xi(Di)}function Oi(e,t,n){if(Di.current!==ki)throw Error(o(168));Ai(Di,t),Ai(Pi,n)}function Bi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,W(e)||"Unknown",i));return L({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Ti=Di.current,Ai(Di,e),Ai(Pi,Pi.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Bi(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,xi(Pi),xi(Di),Ai(Di,e)):xi(Pi),Ai(Pi,n)}var Ni=null,Vi=!1,zi=!1;function Ui(e){null===Ni?Ni=[e]:Ni.push(e)}function Hi(){if(!zi&&null!==Ni){zi=!0;var e=0,t=bt;try{var n=Ni;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ni=null,Vi=!1}catch(t){throw null!==Ni&&(Ni=Ni.slice(e+1)),qe(Je,Hi),t}finally{bt=t,zi=!1}}return null}var Wi=[],ji=0,$i=null,Gi=0,qi=[],Ki=0,Yi=null,Xi=1,Zi="";function Qi(e,t){Wi[ji++]=Gi,Wi[ji++]=$i,$i=e,Gi=t}function Ji(e,t,n){qi[Ki++]=Xi,qi[Ki++]=Zi,qi[Ki++]=Yi,Yi=e;var r=Xi;e=Zi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Xi=1<<32-at(t)+i|n<<i|r,Zi=o+e}else Xi=1<<o|n<<i|r,Zi=e}function eo(e){null!==e.return&&(Qi(e,1),Ji(e,1,0))}function to(e){for(;e===$i;)$i=Wi[--ji],Wi[ji]=null,Gi=Wi[--ji],Wi[ji]=null;for(;e===Yi;)Yi=qi[--Ki],qi[Ki]=null,Zi=qi[--Ki],qi[Ki]=null,Xi=qi[--Ki],qi[Ki]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Fu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Xi,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return!(!(1&e.mode)||128&e.flags)}function uo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ui(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=ui(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ui(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ui(e.nextSibling)}function fo(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=_.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function _o(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Iu(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var o=n.type;return o===C?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===R&&bo(o)===t.type)?((r=i(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Ou(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Bu(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Lu(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Ou(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case S:return(t=Nu(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||B(t))return(t=Bu(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?u(e,t,n,r):null;case S:return n.key===i?c(e,t,n,r):null;case R:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||B(n))return null!==i?null:d(e,t,n,r,null);yo(e,n)}return null}function f(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||B(r))return d(t,e=e.get(n)||null,r,i,null);yo(t,r)}return null}function m(i,o,s,l){for(var u=null,c=null,d=o,m=o=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(i,d,s[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),o=a(v,o,m),null===c?u=v:c.sibling=v,c=v,d=g}if(m===s.length)return n(i,d),io&&Qi(i,m),u;if(null===d){for(;m<s.length;m++)null!==(d=h(i,s[m],l))&&(o=a(d,o,m),null===c?u=d:c.sibling=d,c=d);return io&&Qi(i,m),u}for(d=r(i,d);m<s.length;m++)null!==(g=f(d,i,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Qi(i,m),u}function g(i,s,l,u){var c=B(l);if("function"!=typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var d=c=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(i,m,y.value,u);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),s=a(b,s,g),null===d?c=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),io&&Qi(i,g),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,u))&&(s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return io&&Qi(i,g),c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=f(m,i,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(i,e)})),io&&Qi(i,g),c}return function e(r,o,a,l){if("object"==typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var u=a.key,c=o;null!==c;){if(c.key===u){if((u=a.type)===C){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===u||"object"==typeof u&&null!==u&&u.$$typeof===R&&bo(u)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=vo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===C?((o=Bu(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Ou(a.type,a.key,a.props,null,r.mode,l)).ref=vo(r,o,a),l.return=r,r=l)}return s(r);case S:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Nu(a,r.mode,l)).return=r,r=o}return s(r);case R:return e(r,o,(c=a._init)(a._payload),l)}if(te(a))return m(r,o,a,l);if(B(a))return g(r,o,a,l);yo(r,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Lu(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var wo=_o(!0),So=_o(!1),Co=Ei(null),Eo=null,xo=null,Ao=null;function ko(){Ao=xo=Eo=null}function Do(e){var t=Co.current;xi(Co),e._currentValue=t}function Po(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function To(e,t){Eo=e,Ao=xo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Fo(e){var t=e._currentValue;if(Ao!==e)if(e={context:e,memoizedValue:t,next:null},null===xo){if(null===Eo)throw Error(o(308));xo=e,Eo.dependencies={lanes:0,firstContext:e}}else xo=xo.next=e;return t}var Ro=null;function Io(e){null===Ro?Ro=[e]:Ro.push(e)}function Oo(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Io(t)):(n.next=i.next,i.next=n),t.interleaved=n,Bo(e,r)}function Bo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mo=!1;function Lo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function No(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Vo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Dl){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Bo(e,n)}return null===(i=r.interleaved)?(t.next=t,Io(r)):(t.next=i.next,i.next=t),r.interleaved=t,Bo(e,n)}function Uo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ho(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,r){var i=e.updateQueue;Mo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===a?o=u:a.next=u,a=l;var c=e.alternate;null!==c&&(s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l)}if(null!==o){var d=i.baseState;for(a=0,c=u=l=null,s=o;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"==typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=m.payload)?f.call(p,d,h):f))break e;d=L({},d,h);break e;case 2:Mo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,a|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function jo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(o(191,i));i.call(r)}}}var $o={},Go=Ei($o),qo=Ei($o),Ko=Ei($o);function Yo(e){if(e===$o)throw Error(o(174));return e}function Xo(e,t){switch(Ai(Ko,t),Ai(qo,e),Ai(Go,$o),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Go),Ai(Go,t)}function Zo(){xi(Go),xi(qo),xi(Ko)}function Qo(e){Yo(Ko.current);var t=Yo(Go.current),n=le(t,e.type);t!==n&&(Ai(qo,e),Ai(Go,n))}function Jo(e){qo.current===e&&(xi(Go),xi(qo))}var ea=Ei(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=_.ReactCurrentDispatcher,oa=_.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ua=null,ca=!1,da=!1,ha=0,pa=0;function fa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:es,e=n(r,i),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(o(301));a+=1,ua=la=null,t.updateQueue=null,ia.current=ts,e=n(r,i)}while(da)}if(ia.current=Qa,t=null!==la&&null!==la.next,aa=0,ua=la=sa=null,ca=!1,t)throw Error(o(300));return e}function va(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ua?sa.memoizedState=ua=e:ua=ua.next=e,ua}function ba(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ua?sa.memoizedState:ua.next;if(null!==t)ua=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ua?sa.memoizedState=ua=e:ua=ua.next=e}return ua}function _a(e,t){return"function"==typeof t?t(e):t}function wa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,u=null,c=a;do{var d=c.lane;if((aa&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,s=r):u=u.next=h,sa.lanes|=d,Ml|=d}c=c.next}while(null!==c&&c!==a);null===u?s=r:u.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Ml|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Ca(){}function Ea(e,t){var n=sa,r=ba(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,Ma(ka.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ua&&1&ua.memoizedState.tag){if(n.flags|=2048,Fa(9,Aa.bind(null,n,r,i,t),void 0,null),null===Pl)throw Error(o(349));30&aa||xa(n,t,i)}return i}function xa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Aa(e,t,n,r){t.value=n,t.getSnapshot=r,Da(t)&&Pa(e)}function ka(e,t,n){return n((function(){Da(t)&&Pa(e)}))}function Da(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(e){return!0}}function Pa(e){var t=Bo(e,1);null!==t&&nu(t,e,1,-1)}function Ta(e){var t=ya();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,sa,e),[t.memoizedState,e]}function Fa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ra(){return ba().memoizedState}function Ia(e,t,n,r){var i=ya();sa.flags|=e,i.memoizedState=Fa(1|t,n,void 0,void 0===r?null:r)}function Oa(e,t,n,r){var i=ba();r=void 0===r?null:r;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Fa(t,n,o,r))}sa.flags|=e,i.memoizedState=Fa(1|t,n,o,r)}function Ba(e,t){return Ia(8390656,8,e,t)}function Ma(e,t){return Oa(2048,8,e,t)}function La(e,t){return Oa(4,2,e,t)}function Na(e,t){return Oa(4,4,e,t)}function Va(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function za(e,t,n){return n=null!=n?n.concat([e]):null,Oa(4,4,Va.bind(null,t,e),n)}function Ua(){}function Ha(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wa(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ja(e,t,n){return 21&aa?(sr(n,t)||(n=mt(),sa.lanes|=n,Ml|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n)}function $a(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=oa.transition;oa.transition={};try{e(!1),t()}finally{bt=n,oa.transition=r}}function Ga(){return ba().memoizedState}function qa(e,t,n){var r=tu(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e)?Xa(t,n):null!==(n=Oo(e,t,n,r))&&(nu(n,e,r,eu()),Za(n,t,r))}function Ka(e,t,n){var r=tu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Xa(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(i.next=i,Io(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(n=Oo(e,t,i,r))&&(nu(n,e,r,i=eu()),Za(n,t,r))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Xa(e,t){da=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Za(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qa={readContext:Fo,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Ja={readContext:Fo,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Fo,useEffect:Ba,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Ia(4194308,4,Va.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ia(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ia(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qa.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ta,useDebugValue:Ua,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ta(!1),t=e[0];return e=$a.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,i=ya();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Pl)throw Error(o(349));30&aa||xa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ba(ka.bind(null,r,a,e),[e]),r.flags|=2048,Fa(9,Aa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Pl.identifierPrefix;if(io){var n=Zi;t=":"+t+"R"+(n=(Xi&~(1<<32-at(Xi)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Fo,useCallback:Ha,useContext:Fo,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Na,useMemo:Wa,useReducer:wa,useRef:Ra,useState:function(){return wa(_a)},useDebugValue:Ua,useDeferredValue:function(e){return ja(ba(),la.memoizedState,e)},useTransition:function(){return[wa(_a)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1},ts={readContext:Fo,useCallback:Ha,useContext:Fo,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Na,useMemo:Wa,useReducer:Sa,useRef:Ra,useState:function(){return Sa(_a)},useDebugValue:Ua,useDeferredValue:function(e){var t=ba();return null===la?t.memoizedState=e:ja(t,la.memoizedState,e)},useTransition:function(){return[Sa(_a)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=eu(),i=tu(e),o=Vo(r,i);o.payload=t,null!=n&&(o.callback=n),null!==(t=zo(e,o,i))&&(nu(t,e,i,r),Uo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=eu(),i=tu(e),o=Vo(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=zo(e,o,i))&&(nu(t,e,i,r),Uo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),r=tu(e),i=Vo(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=zo(e,i,r))&&(nu(t,e,r,n),Uo(t,e,r))}};function os(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!(t.prototype&&t.prototype.isPureReactComponent&&lr(n,r)&&lr(i,o))}function as(e,t,n){var r=!1,i=ki,o=t.contextType;return"object"==typeof o&&null!==o?o=Fo(o):(i=Ri(t)?Ti:Di.current,o=(r=null!=(r=t.contextTypes))?Fi(e,i):ki),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Lo(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=Fo(o):(o=Ri(t)?Ti:Di.current,i.context=Fi(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Wo(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function us(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function cs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var hs="function"==typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Vo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){jl||(jl=!0,$l=r),ds(0,t)},n}function fs(e,t,n){(n=Vo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ds(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!=typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xu.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,i){return 1&e.mode?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Vo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e)}var ys=_.ReactCurrentOwner,bs=!1;function _s(e,t,n,r){t.child=null===e?So(t,null,n,r):wo(t,e.child,n,r)}function ws(e,t,n,r,i){n=n.render;var o=t.ref;return To(t,i),r=ga(e,t,n,r,o,i),n=va(),null===e||bs?(io&&n&&eo(t),t.flags|=1,_s(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,js(e,t,i))}function Ss(e,t,n,r,i){if(null===e){var o=n.type;return"function"!=typeof o||Ru(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ou(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cs(e,t,o,r,i))}if(o=e.child,!(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return js(e,t,i)}return t.flags|=1,(e=Iu(o,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=o,!(e.lanes&i))return t.lanes=e.lanes,js(e,t,i);131072&e.flags&&(bs=!0)}}return As(e,t,n,r,i)}function Es(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ai(Il,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ai(Il,Rl),Rl|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ai(Il,Rl),Rl|=n;else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ai(Il,Rl),Rl|=r;return _s(e,t,i,n),t.child}function xs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,n,r,i){var o=Ri(n)?Ti:Di.current;return o=Fi(t,o),To(t,i),n=ga(e,t,n,r,o,i),r=va(),null===e||bs?(io&&r&&eo(t),t.flags|=1,_s(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,js(e,t,i))}function ks(e,t,n,r,i){if(Ri(n)){var o=!0;Mi(t)}else o=!1;if(To(t,i),null===t.stateNode)Ws(e,t),as(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;u="object"==typeof u&&null!==u?Fo(u):Fi(t,u=Ri(n)?Ti:Di.current);var c=n.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&ss(t,a,r,u),Mo=!1;var h=t.memoizedState;a.state=h,Wo(t,r,a,i),l=t.memoizedState,s!==r||h!==l||Pi.current||Mo?("function"==typeof c&&(rs(t,n,c,r),l=t.memoizedState),(s=Mo||os(t,n,s,r,h,l,u))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,No(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:ns(t.type,s),a.props=u,d=t.pendingProps,h=a.context,l="object"==typeof(l=n.contextType)&&null!==l?Fo(l):Fi(t,l=Ri(n)?Ti:Di.current);var p=n.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||h!==l)&&ss(t,a,r,l),Mo=!1,h=t.memoizedState,a.state=h,Wo(t,r,a,i);var f=t.memoizedState;s!==d||h!==f||Pi.current||Mo?("function"==typeof p&&(rs(t,n,p,r),f=t.memoizedState),(u=Mo||os(t,n,u,r,h,f,l)||!1)?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=u):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ds(e,t,n,r,o,i)}function Ds(e,t,n,r,i,o){xs(e,t);var a=!!(128&t.flags);if(!r&&!a)return i&&Li(t,n,!1),js(e,t,o);r=t.stateNode,ys.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):_s(e,t,s,o),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Xo(e,t.containerInfo)}function Ts(e,t,n,r,i){return fo(),mo(i),t.flags|=256,_s(e,t,n,r),t.child}var Fs,Rs,Is,Os,Bs={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,i=t.pendingProps,a=ea.current,s=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ai(ea,1&a),null===e)return uo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},1&i||null===s?s=Mu(l,i,0,null):(s.childLanes=0,s.pendingProps=l),e=Bu(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(n),t.memoizedState=Bs,e):Ns(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Vs(e,t,s,r=cs(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Mu({mode:"visible",children:r.children},i,0,null),(a=Bu(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,1&t.mode&&wo(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Bs,a);if(!(1&t.mode))return Vs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Vs(e,t,s,r=cs(a=Error(o(419)),r,void 0))}if(l=!!(s&e.childLanes),bs||l){if(null!==(r=Pl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=i&(r.suspendedLanes|s)?0:i)&&i!==a.retryLane&&(a.retryLane=i,Bo(e,i),nu(r,e,i,-1))}return mu(),Vs(e,t,s,r=cs(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=ku.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=ui(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(qi[Ki++]=Xi,qi[Ki++]=Zi,qi[Ki++]=Yi,Xi=e.id,Zi=e.overflow,Yi=t),(t=Ns(t,r.children)).flags|=4096,t)}(e,t,l,i,r,a,n);if(s){s=i.fallback,l=t.mode,r=(a=e.child).sibling;var u={mode:"hidden",children:i.children};return 1&l||t.child===a?(i=Iu(a,u)).subtreeFlags=14680064&a.subtreeFlags:((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null),null!==r?s=Iu(r,s):(s=Bu(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ms(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Bs,i}return e=(s=e.child).sibling,i=Iu(s,{mode:"visible",children:i.children}),!(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ns(e,t){return(t=Mu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vs(e,t,n,r){return null!==r&&mo(r),wo(t,e.child,null,n),(e=Ns(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Po(e.return,t,n)}function Us(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Hs(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(_s(e,t,r.children,n),2&(r=ea.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ai(ea,r),1&t.mode)switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Us(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Us(t,!0,n,null,o);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Ws(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function js(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Iu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Iu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function $s(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Ri(t.type)&&Ii(),Gs(t),null;case 3:return r=t.stateNode,Zo(),xi(Pi),xi(Di),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==oo&&(au(oo),oo=null))),Rs(e,t),Gs(t),null;case 5:Jo(t);var i=Yo(Ko.current);if(n=t.type,null!==e&&null!=t.stateNode)Is(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Gs(t),null}if(e=Yo(Go.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[pi]=a,e=!!(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Br.length;i++)Vr(Br[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":X(r,a),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Vr("invalid",r);break;case"textarea":ie(r,a),Vr("invalid",r)}for(var l in ye(n,a),i=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"==typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,u,e),i=["children",u]):"number"==typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,u,e),i=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":G(r),J(r,a,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,Fs(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Br.length;i++)Vr(Br[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":X(e,r),i=Y(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=L({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(a in ye(n,i),u=i)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"==typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"==typeof c&&he(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Vr("scroll",e):null!=c&&b(e,a,c,l))}switch(n){case"input":G(e),J(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+j(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Os(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo(Ko.current),Yo(Go.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Qr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,!!(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Gs(t),null;case 13:if(xi(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&1&t.mode&&!(128&t.flags))po(),fo(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[hi]=t}else fo(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),a=!1}else null!==oo&&(au(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!=(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ea.current?0===Ol&&(Ol=3):mu())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return Zo(),Rs(e,t),null===e&&Hr(t.stateNode.containerInfo),Gs(t),null;case 10:return Do(t.type._context),Gs(t),null;case 19:if(xi(ea),null===(a=t.memoizedState))return Gs(t),null;if(r=!!(128&t.flags),null===(l=a.rendering))if(r)$s(a,!1);else{if(0!==Ol||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,$s(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ai(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Ze()>Hl&&(t.flags|=128,r=!0,$s(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),$s(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return Gs(t),null}else 2*Ze()-a.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,$s(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ze(),t.sibling=null,n=ea.current,Ai(ea,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return du(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Rl)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ks(e,t){switch(to(t),t.tag){case 1:return Ri(t.type)&&Ii(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Zo(),xi(Pi),xi(Di),ra(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Jo(t),null;case 13:if(xi(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(ea),null;case 4:return Zo(),null;case 10:return Do(t.type._context),null;case 22:case 23:return du(),null;default:return null}}Fs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Rs=function(){},Is=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(Go.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=L({},i,{value:void 0}),r=L({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Jr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!=typeof u&&"number"!=typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Vr("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Xs=!1,Zs="function"==typeof WeakSet?WeakSet:Set,Qs=null;function Js(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Eu(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){Eu(e,t,n)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,n,o)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[mi],delete t[gi],delete t[vi]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"==typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Xs||Js(n,t);case 6:var r=cl,i=dl;cl=null,hl(e,t,n),dl=i,null!==(cl=r)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Ht(e)):li(cl,n.stateNode));break;case 4:r=cl,i=dl,cl=n.stateNode.containerInfo,dl=!0,hl(e,t,n),cl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Xs&&null!==(r=n.updateQueue)&&null!==(r=r.lastEffect)){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(2&o||4&o)&&el(n,t,a),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Xs&&(Js(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Eu(n,t,e)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,hl(e,t,n),Xs=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Du.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(o(160));pl(a,s,i),cl=null,dl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(e){Eu(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(t){Eu(e,e.return,t)}try{nl(5,e,e.return)}catch(t){Eu(e,e.return,t)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Js(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Js(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(t){Eu(e,e.return,t)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Z(i,a),be(l,s);var c=be(l,a);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,c)}switch(l){case"input":Q(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(t){Eu(e,e.return,t)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(t){Eu(e,e.return,t)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(t){Eu(e,e.return,t)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Ul=Ze())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(c=Xs)||d,ml(t,e),Xs=c):ml(t,e),vl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&1&e.mode)for(Qs=e,d=e.child;null!==d;){for(h=Qs=d;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Js(p,p.return);var m=p.stateNode;if("function"==typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(e){Eu(r,n,e)}}break;case 5:Js(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,Qs=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"==typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,s=null!=(u=h.memoizedProps.style)&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",s))}catch(t){Eu(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(t){Eu(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),ul(e,sl(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(o(161))}}catch(t){Eu(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Qs=e,bl(e,t,n)}function bl(e,t,n){for(var r=!!(1&e.mode);null!==Qs;){var i=Qs,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Ys;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Ys;var u=Xs;if(Ys=a,(Xs=l)&&!u)for(Qs=i;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?Sl(i):null!==l?(l.return=a,Qs=l):Sl(i);for(;null!==o;)Qs=o,bl(o,t,n),o=o.sibling;Qs=i,Ys=s,Xs=u}_l(e)}else 8772&i.subtreeFlags&&null!==o?(o.return=i,Qs=o):_l(e)}}function _l(e){for(;null!==Qs;){var t=Qs;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Xs||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&jo(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}jo(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(o(163))}Xs||512&t.flags&&il(t)}catch(e){Eu(t,t.return,e)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function Sl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(e){Eu(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(e){Eu(t,i,e)}}var o=t.return;try{il(t)}catch(e){Eu(t,o,e)}break;case 5:var a=t.return;try{il(t)}catch(e){Eu(t,a,e)}}}catch(e){Eu(t,t.return,e)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Cl,El=Math.ceil,xl=_.ReactCurrentDispatcher,Al=_.ReactCurrentOwner,kl=_.ReactCurrentBatchConfig,Dl=0,Pl=null,Tl=null,Fl=0,Rl=0,Il=Ei(0),Ol=0,Bl=null,Ml=0,Ll=0,Nl=0,Vl=null,zl=null,Ul=0,Hl=1/0,Wl=null,jl=!1,$l=null,Gl=null,ql=!1,Kl=null,Yl=0,Xl=0,Zl=null,Ql=-1,Jl=0;function eu(){return 6&Dl?Ze():-1!==Ql?Ql:Ql=Ze()}function tu(e){return 1&e.mode?2&Dl&&0!==Fl?Fl&-Fl:null!==go.transition?(0===Jl&&(Jl=mt()),Jl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type):1}function nu(e,t,n,r){if(50<Xl)throw Xl=0,Zl=null,Error(o(185));vt(e,n,r),2&Dl&&e===Pl||(e===Pl&&(!(2&Dl)&&(Ll|=n),4===Ol&&su(e,Fl)),ru(e,r),1===n&&0===Dl&&!(1&t.mode)&&(Hl=Ze()+500,Vi&&Hi()))}function ru(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?s&n&&!(s&r)||(i[a]=pt(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ht(e,e===Pl?Fl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Vi=!0,Ui(e)}(lu.bind(null,e)):Ui(lu.bind(null,e)),ai((function(){!(6&Dl)&&Hi()})),n=null;else{switch(_t(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pu(n,iu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function iu(e,t){if(Ql=-1,Jl=0,6&Dl)throw Error(o(327));var n=e.callbackNode;if(Su()&&e.callbackNode!==n)return null;var r=ht(e,e===Pl?Fl:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=gu(e,r);else{t=r;var i=Dl;Dl|=2;var a=fu();for(Pl===e&&Fl===t||(Wl=null,Hl=Ze()+500,hu(e,t));;)try{yu();break}catch(t){pu(e,t)}ko(),xl.current=a,Dl=i,null!==Tl?t=0:(Pl=null,Fl=0,t=Ol)}if(0!==t){if(2===t&&0!==(i=ft(e))&&(r=i,t=ou(e,i)),1===t)throw n=Bl,hu(e,0),su(e,r),ru(e,Ze()),n;if(6===t)su(e,r);else{if(i=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)||(t=gu(e,r),2===t&&(a=ft(e),0!==a&&(r=a,t=ou(e,a))),1!==t)))throw n=Bl,hu(e,0),su(e,r),ru(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:wu(e,zl,Wl);break;case 3:if(su(e,r),(130023424&r)===r&&10<(t=Ul+500-Ze())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){eu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wu.bind(null,e,zl,Wl),t);break}wu(e,zl,Wl);break;case 4:if(su(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(wu.bind(null,e,zl,Wl),r);break}wu(e,zl,Wl);break;default:throw Error(o(329))}}}return ru(e,Ze()),e.callbackNode===n?iu.bind(null,e):null}function ou(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(hu(e,t).flags|=256),2!==(e=gu(e,t))&&(t=zl,zl=n,null!==t&&au(t)),e}function au(e){null===zl?zl=e:zl.push.apply(zl,e)}function su(e,t){for(t&=~Nl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lu(e){if(6&Dl)throw Error(o(327));Su();var t=ht(e,0);if(!(1&t))return ru(e,Ze()),null;var n=gu(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=ou(e,r))}if(1===n)throw n=Bl,hu(e,0),su(e,t),ru(e,Ze()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,zl,Wl),ru(e,Ze()),null}function uu(e,t){var n=Dl;Dl|=1;try{return e(t)}finally{0===(Dl=n)&&(Hl=Ze()+500,Vi&&Hi())}}function cu(e){null!==Kl&&0===Kl.tag&&!(6&Dl)&&Su();var t=Dl;Dl|=1;var n=kl.transition,r=bt;try{if(kl.transition=null,bt=1,e)return e()}finally{bt=r,kl.transition=n,!(6&(Dl=t))&&Hi()}}function du(){Rl=Il.current,xi(Il)}function hu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ii();break;case 3:Zo(),xi(Pi),xi(Di),ra();break;case 5:Jo(r);break;case 4:Zo();break;case 13:case 19:xi(ea);break;case 10:Do(r.type._context);break;case 22:case 23:du()}n=n.return}if(Pl=e,Tl=e=Iu(e.current,null),Fl=Rl=t,Ol=0,Bl=null,Nl=Ll=Ml=0,zl=Vl=null,null!==Ro){for(t=0;t<Ro.length;t++)if(null!==(r=(n=Ro[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Ro=null}return e}function pu(e,t){for(;;){var n=Tl;try{if(ko(),ia.current=Qa,ca){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(aa=0,ua=la=sa=null,da=!1,ha=0,Al.current=null,null===n||null===n.return){Ol=1,Bl=t,Tl=null;break}e:{var a=e,s=n.return,l=n,u=t;if(t=Fl,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var c=u,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,vs(f,s,l,0,t),1&f.mode&&ms(a,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(!(1&t)){ms(a,c,t),mu();break e}u=Error(o(426))}else if(io&&1&l.mode){var v=gs(s);if(null!==v){!(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),mo(us(u,l));break e}}a=u=us(u,l),4!==Ol&&(Ol=2),null===Vl?Vl=[a]:Vl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ho(a,ps(0,u,t));break e;case 1:l=u;var y=a.type,b=a.stateNode;if(!(128&a.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Gl&&Gl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Ho(a,fs(a,l,t));break e}}a=a.return}while(null!==a)}_u(n)}catch(e){t=e,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function fu(){var e=xl.current;return xl.current=Qa,null===e?Qa:e}function mu(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Pl||!(268435455&Ml)&&!(268435455&Ll)||su(Pl,Fl)}function gu(e,t){var n=Dl;Dl|=2;var r=fu();for(Pl===e&&Fl===t||(Wl=null,hu(e,t));;)try{vu();break}catch(t){pu(e,t)}if(ko(),Dl=n,xl.current=r,null!==Tl)throw Error(o(261));return Pl=null,Fl=0,Ol}function vu(){for(;null!==Tl;)bu(Tl)}function yu(){for(;null!==Tl&&!Ye();)bu(Tl)}function bu(e){var t=Cl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?_u(e):Tl=t,Al.current=null}function _u(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Ol=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=qs(n,t,Rl)))return void(Tl=n);if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Ol&&(Ol=5)}function wu(e,t,n){var r=bt,i=kl.transition;try{kl.transition=null,bt=1,function(e,t,n,r){do{Su()}while(null!==Kl);if(6&Dl)throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Pl&&(Tl=Pl=null,Fl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||ql||(ql=!0,Pu(tt,(function(){return Su(),null}))),a=!!(15990&n.flags),15990&n.subtreeFlags||a){a=kl.transition,kl.transition=null;var s=bt;bt=1;var l=Dl;Dl|=4,Al.current=null,function(e,t){if(ei=jt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(e){n=null;break e}var s=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=s+i),h!==a||0!==r&&3!==h.nodeType||(u=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===i&&(l=s),p===a&&++d===r&&(u=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},jt=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,1028&t.subtreeFlags&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(o(163))}}catch(e){Eu(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ti),jt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Xe(),Dl=l,bt=s,kl.transition=a}else e.current=n;if(ql&&(ql=!1,Kl=e,Yl=i),0===(a=e.pendingLanes)&&(Gl=null),function(e){if(ot&&"function"==typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),ru(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((i=t[n]).value,{componentStack:i.stack,digest:i.digest});if(jl)throw jl=!1,e=$l,$l=null,e;!!(1&Yl)&&0!==e.tag&&Su(),1&(a=e.pendingLanes)?e===Zl?Xl++:(Xl=0,Zl=e):Xl=0,Hi()}(e,t,n,r)}finally{kl.transition=i,bt=r}return null}function Su(){if(null!==Kl){var e=_t(Yl),t=kl.transition,n=bt;try{if(kl.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Yl=0,6&Dl)throw Error(o(331));var i=Dl;for(Dl|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(16&Qs.flags){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Qs=c;null!==Qs;){var d=Qs;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Qs=h;else for(;null!==Qs;){var p=(d=Qs).sibling,f=d.return;if(ol(d),d===c){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Qs=a}}if(2064&a.subtreeFlags&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(2048&(a=Qs).flags)switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Qs=y;break e}Qs=a.return}}var b=e.current;for(Qs=b;null!==Qs;){var _=(s=Qs).child;if(2064&s.subtreeFlags&&null!==_)_.return=s,Qs=_;else e:for(s=b;null!==Qs;){if(2048&(l=Qs).flags)try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){Eu(l,l.return,e)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(Dl=i,Hi(),ot&&"function"==typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{bt=n,kl.transition=t}}return!1}function Cu(e,t,n){e=zo(e,t=ps(0,t=us(n,t),1),1),t=eu(),null!==e&&(vt(e,1,t),ru(e,t))}function Eu(e,t,n){if(3===e.tag)Cu(e,e,n);else for(;null!==t;){if(3===t.tag){Cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=zo(t,e=fs(t,e=us(n,e),1),1),e=eu(),null!==t&&(vt(t,1,e),ru(t,e));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Fl&n)===n&&(4===Ol||3===Ol&&(130023424&Fl)===Fl&&500>Ze()-Ul?hu(e,0):Nl|=n),ru(e,t)}function Au(e,t){0===t&&(1&e.mode?(t=ct,!(130023424&(ct<<=1))&&(ct=4194304)):t=1);var n=eu();null!==(e=Bo(e,t))&&(vt(e,t,n),ru(e,n))}function ku(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Au(e,n)}function Du(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Au(e,n)}function Pu(e,t){return qe(e,t)}function Tu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fu(e,t,n,r){return new Tu(e,t,n,r)}function Ru(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Iu(e,t){var n=e.alternate;return null===n?((n=Fu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ou(e,t,n,r,i,a){var s=2;if(r=e,"function"==typeof e)Ru(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case C:return Bu(n.children,i,a,t);case E:s=8,i|=8;break;case x:return(e=Fu(12,n,t,2|i)).elementType=x,e.lanes=a,e;case P:return(e=Fu(13,n,t,i)).elementType=P,e.lanes=a,e;case T:return(e=Fu(19,n,t,i)).elementType=T,e.lanes=a,e;case I:return Mu(n,i,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case k:s=9;break e;case D:s=11;break e;case F:s=14;break e;case R:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Fu(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Bu(e,t,n,r){return(e=Fu(7,e,r,t)).lanes=n,e}function Mu(e,t,n,r){return(e=Fu(22,e,r,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function Lu(e,t,n){return(e=Fu(6,e,null,t)).lanes=n,e}function Nu(e,t,n){return(t=Fu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zu(e,t,n,r,i,o,a,s,l){return e=new Vu(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Fu(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lo(o),e}function Uu(e){if(!e)return ki;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Bi(e,n,t)}return t}function Hu(e,t,n,r,i,o,a,s,l){return(e=zu(n,r,!0,e,0,o,0,s,l)).context=Uu(null),n=e.current,(o=Vo(r=eu(),i=tu(n))).callback=null!=t?t:null,zo(n,o,i),e.current.lanes=i,vt(e,i,r),ru(e,r),e}function Wu(e,t,n,r){var i=t.current,o=eu(),a=tu(i);return n=Uu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Vo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(i,t,a))&&(nu(e,i,a,o),Uo(e,i,a)),a}function ju(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function $u(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gu(e,t){$u(e,t),(e=e.alternate)&&$u(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pi.current)bs=!0;else{if(!(e.lanes&n||128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),fo();break;case 5:Qo(t);break;case 1:Ri(t.type)&&Mi(t);break;case 4:Xo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ai(Co,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ai(ea,1&ea.current),t.flags|=128,null):n&t.child.childLanes?Ls(e,t,n):(Ai(ea,1&ea.current),null!==(e=js(e,t,n))?e.sibling:null);Ai(ea,1&ea.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return Hs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ai(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return js(e,t,n)}(e,t,n);bs=!!(131072&e.flags)}else bs=!1,io&&1048576&t.flags&&Ji(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ws(e,t),e=t.pendingProps;var i=Fi(t,Di.current);To(t,n),i=ga(null,t,r,e,i,n);var a=va();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(a=!0,Mi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Lo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=Ds(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),_s(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"==typeof e)return Ru(e)?1:0;if(null!=e){if((e=e.$$typeof)===D)return 11;if(e===F)return 14}return 2}(r),e=ns(r,e),i){case 0:t=As(null,t,r,e,n);break e;case 1:t=ks(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,As(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(Ps(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,No(e,t),Wo(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ts(e,t,r,n,i=us(Error(o(423)),t));break e}if(r!==i){t=Ts(e,t,r,n,i=us(Error(o(424)),t));break e}for(ro=ui(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=So(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){t=js(e,t,n);break e}_s(e,t,r,n)}t=t.child}return t;case 5:return Qo(t),null===e&&uo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),xs(e,t),_s(e,t,s,n),t.child;case 6:return null===e&&uo(t),null;case 13:return Ls(e,t,n);case 4:return Xo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wo(t,null,r,n):_s(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ws(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return _s(e,t,t.pendingProps,n),t.child;case 8:case 12:return _s(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ai(Co,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Pi.current){t=js(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=Vo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),Po(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Po(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}_s(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,To(t,n),r=r(i=Fo(i)),t.flags|=1,_s(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),Ss(e,t,r,i=ns(r.type,i),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Ws(e,t),t.tag=1,Ri(r)?(e=!0,Mi(t)):e=!1,To(t,n),as(t,r,i),ls(t,r,i,n),Ds(null,t,r,!0,e,n);case 19:return Hs(e,t,n);case 22:return Es(e,t,n)}throw Error(o(156,t.tag))};var qu="function"==typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Yu(e){this._internalRoot=e}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qu(){}function Ju(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"==typeof i){var s=i;i=function(){var e=ju(a);s.call(e)}}Wu(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"==typeof r){var o=r;r=function(){var e=ju(a);o.call(e)}}var a=Hu(t,r,e,0,null,!1,0,"",Qu);return e._reactRootContainer=a,e[fi]=a.current,Hr(8===e.nodeType?e.parentNode:e),cu(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var s=r;r=function(){var e=ju(l);s.call(e)}}var l=zu(e,0,!1,null,0,!1,0,"",Qu);return e._reactRootContainer=l,e[fi]=l.current,Hr(8===e.nodeType?e.parentNode:e),cu((function(){Wu(t,l,n,r)})),l}(n,t,e,i,r);return ju(a)}Yu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Wu(e,t,null,null)},Yu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cu((function(){Wu(null,e,null,null)})),t[fi]=null}},Yu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ru(t,Ze()),!(6&Dl)&&(Hl=Ze()+500,Hi()))}break;case 13:cu((function(){var t=Bo(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),Gu(e,1)}},St=function(e){if(13===e.tag){var t=Bo(e,134217728);null!==t&&nu(t,e,134217728,eu()),Gu(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tu(e),n=Bo(e,t);null!==n&&nu(n,e,t,eu()),Gu(e,t)}},Et=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(o(90));q(r),Q(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},De=uu,Pe=cu;var ec={usingClientEntryPoint:!1,Events:[bi,_i,wi,Ae,ke,uu]},tc={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{it=rc.inject(nc),ot=rc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xu(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xu(e))throw Error(o(299));var n=!1,r="",i=qu;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zu(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return null===(e=$e(t))?null:e.stateNode},t.flushSync=function(e){return cu(e)},t.hydrate=function(e,t,n){if(!Zu(t))throw Error(o(200));return Ju(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xu(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=qu;if(null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Hu(t,null,e,1,null!=n?n:null,i,0,a,s),e[fi]=t.current,Hr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yu(t)},t.render=function(e,t,n){if(!Zu(t))throw Error(o(200));return Ju(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zu(e))throw Error(o(40));return!!e._reactRootContainer&&(cu((function(){Ju(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zu(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Ju(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},745:(e,t,n)=>{"use strict";var r=n(3935);t.s=r.createRoot,r.hydrateRoot},3935:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(4448)},9921:(e,t)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,_=n?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case o:case s:case a:case p:return e;default:switch(e=e&&e.$$typeof){case u:case h:case g:case m:case l:return e;default:return t}}case i:return t}}}function S(e){return w(e)===d}t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=o,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=s,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||w(e)===c},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===u},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===o},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===s||e===a||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===_||e.$$typeof===v)},t.typeOf=w},9864:(e,t,n)=>{"use strict";e.exports=n(9921)},2408:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,m(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,C={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,i)&&!E.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:C.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function D(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===o?"."+D(l,0):o,w(a)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),P(a,t,i,"",(function(e){return e}))):null!=a&&(A(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",w(e))for(var u=0;u<e.length;u++){var c=o+D(s=e[u],u);l+=P(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=P(s=s.value,t,i,c=o+D(s,u++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},I={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:I,ReactCurrentOwner:C};function B(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=B,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=C.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)S.call(t,u)&&!E.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=B,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},7294:(e,t,n)=>{"use strict";e.exports=n(2408)},53:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>o(l,n))u<i&&0>o(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<i&&0>o(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var u=[],c=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function _(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function w(e){if(g=!1,_(e),!m)if(null!==r(u))m=!0,I(S);else{var t=r(c);null!==t&&O(w,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(A),A=-1),f=!0;var o=p;try{for(_(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!P());){var a=h.callback;if("function"==typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?h.callback=s:h===r(u)&&i(u),_(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&O(w,d.startTime-n),l=!1}return l}finally{h=null,p=o,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,E=!1,x=null,A=-1,k=5,D=-1;function P(){return!(t.unstable_now()-D<k)}function T(){if(null!==x){var e=t.unstable_now();D=e;var n=!0;try{n=x(!0,e)}finally{n?C():(E=!1,x=null)}}else E=!1}if("function"==typeof b)C=function(){b(T)};else if("undefined"!=typeof MessageChannel){var F=new MessageChannel,R=F.port2;F.port1.onmessage=T,C=function(){R.postMessage(null)}}else C=function(){v(T,0)};function I(e){x=e,E||(E=!0,C())}function O(e,n){A=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,I(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?a+o:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(u)&&e===r(c)&&(g?(y(A),A=-1):g=!0,O(w,o-a))):(e.sortIndex=s,n(u,e),m||f||(m=!0,I(S))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},3840:(e,t,n)=>{"use strict";e.exports=n(53)},7086:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function i(e,t){if(Number.isFinite(e)&&Number.isFinite(t))return e-t;var n=typeof e,r=typeof t;if(n!==r)return n<r?-1:1;if("object"===n){if(null===e)return null===t?0:-1;if(null===t)return 1;if((n=typeof(e=e.valueOf()))!=(r=typeof(t=t.valueOf())))return n<r?-1:1}return e<t?-1:e>t?1:e===t?0:Number.isNaN(e)?Number.isNaN(t)?0:-1:Number.isNaN(t)?1:Array.isArray(e)?0:Number.NaN}Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyBTree=t.asSet=t.simpleComparator=t.defaultComparator=void 0,t.defaultComparator=i,t.simpleComparator=function(e,t){return e>t?1:e<t?-1:0};var o=function(){function e(e,t,n){this._root=m,this._size=0,this._maxNodeSize=n>=4?Math.min(n,256):32,this._compare=t||i,e&&this.setPairs(e)}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._size},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._root=m,this._size=0},e.prototype.forEach=function(e,t){var n=this;return void 0!==t&&(e=e.bind(t)),this.forEachPair((function(t,r){return e(r,t,n)}))},e.prototype.forEachPair=function(e,t){var n=this.minKey(),r=this.maxKey();return this.forRange(n,r,!0,e,t)},e.prototype.get=function(e,t){return this._root.get(e,t,this)},e.prototype.set=function(e,t,n){this._root.isShared&&(this._root=this._root.clone());var r=this._root.set(e,t,n,this);return!0===r||!1===r?r:(this._root=new c([this._root,r]),!0)},e.prototype.has=function(e){return 0!==this.forRange(e,e,!0,void 0)},e.prototype.delete=function(e){return 0!==this.editRange(e,e,!0,p)},e.prototype.with=function(e,t,n){var r=this.clone();return r.set(e,t,n)||n?r:this},e.prototype.withPairs=function(e,t){var n=this.clone();return 0!==n.setPairs(e,t)||t?n:this},e.prototype.withKeys=function(e,t){for(var n=this.clone(),r=!1,i=0;i<e.length;i++)r=n.set(e[i],void 0,!1)||r;return t&&!r?this:n},e.prototype.without=function(e,t){return this.withoutRange(e,e,!0,t)},e.prototype.withoutKeys=function(e,t){var n=this.clone();return n.deleteKeys(e)||!t?n:this},e.prototype.withoutRange=function(e,t,n,r){var i=this.clone();return 0===i.deleteRange(e,t,n)&&r?this:i},e.prototype.filter=function(e,t){var n,r=this.greedyClone();return r.editAll((function(t,r,i){if(!e(t,r,i))return n=h})),!n&&t?this:r},e.prototype.mapValues=function(e){var t={},n=this.greedyClone();return n.editAll((function(n,r,i){return t.value=e(r,n,i),t})),n},e.prototype.reduce=function(e,t){for(var n,r=0,i=t,o=this.entries(this.minKey(),v);!(n=o.next()).done;)i=e(i,n.value,r++,this);return i},e.prototype.entries=function(e,t){var n=this.findPath(e);if(void 0===n)return a();var r=n.nodequeue,i=n.nodeindex,o=n.leaf,s=void 0!==t?1:0,l=void 0===e?-1:o.indexOf(e,0,this._compare)-1;return a((function(){e:for(;;)switch(s){case 0:if(++l<o.keys.length)return{done:!1,value:[o.keys[l],o.values[l]]};s=2;continue;case 1:if(++l<o.keys.length)return t[0]=o.keys[l],t[1]=o.values[l],{done:!1,value:t};s=2;case 2:for(var e=-1;;){if(++e>=r.length){s=3;continue e}if(++i[e]<r[e].length)break}for(;e>0;e--)r[e-1]=r[e][i[e]].children,i[e-1]=0;o=r[0][i[0]],l=-1,s=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))},e.prototype.entriesReversed=function(e,t,n){if(void 0===e&&(n=void 0,void 0===(e=this.maxKey())))return a();var r=this.findPath(e)||this.findPath(this.maxKey()),i=r.nodequeue,o=r.nodeindex,s=r.leaf;y(!i[0]||s===i[0][o[0]],"wat!");var l=s.indexOf(e,0,this._compare);!n&&l<s.keys.length&&this._compare(s.keys[l],e)<=0&&l++;var u=void 0!==t?1:0;return a((function(){e:for(;;)switch(u){case 0:if(--l>=0)return{done:!1,value:[s.keys[l],s.values[l]]};u=2;continue;case 1:if(--l>=0)return t[0]=s.keys[l],t[1]=s.values[l],{done:!1,value:t};u=2;case 2:for(var e=-1;;){if(++e>=i.length){u=3;continue e}if(--o[e]>=0)break}for(;e>0;e--)i[e-1]=i[e][o[e]].children,o[e-1]=i[e-1].length-1;s=i[0][o[0]],l=s.keys.length,u=void 0!==t?1:0;continue;case 3:return{done:!0,value:void 0}}}))},e.prototype.findPath=function(e){var t,n,r=this._root;if(r.isLeaf)t=g,n=g;else{t=[],n=[];for(var i=0;!r.isLeaf;i++){if(t[i]=r.children,n[i]=void 0===e?0:r.indexOf(e,0,this._compare),n[i]>=t[i].length)return;r=t[i][n[i]]}t.reverse(),n.reverse()}return{nodequeue:t,nodeindex:n,leaf:r}},e.prototype.diffAgainst=function(t,n,r,i){if(t._compare!==this._compare)throw new Error("Tree comparators are not the same.");if(this.isEmpty||t.isEmpty){if(this.isEmpty&&t.isEmpty)return;return this.isEmpty?void 0===r?void 0:e.stepToEnd(e.makeDiffCursor(t),r):void 0===n?void 0:e.stepToEnd(e.makeDiffCursor(this),n)}for(var o=this._compare,a=e.makeDiffCursor(this),s=e.makeDiffCursor(t),l=!0,u=!0,c=e.compare(a,s,o);l&&u;){var d=e.compare(a,s,o),h=a.leaf,p=a.internalSpine,f=a.levelIndices,m=s.leaf,g=s.internalSpine,v=s.levelIndices;if(h||m){if(0!==c)if(0===d){if(h&&m&&i){var y=h.values[f[f.length-1]],b=m.values[v[v.length-1]];if(!Object.is(y,b)&&(w=i(a.currentKey,y,b))&&w.break)return w.break}}else if(d>0){if(m&&r){var _=m.values[v[v.length-1]];if((w=r(s.currentKey,_))&&w.break)return w.break}}else if(n&&h&&0!==c){var w;if(y=h.values[f[f.length-1]],(w=n(a.currentKey,y))&&w.break)return w.break}}else if(!h&&!m&&0===d){var S=p.length-1,C=g.length-1,E=p[S][f[S]];if(g[C][v[C]]===E){c=0,l=e.step(a,!0),u=e.step(s,!0);continue}}c=d,d<0?l=e.step(a):u=e.step(s)}return l&&n?e.finishCursorWalk(a,s,o,n):u&&r?e.finishCursorWalk(s,a,o,r):void 0},e.finishCursorWalk=function(t,n,r,i){var o=e.compare(t,n,r);if(0===o){if(!e.step(t))return}else o<0&&y(!1,"cursor walk terminated early");return e.stepToEnd(t,i)},e.stepToEnd=function(t,n){for(var r=!0;r;){var i=t.leaf,o=t.levelIndices,a=t.currentKey;if(i){var s=n(a,i.values[o[o.length-1]]);if(s&&s.break)return s.break}r=e.step(t)}},e.makeDiffCursor=function(e){var t=e._root;return{height:e.height,internalSpine:[[t]],levelIndices:[0],leaf:void 0,currentKey:t.maxKey()}},e.step=function(e,t){var n=e.internalSpine,r=e.levelIndices,i=e.leaf;if(!0===t||i){var o=r.length;if(!0===t||0===r[o-1]){var a=n.length;if(0===a)return!1;for(var s=a-1,l=s;l>=0;){if(r[l]>0)return l<o-1&&(e.leaf=void 0,r.pop()),l<s&&(e.internalSpine=n.slice(0,l+1)),e.currentKey=n[l][--r[l]].maxKey(),!0;l--}return!1}var u=--r[o-1];return e.currentKey=i.keys[u],!0}var c=n.length,d=c-1,h=n[d][r[d]];if(h.isLeaf)e.leaf=h,u=r[c]=h.values.length-1,e.currentKey=h.keys[u];else{var p=h.children;n[c]=p;var f=p.length-1;r[c]=f,e.currentKey=p[f].maxKey()}return!0},e.compare=function(e,t,n){var r=e.height,i=e.currentKey,o=e.levelIndices,a=t.height,s=t.currentKey,l=t.levelIndices,u=n(s,i);if(0!==u)return u;var c=r<a?r:a;return o.length-(r-c)-(l.length-(a-c))},e.prototype.keys=function(e){var t=this.entries(e,v);return a((function(){var e=t.next();return e.value&&(e.value=e.value[0]),e}))},e.prototype.values=function(e){var t=this.entries(e,v);return a((function(){var e=t.next();return e.value&&(e.value=e.value[1]),e}))},Object.defineProperty(e.prototype,"maxNodeSize",{get:function(){return this._maxNodeSize},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this._root.minKey()},e.prototype.maxKey=function(){return this._root.maxKey()},e.prototype.clone=function(){this._root.isShared=!0;var t=new e(void 0,this._compare,this._maxNodeSize);return t._root=this._root,t._size=this._size,t},e.prototype.greedyClone=function(t){var n=new e(void 0,this._compare,this._maxNodeSize);return n._root=this._root.greedyClone(t),n._size=this._size,n},e.prototype.toArray=function(e){void 0===e&&(e=2147483647);var t=this.minKey(),n=this.maxKey();return void 0!==t?this.getRange(t,n,!0,e):[]},e.prototype.keysArray=function(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,(function(t,n){e.push(t)})),e},e.prototype.valuesArray=function(){var e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,(function(t,n){e.push(n)})),e},e.prototype.toString=function(){return this.toArray().toString()},e.prototype.setIfNotPresent=function(e,t){return this.set(e,t,!1)},e.prototype.nextHigherPair=function(e,t){return t=t||[],void 0===e?this._root.minPair(t):this._root.getPairOrNextHigher(e,this._compare,!1,t)},e.prototype.nextHigherKey=function(e){var t=this.nextHigherPair(e,v);return t&&t[0]},e.prototype.nextLowerPair=function(e,t){return t=t||[],void 0===e?this._root.maxPair(t):this._root.getPairOrNextLower(e,this._compare,!1,t)},e.prototype.nextLowerKey=function(e){var t=this.nextLowerPair(e,v);return t&&t[0]},e.prototype.getPairOrNextLower=function(e,t){return this._root.getPairOrNextLower(e,this._compare,!0,t||[])},e.prototype.getPairOrNextHigher=function(e,t){return this._root.getPairOrNextHigher(e,this._compare,!0,t||[])},e.prototype.changeIfPresent=function(e,t){return 0!==this.editRange(e,e,!0,(function(e,n){return{value:t}}))},e.prototype.getRange=function(e,t,n,r){void 0===r&&(r=67108863);var i=[];return this._root.forRange(e,t,n,!1,this,0,(function(e,t){return i.push([e,t]),i.length>r?f:void 0})),i},e.prototype.setPairs=function(e,t){for(var n=0,r=0;r<e.length;r++)this.set(e[r][0],e[r][1],t)&&n++;return n},e.prototype.forRange=function(e,t,n,r,i){var o=this._root.forRange(e,t,n,!1,this,i||0,r);return"number"==typeof o?o:o.break},e.prototype.editRange=function(e,t,n,r,i){var o=this._root;o.isShared&&(this._root=o=o.clone());try{var a=o.forRange(e,t,n,!0,this,i||0,r);return"number"==typeof a?a:a.break}finally{for(var s=void 0;o.keys.length<=1&&!o.isLeaf;)s||(s=o.isShared),this._root=o=0===o.keys.length?m:o.children[0];s&&(o.isShared=!0)}},e.prototype.editAll=function(e,t){return this.editRange(this.minKey(),this.maxKey(),!0,e,t)},e.prototype.deleteRange=function(e,t,n){return this.editRange(e,t,n,p)},e.prototype.deleteKeys=function(e){for(var t=0,n=0;t<e.length;t++)this.delete(e[t])&&n++;return n},Object.defineProperty(e.prototype,"height",{get:function(){for(var e=this._root,t=-1;e;)t++,e=e.isLeaf?void 0:e.children[0];return t},enumerable:!1,configurable:!0}),e.prototype.freeze=function(){var e=this;e.clear=e.set=e.editRange=function(){throw new Error("Attempted to modify a frozen BTree")}},e.prototype.unfreeze=function(){delete this.clear,delete this.set,delete this.editRange},Object.defineProperty(e.prototype,"isFrozen",{get:function(){return this.hasOwnProperty("editRange")},enumerable:!1,configurable:!0}),e.prototype.checkValid=function(){var e=this._root.checkValid(0,this,0);y(e===this.size,"size mismatch: counted ",e,"but stored",this.size)},e}();function a(e){void 0===e&&(e=function(){return{done:!0,value:void 0}});var t={next:e};return Symbol&&Symbol.iterator&&(t[Symbol.iterator]=function(){return this}),t}t.default=o,t.asSet=function(e){return e},Symbol&&Symbol.iterator&&(o.prototype[Symbol.iterator]=o.prototype.entries),o.prototype.where=o.prototype.filter,o.prototype.setRange=o.prototype.setPairs,o.prototype.add=o.prototype.set;var s,l,u=function(){function e(e,t){void 0===e&&(e=[]),this.keys=e,this.values=t||d,this.isShared=void 0}return Object.defineProperty(e.prototype,"isLeaf",{get:function(){return void 0===this.children},enumerable:!1,configurable:!0}),e.prototype.maxKey=function(){return this.keys[this.keys.length-1]},e.prototype.indexOf=function(e,t,n){for(var r=this.keys,i=0,o=r.length,a=o>>1;i<o;){var s=n(r[a],e);if(s<0)i=a+1;else{if(!(s>0)){if(0===s)return a;if(e==e)return r.length;throw new Error("BTree: NaN was used as a key")}o=a}a=i+o>>1}return a^t},e.prototype.minKey=function(){return this.keys[0]},e.prototype.minPair=function(e){if(0!==this.keys.length)return e[0]=this.keys[0],e[1]=this.values[0],e},e.prototype.maxPair=function(e){if(0!==this.keys.length){var t=this.keys.length-1;return e[0]=this.keys[t],e[1]=this.values[t],e}},e.prototype.clone=function(){var t=this.values;return new e(this.keys.slice(0),t===d?t:t.slice(0))},e.prototype.greedyClone=function(e){return this.isShared&&!e?this:this.clone()},e.prototype.get=function(e,t,n){var r=this.indexOf(e,-1,n._compare);return r<0?t:this.values[r]},e.prototype.getPairOrNextLower=function(e,t,n,r){var i=this.indexOf(e,-1,t),o=i<0?~i-1:n?i:i-1;if(o>=0)return r[0]=this.keys[o],r[1]=this.values[o],r},e.prototype.getPairOrNextHigher=function(e,t,n,r){var i=this.indexOf(e,-1,t),o=i<0?~i:n?i:i+1,a=this.keys;if(o<a.length)return r[0]=a[o],r[1]=this.values[o],r},e.prototype.checkValid=function(e,t,n){var r=this.keys.length,i=this.values.length;return y(this.values===d?r<=i:r===i,"keys/values length mismatch: depth",e,"with lengths",r,i,"and baseIndex",n),y(0==e||r>0,"empty leaf at depth",e,"and baseIndex",n),r},e.prototype.set=function(e,t,n,r){var i=this.indexOf(e,-1,r._compare);if(i<0){if(i=~i,r._size++,this.keys.length<r._maxNodeSize)return this.insertInLeaf(i,e,t,r);var o=this.splitOffRightSide(),a=this;return i>this.keys.length&&(i-=this.keys.length,a=o),a.insertInLeaf(i,e,t,r),o}return!1!==n&&(void 0!==t&&this.reifyValues(),this.keys[i]=e,this.values[i]=t),!1},e.prototype.reifyValues=function(){return this.values===d?this.values=this.values.slice(0,this.keys.length):this.values},e.prototype.insertInLeaf=function(e,t,n,r){if(this.keys.splice(e,0,t),this.values===d){for(;d.length<r._maxNodeSize;)d.push(void 0);if(void 0===n)return!0;this.values=d.slice(0,this.keys.length-1)}return this.values.splice(e,0,n),!0},e.prototype.takeFromRight=function(e){var t=this.values;e.values===d?t!==d&&t.push(void 0):(t=this.reifyValues()).push(e.values.shift()),this.keys.push(e.keys.shift())},e.prototype.takeFromLeft=function(e){var t=this.values;e.values===d?t!==d&&t.unshift(void 0):(t=this.reifyValues()).unshift(e.values.pop()),this.keys.unshift(e.keys.pop())},e.prototype.splitOffRightSide=function(){var t=this.keys.length>>1;return new e(this.keys.splice(t),this.values===d?d:this.values.splice(t))},e.prototype.forRange=function(e,t,n,r,i,o,a){var s,l,u=i._compare;if(t===e){if(!n)return o;if(l=(s=this.indexOf(e,-1,u))+1,s<0)return o}else s=this.indexOf(e,0,u),(l=this.indexOf(t,-1,u))<0?l=~l:!0===n&&l++;var c=this.keys,h=this.values;if(void 0!==a)for(var p=s;p<l;p++){var f=c[p],m=a(f,h[p],o++);if(void 0!==m){if(!0===r){if(f!==c[p]||!0===this.isShared)throw new Error("BTree illegally changed or cloned in editRange");m.delete?(this.keys.splice(p,1),this.values!==d&&this.values.splice(p,1),i._size--,p--,l--):m.hasOwnProperty("value")&&(h[p]=m.value)}if(void 0!==m.break)return m}}else o+=l-s;return o},e.prototype.mergeSibling=function(e,t){if(this.keys.push.apply(this.keys,e.keys),this.values===d){if(e.values===d)return;this.values=this.values.slice(0,this.keys.length)}this.values.push.apply(this.values,e.reifyValues())},e}(),c=function(e){function t(t,n){var r=this;if(!n){n=[];for(var i=0;i<t.length;i++)n[i]=t[i].maxKey()}return(r=e.call(this,n)||this).children=t,r}return r(t,e),t.prototype.clone=function(){for(var e=this.children.slice(0),n=0;n<e.length;n++)e[n].isShared=!0;return new t(e,this.keys.slice(0))},t.prototype.greedyClone=function(e){if(this.isShared&&!e)return this;for(var n=new t(this.children.slice(0),this.keys.slice(0)),r=0;r<n.children.length;r++)n.children[r]=n.children[r].greedyClone(e);return n},t.prototype.minKey=function(){return this.children[0].minKey()},t.prototype.minPair=function(e){return this.children[0].minPair(e)},t.prototype.maxPair=function(e){return this.children[this.children.length-1].maxPair(e)},t.prototype.get=function(e,t,n){var r=this.indexOf(e,0,n._compare),i=this.children;return r<i.length?i[r].get(e,t,n):void 0},t.prototype.getPairOrNextLower=function(e,t,n,r){var i=this.indexOf(e,0,t),o=this.children;if(i>=o.length)return this.maxPair(r);var a=o[i].getPairOrNextLower(e,t,n,r);return void 0===a&&i>0?o[i-1].maxPair(r):a},t.prototype.getPairOrNextHigher=function(e,t,n,r){var i=this.indexOf(e,0,t),o=this.children,a=o.length;if(!(i>=a)){var s=o[i].getPairOrNextHigher(e,t,n,r);return void 0===s&&i<a-1?o[i+1].minPair(r):s}},t.prototype.checkValid=function(e,t,n){var r=this.keys.length,i=this.children.length;y(r===i,"keys/children length mismatch: depth",e,"lengths",r,i,"baseIndex",n),y(r>1||e>0,"internal node has length",r,"at depth",e,"baseIndex",n);for(var o=0,a=this.children,s=this.keys,l=0,u=0;u<i;u++)y((o+=a[u].checkValid(e+1,t,n+o))>=(l+=a[u].keys.length),"wtf",n),y(0===u||a[u-1].constructor===a[u].constructor,"type mismatch, baseIndex:",n),a[u].maxKey()!=s[u]&&y(!1,"keys[",u,"] =",s[u],"is wrong, should be ",a[u].maxKey(),"at depth",e,"baseIndex",n),0===u||t._compare(s[u-1],s[u])<0||y(!1,"sort violation at depth",e,"index",u,"keys",s[u-1],s[u]);var c=0===l;return(c||l>t.maxNodeSize*i)&&y(!1,c?"too few":"too many","children (",l,o,") at depth",e,"maxNodeSize:",t.maxNodeSize,"children.length:",i,"baseIndex:",n),o},t.prototype.set=function(e,t,n,r){var i,o=this.children,a=r._maxNodeSize,s=r._compare,l=Math.min(this.indexOf(e,0,s),o.length-1),u=o[l];u.isShared&&(o[l]=u=u.clone()),u.keys.length>=a&&(l>0&&(i=o[l-1]).keys.length<a&&s(u.keys[0],e)<0?(i.isShared&&(o[l-1]=i=i.clone()),i.takeFromRight(u),this.keys[l-1]=i.maxKey()):void 0!==(i=o[l+1])&&i.keys.length<a&&s(u.maxKey(),e)<0&&(i.isShared&&(o[l+1]=i=i.clone()),i.takeFromLeft(u),this.keys[l]=o[l].maxKey()));var c=u.set(e,t,n,r);if(!1===c)return!1;if(this.keys[l]=u.maxKey(),!0===c)return!0;if(this.keys.length<a)return this.insert(l+1,c),!0;var d=this.splitOffRightSide(),h=this;return s(c.maxKey(),this.maxKey())>0&&(h=d,l-=this.keys.length),h.insert(l+1,c),d},t.prototype.insert=function(e,t){this.children.splice(e,0,t),this.keys.splice(e,0,t.maxKey())},t.prototype.splitOffRightSide=function(){var e=this.children.length>>1;return new t(this.children.splice(e),this.keys.splice(e))},t.prototype.takeFromRight=function(e){this.keys.push(e.keys.shift()),this.children.push(e.children.shift())},t.prototype.takeFromLeft=function(e){this.keys.unshift(e.keys.pop()),this.children.unshift(e.children.pop())},t.prototype.forRange=function(e,t,n,r,i,o,a){var s=i._compare,l=this.keys,u=this.children,c=this.indexOf(e,0,s),d=c,h=Math.min(t===e?c:this.indexOf(t,0,s),l.length-1);if(r){if(d<=h)try{for(;d<=h;d++){if(u[d].isShared&&(u[d]=u[d].clone()),f=u[d].forRange(e,t,n,r,i,o,a),l[d]=u[d].maxKey(),"number"!=typeof f)return f;o=f}}finally{var p=i._maxNodeSize>>1;for(c>0&&c--,d=h;d>=c;d--)u[d].keys.length<=p&&(0!==u[d].keys.length?this.tryMerge(d,i._maxNodeSize):(l.splice(d,1),u.splice(d,1)));0!==u.length&&0===u[0].keys.length&&y(!1,"emptiness bug")}}else for(;d<=h;d++){var f;if("number"!=typeof(f=u[d].forRange(e,t,n,r,i,o,a)))return f;o=f}return o},t.prototype.tryMerge=function(e,t){var n=this.children;return e>=0&&e+1<n.length&&n[e].keys.length+n[e+1].keys.length<=t&&(n[e].isShared&&(n[e]=n[e].clone()),n[e].mergeSibling(n[e+1],t),n.splice(e+1,1),this.keys.splice(e+1,1),this.keys[e]=n[e].maxKey(),!0)},t.prototype.mergeSibling=function(e,t){var n=this.keys.length;this.keys.push.apply(this.keys,e.keys);var r=e.children;if(this.children.push.apply(this.children,r),e.isShared&&!this.isShared)for(var i=0;i<r.length;i++)r[i].isShared=!0;this.tryMerge(n-1,t)},t}(u),d=[],h={delete:!0},p=function(){return h},f={break:!0},m=((s=new u).isShared=!0,s),g=[],v=[];function y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)throw t.unshift("B+ tree"),new Error(t.join(" "))}t.EmptyBTree=((l=new o).freeze(),l)},372:(e,t,n)=>{"use strict";var r=n(6060);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!r(e)}},3940:(e,t,n)=>{"use strict";var r=n(5618),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!r(e)&&hasOwnProperty.call(i,typeof e)}},7205:(e,t,n)=>{"use strict";var r=n(372),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!r(e)&&!i.test(o.call(e))}},6060:(e,t,n)=>{"use strict";var r=n(3940);e.exports=function(e){if(!r(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},5618:e=>{"use strict";e.exports=function(e){return null!=e}},4927:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},8083:t=>{"use strict";t.exports=e}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.u=e=>e+".reader.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="",r.b=document.baseURI||self.location.href;var i={};return(()=>{"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,n,r){return i=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n),(n="symbol"==t(i)?i:String(i))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e;var i}r.r(e),r.d(e,{RangeObject:()=>ua,blob2base64:()=>na,borders:()=>Mo,bounds:()=>Bo,createBase64Url:()=>Go,createBlob:()=>Wo,createBlobUrl:()=>jo,defaults:()=>To,defer:()=>ra,documentHeight:()=>xo,extend:()=>Fo,filterChildren:()=>sa,findChildren:()=>oa,getParentByTagName:()=>la,indexOfElementNode:()=>Uo,indexOfNode:()=>Vo,indexOfSorted:()=>Oo,indexOfTextNode:()=>zo,insert:()=>Ro,isElement:()=>Ao,isFloat:()=>Do,isNumber:()=>ko,isXml:()=>Ho,locationOf:()=>Io,nodeBounds:()=>Lo,parents:()=>aa,parse:()=>Ko,prefixed:()=>Po,qs:()=>Xo,qsa:()=>Zo,qsp:()=>Qo,querySelectorByType:()=>ia,removeCommentData:()=>Yo,requestAnimationFrame:()=>_o,revokeBlobUrl:()=>$o,sprint:()=>Jo,treeWalker:()=>ea,type:()=>qo,uuid:()=>Eo,walk:()=>ta,windowBounds:()=>No});var i=r(745),o=r(7294),a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},l.apply(this,arguments)};function u(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function c(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function d(e,t){var n=t&&t.cache?t.cache:w,r=t&&t.serializer?t.serializer:g;return(t&&t.strategy?t.strategy:m)(e,{cache:n,serializer:r})}function h(e,t,n,r){var i,o=null==(i=r)||"number"==typeof i||"boolean"==typeof i?r:n(r),a=t.get(o);return void 0===a&&(a=e.call(this,r),t.set(o,a)),a}function p(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),o=t.get(i);return void 0===o&&(o=e.apply(this,r),t.set(i,o)),o}function f(e,t,n,r,i){return n.bind(t,e,r,i)}function m(e,t){return f(e,this,1===e.length?h:p,t.cache.create(),t.serializer)}Object.create,Object.create;var g=function(){return JSON.stringify(arguments)};function v(){this.cache=Object.create(null)}v.prototype.get=function(e){return this.cache[e]},v.prototype.set=function(e,t){this.cache[e]=t};var y,b,_,w={create:function(){return new v}},S={variadic:function(e,t){return f(e,this,p,t.cache.create(),t.serializer)},monadic:function(e,t){return f(e,this,h,t.cache.create(),t.serializer)}};function C(e){return e.type===b.literal}function E(e){return e.type===b.argument}function x(e){return e.type===b.number}function A(e){return e.type===b.date}function k(e){return e.type===b.time}function D(e){return e.type===b.select}function P(e){return e.type===b.plural}function T(e){return e.type===b.pound}function F(e){return e.type===b.tag}function R(e){return!(!e||"object"!=typeof e||e.type!==_.number)}function I(e){return!(!e||"object"!=typeof e||e.type!==_.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(y||(y={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(b||(b={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(_||(_={}));var O=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,B=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function M(e){var t={};return e.replace(B,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"long":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var L=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i,N=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,V=/^(@+)?(\+|#+)?[rs]?$/g,z=/(\*)(0+)|(#+)(0+)|(0+)/g,U=/^(0+)$/;function H(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(V,(function(e,n,r){return"string"!=typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"==typeof r?r.length:0)),""})),t}function W(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function j(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var n=e.slice(0,2);if("+!"===n?(t.signDisplay="always",e=e.slice(2)):"+?"===n&&(t.signDisplay="exceptZero",e=e.slice(2)),!U.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function $(e){return W(e)||{}}function G(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=i.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=i.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=l(l(l({},t),{notation:"scientific"}),i.options.reduce((function(e,t){return l(l({},e),$(t))}),{}));continue;case"engineering":t=l(l(l({},t),{notation:"engineering"}),i.options.reduce((function(e,t){return l(l({},e),$(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(i.options[0]);continue;case"rounding-mode-floor":t.roundingMode="floor";continue;case"rounding-mode-ceiling":t.roundingMode="ceil";continue;case"rounding-mode-down":t.roundingMode="trunc";continue;case"rounding-mode-up":t.roundingMode="expand";continue;case"rounding-mode-half-even":t.roundingMode="halfEven";continue;case"rounding-mode-half-down":t.roundingMode="halfTrunc";continue;case"rounding-mode-half-up":t.roundingMode="halfExpand";continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(z,(function(e,n,r,i,o,a){if(n)t.minimumIntegerDigits=r.length;else{if(i&&o)throw new Error("We currently do not support maximum integer digits");if(a)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(U.test(i.stem))t.minimumIntegerDigits=i.stem.length;else if(N.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(N,(function(e,n,r,i,o,a){return"*"===r?t.minimumFractionDigits=n.length:i&&"#"===i[0]?t.maximumFractionDigits=i.length:o&&a?(t.minimumFractionDigits=o.length,t.maximumFractionDigits=o.length+a.length):(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length),""}));var o=i.options[0];"w"===o?t=l(l({},t),{trailingZeroDisplay:"stripIfInteger"}):o&&(t=l(l({},t),H(o)))}else if(V.test(i.stem))t=l(l({},t),H(i.stem));else{var a=W(i.stem);a&&(t=l(l({},t),a));var s=j(i.stem);s&&(t=l(l({},t),s))}}return t}var q,K={"001":["H","h"],419:["h","H","hB","hb"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["h","H","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["h","H","hB","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["h","H","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["h","H","hB","hb"],CU:["h","H","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["h","H","hB","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["h","H","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["h","H","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["h","H","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["h","H","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["h","H","hB","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["h","H","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["h","H","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["h","H","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"en-HK":["h","hb","H","hB"],"en-IL":["H","h","hb","hB"],"en-MY":["h","hb","H","hB"],"es-BR":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function Y(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n,r=e.language;return"root"!==r&&(n=e.maximize().region),(K[n||""]||K[r||""]||K["".concat(r,"-001")]||K["001"])[0]}var X=new RegExp("^".concat(O.source,"*")),Z=new RegExp("".concat(O.source,"*$"));function Q(e,t){return{start:e,end:t}}var J=!!String.prototype.startsWith&&"_a".startsWith("a",1),ee=!!String.fromCodePoint,te=!!Object.fromEntries,ne=!!String.prototype.codePointAt,re=!!String.prototype.trimStart,ie=!!String.prototype.trimEnd,oe=Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},ae=!0;try{ae="a"===(null===(q=fe("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===q?void 0:q[0])}catch(e){ae=!1}var se,le=J?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return e.slice(n,n+t.length)===t},ue=ee?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,r="",i=e.length,o=0;i>o;){if((n=e[o++])>1114111)throw RangeError(n+" is not a valid code point");r+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return r},ce=te?Object.fromEntries:function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],a=i[1];t[o]=a}return t},de=ne?function(e,t){return e.codePointAt(t)}:function(e,t){var n=e.length;if(!(t<0||t>=n)){var r,i=e.charCodeAt(t);return i<55296||i>56319||t+1===n||(r=e.charCodeAt(t+1))<56320||r>57343?i:r-56320+(i-55296<<10)+65536}},he=re?function(e){return e.trimStart()}:function(e){return e.replace(X,"")},pe=ie?function(e){return e.trimEnd()}:function(e){return e.replace(Z,"")};function fe(e,t){return new RegExp(e,t)}if(ae){var me=fe("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");se=function(e,t){var n;return me.lastIndex=t,null!==(n=me.exec(e)[1])&&void 0!==n?n:""}}else se=function(e,t){for(var n=[];;){var r=de(e,t);if(void 0===r||be(r)||_e(r))break;n.push(r),t+=r>=65536?2:1}return ue.apply(void 0,n)};var ge,ve=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,n){for(var r=[];!this.isEOF();){var i=this.char();if(123===i){if((o=this.parseArgument(e,n)).err)return o;r.push(o.val)}else{if(125===i&&e>0)break;if(35!==i||"plural"!==t&&"selectordinal"!==t){if(60===i&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(y.UNMATCHED_CLOSING_TAG,Q(this.clonePosition(),this.clonePosition()))}if(60===i&&!this.ignoreTag&&ye(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;r.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;r.push(o.val)}}else{var a=this.clonePosition();this.bump(),r.push({type:b.pound,location:Q(a,this.clonePosition())})}}}return{val:r,err:null}},e.prototype.parseTag=function(e,t){var n=this.clonePosition();this.bump();var r=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:b.literal,value:"<".concat(r,"/>"),location:Q(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var i=this.parseMessage(e+1,t,!0);if(i.err)return i;var o=i.val,a=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!ye(this.char()))return this.error(y.INVALID_TAG,Q(a,this.clonePosition()));var s=this.clonePosition();return r!==this.parseTagName()?this.error(y.UNMATCHED_CLOSING_TAG,Q(s,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:b.tag,value:r,children:o,location:Q(n,this.clonePosition())},err:null}:this.error(y.INVALID_TAG,Q(a,this.clonePosition())))}return this.error(y.UNCLOSED_TAG,Q(n,this.clonePosition()))}return this.error(y.INVALID_TAG,Q(n,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var n=this.clonePosition(),r="";;){var i=this.tryParseQuote(t);if(i)r+=i;else{var o=this.tryParseUnquoted(e,t);if(o)r+=o;else{var a=this.tryParseLeftAngleBracket();if(!a)break;r+=a}}}var s=Q(n,this.clonePosition());return{val:{type:b.literal,value:r,location:s},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(ye(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(n);this.bump()}return ue.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===t||"selectordinal"===t)||125===n&&e>0?null:(this.bump(),ue(n))},e.prototype.parseArgument=function(e,t){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(y.EXPECT_ARGUMENT_CLOSING_BRACE,Q(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(y.EMPTY_ARGUMENT,Q(n,this.clonePosition()));var r=this.parseIdentifierIfPossible().value;if(!r)return this.error(y.MALFORMED_ARGUMENT,Q(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(y.EXPECT_ARGUMENT_CLOSING_BRACE,Q(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:b.argument,value:r,location:Q(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(y.EXPECT_ARGUMENT_CLOSING_BRACE,Q(n,this.clonePosition())):this.parseArgumentOptions(e,t,r,n);default:return this.error(y.MALFORMED_ARGUMENT,Q(n,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),n=se(this.message,t),r=t+n.length;return this.bumpTo(r),{value:n,location:Q(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,n,r){var i,o=this.clonePosition(),a=this.parseIdentifierIfPossible().value,s=this.clonePosition();switch(a){case"":return this.error(y.EXPECT_ARGUMENT_TYPE,Q(o,s));case"number":case"date":case"time":this.bumpSpace();var u=null;if(this.bumpIf(",")){this.bumpSpace();var c=this.clonePosition();if((w=this.parseSimpleArgStyleIfPossible()).err)return w;if(0===(f=pe(w.val)).length)return this.error(y.EXPECT_ARGUMENT_STYLE,Q(this.clonePosition(),this.clonePosition()));u={style:f,styleLocation:Q(c,this.clonePosition())}}if((S=this.tryParseArgumentClose(r)).err)return S;var d=Q(r,this.clonePosition());if(u&&le(null==u?void 0:u.style,"::",0)){var h=he(u.style.slice(2));if("number"===a)return(w=this.parseNumberSkeletonFromString(h,u.styleLocation)).err?w:{val:{type:b.number,value:n,location:d,style:w.val},err:null};if(0===h.length)return this.error(y.EXPECT_DATE_TIME_SKELETON,d);var p=h;this.locale&&(p=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e.charAt(r);if("j"===i){for(var o=0;r+1<e.length&&e.charAt(r+1)===i;)o++,r++;var a=1+(1&o),s=o<2?1:3+(o>>1),l=Y(t);for("H"!=l&&"k"!=l||(s=0);s-- >0;)n+="a";for(;a-- >0;)n=l+n}else n+="J"===i?"H":i}return n}(h,this.locale));var f={type:_.dateTime,pattern:p,location:u.styleLocation,parsedOptions:this.shouldParseSkeletons?M(p):{}};return{val:{type:"date"===a?b.date:b.time,value:n,location:d,style:f},err:null}}return{val:{type:"number"===a?b.number:"date"===a?b.date:b.time,value:n,location:d,style:null!==(i=null==u?void 0:u.style)&&void 0!==i?i:null},err:null};case"plural":case"selectordinal":case"select":var m=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(y.EXPECT_SELECT_ARGUMENT_OPTIONS,Q(m,l({},m)));this.bumpSpace();var g=this.parseIdentifierIfPossible(),v=0;if("select"!==a&&"offset"===g.value){if(!this.bumpIf(":"))return this.error(y.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,Q(this.clonePosition(),this.clonePosition()));var w;if(this.bumpSpace(),(w=this.tryParseDecimalInteger(y.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,y.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return w;this.bumpSpace(),g=this.parseIdentifierIfPossible(),v=w.val}var S,C=this.tryParsePluralOrSelectOptions(e,a,t,g);if(C.err)return C;if((S=this.tryParseArgumentClose(r)).err)return S;var E=Q(r,this.clonePosition());return"select"===a?{val:{type:b.select,value:n,options:ce(C.val),location:E},err:null}:{val:{type:b.plural,value:n,options:ce(C.val),offset:v,pluralType:"plural"===a?"cardinal":"ordinal",location:E},err:null};default:return this.error(y.INVALID_ARGUMENT_TYPE,Q(o,s))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(y.EXPECT_ARGUMENT_CLOSING_BRACE,Q(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();)switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(y.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,Q(n,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var n=[];try{n=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=e.split(L).filter((function(e){return e.length>0})),n=[],r=0,i=t;r<i.length;r++){var o=i[r].split("/");if(0===o.length)throw new Error("Invalid number skeleton");for(var a=o[0],s=o.slice(1),l=0,u=s;l<u.length;l++)if(0===u[l].length)throw new Error("Invalid number skeleton");n.push({stem:a,options:s})}return n}(e)}catch(e){return this.error(y.INVALID_NUMBER_SKELETON,t)}return{val:{type:_.number,tokens:n,location:t,parsedOptions:this.shouldParseSkeletons?G(n):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,n,r){for(var i,o=!1,a=[],s=new Set,l=r.value,u=r.location;;){if(0===l.length){var c=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(y.EXPECT_PLURAL_ARGUMENT_SELECTOR,y.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;u=Q(c,this.clonePosition()),l=this.message.slice(c.offset,this.offset())}if(s.has(l))return this.error("select"===t?y.DUPLICATE_SELECT_ARGUMENT_SELECTOR:y.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,u);"other"===l&&(o=!0),this.bumpSpace();var h=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?y.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:y.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,Q(this.clonePosition(),this.clonePosition()));var p=this.parseMessage(e+1,t,n);if(p.err)return p;var f=this.tryParseArgumentClose(h);if(f.err)return f;a.push([l,{value:p.val,location:Q(h,this.clonePosition())}]),s.add(l),this.bumpSpace(),l=(i=this.parseIdentifierIfPossible()).value,u=i.location}return 0===a.length?this.error("select"===t?y.EXPECT_SELECT_ARGUMENT_SELECTOR:y.EXPECT_PLURAL_ARGUMENT_SELECTOR,Q(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(y.MISSING_OTHER_CLAUSE,Q(this.clonePosition(),this.clonePosition())):{val:a,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var n=1,r=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var i=!1,o=0;!this.isEOF();){var a=this.char();if(!(a>=48&&a<=57))break;i=!0,o=10*o+(a-48),this.bump()}var s=Q(r,this.clonePosition());return i?oe(o*=n)?{val:o,err:null}:this.error(t,s):this.error(e,s)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=de(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(le(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),n=this.message.indexOf(e,t);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&be(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),n=this.message.charCodeAt(t+(e>=65536?2:1));return null!=n?n:null},e}();function ye(e){return e>=97&&e<=122||e>=65&&e<=90}function be(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function _e(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function we(e){e.forEach((function(e){if(delete e.location,D(e)||P(e))for(var t in e.options)delete e.options[t].location,we(e.options[t].value);else x(e)&&R(e.style)||(A(e)||k(e))&&I(e.style)?delete e.style.location:F(e)&&we(e.children)}))}function Se(e,t){void 0===t&&(t={}),t=l({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var n=new ve(e,t).parse();if(n.err){var r=SyntaxError(y[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return(null==t?void 0:t.captureLocation)||we(n.val),n.val}!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(ge||(ge={}));var Ce,Ee=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.code=n,i.originalMessage=r,i}return s(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),xe=function(e){function t(t,n,r,i){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(n,'". Options are "').concat(Object.keys(r).join('", "'),'"'),ge.INVALID_VALUE,i)||this}return s(t,e),t}(Ee),Ae=function(e){function t(t,n,r){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(n),ge.INVALID_VALUE,r)||this}return s(t,e),t}(Ee),ke=function(e){function t(t,n){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(n,'"'),ge.MISSING_VALUE,n)||this}return s(t,e),t}(Ee);function De(e){return"function"==typeof e}function Pe(e,t,n,r,i,o,a){if(1===e.length&&C(e[0]))return[{type:Ce.literal,value:e[0].value}];for(var s=[],l=0,u=e;l<u.length;l++){var c=u[l];if(C(c))s.push({type:Ce.literal,value:c.value});else if(T(c))"number"==typeof o&&s.push({type:Ce.literal,value:n.getNumberFormat(t).format(o)});else{var d=c.value;if(!i||!(d in i))throw new ke(d,a);var h=i[d];if(E(c))h&&"string"!=typeof h&&"number"!=typeof h||(h="string"==typeof h||"number"==typeof h?String(h):""),s.push({type:"string"==typeof h?Ce.literal:Ce.object,value:h});else if(A(c)){var p="string"==typeof c.style?r.date[c.style]:I(c.style)?c.style.parsedOptions:void 0;s.push({type:Ce.literal,value:n.getDateTimeFormat(t,p).format(h)})}else if(k(c))p="string"==typeof c.style?r.time[c.style]:I(c.style)?c.style.parsedOptions:r.time.medium,s.push({type:Ce.literal,value:n.getDateTimeFormat(t,p).format(h)});else if(x(c))(p="string"==typeof c.style?r.number[c.style]:R(c.style)?c.style.parsedOptions:void 0)&&p.scale&&(h*=p.scale||1),s.push({type:Ce.literal,value:n.getNumberFormat(t,p).format(h)});else{if(F(c)){var f=c.children,m=c.value,g=i[m];if(!De(g))throw new Ae(m,"function",a);var v=g(Pe(f,t,n,r,i,o).map((function(e){return e.value})));Array.isArray(v)||(v=[v]),s.push.apply(s,v.map((function(e){return{type:"string"==typeof e?Ce.literal:Ce.object,value:e}})))}if(D(c)){if(!(y=c.options[h]||c.options.other))throw new xe(c.value,h,Object.keys(c.options),a);s.push.apply(s,Pe(y.value,t,n,r,i))}else if(P(c)){var y;if(!(y=c.options["=".concat(h)])){if(!Intl.PluralRules)throw new Ee('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',ge.MISSING_INTL_API,a);var b=n.getPluralRules(t,{type:c.pluralType}).select(h-(c.offset||0));y=c.options[b]||c.options.other}if(!y)throw new xe(c.value,h,Object.keys(c.options),a);s.push.apply(s,Pe(y.value,t,n,r,i,h-(c.offset||0)))}}}}return(_=s).length<2?_:_.reduce((function(e,t){var n=e[e.length-1];return n&&n.type===Ce.literal&&t.type===Ce.literal?n.value+=t.value:e.push(t),e}),[]);var _}function Te(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(Ce||(Ce={}));var Fe,Re=function(){function e(t,n,r,i){void 0===n&&(n=e.defaultLocale);var o,a,s,h=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=h.formatToParts(e);if(1===t.length)return t[0].value;var n=t.reduce((function(e,t){return e.length&&t.type===Ce.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(e){return Pe(h.ast,h.locales,h.formatters,h.formats,e,void 0,h.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=h.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(h.locales)[0]}},this.getAst=function(){return h.ast},this.locales=n,this.resolvedLocale=e.resolveLocale(n),"string"==typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var p=i||{},f=(p.formatters,u(p,["formatters"]));this.ast=e.__parse(t,l(l({},f),{locale:this.resolvedLocale}))}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=(a=e.formats,(s=r)?Object.keys(a).reduce((function(e,t){var n,r;return e[t]=(n=a[t],(r=s[t])?l(l(l({},n||{}),r||{}),Object.keys(n).reduce((function(e,t){return e[t]=l(l({},n[t]),r[t]||{}),e}),{})):n),e}),l({},a)):a),this.formatters=i&&i.formatters||(void 0===(o=this.formatterCache)&&(o={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,c([void 0],t,!1)))}),{cache:Te(o.number),strategy:S.variadic}),getDateTimeFormat:d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,c([void 0],t,!1)))}),{cache:Te(o.dateTime),strategy:S.variadic}),getPluralRules:d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,c([void 0],t,!1)))}),{cache:Te(o.pluralRules),strategy:S.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if(void 0!==Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])}},e.__parse=Se,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}();!function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"}(Fe||(Fe={}));var Ie=function(e){function t(n,r,i){var o=this,a=i?i instanceof Error?i:new Error(String(i)):void 0;return(o=e.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(r,"\n").concat(a?"\n".concat(a.message,"\n").concat(a.stack):""))||this).code=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return s(t,e),t}(Error),Oe=function(e){function t(t,n){return e.call(this,Fe.UNSUPPORTED_FORMATTER,t,n)||this}return s(t,e),t}(Ie),Be=function(e){function t(t,n){return e.call(this,Fe.INVALID_CONFIG,t,n)||this}return s(t,e),t}(Ie),Me=function(e){function t(t,n){return e.call(this,Fe.MISSING_DATA,t,n)||this}return s(t,e),t}(Ie),Le=function(e){function t(t,n,r){var i=e.call(this,Fe.FORMAT_ERROR,"".concat(t,"\nLocale: ").concat(n,"\n"),r)||this;return i.locale=n,i}return s(t,e),t}(Ie),Ne=function(e){function t(t,n,r,i){var o=e.call(this,"".concat(t,"\nMessageID: ").concat(null==r?void 0:r.id,"\nDefault Message: ").concat(null==r?void 0:r.defaultMessage,"\nDescription: ").concat(null==r?void 0:r.description,"\n"),n,i)||this;return o.descriptor=r,o.locale=n,o}return s(t,e),t}(Le),Ve=function(e){function t(t,n){var r=e.call(this,Fe.MISSING_TRANSLATION,'Missing message: "'.concat(t.id,'" for locale "').concat(n,'", using ').concat(t.defaultMessage?"default message (".concat("string"==typeof t.defaultMessage?t.defaultMessage:t.defaultMessage.map((function(e){var t;return null!==(t=e.value)&&void 0!==t?t:JSON.stringify(e)})).join(),")"):"id"," as fallback."))||this;return r.descriptor=t,r}return s(t,e),t}(Ie);function ze(e,t,n){return void 0===n&&(n={}),t.reduce((function(t,r){return r in e?t[r]=e[r]:r in n&&(t[r]=n[r]),t}),{})}var Ue={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:function(e){},onWarn:function(e){}};function He(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}function We(e,t,n,r){var i,o=e&&e[t];if(o&&(i=o[n]),i)return i;r(new Oe("No ".concat(t," format named: ").concat(n)))}function je(e){!function(e,t,n){if(void 0===n&&(n=Error),!e)throw new n("[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}(e)}var $e=l(l({},Ue),{textComponent:o.Fragment});function Ge(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(var o=0;o<i;o++){var a=n[o];if(e[a]!==t[a]||!Object.prototype.hasOwnProperty.call(t,a))return!1}return!0}r(8679);var qe="undefined"==typeof window||window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?o.createContext(null):window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=o.createContext(null)),Ke=(qe.Consumer,qe.Provider),Ye=qe;function Xe(e,t){return Object.keys(e).reduce((function(n,r){return n[r]=l({timeZone:t},e[r]),n}),{})}function Ze(e,t){return Object.keys(l(l({},e),t)).reduce((function(n,r){return n[r]=l(l({},e[r]||{}),t[r]||{}),n}),{})}function Qe(e,t){if(!t)return e;var n=Re.formats;return l(l(l({},n),e),{date:Ze(Xe(n.date,t),Xe(e.date||{},t)),time:Ze(Xe(n.time,t),Xe(e.time||{},t))})}var Je=function(e,t,n,r,i){var o=e.locale,a=e.formats,s=e.messages,u=e.defaultLocale,c=e.defaultFormats,d=e.fallbackOnEmptyString,h=e.onError,p=e.timeZone,f=e.defaultRichTextElements;void 0===n&&(n={id:""});var m=n.id,g=n.defaultMessage;!function(e,t,n){if(void 0===n&&(n=Error),!e)throw new n("[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.github.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.github.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.github.io/docs/tooling/linter#enforce-id)\nto autofix this issue")}(!!m);var v=String(m),y=s&&Object.prototype.hasOwnProperty.call(s,v)&&s[v];if(Array.isArray(y)&&1===y.length&&y[0].type===b.literal)return y[0].value;if(!r&&y&&"string"==typeof y&&!f)return y.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=l(l({},f),r||{}),a=Qe(a,p),c=Qe(c,p),!y){if(!1===d&&""===y)return y;if((!g||o&&o.toLowerCase()!==u.toLowerCase())&&h(new Ve(n,o)),g)try{return t.getMessageFormat(g,u,c,i).format(r)}catch(e){return h(new Ne('Error formatting default message for: "'.concat(v,'", rendering default message verbatim'),o,n,e)),"string"==typeof g?g:v}return v}try{return t.getMessageFormat(y,o,a,l({formatters:t},i||{})).format(r)}catch(e){h(new Ne('Error formatting message: "'.concat(v,'", using ').concat(g?"default message":"id"," as fallback."),o,n,e))}if(g)try{return t.getMessageFormat(g,u,c,i).format(r)}catch(e){h(new Ne('Error formatting the default message for: "'.concat(v,'", rendering message verbatim'),o,n,e))}return"string"==typeof y?y:"string"==typeof g?g:v},et=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function tt(e,t,n,r){var i=e.locale,o=e.formats,a=e.onError,s=e.timeZone;void 0===r&&(r={});var u=r.format,c=l(l({},s&&{timeZone:s}),u&&We(o,t,u,a)),d=ze(r,et,c);return"time"!==t||d.hour||d.minute||d.second||d.timeStyle||d.dateStyle||(d=l(l({},d),{hour:"numeric",minute:"numeric"})),n(i,d)}function nt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],a=void 0===o?{}:o,s="string"==typeof i?new Date(i||0):i;try{return tt(e,"date",t,a).format(s)}catch(t){e.onError(new Le("Error formatting date.",e.locale,t))}return String(s)}function rt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],a=void 0===o?{}:o,s="string"==typeof i?new Date(i||0):i;try{return tt(e,"time",t,a).format(s)}catch(t){e.onError(new Le("Error formatting time.",e.locale,t))}return String(s)}function it(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],a=n[2],s=void 0===a?{}:a,l=e.timeZone,u=e.locale,c=e.onError,d=ze(s,et,l?{timeZone:l}:{});try{return t(u,d).formatRange(i,o)}catch(t){c(new Le("Error formatting date time range.",e.locale,t))}return String(i)}function ot(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],a=void 0===o?{}:o,s="string"==typeof i?new Date(i||0):i;try{return tt(e,"date",t,a).formatToParts(s)}catch(t){e.onError(new Le("Error formatting date.",e.locale,t))}return[]}function at(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],a=void 0===o?{}:o,s="string"==typeof i?new Date(i||0):i;try{return tt(e,"time",t,a).formatToParts(s)}catch(t){e.onError(new Le("Error formatting time.",e.locale,t))}return[]}var st=["style","type","fallback","languageDisplay"];function lt(e,t,n,r){var i=e.locale,o=e.onError;Intl.DisplayNames||o(new Ee('Intl.DisplayNames is not available in this environment.\nTry polyfilling it using "@formatjs/intl-displaynames"\n',ge.MISSING_INTL_API));var a=ze(r,st);try{return t(i,a).of(n)}catch(e){o(new Le("Error formatting display name.",i,e))}}var ut=["type","style"],ct=Date.now();function dt(e,t,n,r){void 0===r&&(r={});var i=ht(e,t,n,r).reduce((function(e,t){var n=t.value;return"string"!=typeof n?e.push(n):"string"==typeof e[e.length-1]?e[e.length-1]+=n:e.push(n),e}),[]);return 1===i.length?i[0]:0===i.length?"":i}function ht(e,t,n,r){var i=e.locale,o=e.onError;void 0===r&&(r={}),Intl.ListFormat||o(new Ee('Intl.ListFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-listformat"\n',ge.MISSING_INTL_API));var a=ze(r,ut);try{var s={},u=n.map((function(e,t){if("object"==typeof e){var n=function(e){return"".concat(ct,"_").concat(e,"_").concat(ct)}(t);return s[n]=e,n}return String(e)}));return t(i,a).formatToParts(u).map((function(e){return"literal"===e.type?e:l(l({},e),{value:s[e.value]||e.value})}))}catch(e){o(new Le("Error formatting list.",i,e))}return n}var pt=["style","currency","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem","trailingZeroDisplay","roundingPriority","roundingIncrement","roundingMode"];function ft(e,t,n){var r=e.locale,i=e.formats,o=e.onError;void 0===n&&(n={});var a=n.format,s=a&&We(i,"number",a,o)||{};return t(r,ze(n,pt,s))}function mt(e,t,n,r){void 0===r&&(r={});try{return ft(e,t,r).format(n)}catch(t){e.onError(new Le("Error formatting number.",e.locale,t))}return String(n)}function gt(e,t,n,r){void 0===r&&(r={});try{return ft(e,t,r).formatToParts(n)}catch(t){e.onError(new Le("Error formatting number.",e.locale,t))}return[]}var vt=["type"];function yt(e,t,n,r){var i=e.locale,o=e.onError;void 0===r&&(r={}),Intl.PluralRules||o(new Ee('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',ge.MISSING_INTL_API));var a=ze(r,vt);try{return t(i,a).select(n)}catch(e){o(new Le("Error formatting plural.",i,e))}return"other"}var bt=["numeric","style"];function _t(e,t,n,r,i){void 0===i&&(i={}),r||(r="second"),Intl.RelativeTimeFormat||e.onError(new Ee('Intl.RelativeTimeFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-relativetimeformat"\n',ge.MISSING_INTL_API));try{return function(e,t,n){var r=e.locale,i=e.formats,o=e.onError;void 0===n&&(n={});var a=n.format,s=!!a&&We(i,"relative",a,o)||{};return t(r,ze(n,bt,s))}(e,t,i).format(n,r)}catch(t){e.onError(new Le("Error formatting relative time.",e.locale,t))}return String(n)}function wt(e,t){var n=function(e){void 0===e&&(e={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}});var t=Intl.RelativeTimeFormat,n=Intl.ListFormat,r=Intl.DisplayNames,i=d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,c([void 0],t,!1)))}),{cache:He(e.dateTime),strategy:S.variadic}),o=d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,c([void 0],t,!1)))}),{cache:He(e.number),strategy:S.variadic}),a=d((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,c([void 0],t,!1)))}),{cache:He(e.pluralRules),strategy:S.variadic});return{getDateTimeFormat:i,getNumberFormat:o,getMessageFormat:d((function(e,t,n,r){return new Re(e,t,n,l({formatters:{getNumberFormat:o,getDateTimeFormat:i,getPluralRules:a}},r||{}))}),{cache:He(e.message),strategy:S.variadic}),getRelativeTimeFormat:d((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new(t.bind.apply(t,c([void 0],e,!1)))}),{cache:He(e.relativeTime),strategy:S.variadic}),getPluralRules:a,getListFormat:d((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(n.bind.apply(n,c([void 0],e,!1)))}),{cache:He(e.list),strategy:S.variadic}),getDisplayNames:d((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(r.bind.apply(r,c([void 0],e,!1)))}),{cache:He(e.displayNames),strategy:S.variadic})}}(t),r=l(l({},Ue),e),i=r.locale,o=r.defaultLocale,a=r.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&a?a(new Me('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&a&&a(new Me('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl#runtime-requirements for more details'))):(a&&a(new Be('"locale" was not configured, using "'.concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),function(e){var t;e.onWarn&&e.defaultRichTextElements&&"string"==typeof((t=e.messages||{})?t[Object.keys(t)[0]]:void 0)&&e.onWarn('[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. \nPlease consider using "@formatjs/cli" to pre-compile your messages for performance.\nFor more details see https://formatjs.github.io/docs/getting-started/message-distribution')}(r),l(l({},r),{formatters:n,formatNumber:mt.bind(null,r,n.getNumberFormat),formatNumberToParts:gt.bind(null,r,n.getNumberFormat),formatRelativeTime:_t.bind(null,r,n.getRelativeTimeFormat),formatDate:nt.bind(null,r,n.getDateTimeFormat),formatDateToParts:ot.bind(null,r,n.getDateTimeFormat),formatTime:rt.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:it.bind(null,r,n.getDateTimeFormat),formatTimeToParts:at.bind(null,r,n.getDateTimeFormat),formatPlural:yt.bind(null,r,n.getPluralRules),formatMessage:Je.bind(null,r,n),$t:Je.bind(null,r,n),formatList:dt.bind(null,r,n.getListFormat),formatListToParts:ht.bind(null,r,n.getListFormat),formatDisplayName:lt.bind(null,r,n.getDisplayNames)})}function St(e){return e?Object.keys(e).reduce((function(t,n){var r,i=e[n];return t[n]=De(i)?(r=i,function(e){return r(o.Children.toArray(e))}):i,t}),{}):e}var Ct=function(e,t,n,r){for(var i=[],a=4;a<arguments.length;a++)i[a-4]=arguments[a];var s=St(r),l=Je.apply(void 0,c([e,t,n,s],i,!1));return Array.isArray(l)?o.Children.toArray(l):l},Et=function(e,t){var n=e.defaultRichTextElements,r=u(e,["defaultRichTextElements"]),i=St(n),o=wt(l(l(l({},$e),r),{defaultRichTextElements:i}),t),a={locale:o.locale,timeZone:o.timeZone,fallbackOnEmptyString:o.fallbackOnEmptyString,formats:o.formats,defaultLocale:o.defaultLocale,defaultFormats:o.defaultFormats,messages:o.messages,onError:o.onError,defaultRichTextElements:i};return l(l({},o),{formatMessage:Ct.bind(null,a,o.formatters),$t:Ct.bind(null,a,o.formatters)})};function xt(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}var At=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cache={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}},t.state={cache:t.cache,intl:Et(xt(t.props),t.cache),prevConfig:xt(t.props)},t}return s(t,e),t.getDerivedStateFromProps=function(e,t){var n=t.prevConfig,r=t.cache,i=xt(e);return Ge(n,i)?null:{intl:Et(i,r),prevConfig:i}},t.prototype.render=function(){return je(this.state.intl),o.createElement(Ke,{value:this.state.intl},this.props.children)},t.displayName="IntlProvider",t.defaultProps=$e,t}(o.PureComponent);const kt=At;function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(this,arguments)}var Pt=r(4184),Tt=r.n(Pt);function Ft(){var e=o.useContext(Ye);return je(e),e}let Rt=(0,o.memo)((({type:e,...t})=>{let n=(0,o.useRef)();return(0,o.useEffect)((()=>{n.current.replaceChildren();let r=!1,i=new CustomEvent("customEvent",{detail:{type:`render${e}`,doc:document,append:(...e)=>{if(r)throw new Error("Append must be called directly and synchronously in the event");let t=document.createElement("div");t.className="section",t.append(...e),n.current.append(t)},params:t}});window.dispatchEvent(i),r=!0})),o.createElement("div",{ref:n,className:"custom-sections"})}));const It=Rt;function Ot(){return o.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},o.createElement("polygon",{fill:"currentColor",points:"0.5 0.5 23.5 0.5 23.5 23.5 11.5 23.5 0.5 12.5 0.5 0.5"}),o.createElement("polygon",{points:"0.5 12.5 11.5 12.5 11.5 23.5 0.5 12.5",fill:"#fff",opacity:"0.4"}),o.createElement("path",{d:"M0,0V12.707L11.293,24H24V0ZM11,22.293,1.707,13H11ZM23,23H12V12H1V1H23Z"}))}function Bt({color:e}){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},o.createElement("rect",{x:"2",y:"2",width:"16",height:"16",rx:"2",fill:e}),o.createElement("rect",{x:"2.5",y:"2.5",width:"15",height:"15",rx:"1.5",stroke:"currentColor",strokeOpacity:"0.1"}))}function Mt({color:e}){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},o.createElement("path",{d:"M1 3C1 1.89543 1.89543 1 3 1H13C14.1046 1 15 1.89543 15 3V13C15 14.1046 14.1046 15 13 15H3C1.89543 15 1 14.1046 1 13V3Z",fill:e}),o.createElement("path",{d:"M1.5 3C1.5 2.17157 2.17157 1.5 3 1.5H13C13.8284 1.5 14.5 2.17157 14.5 3V13C14.5 13.8284 13.8284 14.5 13 14.5H3C2.17157 14.5 1.5 13.8284 1.5 13V3Z",stroke:"black",strokeOpacity:"0.1"}))}function Lt(){return o.createElement("svg",{width:"8",viewBox:"0 0 448 512"},o.createElement("path",{fill:"currentColor",d:"M224 256c70.7 0 128-57.31 128-128s-57.3-128-128-128C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3C77.61 304 0 381.6 0 477.3c0 19.14 15.52 34.67 34.66 34.67h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304z"}))}function Nt({color:e}){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none"},o.createElement("circle",{cx:"4",cy:"4",r:"4",fill:e}))}var Vt,zt;function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ut.apply(this,arguments)}const Ht=e=>o.createElement("svg",Ut({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Vt||(Vt=o.createElement("path",{fill:"currentColor",d:"M7 7.25H4V6h3zM7 10.25H4V9h3zM7 13.25H4V12h3z"})),zt||(zt=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2.25 3C1.56 3 1 3.56 1 4.25v11.5c0 .69.56 1.25 1.25 1.25h15.5c.69 0 1.25-.56 1.25-1.25V4.25C19 3.56 18.44 3 17.75 3zm15.5 1.25H10v11.5h7.75zm-15.5 0h6.5v11.5h-6.5z",clipRule:"evenodd"})));var Wt,jt;function $t(){return $t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$t.apply(this,arguments)}const Gt=e=>o.createElement("svg",$t({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Wt||(Wt=o.createElement("path",{fill:"currentColor",d:"M6 15v1.25h8V15zM6 12.75V14h6v-1.25z"})),jt||(jt=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M17 17.75c0 .69-.56 1.25-1.25 1.25H4.25C3.56 19 3 18.44 3 17.75V2.25C3 1.56 3.56 1 4.25 1h11.5c.69 0 1.25.56 1.25 1.25zm-1.25-15.5V10H4.25V2.25zm0 15.5v-6.5H4.25v6.5z",clipRule:"evenodd"})));var qt;function Kt(){return Kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kt.apply(this,arguments)}const Yt=e=>o.createElement("svg",Kt({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),qt||(qt=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.5 12.75a5.25 5.25 0 1 0 0-10.5 5.25 5.25 0 0 0 0 10.5m5.017-1.117a6.5 6.5 0 1 0-.884.884L18.116 19l.884-.884zM6.875 6.875V4h1.25v2.875H11v1.25H8.125V11h-1.25V8.125H4v-1.25z",clipRule:"evenodd"})));var Xt;function Zt(){return Zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zt.apply(this,arguments)}const Qt=e=>o.createElement("svg",Zt({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Xt||(Xt=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.5 12.75a5.25 5.25 0 1 0 0-10.5 5.25 5.25 0 0 0 0 10.5m5.017-1.117a6.5 6.5 0 1 0-.884.884L18.116 19l.884-.884zM11 8.125H4v-1.25h7z",clipRule:"evenodd"})));var Jt;function en(){return en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},en.apply(this,arguments)}const tn=e=>o.createElement("svg",en({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Jt||(Jt=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M17.75 4.25H2.25v11.5h15.5zM2.25 3C1.56 3 1 3.56 1 4.25v11.5c0 .69.56 1.25 1.25 1.25h15.5c.69 0 1.25-.56 1.25-1.25V4.25C19 3.56 18.44 3 17.75 3zm3.259 7.625L7 12.116 6.116 13l-3-3 3-3L7 7.884 5.51 9.375H9v1.25zm5.491 0h3.491L13 12.116l.884.884 3-3-3-3-.884.884 1.491 1.491H11z",clipRule:"evenodd"})));var nn;function rn(){return rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rn.apply(this,arguments)}const on=e=>o.createElement("svg",rn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),nn||(nn=o.createElement("path",{fill:"currentColor",d:"M13.884 17.116 13 18l-8-8 8-8 .884.884L6.768 10z"})));var an;function sn(){return sn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sn.apply(this,arguments)}const ln=e=>o.createElement("svg",sn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),an||(an=o.createElement("path",{fill:"currentColor",d:"M2.884 14 2 13.116l8-8 8 8-.884.884L10 6.884z"})));var un;function cn(){return cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cn.apply(this,arguments)}const dn=e=>o.createElement("svg",cn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),un||(un=o.createElement("path",{fill:"currentColor",d:"m17.116 6 .884.884-8 8-8-8L2.884 6 10 13.116z"})));var hn,pn;function fn(){return fn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fn.apply(this,arguments)}const mn=e=>o.createElement("svg",fn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),hn||(hn=o.createElement("g",{clipPath:"url(#format-text_svg__a)"},o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 16 7 4H5L0 16h2.167l1.25-3h5.166l1.25 3zm-4.042-4.5L6 6.8l-1.958 4.7zM18 14.65c-.635.833-1.52 1.35-2.5 1.35-1.933 0-3.5-2.015-3.5-4.5S13.567 7 15.5 7c.98 0 1.865.517 2.5 1.35V7h2v9h-2zm0-3.15c0 1.657-.895 3-2 3-1.104 0-2-1.343-2-3s.896-3 2-3c1.105 0 2 1.343 2 3",clipRule:"evenodd"}))),pn||(pn=o.createElement("defs",null,o.createElement("clipPath",{id:"format-text_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h20v20H0z"})))));var gn;function vn(){return vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vn.apply(this,arguments)}const yn=e=>o.createElement("svg",vn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),gn||(gn=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 3h14v14H3zM1.75 1.75h16.5v16.5H1.75V3zM16 16 11 4H9L4 16h2.167l1.25-3h5.166l1.25 3zm-6-9.2-1.958 4.7h3.916z",clipRule:"evenodd"})));var bn;function _n(){return _n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_n.apply(this,arguments)}const wn=e=>o.createElement("svg",_n({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),bn||(bn=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 16 11 4H9L4 16h2.167l1.25-3h5.166l1.25 3zm-6-9.2-1.958 4.7h3.916zM2 17h16v1.25H2v-1z",clipRule:"evenodd"})));var Sn;function Cn(){return Cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cn.apply(this,arguments)}const En=e=>o.createElement("svg",Cn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Sn||(Sn=o.createElement("path",{stroke:"currentColor",strokeWidth:1.25,d:"M9.375 17.625h8.25V2.375H2.375v8.25m7 7-7-7m7 7v-7h-7"})));var xn;function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},An.apply(this,arguments)}const kn=e=>o.createElement("svg",An({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),xn||(xn=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9 2H4v2h5v13h2V4h5V2h-5z",clipRule:"evenodd"})));var Dn,Pn,Tn;function Fn(){return Fn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fn.apply(this,arguments)}const Rn=e=>o.createElement("svg",Fn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Dn||(Dn=o.createElement("path",{fill:"currentColor",d:"M12 1.75H8V3h4z"})),Pn||(Pn=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 4v12h12V4zm10.75 1.25h-9.5v9.5h9.5z",clipRule:"evenodd"})),Tn||(Tn=o.createElement("path",{fill:"currentColor",d:"M17 14h1.25v4.25H14V17h3zM18.25 8H17v4h1.25zM1.75 8H3v4H1.75zM8 17h4v1.25H8zM14 3h3v3h1.25V1.75H14zM3 3v3H1.75V1.75H6V3zM6 17H3v-3H1.75v4.25H6z"})));var In,On;function Bn(){return Bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bn.apply(this,arguments)}const Mn=e=>o.createElement("svg",Bn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),In||(In=o.createElement("g",{clipPath:"url(#annotate-ink_svg__a)"},o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15.3 3.451C9.707.401 5.62.768 3.511 2.731 2.067 4.074 1.7 6.044 2.409 7.784a5.55 5.55 0 0 0-1.008 1.91c-.733 2.444.057 5.641 3.365 9.078l.45-1.35C2.5 14.399 2.07 11.817 2.599 10.056c.118-.396.287-.758.494-1.084.283.367.624.712 1.023 1.022 2.43 1.89 4.747 1.504 5.77.055.49-.695.629-1.604.243-2.43-.387-.826-1.24-1.45-2.493-1.728-1.468-.326-3.015.043-4.229.942a3.248 3.248 0 0 1 .956-3.187c1.518-1.413 4.93-2.046 10.338.904zM7.026 19.967l-.74.247c.102.088.205.176.31.264zM4.884 9.007a4.4 4.4 0 0 1-.949-1c.965-.815 2.246-1.16 3.43-.897.996.221 1.455.661 1.631 1.038.177.377.128.812-.132 1.18-.477.675-1.91 1.288-3.98-.321M15.616 6.5a1.25 1.25 0 0 1 1.768 0L18.5 7.616a1.25 1.25 0 0 1 0 1.768l-7.954 7.954a1.25 1.25 0 0 1-.488.302l-2.86.953-1.186.395.395-1.186.953-2.86a1.25 1.25 0 0 1 .302-.488zM14.5 9.384l-5.954 5.954-.558 1.674 1.674-.558 5.954-5.954zm.884-.884L16.5 9.616 17.616 8.5 16.5 7.384z",clipRule:"evenodd"}))),On||(On=o.createElement("defs",null,o.createElement("clipPath",{id:"annotate-ink_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h20v20H0z"})))));var Ln;function Nn(){return Nn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nn.apply(this,arguments)}const Vn=e=>o.createElement("svg",Nn({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Ln||(Ln=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M13.384 1.5a1.25 1.25 0 0 0-1.768 0L1.5 11.616a1.25 1.25 0 0 0 0 1.768L6.616 18.5a1.25 1.25 0 0 0 1.768 0L18.5 8.384a1.25 1.25 0 0 0 0-1.768zM5.884 9 12.5 2.384 17.616 7.5 11 14.116zM5 9.884 2.384 12.5 7.5 17.616 10.116 15zM9.652 19H19v-1.25h-8.098zm1.906-13.558 3 3 .884-.884-3-3z",clipRule:"evenodd"})));var zn;function Un(){return Un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Un.apply(this,arguments)}const Hn=e=>o.createElement("svg",Un({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),zn||(zn=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12.75 7.5a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0m-1.117 5.017a6.5 6.5 0 1 1 .884-.884L19 18.116l-.884.884z",clipRule:"evenodd"})));var Wn;function jn(){return jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jn.apply(this,arguments)}const $n=e=>o.createElement("svg",jn({xmlns:"http://www.w3.org/2000/svg",width:8,height:8,fill:"none"},e),Wn||(Wn=o.createElement("path",{fill:"currentColor",d:"m0 2.707 4 4 4-4L7.293 2 4 5.293.707 2z"}))),Gn=function(e){const t=Ft(),n=(0,o.useRef)(),{platform:r}=(0,o.useContext)(hd);function i(t){e.tool.type===t&&(t="pointer"),"ink"===t&&["ink","eraser"].includes(e.tool.type)&&(t="pointer"),e.onChangeTool({type:t})}return(0,o.useEffect)((()=>{var t;["pdf","epub"].includes(e.type)&&(n.current.value=null!==(t=e.pageLabel)&&void 0!==t?t:e.pageIndex+1)}),[e.pageLabel,e.pageIndex]),o.createElement("div",{className:"toolbar","data-tabstop":1,role:"application"},o.createElement("div",{className:"start"},o.createElement("button",{id:"sidebarToggle",className:"toolbar-button sidebar-toggle",title:t.formatMessage({id:"pdfReader.toggleSidebar"}),tabIndex:-1,onClick:function(t){e.onToggleSidebar(!e.sidebarOpen)}},o.createElement(Ht,null)),o.createElement("div",{className:"divider"}),o.createElement("button",{id:"zoomOut",className:"toolbar-button zoomOut",title:t.formatMessage({id:"pdfReader.zoomOut"}),tabIndex:-1,disabled:!e.enableZoomOut,onClick:e.onZoomOut},o.createElement(Qt,null)),o.createElement("button",{id:"zoomIn",className:"toolbar-button zoomIn",title:t.formatMessage({id:"pdfReader.zoomIn"}),tabIndex:-1,disabled:!e.enableZoomIn,onClick:e.onZoomIn},o.createElement(Yt,null)),o.createElement("button",{id:"zoomAuto",className:"toolbar-button zoomAuto",title:t.formatMessage({id:"pdfReader.zoomReset"}),tabIndex:-1,disabled:!e.enableZoomReset,onClick:e.onZoomReset},o.createElement(tn,null)),o.createElement("button",{id:"appearance",className:Tt()("toolbar-button",{active:e.appearancePopup}),title:t.formatMessage({id:"pdfReader.appearance"}),tabIndex:-1,onClick:e.onToggleAppearancePopup},o.createElement(mn,null)),o.createElement("div",{className:"divider"}),o.createElement("button",{id:"navigateBack",className:"toolbar-button navigateBack",title:t.formatMessage({id:"general.back"}),tabIndex:-1,disabled:!e.enableNavigateBack,onClick:e.onNavigateBack},o.createElement(on,null)),o.createElement("div",{className:"divider"}),["pdf","epub"].includes(e.type)&&o.createElement(o.Fragment,null,o.createElement("button",{className:"toolbar-button pageUp",title:t.formatMessage({id:"pdfReader.previousPage"}),id:"previous",tabIndex:-1,disabled:!e.enableNavigateToPreviousPage,onClick:e.onNavigateToPreviousPage,"aria-describedby":"numPages"},o.createElement(ln,null)),o.createElement("button",{className:"toolbar-button pageDown",title:t.formatMessage({id:"pdfReader.nextPage"}),id:"next",tabIndex:-1,disabled:!e.enableNavigateToNextPage,onClick:e.onNavigateToNextPage,"aria-describedby":"numPages"},o.createElement(dn,null))),["pdf","epub"].includes(e.type)&&o.createElement("input",{ref:n,type:"input",id:"pageNumber",className:"toolbar-text-input",title:t.formatMessage({id:"pdf"===e.type||e.usePhysicalPageNumbers?"pdfReader.page":"pdfReader.location"}),defaultValue:"",size:"4",min:"1",tabIndex:-1,autoComplete:"off",onKeyDown:function(t){"Enter"===t.key&&e.onChangePageNumber(t.target.value)},onBlur:function(t){var n;t.target.value!=(null!==(n=e.pageLabel)&&void 0!==n?n:e.pageIndex+1)&&e.onChangePageNumber(t.target.value)}}),e.pageLabel&&o.createElement("span",{id:"numPages"},"",o.createElement("div",null,!("pdf"===e.type&&e.pageIndex+1==e.pageLabel)&&e.pageIndex+1," / ",e.pagesCount))),o.createElement("div",{className:"center tools"},o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button highlight",{active:"highlight"===e.tool.type}),title:t.formatMessage({id:"pdfReader.highlightText"}),disabled:e.readOnly,onClick:()=>i("highlight"),"data-l10n-id":"pdfReader-toolbar-highlight"},o.createElement(yn,null)),o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button underline",{active:"underline"===e.tool.type}),title:t.formatMessage({id:"pdfReader.underlineText"}),disabled:e.readOnly,onClick:()=>i("underline"),"data-l10n-id":"pdfReader-toolbar-underline"},o.createElement(wn,null)),o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button note",{active:"note"===e.tool.type}),title:t.formatMessage({id:"pdfReader.addNote"}),disabled:e.readOnly,onClick:()=>i("note"),"data-l10n-id":"pdfReader-toolbar-note"},o.createElement(En,null)),"pdf"===e.type&&o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button text",{active:"text"===e.tool.type}),title:t.formatMessage({id:"pdfReader.addText"}),disabled:e.readOnly,onClick:()=>i("text"),"data-l10n-id":"pdfReader-toolbar-text"},o.createElement(kn,null)),"pdf"===e.type&&o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button area",{active:"image"===e.tool.type}),title:t.formatMessage({id:"pdfReader.selectArea"}),disabled:e.readOnly,onClick:()=>i("image"),"data-l10n-id":"pdfReader-toolbar-area"},o.createElement(Rn,null)),"pdf"===e.type&&o.createElement("button",{tabIndex:-1,className:Tt()("toolbar-button ink",{active:["ink","eraser"].includes(e.tool.type)}),title:t.formatMessage({id:"pdfReader.draw"}),disabled:e.readOnly,onClick:()=>i("ink"),"data-l10n-id":"pdfReader-toolbar-draw"},o.createElement(Mn,null)),o.createElement("div",{className:"divider"}),o.createElement("button",{tabIndex:-1,className:"toolbar-button toolbar-dropdown-button",disabled:e.readOnly||["pointer","hand"].includes(e.tool.type),title:t.formatMessage({id:"pdfReader.pickColor"}),onClick:function(t){let n=t.currentTarget.getBoundingClientRect();e.onOpenColorContextMenu({x:n.left,y:n.bottom})}},"eraser"===e.tool.type?o.createElement(Vn,null):o.createElement(Bt,{color:e.tool.color||["pointer","hand"].includes(e.tool.type)&&"transparent"}),o.createElement($n,null))),o.createElement("div",{className:"end"},o.createElement(It,{type:"Toolbar"}),o.createElement("button",{className:Tt()("toolbar-button find",{active:e.findPopupOpen}),title:t.formatMessage({id:"pdfReader.findInDocument"}),tabIndex:-1,onClick:function(t){e.onToggleFind()}},o.createElement(Hn,null)),"zotero"===r&&e.showContextPaneToggle&&o.createElement(o.Fragment,null,o.createElement("div",{className:"divider"}),o.createElement("button",{className:"toolbar-button context-pane-toggle",title:t.formatMessage({id:"pdfReader.toggleContextPane"}),tabIndex:-1,onClick:e.onToggleContextPane},e.stackedView?o.createElement(Gt,null):o.createElement(Ht,{className:"standard-view"})))))};var qn=r(3935);function Kn(e){var t=Ft(),n=t.formatMessage,r=t.textComponent,i=void 0===r?o.Fragment:r,a=e.id,s=e.description,l=e.defaultMessage,u=e.values,c=e.children,d=e.tagName,h=void 0===d?i:d,p=n({id:a,description:s,defaultMessage:l},u,{ignoreTag:e.ignoreTag});return"function"==typeof c?c(Array.isArray(p)?p:[p]):h?o.createElement(h,null,o.Children.toArray(p)):o.createElement(o.Fragment,null,p)}Kn.displayName="FormattedMessage";var Yn=o.memo(Kn,(function(e,t){var n=e.values,r=u(e,["values"]),i=t.values,o=u(t,["values"]);return Ge(i,n)&&Ge(r,o)}));Yn.displayName="MemoizedFormattedMessage";const Xn=Yn,Zn=["i","b","sub","sup"];function Qn(e){let t=Zn.map((t=>e.toLowerCase().indexOf("<"+t+">")));t=t.map(((e,t)=>[Zn[t],e])),t.sort(((e,t)=>e[1]-t[1]));for(let n of t){let t=n[0],r=n[1];if(r<0)continue;let i=e.toLowerCase().indexOf("</"+t+">",r);if(i>=0){let n=[];return n.push(e.slice(0,r)),n.push(e.slice(r+t.length+2,i)),n.push(e.slice(i+t.length+3)),{format:t,parts:n}}}return null}function Jn(e){let t=e.firstChild;for(;t;){if(3===t.nodeType){let e=Qn(t.nodeValue);if(e){let n=[];n.push(document.createTextNode(e.parts[0]));let r=document.createElement(e.format);r.appendChild(document.createTextNode(e.parts[1])),n.push(r),n.push(document.createTextNode(e.parts[2])),t.replaceWith(...n),t=r}}Jn(t),t=t.nextSibling}}function er(e){let t=e.firstChild;for(;t;){let e=t.nodeName.toLowerCase();if(1===t.nodeType&&Zn.includes(e)&&t.innerText.trim().length){let n=[];n.push(document.createTextNode("<"+e+">")),n.push(...t.childNodes),n.push(document.createTextNode("</"+e+">")),t.replaceWith(...n),t=n[0]}if("DIV"===t.nodeName&&(t.firstChild&&"BR"===t.firstChild.nodeName||"DIV"===t.nodeName&&t.nextSibling&&"DIV"===t.nextSibling.nodeName&&t.nextSibling.firstChild&&"BR"===t.nextSibling.firstChild.nodeName)){let e=t.firstChild;t.replaceWith(...t.childNodes),t=e}er(t),t=t.nextSibling}}function tr(e,t){let n={strong:"b"},r=e.firstChild;for(;r;){if(1===r.nodeType){for(let e in n)if(r.nodeName.toLowerCase()===e){let t=r.childNodes,i=document.createElement(n[e]);i.append(...t),r.replaceWith(i),r=i}let e=["br","div"];if(!(t?Zn:[]).concat(e).includes(r.nodeName.toLowerCase())){let e=r.firstChild,t=r.nextSibling;r.replaceWith(...r.childNodes),r=e||t;continue}for(;r.attributes.length>0;)r.removeAttribute(r.attributes[0].name)}else 3===r.nodeType||e.removeChild(r);tr(r,t),r=r.nextSibling}}var nr=[{icon:"<b>B</b>",title:"Bold",command:"bold"},{icon:"<i>I</i>",title:"Italic",command:"italic"},{icon:"X<sub>2</sub>",title:"Subscript",command:"subscript"},{icon:"X<sup>2</sup>",title:"Superscript",command:"superscript"},{icon:"T<sub>x</sub>",title:"Remove Format",command:"removeformat"}];function rr({action:e,onCommand:t}){return o.createElement("button",{className:Tt()("button","icon-"+e.command),dangerouslySetInnerHTML:{__html:e.icon},onPointerDown:function(n){n.preventDefault(),t(e.command)}})}function ir({onCommand:e}){let t=(0,o.useRef)(),n=(0,o.useRef)(!1);function r(n){let r=n.target.closest(".editor [contenteditable=true]");if(!r||!t.current.parentNode.contains(r))return;let{key:i}=n,o=n.ctrlKey,a=n.metaKey,s=n.shiftKey,l=n.altKey;s||l||!o&&!a||("b"===i?(e("bold"),n.preventDefault()):"i"===i&&(e("italic"),n.preventDefault()))}function i(){s()}function a(){s()}function s(){let e=window.getSelection();if(!e||e.isCollapsed)return t.current.style.display="none",void(n.current=!1);let r=e.getRangeAt(0),i=r.getBoundingClientRect(),o=r.startContainer.parentNode.closest(".editor");if(!o||!o.parentNode.contains(t.current))return t.current.style.display="none",void(n.current=!1);let a=o.getBoundingClientRect(),s=i.y-a.y;s<-15?t.current.style.display="none":(t.current.style.display="flex",t.current.style.top=s+"px",n.current=!0)}return(0,o.useLayoutEffect)((()=>{s()}),[]),(0,o.useEffect)((()=>(document.addEventListener("keydown",r),document.addEventListener("selectionchange",i),document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("keydown",r),document.removeEventListener("selectionchange",i),document.removeEventListener("scroll",a,!0)}))),o.createElement("div",{ref:t,className:"editor-toolbar"},nr.map(((t,n)=>o.createElement(rr,{key:n,action:t,onCommand:e}))))}let or=o.forwardRef(((e,t)=>{let n=(0,o.useRef)(),r=(0,o.useRef)(),i=(0,o.useRef)();return(0,o.useEffect)((()=>{n.current!==e.text&&(n.current=e.text,r.current.innerText=e.text,e.enableRichText&&Jn(r.current))})),(0,o.useImperativeHandle)(t,(()=>({focus:()=>r.current.focus()}))),o.createElement(o.Fragment,null,o.createElement("div",{id:e.id,ref:r,suppressContentEditableWarning:!0,className:"content",contentEditable:!e.readOnly,dir:"auto",placeholder:e.placeholder,"data-tabstop":e.readOnly?void 0:1,tabIndex:e.readOnly?void 0:-1,onInput:function(t){tr(r.current,e.enableRichText),i.current.innerHTML=r.current.innerHTML,er(i.current);let o=i.current.innerText;o=o.replace(/\n<\//g,"</"),o=o.trim(),n.current=o,e.onChange(o)},role:"textbox","aria-label":e.ariaLabel,"aria-readonly":e.readOnly}),o.createElement("div",{className:"renderer",ref:i}))}));const ar=function(e){let t=(0,o.useRef)();return o.createElement("div",{className:Tt()("editor",{"read-only":e.readOnly})},!e.readOnly&&e.enableRichText&&o.createElement(ir,{onCommand:function(e){t.current.focus(),document.execCommand(e,!1,null)}}),o.createElement(or,{ref:t,id:e.id,text:e.text,readOnly:e.readOnly,enableRichText:e.enableRichText,placeholder:e.placeholder,onChange:e.onChange,ariaLabel:e.ariaLabel}))},sr=function(e){return o.createElement("div",{className:Tt()("expandable-editor",{expanded:e.expanded})},o.createElement("div",{className:Tt()("editor-view")},o.createElement(ar,e)))};function lr(){return!!navigator&&/Mac/.test(navigator.platform)}function ur(){return!!navigator&&/Linux/.test(navigator.platform)}function cr(){return!!navigator&&/Win/.test(navigator.platform)}let dr="undefined"!=typeof InstallTrigger,hr=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&window.safari.pushNotification).toString()||!!navigator&&navigator.userAgent.includes("Safari/")&&!navigator.userAgent.includes("Chrome/");function pr(e){return["INPUT"].includes(e.nodeName)&&"text"===e.type||"true"===e.getAttribute("contenteditable")}function fr(e){let{key:t}=e;return!window.rtl&&"ArrowRight"===t||window.rtl&&"ArrowLeft"===t||"ArrowDown"===t}function mr(e){let{key:t}=e;return!window.rtl&&"ArrowLeft"===t||window.rtl&&"ArrowRight"===t||"ArrowUp"===t}function gr(e){let t=[];e.metaKey&&lr()&&t.push("Cmd"),e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift");let n=function(e,t){return 1===e.length&&("A"<=e&&e<="Z"&&(e=e.toLowerCase()),(e<"a"||e>"z")&&4===t.length&&t[3]>="A"&&t[3]<="Z"&&(e=t[3].toLowerCase())),e}(e.key,e.code);return" "===n&&(n="Space"),["Shift","Control","Meta","Alt"].includes(n)&&(n=""),n&&t.push(n),t.join("-")}function vr(e){let t=[];e.metaKey&&lr()&&t.push("Cmd"),e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift");let{key:n,code:r}=e;return["Shift","Control","Meta","Alt"].includes(n)&&(r=""),r&&t.push(r),t.join("-")}function yr(e){let t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t),e.focus(),t.detach()}function br(e){if(e.clientX,e.clientY,e.screenX)return{x:e.clientX,y:e.clientY};{let t=e.currentTarget.getBoundingClientRect();return{x:t.left,y:t.bottom}}}function _r(e,t){if(e===t)return!0;if("object"==typeof e&&null!=e&&"object"==typeof t&&null!==t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e){if(!t.hasOwnProperty(n))return!1;if(!_r(e[n],t[n]))return!1}return!0}return!1}function wr(e,t=100){return new Promise((n=>{let r,i=()=>{e.removeEventListener("scroll",o),clearTimeout(r),n()},o=()=>{clearTimeout(r),r=setTimeout(i,t)};e.addEventListener("scroll",o),r=setTimeout(i,t)}))}function Sr(e){return localStorage.getItem("theme")}function Cr(e,t){function n(e){const t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]}function r([e,t,n]){return[e,t,n].map((e=>{const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})).reduce(((e,t,n)=>e+t*[.2126,.7152,.0722][n]),0)}return r(n(e))>r(n(t))?"light":"dark"}async function Er(e){var t;if((null===(t=e)||void 0===t?void 0:t.nodeType)===Node.TEXT_NODE&&(e=e.parentNode),!e)return;let n=e.ownerDocument,r=n.querySelector(".a11y-cursor-target");if(e==r&&n.activeElement==e)return;let i=e.getAttribute("tabindex");function o(){i?e.setAttribute("tabindex",i):e.removeAttribute("tabindex"),e.classList.remove("a11y-cursor-target")}e.setAttribute("tabindex","-1"),e.classList.add("a11y-cursor-target"),e.focus({preventScroll:!0}),e.addEventListener("blur",o,{once:!0}),n.activeElement==e||o()}var xr;function Ar(){return Ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ar.apply(this,arguments)}Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if("function"!=typeof e)throw new TypeError("callback must be a function");for(var i=r-1;i>=0;){var o=n[i];if(e.call(t,o,i,n))return i;i--}return-1});const kr=e=>o.createElement("svg",Ar({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),xr||(xr=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2h12v12H2zM1 1h14v14H1V2zm12 12L8.75 3h-1.5L3 13h1.63l1.275-3h4.19l1.275 3zM8 5.07 6.33 9h3.34z",clipRule:"evenodd"})));var Dr;function Pr(){return Pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pr.apply(this,arguments)}const Tr=e=>o.createElement("svg",Pr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Dr||(Dr=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M13 13 8.75 3h-1.5L3 13h1.63l1.275-3h4.19l1.275 3zM8 5.07 6.33 9h3.34zM15 15v-1H1v1z",clipRule:"evenodd"})));var Fr;function Rr(){return Rr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rr.apply(this,arguments)}const Ir=e=>o.createElement("svg",Rr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Fr||(Fr=o.createElement("path",{stroke:"currentColor",d:"M7.5 14.5h7v-13h-13v7m6 6-6-6m6 6v-6h-6"})));var Or;function Br(){return Br=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Br.apply(this,arguments)}const Mr=e=>o.createElement("svg",Br({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Or||(Or=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10 1H6v1h4zm2 3H4v8h8zM3 3v10h10V3zm11 11v-2h1v3h-3v-1zm1-8h-1v4h1zM1 6h1v4H1zm5 8h4v1H6zm6-12h2v2h1V1h-3zM2 2v2H1V1h3v1zm2 12H2v-2H1v3h3z",clipRule:"evenodd"})));var Lr,Nr;function Vr(){return Vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vr.apply(this,arguments)}const zr=e=>o.createElement("svg",Vr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Lr||(Lr=o.createElement("g",{clipPath:"url(#annotate-ink_svg__a)"},o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12.238 1.96C7.354-.685 3.87-.185 2.14 1.602 1.093 2.685.77 4.184 1.2 5.5a4.46 4.46 0 0 0-.795 1.443c-.658 1.993-.013 4.608 2.738 7.409l.407-1.02C1.228 10.83.881 8.698 1.356 7.257c.09-.27.209-.522.354-.754A4.07 4.07 0 0 0 2.943 7.63C5.086 8.915 7 8.475 7.787 7.274c.387-.591.46-1.34.09-2.005C7.512 4.615 6.769 4.13 5.7 3.91a4.676 4.676 0 0 0-3.658.802c-.119-.843.157-1.732.817-2.414C4.13.985 7.046.285 11.762 2.84zM3.457 6.771a3.014 3.014 0 0 1-1.067-1.06A3.669 3.669 0 0 1 5.5 4.89c.889.181 1.325.546 1.503.866.172.31.15.661-.053.97-.392.6-1.636 1.16-3.493.045M13.293 4a1 1 0 0 1 1.414 0l.793.793a1 1 0 0 1 0 1.414l-8.074 8.074c-.096.096-.21.171-.336.221l-2.404.962-1.084.434.434-1.084.962-2.404a1 1 0 0 1 .221-.336zM12.5 6.207l-6.574 6.574-.528 1.321 1.321-.528L13.293 7zm.707-.707.793.793.793-.793L14 4.707z",clipRule:"evenodd"}))),Nr||(Nr=o.createElement("defs",null,o.createElement("clipPath",{id:"annotate-ink_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))));var Ur;function Hr(){return Hr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hr.apply(this,arguments)}const Wr=e=>o.createElement("svg",Hr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Ur||(Ur=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M13 1.5H3V3h4.25v11h1.5V3H13z",clipRule:"evenodd"})));var jr;function $r(){return $r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$r.apply(this,arguments)}const Gr=e=>o.createElement("svg",$r({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),jr||(jr=o.createElement("path",{fill:"currentColor",d:"M4.5 8A1.25 1.25 0 1 1 2 8a1.25 1.25 0 0 1 2.5 0M9.25 8a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0M12.75 9.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5"})));var qr;function Kr(){return Kr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kr.apply(this,arguments)}const Yr=e=>o.createElement("svg",Kr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),qr||(qr=o.createElement("path",{fill:"currentColor",fillOpacity:.5,fillRule:"evenodd",d:"M6 4a2 2 0 1 1 4 0v2H6zM5 6V4a3 3 0 0 1 6 0v2h1a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm-1 8V7h8v7z",clipRule:"evenodd"})));function Xr(e){const t=Ft();let{annotation:n,type:r}=e;return o.createElement("div",{className:Tt()("preview",{"read-only":e.readOnly})},o.createElement("header",{title:t.formatDate(new Date(n.dateModified))+" "+t.formatTime(new Date(n.dateModified))+(n.lastModifiedByUser?" ("+n.lastModifiedByUser+")":"")},o.createElement("div",{className:"start"},o.createElement("div",{className:Tt()("icon","icon-"+n.type),style:{color:n.color}},"highlight"===n.type&&o.createElement(kr,null)||"underline"===n.type&&o.createElement(Tr,null)||"note"===n.type&&o.createElement(Ir,null)||"image"===n.type&&o.createElement(Mr,null)||"ink"===n.type&&o.createElement(zr,null)||"text"===n.type&&o.createElement(Wr,null)),(n.pageLabel||"pdf"===e.type)&&o.createElement("div",{className:"page",onDoubleClick:function(t){"pdf"!==e.type||e.readOnly||e.onOpenPageLabelPopup(e.annotation.id)}},o.createElement("div",null,o.createElement(Xn,{id:"pdfReader.page"})),o.createElement("div",{className:"label"},n.pageLabel||"-"))),o.createElement("div",{className:"end"},n.authorName&&o.createElement("div",{className:Tt()("author",{"non-authoritative":!n.isAuthorNameAuthoritative})},n.authorName),o.createElement("button",{"data-tabstop":e.readOnly?void 0:1,tabIndex:-1,className:"more",title:t.formatMessage({id:"pdfReader.openMenu"}),disabled:e.readOnly,onClick:function(t){t.stopPropagation();let{x:n,y:r}=br(t);e.onOpenContextMenu({ids:[e.annotation.id],currentID:e.annotation.id,x:n,y:r,popup:!0,view:!0})}},e.readOnly?o.createElement(Yr,null):o.createElement(Gr,null)))),!["ink","text"].includes(n.type)&&o.createElement("div",{className:"comment"},o.createElement(ar,{id:n.id,text:n.comment,ariaLabel:t.formatMessage({id:"pdfReader.annotationComment"}),placeholder:e.readOnly?t.formatMessage({id:"pdfReader.readOnly"}):t.formatMessage({id:"pdfReader.addComment"}),readOnly:e.readOnly,enableRichText:"text"!==n.type,onChange:function(t){e.onChange({id:e.annotation.id,comment:t})}})),(!e.readOnly||!!n.tags.length)&&o.createElement("button",{className:"tags","data-tabstop":1,onClick:function(t){if(e.readOnly)return;let n=t.target.closest(".tags").getBoundingClientRect();e.onOpenTagsPopup(e.annotation.id,n.left,n.top)},"aria-description":t.formatMessage({id:"pdfReader.manageTags"}),"aria-haspopup":!0},n.tags.length?n.tags.map(((e,t)=>o.createElement("span",{className:"tag",key:t,style:{color:e.color}},e.name))):o.createElement(Xn,{id:"pdfReader.addTags"})))}function Zr(e){const t=Ft(),{platform:n}=(0,o.useContext)(hd),r=(0,o.useRef)();function i(t,n){e.onClickSection(e.annotation.id,n,t)}function a(t){if(!t.target.getAttribute("draggable"))return;let n=t.target.closest(".preview").getBoundingClientRect(),r=t.clientX-n.left,i=t.clientY-n.top;t.dataTransfer.setDragImage(t.target.closest(".annotation"),r,i),e.onSetDataTransferAnnotations(t.dataTransfer,e.annotation)}function s(){e.onDoubleClickText(e.annotation.id)}e.annotation.image&&(r.current=e.annotation.image);let{annotation:l,state:u,type:c}=e,d=["highlight","underline"].includes(l.type)&&o.createElement("div",{className:"text",onClick:e=>i(e,"text"),onDoubleClick:s,draggable:3!==u||e.readOnly,"data-tabstop":[1,2].includes(u)?1:void 0,tabIndex:[1,2].includes(u)?-1:void 0,onDragStart:a,onKeyDown:function(t){let{key:n}=t;["Enter","Space"].includes(n)&&[1,2].includes(u)&&(e.readOnly?i(t,"text"):s())}},o.createElement("div",{className:"blockquote-border",style:{backgroundColor:l.color}}),o.createElement(sr,{id:l.id,text:l.text,placeholder:t.formatMessage({id:"pdfReader.noExtractedText"}),ariaLabel:t.formatMessage({id:"pdfReader.annotationText"}),readOnly:e.readOnly||3!==u,expanded:e.state>=2,enableRichText:"text"!==l.type,onChange:function(t){e.onChange({id:e.annotation.id,text:t})}})),h=(u>=1||l.comment)&&"ink"!==l.type&&!(e.readOnly&&!l.comment)&&o.createElement("div",{className:"comment",onClick:e=>i(e,"comment"),draggable:0===u||e.readOnly,onDragStart:a},o.createElement(sr,{id:l.id,text:l.comment,readOnly:e.readOnly||!(1===u||2===u||3===u),expanded:u>=1,placeholder:t.formatMessage({id:"pdfReader.addComment"}),ariaLabel:t.formatMessage({id:"pdfReader.annotationComment"}),enableRichText:"text"!==l.type,onChange:function(t){e.onChange({id:e.annotation.id,comment:t})}})),p=l.tags.length?l.tags.map(((e,t)=>o.createElement("span",{className:"tag",key:t,style:{color:e.color}},e.name))):o.createElement(Xn,{id:"pdfReader.addTags"}),f={};f["expanded"+e.state]=!0;let m=l.image||r.current;return o.createElement("div",{onContextMenu:function(t){let r=t.target.closest('div[contenteditable="true"]');if("web"!==n&&2===t.button&&(!r||document.activeElement!==r))return t.stopPropagation(),t.preventDefault(),e.onOpenContextMenu({ids:[e.annotation.id],currentID:e.annotation.id,x:t.clientX,y:t.clientY}),!1},className:Tt()("preview",{"read-only":e.readOnly,...f})},o.createElement("header",{title:t.formatDate(new Date(l.dateModified))+" "+t.formatTime(new Date(l.dateModified))+(l.lastModifiedByUser?" ("+l.lastModifiedByUser+")":""),onClick:e=>i(e,"header"),draggable:!0,onDragStart:a},o.createElement("div",{className:"start"},o.createElement("div",{className:Tt()("icon","icon-"+l.type),style:{color:l.color}},"highlight"===l.type&&o.createElement(kr,null)||"underline"===l.type&&o.createElement(Tr,null)||"note"===l.type&&o.createElement(Ir,null)||"image"===l.type&&o.createElement(Mr,null)||"ink"===l.type&&o.createElement(zr,null)||"text"===l.type&&o.createElement(Wr,null)),(l.pageLabel||"pdf"===e.type)&&o.createElement("div",{className:"page",onClick:function(e){e.stopPropagation()},onDoubleClick:function(t){"pdf"!==e.type||e.readOnly||e.onOpenPageLabelPopup(e.annotation.id)},id:`page_${l.id}`},o.createElement("div",null,o.createElement(Xn,{id:"pdfReader.page"})),o.createElement("div",{className:"label"},l.pageLabel||"-"))),o.createElement("div",{className:"end"},l.authorName&&o.createElement("div",{className:Tt()("author",{"non-authoritative":!l.isAuthorNameAuthoritative})},l.authorName),o.createElement(It,{type:"SidebarAnnotationHeader",annotation:l}),o.createElement("button",{"data-tabstop":e.selected&&!e.readOnly?1:void 0,tabIndex:e.selected&&!e.readOnly?-1:void 0,className:"more",disabled:e.readOnly,title:t.formatMessage({id:"pdfReader.openMenu"}),onClick:function(t){t.stopPropagation();let{x:n,y:r}=br(t);e.onOpenContextMenu({ids:[e.annotation.id],currentID:e.annotation.id,x:n,y:r,button:!0})},onFocus:e=>e.stopPropagation()},e.readOnly?o.createElement(Yr,null):o.createElement(Gr,null)))),m&&o.createElement("img",{className:"image",src:m,onClick:e=>i(e,"image"),draggable:!0,onDragStart:a}),d,h,(u>=1&&!e.readOnly||l.tags.length>0)&&o.createElement("button",{className:"tags","data-tabstop":e.selected&&!e.readOnly?1:void 0,onClick:e=>i(e,"tags"),draggable:!0,onDragStart:a,"aria-haspopup":!0,"aria-description":t.formatMessage({id:"pdfReader.manageTags"})},p))}let Qr=[["general.yellow","#ffd400"],["general.red","#ff6666"],["general.green","#5fb236"],["general.blue","#2ea8e5"],["general.purple","#a28ae5"],["general.magenta","#e56eee"],["general.orange","#f19837"],["general.gray","#aaaaaa"]],Jr=[["general.black","#000000"]],ei="#71ADFD";const ti=10,ni=[.2,.4,.6,.8,1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5,15,15.5,16,16.5,17,17.5,18,18.5,19,19.5,20,20.5,21,21.5,22,22.5,23,23.5,24,24.5,25],ri=[10,12,14,18,24,36,48,64,72,96,144,192],ii=[{id:"dark",label:"Dark",background:"#2E3440",foreground:"#D8DEE9"},{id:"snow",label:"Snow",background:"#ECEFF4",foreground:"#3B4252"},{id:"sepia",label:"Sepia",background:"#F4ECD8",foreground:"#5B4636"}];function oi({tags:e,colors:t,authors:n,onContextMenu:r,onClickTag:i,onClickColor:a,onClickAuthor:s,onChange:l}){const u=Ft();function c(e){e.preventDefault(),e.dataTransfer.dropEffect="move",e.target.closest("button").classList.add("dragged-over")}function d(e){e.target.closest("button").classList.remove("dragged-over")}function h(e,t,n){e.preventDefault();let r=e.shiftKey||e.metaKey;l(r,t,n),e.target.closest("button").classList.remove("dragged-over")}return o.createElement("div",{id:"selector",className:"selector","data-tabstop":1,onContextMenu:r},t.length>1&&o.createElement("div",{className:"colors"},t.map(((e,t)=>o.createElement("button",{key:t,tabIndex:-1,className:Tt()("color",{selected:e.selected,inactive:e.inactive}),title:e.name?u.formatMessage({id:e.name}):null,onClick:()=>a(e.color),onDragOver:c,onDragLeave:d,onDrop:t=>h(t,null,e.color),role:"checkbox","aria-checked":e.selected,"aria-description":u.formatMessage({id:"pdfReader.tagSelectorMessage"})},o.createElement(Mt,{color:e.color}))))),!!e.length&&o.createElement("div",{className:"tags"},e.map(((e,t)=>o.createElement("button",{key:t,tabIndex:-1,className:Tt()("tag",{color:!!e.color,selected:e.selected,inactive:e.inactive}),onClick:()=>i(e.name),onDragOver:c,onDragLeave:d,onDrop:t=>h(t,{name:e.name,color:e.color}),role:"checkbox","aria-checked":e.selected,"aria-description":u.formatMessage({id:"pdfReader.tagSelectorMessage"})},!!e.color&&o.createElement("span",{className:"icon"},o.createElement(Nt,{color:e.color})),e.name)))),n.length>1&&o.createElement("div",{className:"authors"},n.map(((e,t)=>o.createElement("button",{key:t,tabIndex:-1,className:Tt()("author",{selected:e.selected,inactive:e.inactive}),onClick:()=>s(e.author)},o.createElement(Lt,null),e.author)))))}const ai=o.memo((e=>o.createElement("div",{tabIndex:-1,className:Tt()("annotation",{selected:e.isSelected}),"data-sidebar-annotation-id":e.annotation.id,onMouseDown:e=>e.stopPropagation(),onFocus:()=>e.onFocus(e.annotation.id),role:"option","aria-labelledby":`page_${e.annotation.id}`,"aria-describedby":e.annotation.id},o.createElement(Zr,{type:e.type,readOnly:e.readOnly,state:e.expansionState,annotation:e.annotation,selected:e.isSelected,onSetDataTransferAnnotations:e.onSetDataTransferAnnotations,onClickSection:e.onClickAnnotationSection,onDoubleClickText:e.onDoubleClickText,onOpenPageLabelPopup:e.onOpenPageLabelPopup,onOpenContextMenu:e.onOpenContextMenu,onChange:e.onChange})))),si=(0,o.memo)(o.forwardRef(((e,t)=>{const[n,r]=(0,o.useState)(0),i=(0,o.useRef)(!1),a=(0,o.useRef)(0),{platform:s}=(0,o.useContext)(hd),l=(0,o.useRef)(),u=(0,o.useRef)(),c=(0,o.useRef)();function d(e){setTimeout((()=>{document.querySelector(`[data-sidebar-annotation-id="${e}"]`).scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}))}function h(e){document.querySelector(`[data-sidebar-annotation-id="${e}"]`).focus(),setTimeout((()=>{r(3),b(e)}),50)}l.current=n,u.current=e.selectedIDs,c.current=e.annotations,(0,o.useImperativeHandle)(t,(()=>({scrollAnnotationIntoView:d,editAnnotationText:h}))),(0,o.useEffect)((()=>(window.addEventListener("pointerdown",f),window.addEventListener("pointerup",m),window.addEventListener("dragend",m),()=>{window.removeEventListener("pointerdown",f),window.removeEventListener("pointerup",m),window.removeEventListener("dragend",m)}))),(0,o.useEffect)((()=>{1===e.selectedIDs.length?r(1):r(0),a.current=Date.now()}),[e.selectedIDs]);let p=(0,o.useCallback)((t=>{e.onUpdateAnnotations([t])}),[]);function f(e){i.current=!0}function m(){i.current=!1}let g=(0,o.useCallback)((t=>{i.current||1===u.current.length&&u.current[0]===t||e.onSelectAnnotations([t])}),[]);const v=(0,o.useCallback)(((t,n,r)=>{let i=c.current.filter((e=>window._draggingAnnotationIDs.includes(e.id)));i=i.filter((e=>!e.readOnly));let o=[];for(let e of i){let i={id:e.id};n?t?e.tags.find((e=>e.name===n.name))&&(i.tags=e.tags.filter((e=>e.name!==n.name)),o.push(i)):e.tags.find((e=>e.name===n.name))||(i.tags=[...e.tags,n],o.push(i)):r&&e.color!==r&&(i.color=r,o.push(i))}e.onUpdateAnnotations(o)}),[]);let y=(0,o.useCallback)(((t,n,i)=>{let o=i.ctrlKey||i.metaKey,a=i.shiftKey,s=c.current.find((e=>e.id===t));if(!("tags"!==n||o||a||e.readOnly||s.readOnly)){let n=i.target.closest(".tags").getBoundingClientRect();return e.onOpenTagsPopup(t,n.left,n.top)}"text"===n&&1===u.current.length&&u.current[0]===t?l.current>=1&&l.current<=2&&r(2):("comment"===n&&3===l.current&&r(2),(1!==u.current.length||u.current[0]!==t||1===u.current.length&&"header"===n)&&e.onSelectAnnotations([t],!1,i))}),[]);function b(e){setTimeout((function(){let t=document.querySelector(`[data-sidebar-annotation-id="${e}"] .text .content`);t&&yr(t)}),100)}let _=(0,o.useCallback)((e=>{1===u.current.length&&u.current[0]===e&&Date.now()-a.current>500&&l.current>=1&&l.current<=2&&(r(3),b(e))}),[]),w=(0,o.useCallback)((t=>{!t.button&&u.current.includes(t.ids[0])&&(t.ids=u.current.slice()),e.onOpenAnnotationContextMenu(t)}),[]),S=e.annotations.filter((e=>!e._hidden));e.filter.query.length&&S.sort(((e,t)=>t._score-e._score));let C={},E={},x={};for(let t of e.annotations){for(let n of t.tags)C[n.name]||(C[n.name]={...n},C[n.name].selected=e.filter.tags.includes(n.name),C[n.name].inactive=!0);let n=t.color;if(!E[n]){let t=Qr.find((e=>e[1]===n));E[n]={color:n,selected:e.filter.colors.includes(n),inactive:!0,name:t?t[0]:null}}let r=t.authorName;r&&!x[r]&&(x[r]={author:r,selected:e.filter.authors.includes(r),inactive:!0,current:r===e.authorName})}for(let t of e.filter.tags)C[t]||(C[t]={name:t,selected:!0,inactive:!1});for(let t of e.filter.colors)E[t]||(E[t]={color:t,selected:!0,inactive:!1,name:null});for(let t of e.filter.authors)x[t]||(x[t]={author:t,selected:!0,inactive:!1,current:t===e.authorName});for(let e of S){for(let t of e.tags)C[t.name].inactive=!1;E[e.color].inactive=!1;let t=e.authorName;t&&(x[t].inactive=!1)}let A=[];for(let e in C){let t=C[e];t.color&&(A.push(t),delete C[e])}A.sort(((e,t)=>e.position-t.position));let k=[];for(let e of Qr)E[e[1]]&&(k.push(E[e[1]]),delete E[e[1]]);C=Object.values(C);let D=new Intl.Collator;return C.sort((function(e,t){return D.compare(e.name,t.name)})),C=[...A,...C],E=Object.values(E),E=[...k,...E],x=Object.values(x),x.sort((function(e,t){return e.current?-1:t.current?1:D.compare(e.author,t.author)})),o.createElement(o.Fragment,null,o.createElement("div",{id:"annotations",role:"listbox",className:"annotations","data-tabstop":S.length?1:void 0,onKeyDownCapture:function(e){let t=e.target;if(t.classList.contains("annotation"))return;let n=t.closest(".annotation");var r;if(!t.classList.contains("content"))if(mr(e))null===(r=n.previousElementSibling)||void 0===r||r.focus(),e.preventDefault();else if(fr(e)){var i;null===(i=n.nextElementSibling)||void 0===i||i.focus(),e.preventDefault()}}},e.annotations.length?S.map((t=>o.createElement(ai,{type:e.type,key:t.id,readOnly:e.readOnly||t.readOnly,isSelected:e.selectedIDs.includes(t.id),annotation:t,expansionState:e.selectedIDs.includes(t.id)?n:0,onFocus:g,onChange:p,onClickAnnotationSection:y,onDoubleClickText:_,onOpenPageLabelPopup:e.onOpenPageLabelPopup,onOpenContextMenu:w,onSetDataTransferAnnotations:e.onSetDataTransferAnnotations,onClickContent:e.onClickContent}))):!e.filter.query.length&&!e.readOnly&&!window.isWeb&&o.createElement("div",null,o.createElement(Xn,{id:"pdfReader.noAnnotations"}))),(!!C.length||E.length>1||x.length>1)&&o.createElement(oi,{tags:C,colors:E,authors:x,onContextMenu:function(t){"web"!==s&&(t.preventDefault(),e.onOpenSelectorContextMenu({x:t.clientX,y:t.clientY,enableClearSelection:e.filter.colors.length||e.filter.tags.length||e.filter.authors.length}))},onClickTag:function(t){let{tags:n}=e.filter;n=n.includes(t)?n.filter((e=>e!==t)):[...n,t],e.onChangeFilter({...e.filter,tags:n})},onClickColor:function(t){let{colors:n}=e.filter;n=n.includes(t)?n.filter((e=>e!==t)):[...n,t],e.onChangeFilter({...e.filter,colors:n})},onClickAuthor:function(t){let{authors:n}=e.filter;n=n.includes(t)?n.filter((e=>e!==t)):[...n,t],e.onChangeFilter({...e.filter,authors:n})},onChange:v}))}))),li=si;var ui;function ci(){return ci=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ci.apply(this,arguments)}const di=e=>o.createElement("svg",ci({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),ui||(ui=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10.75 1h4.134l.183.183 1.75 1.75.183.183V9.25h-6.25V1.625zM12 2.25V8h3.75V3.634L14.366 2.25zm-8.375 8.5H3V19h6.25v-6.134l-.183-.183-1.75-1.75-.183-.183h-.259zm.625 7V12h2.366L8 13.384v4.366zm7.125-7h-.625V19H17v-6.134l-.183-.183-1.75-1.75-.183-.183h-.259zm.625 7V12h2.366l1.384 1.384v4.366zM3.625 1H3v8.25h6.25V3.116l-.183-.183-1.75-1.75L7.134 1h-.259zm.625 7V2.25h2.366L8 3.634V8z",clipRule:"evenodd"})));var hi;function pi(){return pi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pi.apply(this,arguments)}const fi=e=>o.createElement("svg",pi({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),hi||(hi=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5 4.75v-3h13.25V15h-3v3.25H8.116l-.183-.183-6-6-.183-.183V4.75h.625zM6.25 6H3v5h6v6h5V6zm9 7.75v-9h-9V3H17v10.75zm-11.366-1.5 3.866 3.866V12.25z",clipRule:"evenodd"})));var mi;function gi(){return gi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gi.apply(this,arguments)}const vi=e=>o.createElement("svg",gi({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),mi||(mi=o.createElement("path",{fill:"currentColor",d:"M2 3.25h1.25V2H2zM5 3.25h13V2H5zM3.25 7.25H2V6h1.25zM18 7.25H5V6h13zM6.25 11H5V9.75h1.25zM18 11H8V9.75h10zM3.25 18H2v-1.25h1.25zM18 18H5v-1.25h13zM5 14h1.25v-1.25H5zM8 14h10v-1.25H8z"})));var yi,bi;function _i(){return _i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_i.apply(this,arguments)}const wi=e=>o.createElement("svg",_i({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),yi||(yi=o.createElement("g",{clipPath:"url(#magnifier-2_svg__a)"},o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M11 6A5 5 0 1 1 1 6a5 5 0 0 1 10 0m-1.126 4.582a6 6 0 1 1 .707-.707L16 15.292l-.707.707z",clipRule:"evenodd"}))),bi||(bi=o.createElement("defs",null,o.createElement("clipPath",{id:"magnifier-2_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))));var Si,Ci;function Ei(){return Ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ei.apply(this,arguments)}const xi=e=>o.createElement("svg",Ei({xmlns:"http://www.w3.org/2000/svg",width:14,height:14},e),Si||(Si=o.createElement("circle",{cx:7,cy:7,r:7,fill:"gray"})),Ci||(Ci=o.createElement("path",{stroke:"#fff",strokeWidth:1.5,d:"m4 4 6 6M10 4l-6 6"}))),Ai=function({query:e,placeholder:t,onInput:n}){const r=Ft(),[i,a]=(0,o.useState)(!!e.length),s=(0,o.useRef)(null),l=(0,o.useRef)(null);function u(e){n(""),e.preventDefault()}return o.createElement("div",{ref:l,className:"search-box "+(i?"expanded":"")},o.createElement("div",{className:"btn magnifier",onClick:function(){window.focus(),s.current.focus()},"aria-hidden":"true"},i?o.createElement(wi,null):o.createElement(Hn,null)),o.createElement("input",{ref:s,id:"searchInput",type:"text",placeholder:t,value:e,autoComplete:"off","data-tabstop":1,onChange:function(e){n(e.target.value)},onKeyDown:function(e){"Escape"===e.key&&e.target.value&&(u(e),e.stopPropagation())},onFocus:function(){a(!0)},onBlur:function(){s.current.value.length||a(!1)}}),0!==e.length&&o.createElement("div",{className:"btn clear",role:"button","aria-label":r.formatMessage({id:"general.clear"}),onClick:function(e){u(e),s.current.focus()}},o.createElement(xi,null)))},ki=function(e){const t=Ft();return o.createElement("div",{id:"sidebarContainer",className:"sidebarOpen",role:"application"},o.createElement("div",{className:"sidebar-toolbar"},o.createElement("div",{className:"start","data-tabstop":1,role:"tablist"},"pdf"===e.type&&o.createElement("button",{id:"viewThumbnail",className:Tt()("toolbar-button",{active:"thumbnails"===e.view}),tabIndex:-1,title:t.formatMessage({id:"pdfReader.showThumbnails"}),role:"tab","aria-selected":"thumbnails"===e.view,"aria-controls":"thumbnailsView",onClick:()=>e.onChangeView("thumbnails")},o.createElement(di,null)),o.createElement("button",{id:"viewAnnotations",className:Tt()("toolbar-button",{active:"annotations"===e.view}),tabIndex:-1,title:t.formatMessage({id:"pdfReader.showAnnotations"}),role:"tab","aria-selected":"annotations"===e.view,"aria-controls":"annotationsView",onClick:()=>e.onChangeView("annotations")},o.createElement(fi,null)),o.createElement("button",{id:"viewOutline",className:Tt()("toolbar-button",{active:"outline"===e.view}),tabIndex:-1,title:t.formatMessage({id:"pdfReader.showOutline"}),role:"tab","aria-selected":"outline"===e.view,"aria-controls":"outlineView",onClick:()=>e.onChangeView("outline"),onDoubleClick:function(){"outline"===e.view&&""===e.outlineQuery&&(function e(t,n){t.forEach((t=>{var r;null!==(r=t.items)&&void 0!==r&&r.length&&(t.expanded=n,e(t.items,n))}))}(e.outline,function e(t){var n=!1;return t.forEach((t=>{var r;null!==(r=t.items)&&void 0!==r&&r.length&&(!1===t.expanded||e(t.items))&&(n=!0)})),n}(e.outline)),e.onUpdateOutline([...e.outline]))}},o.createElement(vi,null))),o.createElement("div",{className:"end"},"annotations"===e.view&&o.createElement(Ai,{query:e.filter.query,onInput:function(t){e.onChangeFilter({...e.filter,query:t})},placeholder:t.formatMessage({id:"pdfReader.searchAnnotations"})}),"outline"===e.view&&o.createElement(Ai,{query:e.outlineQuery,onInput:function(t){e.onUpdateOutlineQuery(t),e.onUpdateOutline([...function e(n,r){let i=!1;return n.forEach((n=>{var o,a,s;""==r?("expandedBak"in n&&(void 0!==n.expandedBak?n.expanded=n.expandedBak:delete n.expanded),delete n.matched,delete n.childMatched,delete n.expandedBak,null!==(o=n.items)&&void 0!==o&&o.length&&e(n.items,t).containActive&&(n.expanded=!0,i=!0),n.active&&(i=!0)):(n.matched=(s=(s=n.title).toLowerCase(),r=r.toLowerCase(),s.includes(r)),n.childMatched=!1,n.expandedBak="expandedBak"in n?n.expandedBak:n.expanded,null!==(a=n.items)&&void 0!==a&&a.length&&(delete n.expanded,e(n.items,t),n.items.forEach((e=>{!0!==e.matched&&!0!==e.childMatched||(n.childMatched=!0,n.expanded=!0)}))))})),{items:n,containActive:i}}(e.outline,t).items])},placeholder:t.formatMessage({id:"pdfReader.searchOutline"})}))),o.createElement("div",{id:"sidebarContent",className:"sidebar-content"},o.createElement("div",{className:Tt()("viewWrapper",{hidden:"thumbnails"!==e.view})},e.thumbnailsView),o.createElement("div",{id:"annotationsView",role:"tabpanel","aria-labelledby":"viewAnnotations",className:Tt()("viewWrapper",{hidden:"annotations"!==e.view})},e.annotationsView),o.createElement("div",{className:Tt()("viewWrapper",{hidden:"outline"!==e.view}),role:"tabpanel"},e.outlineView)))},Di=function({id:e,rect:t,className:n,uniqueRef:r,padding:i,children:a,onRender:s}){const[l,u]=(0,o.useState)(null),c=(0,o.useRef)(),d=(0,o.useRef)(),h=(0,o.useRef)(!1),p=(0,o.useRef)(null);function f(){if(!c.current)return;let e=c.current.offsetWidth,n=c.current.offsetHeight,r=c.current.parentNode.getBoundingClientRect();r=[0,0,r.width,r.height];let o,a,s=t[0]+(t[2]-t[0])/2-e/2;s<0?(o="right",s=t[2]+i,a=t[1]+(t[3]-t[1]-n)/2,a<0?a=t[1]:a+n>r[3]&&(a=t[1]+(t[3]-t[1])-n)):s+e>r[2]?(o="left",s=t[0]-e-i,a=t[1]+(t[3]-t[1]-n)/2,a<0?a=t[1]:a+n>r[3]&&(a=t[1]+(t[3]-t[1])-n)):t[3]+n+i<r[3]?(a=t[3]+i,o="bottom"):t[1]-i-n>0?(a=t[1]-i-n,o="top"):(a=t[3]+i,o="top",t[0]<(r[2]-r[0])/2?(o="right",s=t[2]+i,a=t[1]+(t[3]-t[1]-n)/2,a<0?a=t[1]:a+n>r[3]&&(a=t[1]+(t[3]-t[1])-n)):(o="left",s=t[0]-e-i,a=t[1]+(t[3]-t[1]-n)/2,a<0?a=t[1]:a+n>r[3]&&(a=t[1]+(t[3]-t[1])-n)),s<i?s=i:s+e>r[2]-i&&(s=r[2]-e-i)),d.current=t,p.current={top:a,left:s,side:o},u({}),h.current=!0}(0,o.useEffect)((()=>{if(d.current){let e=t[0]-d.current[0],n=t[1]-d.current[1];d.current=t,p.current.left+=e,p.current.top+=n,u({})}else d.current=t}),[t]),(0,o.useLayoutEffect)((()=>{h.current&&s&&s()}),[l]),(0,o.useLayoutEffect)((()=>{f(),setTimeout(f,0)}),[r,t]);let m={};return p.current&&(m["page-popup-"+p.current.side+"-center"]=!0),o.createElement("div",{ref:c,className:Tt()("view-popup",n,{...m}),style:p.current?{transform:`translate(${p.current.left}px, ${p.current.top}px)`}:{}},a)},Pi=function(e){const t=Ft(),[n,r]=(0,o.useState)(null),[i,a]=(0,o.useState)(!1);return o.createElement(Di,{className:"selection-popup",rect:e.params.rect,uniqueRef:{},padding:20},o.createElement("div",{className:"content-selector"},o.createElement("button",{className:"content-selector-button",onClick:function(){a(!i)}},o.createElement("span",{className:"content-selector-text"},n?`${n.name}`:"   ()"),o.createElement("svg",{className:Tt()("content-selector-arrow",{open:i}),viewBox:"0 0 24 24"},o.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}))),i&&o.createElement("div",{className:"content-list"},e.categories.length>0?e.categories.map((t=>o.createElement("button",{key:t.id,className:Tt()("content-list-item",{selected:(null==n?void 0:n.id)===t.id}),onClick:()=>{return n=t,console.log("Selected content:",n),r(n),a(!1),void("function"==typeof e.onContentSelect&&e.onContentSelect(n.id));var n}},o.createElement("div",{className:"content-title"},t.name)))):o.createElement("div",{className:"content-list-item"},o.createElement("div",{className:"content-title"},"   ")))),o.createElement("div",{className:"colors","data-tabstop":1},Qr.map(((r,i)=>o.createElement("button",{key:i,tabIndex:-1,className:"toolbar-button color-button",title:t.formatMessage({id:r[0]}),onClick:()=>function(t){let r=e.textSelectionAnnotationMode;const i={...e.params.annotation,type:r,color:t};n&&(i.contentId=n.id,i.contentTitle=n.name,i.contentDescription=n.comment),e.onAddAnnotation(i)}(r[1])},o.createElement(Mt,{color:r[1]}))))),o.createElement("div",{className:"tool-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()("highlight",{active:"highlight"===e.textSelectionAnnotationMode}),title:t.formatMessage({id:"pdfReader.highlightText"}),onClick:()=>e.onChangeTextSelectionAnnotationMode("highlight")},o.createElement(kr,null)),o.createElement("button",{tabIndex:-1,className:Tt()("underline",{active:"underline"===e.textSelectionAnnotationMode}),title:t.formatMessage({id:"pdfReader.underlineText"}),onClick:()=>e.onChangeTextSelectionAnnotationMode("underline")},o.createElement(Tr,null))),e.enableAddToNote&&o.createElement("button",{className:"toolbar-button wide-button","data-tabstop":1,onClick:function(){e.onAddToNote([e.params.annotation])}},o.createElement(Xn,{id:"pdfReader.addToNote"})),o.createElement(It,{type:"TextSelectionPopup",annotation:e.params.annotation}))};function Ti(e,t,n){let r,i,o,a,s,l,u=window,c=0,d=!1,h=!1,p=!0;const f=!t&&0!==t&&"function"==typeof u.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){const n=r,o=i;return r=i=void 0,c=t,a=e.apply(o,n),a}function g(e,t){return f?(u.cancelAnimationFrame(s),u.requestAnimationFrame(e)):setTimeout(e,t)}function v(e){const n=e-l;return void 0===l||n>=t||n<0||h&&e-c>=o}function y(){const e=Date.now();if(v(e))return b(e);s=g(y,function(e){const n=e-c,r=t-(e-l);return h?Math.min(r,o-n):r}(e))}function b(e){return s=void 0,p&&r?m(e):(r=i=void 0,a)}function _(...e){const n=Date.now(),o=v(n);if(r=e,i=this,l=n,o){if(void 0===s)return function(e){return c=e,s=g(y,t),d?m(e):a}(l);if(h)return s=g(y,t),m(l)}return void 0===s&&(s=g(y,t)),a}return t=+t||0,function(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}(n)&&(d=!!n.leading,h="maxWait"in n,o=h?Math.max(+n.maxWait||0,t):o,p="trailing"in n?!!n.trailing:p),_.cancel=function(){void 0!==s&&function(e){if(f)return u.cancelAnimationFrame(e);clearTimeout(e)}(s),c=0,r=l=i=s=void 0},_.flush=function(){return void 0===s?a:b(Date.now())},_.pending=function(){return void 0!==s},_}var Fi;function Ri(){return Ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ri.apply(this,arguments)}const Ii=e=>o.createElement("svg",Ri({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),Fi||(Fi=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.116 10 3 3.884 3.884 3 10 9.116 16.116 3l.884.884L10.884 10 17 16.116l-.884.884L10 10.884 3.884 17 3 16.116z",clipRule:"evenodd"}))),Oi=function({params:e,onChange:t,onFindNext:n,onFindPrevious:r,onAddAnnotation:i,tools:a}){var s,l;const u=Ft(),c=(0,o.useRef)(),d=(0,o.useRef)(!1),[h,p]=(0,o.useState)(e.query),f=(0,o.useRef)();f.current=e;const m=(0,o.useCallback)(Ti((e=>{if(!c.current)return;let n=c.current.value;n===f.current.query||1===n.length&&RegExp(/^\p{Script=Latin}/,"u").test(n)||t({...f.current,query:n,active:!0,result:null})}),500),[t]);return(0,o.useLayoutEffect)((()=>{var t;e.popupOpen&&(null===(t=c.current)||void 0===t||t.focus())}),[e.popupOpen]),(0,o.useEffect)((()=>{p(e.query)}),[e.query]),o.createElement("div",{className:"find-popup",role:"application"},o.createElement("div",{className:"row input"},o.createElement("div",{className:Tt()("input-box",{loading:!e.result&&e.active&&e.query})},o.createElement("input",{ref:c,type:"text",title:u.formatMessage({id:"pdfReader.find"}),className:"toolbar-text-input",placeholder:"Find in document","data-l10n-id":"pdfReader-findInDocumentInput",value:null!==h?h:e.query,tabIndex:"-1","data-tabstop":1,autoComplete:"off",onChange:function(e){let n=e.target.value;p(n),n.trim()?d.current?d.current=!1:m():t({...f.current,query:"",result:null})},onKeyDown:function(o){let s=gr(o),l=vr(o);if("Enter"===s)e.active?n():t({...e,active:!0});else if("Shift-Enter"===s)e.active?r():t({...e,active:!0});else if("Escape"===s)t({...e,popupOpen:!1,active:!1,result:null}),o.preventDefault(),o.stopPropagation();else if("Ctrl-Alt-Digit1"===l){var u;d.current=!0,null!==(u=e.result)&&void 0!==u&&u.annotation&&(i({...e.result.annotation,type:"highlight",color:a.highlight.color},!0),t({...e,popupOpen:!1,active:!1,result:null}))}else if("Ctrl-Alt-Digit2"===l){var c;d.current=!0,null!==(c=e.result)&&void 0!==c&&c.annotation&&(i({...e.result.annotation,type:"underline",color:a.underline.color},!0),t({...e,popupOpen:!1,active:!1,result:null}))}}}),o.createElement("div",{className:"spinner-container"},o.createElement("div",{className:"spinner"}))),o.createElement("div",{className:"group","data-tabstop":1},o.createElement("button",{className:"previous toolbar-button",title:u.formatMessage({id:"pdfReader.findPrevious"}),tabIndex:"-1",disabled:(null===(s=e.result)||void 0===s?void 0:s.total)<=1,onClick:r},o.createElement(ln,null)),o.createElement("button",{className:"next toolbar-button",title:u.formatMessage({id:"pdfReader.findNext"}),tabIndex:"-1",disabled:(null===(l=e.result)||void 0===l?void 0:l.total)<=1,onClick:n},o.createElement(dn,null)),o.createElement("button",{className:"close toolbar-button",title:u.formatMessage({id:"pdfReader.close"}),tabIndex:"-1",onClick:function(){t({...e,popupOpen:!1,active:!1,result:null})}},o.createElement(Ii,null)))),o.createElement("div",{className:"row options","data-tabstop":1},o.createElement("div",{className:"option"},o.createElement("input",{id:"highlight-all",type:"checkbox",tabIndex:"-1",checked:e.highlightAll,onChange:function(n){t({...e,highlightAll:n.currentTarget.checked,result:null})}}),o.createElement("label",{htmlFor:"highlight-all"},o.createElement(Xn,{id:"pdfReader.highlightAll"}))),o.createElement("div",{className:"option"},o.createElement("input",{id:"case-sensitive",type:"checkbox",tabIndex:"-1",checked:e.caseSensitive,onChange:function(n){t({...e,caseSensitive:n.currentTarget.checked,result:null})}}),o.createElement("label",{htmlFor:"case-sensitive"},o.createElement(Xn,{id:"pdfReader.matchCase"}))),o.createElement("div",{className:"option"},o.createElement("input",{id:"entire-word",type:"checkbox",tabIndex:"-1",checked:e.entireWord,onChange:function(n){t({...e,entireWord:n.currentTarget.checked,result:null})}}),o.createElement("label",{htmlFor:"entire-word"},o.createElement(Xn,{id:"pdfReader.wholeWords"})))),e.result&&o.createElement("div",{className:"row result"},e.result.total>0?e.result.index+1+" / "+e.result.total:o.createElement(Xn,{id:"pdfReader.phraseNotFound"})))},Bi=function(e){let{annotation:t}=e;return o.createElement(Di,{className:"annotation-popup",rect:e.params.rect,uniqueRef:e.params.annotation.id,padding:20},o.createElement(Xr,{type:e.type,readOnly:e.readOnly||t.readOnly,annotation:t,isExpandable:!1,enableText:!1,enableImage:!1,enableComment:!(e.readOnly||t.readOnly)||t.comment,enableTags:!(e.readOnly||t.readOnly)||t.tags.length>0,onUpdate:t=>{e.onChange({id:popupAnnotation.id,comment:t})},onColorChange:t=>{e.onChange({id:popupAnnotation.id,color:t})},onOpenTagsPopup:e.onOpenTagsPopup,onChange:e.onChange,onOpenPageLabelPopup:e.onOpenPageLabelPopup,onOpenContextMenu:e.onOpenAnnotationContextMenu,onDragStart:t=>{e.onSetDataTransferAnnotations(t.dataTransfer,[popupAnnotation])}}))},Mi=function(e){const[t,n]=(0,o.useState)(!1),r=(0,o.useCallback)((function(n){if(!t)return;let r=n.clientX;"rtl"===document.documentElement.dir&&(r=window.innerWidth-r);let i=Math.floor(window.innerWidth/2);r>i&&(r=i),r<180&&(r=180),e.onResize(r)}),[t]),i=(0,o.useCallback)((function(){n(!1)}),[t]);return(0,o.useEffect)((()=>(window.addEventListener("pointermove",r),window.addEventListener("pointerup",i),()=>{window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",i)})),[r,i]),o.createElement("div",{className:Tt()("sidebar-resizer",{resizing:t}),onPointerDown:function(){n(!0)}})},Li=function(e){const[t,n]=(0,o.useState)(!1),r=(0,o.useRef)(),i=(0,o.useCallback)((function(n){if(!t)return;let i;if(document.body.classList.contains("enable-horizontal-split-view")){let e=n.clientY,t=r.current.parentNode.getBoundingClientRect(),o=Math.floor((t.height-(e-t.top))/t.height*100);o<20?o=20:o>80&&(o=80),i=o}else{let e=n.clientX,t=r.current.parentNode.getBoundingClientRect(),o=Math.floor((t.width-(e-t.left))/t.width*100);o<20?o=20:o>80&&(o=80),i=o,window.rtl&&(i=100-i)}e.onResize(i+"%")}),[t]),a=(0,o.useCallback)((function(){n(!1)}),[t]);return(0,o.useEffect)((()=>(window.addEventListener("pointermove",i),window.addEventListener("pointerup",a),()=>{window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",a)})),[i,a]),o.createElement("div",{ref:r,className:Tt()("split-view-resizer",{resizing:t}),onPointerDown:function(){n(!0)}})},Ni=(0,o.memo)((({thumbnail:e,selected:t,pageLabel:n,onContextMenu:r})=>{const i=Ft();return o.createElement("div",{className:Tt()("thumbnail",{selected:t}),"data-page-index":e.pageIndex,onContextMenu:r,role:"option","aria-label":i.formatMessage({id:"pdfReader.page"})+`${n}`,"aria-selected":t,id:`thumbnail_${e.pageIndex}`},o.createElement("div",{className:"image"},e.image?o.createElement("img",{width:e.width,height:e.height,src:e.image,draggable:!1}):o.createElement("div",{className:"placeholder",style:{width:e.width+"px",height:e.height+"px"}})),o.createElement("div",{className:"label"},n))}));Ni.displayName="Thumbnail";const Vi=function(e){const t=Ft(),[n,r]=(0,o.useState)([0]),i=(0,o.useRef)(),{onOpenThumbnailContextMenu:a}=e,{platform:s}=(0,o.useContext)(hd);(0,o.useEffect)((()=>{var t;n.length<=1&&void 0!==e.currentPageIndex&&(r([e.currentPageIndex]),null===(t=i.current.children[e.currentPageIndex])||void 0===t||t.scrollIntoView({block:"nearest",inline:"nearest"}))}),[e.currentPageIndex]),(0,o.useEffect)((()=>{let t={root:document.querySelector(".sidebar-content"),rootMargin:"200px",threshold:1};const n=new IntersectionObserver((function(t){let n=[];for(let e of t)if(e.isIntersecting){let t=parseInt(e.target.getAttribute("data-page-index"));n.unshift(t)}n.length&&e.onRenderThumbnails(n)}),t);let r=i.current.querySelectorAll(".thumbnail");for(let e of r)n.observe(e);return()=>{n.disconnect()}}),[e.thumbnails]);const l=(0,o.useCallback)((e=>{"web"!==s&&(e.preventDefault(),a({x:e.clientX,y:e.clientY,pageIndexes:n}))}),[a,s,n]),u=(0,o.useCallback)((e=>{e.preventDefault();const{x:t,bottom:r}=e.target.getBoundingClientRect();a({x:t,y:r,pageIndexes:n})}),[a,n]);return o.createElement("div",{id:"thumbnailsView",className:"thumbnails-view",role:"tabpanel","aria-labelledby":"viewThumbnail"},"web"===s&&o.createElement("div",{className:"thumbnails-header"},o.createElement(Xn,{id:"pdfReader.selectedPages",values:{count:n.length}}),o.createElement("button",{tabIndex:-1,"data-tabstop":1,className:"toolbar-button",title:t.formatMessage({id:"pdfReader.pageOptions"}),onClick:u},o.createElement(Gr,null))),o.createElement("div",{className:"thumbnails","data-tabstop":1,onKeyDown:function(t){if(mr(t)){let o=n[n.length-1];void 0===o?o=0:(o-=1,o<0&&(o=0)),t.shiftKey?n.includes(o)&&n.length>=2?r(n.filter((e=>e!==o+1))):r([...new Set([...n,o])]):(r([o]),e.onNavigate({pageIndex:o})),i.current.children[o].scrollIntoView({block:"nearest",inline:"nearest"})}else if(fr(t)){let o=n[n.length-1];void 0===o?o=0:(o+=1,o===i.current.children.length&&(o=i.current.children.length-1)),t.shiftKey?n.includes(o)&&n.length>=2?r(n.filter((e=>e!==o-1))):r([...new Set([...n,o])]):(r([o]),e.onNavigate({pageIndex:o})),i.current.children[o].scrollIntoView({block:"nearest",inline:"nearest"})}else if(!t.ctrlKey&&!t.metaKey||t.shiftKey||"a"!==t.key.toLowerCase()){if("Escape"===t.key){var o;r([e.currentPageIndex]),null===(o=i.current.children[e.currentPageIndex])||void 0===o||o.scrollIntoView({block:"nearest",inline:"nearest"})}}else{let e=[];for(let t=0;t<i.current.children.length;t++)e.push(t);r(e)}},onMouseDown:function(t){let o=t.target.closest(".thumbnail");if(o){let a=Array.from(i.current.children).indexOf(o);if(1!==t.buttons&&n.includes(a))return;if(t.shiftKey){let e=n.slice(-1),t=Math.min(...e,a),i=Math.max(...e,a),o=[];for(let e=t;e<=i;e++)o.push(e);r([...new Set([...n,...o])])}else t.metaKey||t.ctrlKey?n.includes(a)?r(n.filter((e=>e!==a))):r([...n,a]):(r([a]),e.onNavigate({pageIndex:a}))}},ref:i,tabIndex:-1,role:"listbox","aria-label":t.formatMessage({id:"pdfReader.thumbnails"}),"aria-activedescendant":`thumbnail_${n[n.length-1]}`,"aria-multiselectable":"true"},e.thumbnails.map(((t,r)=>{let i=e.pageLabels[r]||(r+1).toString();return o.createElement(Ni,{key:r,thumbnail:t,selected:n.includes(r),pageLabel:i,contextMenu:e.contextMenu,onContextMenu:l})}))))};function zi(e){for(let t of e)t.active=!1,t.items&&zi(t.items)}function Ui({item:e,id:t,children:n,onOpenLink:r,onUpdate:i,onSelect:a}){var s,l;function u(){e.expanded=!e.expanded,i()}let c;c=null!==(s=e.items)&&void 0!==s&&s.length&&!1!==e.childMatched?o.createElement("div",{className:"toggle",onClick:u},o.createElement($n,null)):o.createElement("div",{className:"toggle"});let{expanded:d,active:h}=e;return o.createElement("li",{id:`outline-${t}`,"aria-label":e.title},o.createElement("div",{className:Tt()("item",{expandable:!(null===(l=e.items)||void 0===l||!l.length),unmatched:!1===e.matched,expanded:d,active:h}),"data-id":t},c,o.createElement("div",{className:"title",onPointerDown:function(){a(e)},onDoubleClick:function(){var t;null!==(t=e.items)&&void 0!==t&&t.length&&u()}},e.title,e.url&&o.createElement(o.Fragment,null," [",o.createElement("a",{href:e.url,onClick:function(t){t.preventDefault(),r(e.url)}},"URL"),"]"))),n&&o.createElement("div",{className:"children"},n))}const Hi=function({outline:e,currentOutlinePath:t,onNavigate:n,onOpenLink:r,onUpdate:i}){let a=(0,o.useRef)();function s(){i([...e])}function l(t){zi(e),t.active=!0,s(),t.location&&n(t.location,{block:"start"})}function u(e,t=[]){for(let n of e)!1===n.matched&&!1===n.childMatched||t.push(n),n.items&&n.expanded&&!1!==n.childMatched&&u(n.items,t);return t}(0,o.useEffect)((()=>{t&&!function(e,t){let n=e,r=null;for(let e=0;e<t.length;e++){const i=n[t[e]];if(!i)return!1;if(!i.expanded){r=i;break}if(e===t.length-1){r=i;break}n=i.items||[]}return!!r&&!!r.active}(e,t)&&(zi(e),function(e,t){let n=e;for(let e=0;e<t.length;e++){const r=n[t[e]];if(!r)return;if(!r.expanded)return void(r.active=!0);if(e===t.length-1)return void(r.active=!0);n=r.items||[]}}(e,t),s(),setTimeout((()=>{var e;null===(e=a.current.querySelector(".active"))||void 0===e||e.scrollIntoView({block:"nearest",inline:"nearest"})}),200))}),[t]);let c=u(e||[]).findIndex((e=>e.active));return o.createElement("div",{ref:a,className:Tt()("outline-view",{loading:null===e}),"data-tabstop":"1",tabIndex:-1,id:"outlineView",role:"listbox","aria-labelledby":"viewOutline",onKeyDown:function(t){let{key:i}=t,o=u(e),l=o.findIndex((e=>e.active)),c=o[l];if("ArrowUp"===i){let t=o[l-1];if(t){zi(e),t.active=!0,t.location&&n(t.location,{block:"start"});let r=a.current.querySelector(`[data-id="${l-1}"]`);r&&r.scrollIntoView({block:"nearest",inline:"nearest"})}}else if("ArrowDown"===i){let t=o[l+1];if(t){zi(e),t.active=!0,t.location&&n(t.location,{block:"start"});let r=a.current.querySelector(`[data-id="${l+1}"]`);r&&r.scrollIntoView({block:"nearest",inline:"nearest"})}}else if("Enter"===i)c.items.length?c.expanded=!c.expanded:c.url&&r(c.url);else if(!window.rtl&&"ArrowLeft"===t.key||window.rtl&&"ArrowRight"===t.key)c.items.length&&(c.expanded=!1);else{if(!(!window.rtl&&"ArrowRight"===t.key||window.rtl&&"ArrowLeft"===t.key))return;c.items.length&&(c.expanded=!0)}s()},"aria-activedescendant":-1!==c?`outline-${c}`:null},null===e?o.createElement("div",{className:"spinner"}):function e(t,n={n:-1}){return o.createElement("ul",null,t.map(((t,i)=>(n.n++,(!1!==t.matched||!1!==t.childMatched)&&o.createElement(Ui,{key:i,item:t,id:n.n,onOpenLink:r,onUpdate:s,onSelect:l},t.expanded&&(null==t?void 0:t.items)&&e(t.items,n))))))}(e))},Wi=function(e){const t=(0,o.useRef)();return o.createElement(Di,{className:"preview-popup",rect:e.params.rect,uniqueRef:{},padding:10,onRender:function(){let{x:n,y:r}=e.params;const i=n-t.current.offsetWidth/2,o=r-t.current.offsetHeight/2;o>0&&(t.current.scrollTop=o),i>0&&(t.current.scrollLeft=i)}},o.createElement("div",{dir:"ltr",ref:t,className:"inner",tabIndex:"-1","data-tabstop":1},o.createElement("img",{height:e.params.height,width:e.params.width,src:e.params.image})))},ji=function(e){return Ft(),(0,o.useRef)(),o.createElement(Di,{className:"link-popup",rect:e.params.rect,uniqueRef:e.params.ref,padding:10},o.createElement("a",{href:e.params.url,onClick:function(t){t.preventDefault(),e.onOpenLink(t.target.href)}},e.params.url))},$i=function({params:e,onOpenLink:t}){let n=o.useRef(null),[r,i]=o.useState(!0);return o.useEffect((()=>{i(!0)}),[e.content]),o.createElement(Di,{className:Tt()("footnote-popup",{loading:r}),rect:e.rect,uniqueRef:r?{}:e.ref,padding:r?0:10},o.createElement("iframe",{ref:n,sandbox:"allow-same-origin",srcDoc:e.content,onLoad:()=>{if(n.current){let r=n.current,i=new r.contentWindow.CSSStyleSheet;i.replaceSync(e.css),r.contentDocument.body.classList.add("footnote-popup-content"),r.contentDocument.adoptedStyleSheets.push(i),r.style.height="0",r.style.height=r.contentWindow.document.documentElement.scrollHeight+"px";let o=new ResizeObserver((()=>{r.contentWindow?(r.style.height="0",r.style.height=r.contentWindow.document.documentElement.scrollHeight+"px"):o.disconnect()}));o.observe(r.contentDocument.body);let a=e=>{e.preventDefault();let n=e.target.closest("a[href]");n&&t(n.href)};r.contentDocument.addEventListener("click",a)}i(!1)}}))};function Gi({chars:e,onOpenLink:t}){function n({text:e,bold:n,italic:r,url:i}){let a=o.createElement("span",null,e);return i&&(a=o.createElement("a",{href:i,onClick:function(e){e.preventDefault(),e.stopPropagation(),t(i)}},a)),r&&(a=o.createElement("em",null,a)),n&&(a=o.createElement("strong",null,a)),a}const r=o.useMemo((()=>e.reduce(((t,n,r)=>{const{c:i,bold:o,italic:a,url:s,spaceAfter:l}=n;return n.ignorable||(0===r||t[t.length-1].isBold!==o||t[t.length-1].isItalic!==a||t[t.length-1].url!==s?t.push({text:i,isBold:o,isItalic:a,url:s}):t[t.length-1].text+=i,(l||n.lineBreakAfter&&r!==e.length-1)&&(t[t.length-1].text+=" ")),t}),[]).map(((e,t)=>o.createElement(n,{key:t,text:e.text,bold:e.bold,italic:e.italic,url:e.url})))),[e]);return o.createElement("div",null,r)}function qi({reference:e,onNavigate:t,onOpenLink:n}){return o.createElement("div",{className:"reference-row",onClick:function(){let{position:t}=e}},o.createElement(Gi,{chars:e.chars,onOpenLink:n}))}function Ki(e){return Ft(),(0,o.useRef)(),o.createElement(Di,{className:"reference-popup",rect:e.params.rect,uniqueRef:e.params.ref,padding:10},e.params.references.map(((t,n)=>o.createElement(qi,{key:n,reference:t,onNavigate:e.onNavigate,onOpenLink:e.onOpenLink}))))}function Yi({reference:e,onNavigate:t,onOpenLink:n}){return o.createElement("div",{className:"reference-row",onClick:function(){let{position:t}=e}},o.createElement(Gi,{chars:e.chars,onOpenLink:n}))}function Xi(e){return Ft(),(0,o.useRef)(),o.createElement(Di,{className:"citation-popup",rect:e.params.rect,uniqueRef:e.params.ref,padding:10},o.createElement("div",{className:"inner"},e.params.references.map(((t,n)=>o.createElement(Yi,{key:n,reference:t,onNavigate:e.onNavigate,onOpenLink:e.onOpenLink})))))}const Zi=function({params:e,onClose:t}){let{src:n,title:r,alt:i,rect:a}=e;const s=Ft();let[l,u]=(0,o.useState)(!1);return o.createElement("div",{className:Tt()("image-popup",{show:l}),role:"button","aria-label":s.formatMessage({id:"pdfReader.zoomOut"}),style:{"--rect-left":a[0]+"px","--rect-top":a[1]+"px","--rect-right":a[2]+"px","--rect-bottom":a[3]+"px"},onClick:function(){u(!1),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&t()}},o.createElement("img",{src:n,title:r,alt:i,onLoad:function(){u(!0)},onTransitionEnd:function(){l||t()}}))},Qi=function(e){return"internal-link"===e.params.type?o.createElement(Wi,e):"external-link"===e.params.type?o.createElement(ji,e):"footnote"===e.params.type?o.createElement($i,e):"citation"===e.params.type?o.createElement(Xi,e):"reference"===e.params.type?o.createElement(Ki,e):"image"===e.params.type?o.createElement(Zi,e):void 0};var Ji,eo;function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},to.apply(this,arguments)}const no=e=>o.createElement("svg",to({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Ji||(Ji=o.createElement("g",{clipPath:"url(#annotate-eraser_svg__a)"},o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.793.5a1 1 0 0 1 1.414 0L15.5 4.793a1 1 0 0 1 0 1.414L6.207 15.5a1 1 0 0 1-1.414 0L.5 11.207a1 1 0 0 1 0-1.414zm.707.707L4.707 7 9 11.293 14.793 5.5zM1.207 10.5 4 7.707 8.293 12 5.5 14.793zm8.44-7.146 3 3 .707-.708-3-3zM16 16H7.121l1-1H16z",clipRule:"evenodd"}))),eo||(eo=o.createElement("defs",null,o.createElement("clipPath",{id:"annotate-eraser_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))));function ro({item:e,onClose:t}){return o.createElement("button",{tabIndex:-1,className:Tt()("row basic",{checked:e.checked}),onClick:n=>function(e,n){t(),e.preventDefault(),setTimeout((()=>n.onCommand()))}(n,e),disabled:e.disabled},e.color&&o.createElement("div",{className:"icon"},o.createElement(Mt,{color:e.color})),e.eraser&&o.createElement("div",{className:"icon"},o.createElement(no,null)),e.label)}function io({item:e}){let[t,n]=(0,o.useState)(e.size),r=(0,o.useRef)();const i=(0,o.useCallback)(Ti((()=>{e.onCommand(s(r.current.value))}),300),[]);let{steps:a}=e;function s(e){return a[e]}return o.createElement("div",{className:Tt()("row slider",{checked:e.checked},{center:dr||hr})},o.createElement("div",null,o.createElement(Xn,{id:"pdfReader.size"}),":"),o.createElement("input",{ref:r,tabIndex:-1,type:"range",min:"0",max:a.length-1,value:(l=t,function(e){let t=0,n=Math.abs(a[0]-e);for(let r=1;r<a.length;r++){let i=Math.abs(a[r]-e);i<n&&(n=i,t=r)}return t}(l)),className:"slider",id:"myRange",disabled:e.disabled,onChange:function(e){n(s(e.target.value)),i()}}),o.createElement("div",{className:"number"},t.toFixed(1)));var l}const oo=function({params:e,onClose:t}){Ft();const[n,r]=(0,o.useState)({style:{}}),[i,a]=(0,o.useState)(),s=(0,o.useRef)(),l=(0,o.useRef)(""),u=(0,o.useRef)(null);return(0,o.useEffect)((()=>{a({})}),[e]),(0,o.useLayoutEffect)((()=>{i&&function(){let t=s.current.offsetWidth,n=s.current.offsetHeight,{x:i,y:o}=e;o+=2,i+t>window.innerWidth&&(i=window.innerWidth-t),o+n>window.innerHeight&&(o=window.innerHeight-n),r({style:{top:o,left:i}})}()}),[i]),o.createElement("div",{className:"context-menu-overlay",onPointerDown:function(e){e.target.classList.contains("context-menu-overlay")&&(setTimeout(t),e.stopPropagation())}},o.createElement("div",{ref:s,className:"context-menu",style:n.style,"data-tabstop":1,onKeyDown:function(e){let{key:t}=e;if(1!==t.length||!t.match(/\S/))return;u.current&&clearTimeout(u.current),u.current=setTimeout((()=>{l.current=""}),2e3),l.current+=t.toLowerCase();let n=[...document.querySelectorAll(".context-menu button:not([disabled])")].filter((e=>e.textContent.toLowerCase().startsWith(l.current)));n.length&&n[0].focus()}},e.itemGroups.map(((e,n)=>o.createElement("div",{key:n,className:"group"},e.map(((e,n)=>e.slider?o.createElement(io,{key:n,item:e}):o.createElement(ro,{key:n,item:e,onClose:t}))))))))},ao=function({rect:e,className:t,children:n,onClose:r}){const[i,a]=(0,o.useState)({style:{},classes:{}}),[s,l]=(0,o.useState)(),u=(0,o.useRef)(),c=(0,o.useRef)();return(0,o.useEffect)((()=>{l({})}),[e]),(0,o.useLayoutEffect)((()=>{s&&function(){let t="center",n="bottom",r=c.current.offsetWidth,i=c.current.offsetHeight,o=e[3]+10,s=e[0]+(e[2]-e[0])/2-r/2;s<0?(s=e[0]+(e[2]-e[0])/2-20,t="left"):s+r>window.innerWidth&&(s=e[0]+(e[2]-e[0])/2-(r-20),t="right"),o+i>window.innerHeight&&(n="top",o=e[1]-i-10),s<0?(s=0,t="left"):s+r>window.innerWidth&&(s=window.innerWidth-r,t="right"),a({style:{top:o,left:s},classes:{["popup-"+n+"-"+t]:!0}})}()}),[s]),o.createElement("div",{ref:u,className:Tt()("tooltip-popup-overlay"),onPointerDown:function(e){e.target===u.current&&r()}},o.createElement("div",{ref:c,className:Tt()("modal-popup",t,i.classes),style:i.style},n))},so=function({params:e,onUpdateAnnotations:t,onClose:n}){let r=function(e){let t=[],n=e.currentAnnotation;if(!n)return;let r=e.selectedAnnotations.filter((e=>!e.readOnly));t=r.length&&r.includes(e.currentAnnotation)?r:[e.currentAnnotation],t.sort(((e,t)=>e.position.pageIndex-t.position.pageIndex));let i,o=1===t.length,a=t.length>1,s=e.allAnnotations.filter((e=>e.position.pageIndex===t[0].position.pageIndex)),l=e.allAnnotations.filter((e=>e.position.pageIndex>=t[0].position.pageIndex)),u=s.some((e=>!t.includes(e))),c=l.some((e=>!t.includes(e))),d=e.allAnnotations.length!==s.length&&e.allAnnotations.length!==l.length;i=c?"from":d?"all":u?"page":a?"selected":"single";let{pageIndex:h}=n.position,p=e.pageLabels.length&&e.pageLabels[h]||(h+1).toString();return{checked:i,pageLabel:n.pageLabel,autoPageLabel:p,single:o,selected:a,page:u,from:c,all:d}}(e),[i,a]=(0,o.useState)(r.pageLabel),[s,l]=(0,o.useState)(r.checked),[u,c]=(0,o.useState)(!1),d=(0,o.useRef)();const h=Ft();function p(){u?m("auto"):m(s,i.trim())}function f(e){l(e.target.value)}function m(r,i){let o=[];if("auto"===r){n();let r=e.allAnnotations.filter((e=>!e.readOnly));for(let t of r){let{pageIndex:n}=t.position;o.push({id:t.id,pageLabel:e.pageLabels[n]||(n+1).toString()})}return void t(o)}if(!i)return;let a=e.currentAnnotation;if(!a)return;a={...a};let s=a.position.pageIndex,l=parseInt(i)==i;if("page"===r){let t=e.allAnnotations.filter((e=>!e.readOnly));o=t.filter((e=>e.position.pageIndex===s)).map((({id:e})=>({id:e}))),o.forEach((e=>e.pageLabel=i))}else if("selected"!==r||l)if("single"===r||!l&&"selected"!==r)a.readOnly||(o=[{id:a.id,pageLabel:i}]);else{let t=e.allAnnotations.filter((e=>!e.readOnly));switch(r){case"selected":o=t.filter((t=>e.selectedAnnotations.includes(t)));break;case"page":o=t.filter((e=>e.position.pageIndex===s));break;case"from":o=t.filter((e=>e.position.pageIndex>=s));break;case"all":o=t}i=parseInt(i),o=o.map((e=>({...e})));for(let e of o){let t=i+(e.position.pageIndex-s);t<1||(e.pageLabel=t.toString())}o=o.map((({id:e,pageLabel:t})=>({id:e,pageLabel:t})))}else o=e.selectedAnnotations.filter((e=>!e.readOnly)).map((({id:e})=>({id:e}))),o.forEach((e=>e.pageLabel=i));n(),t(o)}(0,o.useEffect)((()=>{d.current.focus(),d.current.select()}),[]);let g=!1;(parseInt(i)!=i||parseInt(i)<1)&&(g=!0,s=r.page&&!["single","selected"].includes(s)?"page":r.single?"single":"selected");let v=!i.trim().length;return u&&(r.all?s="all":r.from?s="from":r.page?s="page":r.selected?s="selected":r.single&&(s="single")),o.createElement(ao,{className:"label-popup",rect:e.rect,onClose:n},o.createElement("div",{className:"row label"},o.createElement("div",{className:"column first"},o.createElement("input",{ref:d,type:"text",tabIndex:-1,"data-tabstop":1,className:"toolbarField",value:u?r.autoPageLabel:i,disabled:u,maxLength:32,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&p()},"aria-label":h.formatMessage({id:"pdfReader.editPageNumber"})})),o.createElement("div",{className:"column second"},o.createElement("input",{id:"renumber-auto-detect",type:"checkbox","data-tabstop":1,tabIndex:-1,checked:u,onChange:function(e){c(e.target.checked)}}),o.createElement("label",{htmlFor:"renumber-auto-detect"},o.createElement(Xn,{id:"pdfReader.autoDetect"})))),o.createElement("fieldset",{className:"radio row","data-tabstop":1},o.createElement("legend",null,o.createElement(Xn,{id:"pdfReader.pageNumberPopupHeader"})),r.single&&o.createElement("div",{className:"choice"},o.createElement("input",{type:"radio",tabIndex:-1,id:"renumber-selected",name:"renumber",value:"single",checked:"single"===s&&!v,disabled:v||u,onChange:f}),o.createElement("label",{htmlFor:"renumber-selected"},o.createElement(Xn,{id:"pdfReader.thisAnnotation"}))),r.selected&&o.createElement("div",{className:"choice"},o.createElement("input",{type:"radio",tabIndex:-1,id:"renumber-selected",name:"renumber",value:"selected",checked:"selected"===s&&!v,disabled:v||u,onChange:f}),o.createElement("label",{htmlFor:"renumber-selected"},o.createElement(Xn,{id:"pdfReader.selectedAnnotations"}))),r.page&&o.createElement("div",{className:"choice"},o.createElement("input",{type:"radio",tabIndex:-1,id:"renumber-page",name:"renumber",value:"page",checked:"page"===s,disabled:v||u,onChange:f}),o.createElement("label",{htmlFor:"renumber-page"},o.createElement(Xn,{id:"pdfReader.thisPage"}))),r.from&&o.createElement("div",{className:"choice"},o.createElement("input",{type:"radio",tabIndex:-1,id:"renumber-from-page",name:"renumber",value:"from",checked:"from"===s,disabled:g||v||u,onChange:f}),o.createElement("label",{htmlFor:"renumber-from-page"},o.createElement(Xn,{id:"pdfReader.thisPageAndLaterPages"}))),r.all&&o.createElement("div",{className:"choice"},o.createElement("input",{type:"radio",tabIndex:-1,id:"renumber-all",name:"renumber",value:"all",checked:"all"===s,disabled:g||v||u,onChange:f}),o.createElement("label",{htmlFor:"renumber-all"},o.createElement(Xn,{id:"pdfReader.allPages"})))),o.createElement("div",{className:"row buttons"},o.createElement("button",{tabIndex:-1,"data-tabstop":1,className:"form-button primary",disabled:v,onClick:p},o.createElement(Xn,{id:"general.update"}))))},lo=function({className:e,children:t,onClose:n}){let r=(0,o.useRef)();return(0,o.useLayoutEffect)((()=>{let e=r.current.querySelector("[data-default-focus]");e&&e.focus()}),[]),o.createElement("div",{ref:r,className:"overlay dialog-popup-overlay",onPointerDown:function(e){e.target===r.current&&n&&n()}},o.createElement("div",{className:Tt()("modal-popup",e)},t))},uo=function({params:e,onEnterPassword:t}){let n=(0,o.useRef)();return o.createElement(lo,{className:"password-popup"},o.createElement("form",{onSubmit:function(e){e.preventDefault(),t(n.current.value)}},o.createElement("div",{className:"row description"},o.createElement(Xn,{id:"pdfReader.enterPassword"})),o.createElement("div",{className:"row"},o.createElement("input",{type:"password",ref:n}))))},co=function({params:e}){let[t,n]=(0,o.useState)(!0);function r(){window.abortPrint()}return o.createElement(lo,{className:"print-popup"},void 0===e.percent&&o.createElement(o.Fragment,null,o.createElement("div",{className:"row checkbox"},o.createElement("input",{id:"renumber-auto-detect",type:"checkbox",tabIndex:-1,"data-tabstop":1,checked:t,onChange:function(e){n(e.target.checked)}}),o.createElement("label",{htmlFor:"renumber-auto-detect"},o.createElement(Xn,{id:"pdfReader.includeAnnotations"}))),o.createElement("div",{className:"row buttons","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:"form-button",onClick:r},o.createElement(Xn,{id:"general.cancel"})),o.createElement("button",{tabIndex:-1,"data-default-focus":!0,className:"form-button primary",onClick:function(){window.print(t)}},o.createElement(Xn,{id:"general.print"})))),void 0!==e.percent&&o.createElement(o.Fragment,null,o.createElement("div",{className:"row description"},o.createElement(Xn,{id:"pdfReader.preparingDocumentForPrinting"})),o.createElement("div",{className:"row progress"},o.createElement("progress",{max:"100",value:e.percent},e.percent,"%")),o.createElement("div",{className:"row buttons","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:"form-button",onClick:r},o.createElement(Xn,{id:"general.cancel"})))))};var ho;function po(){return po=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},po.apply(this,arguments)}const fo=e=>o.createElement("svg",po({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),ho||(ho=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m.19 4.75 4.5 4.5 1.06-1.06L3.06 5.5h7.44a4 4 0 0 1 0 8H8V15h2.5a5.5 5.5 0 1 0 0-11H3.06l2.69-2.69L4.69.25z",clipRule:"evenodd"})));var mo=r(9294),go=r.n(mo);const vo=class{constructor(e){var t;e.indexOf("://")>-1&&(e=new URL(e).pathname),t=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=t.dir+"/",this.filename=t.base,this.extension=t.ext.slice(1)}parse(e){return go().parse(e)}isAbsolute(e){return go().isAbsolute(e||this.path)}isDirectory(e){return"/"===e.charAt(e.length-1)}resolve(e){return go().resolve(this.directory,e)}relative(e){return e&&e.indexOf("://")>-1?e:go().relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}};var yo=r(8370),bo=r.n(yo);const _o="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),wo=1,So=3,Co="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function Eo(){if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:7&n|8).toString(16)}))}function xo(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function Ao(e){return!(!e||1!=e.nodeType)}function ko(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Do(e){let t=parseFloat(e);return!1!==ko(e)&&("string"==typeof e&&e.indexOf(".")>-1||Math.floor(t)!==t)}function Po(e){var t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=e.toLowerCase();if("undefined"==typeof document||void 0!==document.body.style[n])return e;for(var r=0;r<5;r++)if(void 0!==document.body.style[t[r]+n])return t[r]+n;return e}function To(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var i in r)void 0===e[i]&&(e[i]=r[i])}return e}function Fo(e){return[].slice.call(arguments,1).forEach((function(t){t&&Object.getOwnPropertyNames(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))})),e}function Ro(e,t,n){var r=Io(e,t,n);return t.splice(r,0,e),r}function Io(e,t,n,r,i){var o,a=r||0,s=i||t.length,l=parseInt(a+(s-a)/2);return n||(n=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),s-a<=0?l:(o=n(t[l],e),s-a==1?o>=0?l:l+1:0===o?l:-1===o?Io(e,t,n,l,s):Io(e,t,n,a,l))}function Oo(e,t,n,r,i){var o,a=r||0,s=i||t.length,l=parseInt(a+(s-a)/2);return n||(n=function(e,t){return e>t?1:e<t?-1:e==t?0:void 0}),s-a<=0?-1:(o=n(t[l],e),s-a==1?0===o?l:-1:0===o?l:-1===o?Oo(e,t,n,l,s):Oo(e,t,n,a,l))}function Bo(e){var t=window.getComputedStyle(e),n=0,r=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(e){n+=parseFloat(t[e])||0})),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(e){r+=parseFloat(t[e])||0})),{height:r,width:n}}function Mo(e){var t=window.getComputedStyle(e),n=0,r=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(e){n+=parseFloat(t[e])||0})),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(e){r+=parseFloat(t[e])||0})),{height:r,width:n}}function Lo(e){let t,n=e.ownerDocument;if(e.nodeType==Node.TEXT_NODE){let r=n.createRange();r.selectNodeContents(e),t=r.getBoundingClientRect()}else t=e.getBoundingClientRect();return t}function No(){var e=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function Vo(e,t){for(var n,r=e.parentNode.childNodes,i=-1,o=0;o<r.length&&((n=r[o]).nodeType===t&&i++,n!=e);o++);return i}function zo(e){return Vo(e,So)}function Uo(e){return Vo(e,wo)}function Ho(e){return["xml","opf","ncx"].indexOf(e)>-1}function Wo(e,t){return new Blob([e],{type:t})}function jo(e,t){var n=Wo(e,t);return Co.createObjectURL(n)}function $o(e){return Co.revokeObjectURL(e)}function Go(e,t){if("string"==typeof e)return"data:"+t+";base64,"+btoa(e)}function qo(e){return Object.prototype.toString.call(e).slice(8,-1)}function Ko(e,t){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),(new DOMParser).parseFromString(e,t)}function Yo(e){let t,n=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT),r=[];for(;t=n.nextNode();)r.push(t);for(let e of r)e.data=""}function Xo(e,t){var n;if(!e)throw new Error("No Element Provided");return void 0!==e.querySelector?e.querySelector(t):(n=e.getElementsByTagName(t)).length?n[0]:void 0}function Zo(e,t){return void 0!==e.querySelector?e.querySelectorAll(t):e.getElementsByTagName(t)}function Qo(e,t,n){var r,i;if(void 0!==e.querySelector){for(var o in t+="[",n)t+=o+"~='"+n[o]+"'";return t+="]",e.querySelector(t)}if(r=e.getElementsByTagName(t),i=Array.prototype.slice.call(r,0).filter((function(e){for(var t in n)if(e.getAttribute(t)===n[t])return!0;return!1})),i)return i[0]}function Jo(e,t){void 0!==(e.ownerDocument||e).createTreeWalker?ea(e,t,NodeFilter.SHOW_TEXT):ta(e,(function(e){e&&3===e.nodeType&&t(e)}))}function ea(e,t,n){var r=document.createTreeWalker(e,n,null,!1);let i;for(;i=r.nextNode();)t(i)}function ta(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(ta(e,t))return!0;e=e.nextSibling}while(e)}function na(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t(r.result)}}))}function ra(){this.resolve=null,this.reject=null,this.id=Eo(),this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),Object.freeze(this)}function ia(e,t,n){var r;if(void 0!==e.querySelector&&(r=e.querySelector(`${t}[*|type="${n}"]`)),r&&0!==r.length)return r;r=Zo(e,t);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||r[i].getAttribute("epub:type")===n)return r[i]}function oa(e){for(var t=[],n=e.childNodes,r=0;r<n.length;r++){let e=n[r];1===e.nodeType&&t.push(e)}return t}function aa(e){for(var t=[e];e;e=e.parentNode)t.unshift(e);return t}function sa(e,t,n){for(var r=[],i=e.childNodes,o=0;o<i.length;o++){let e=i[o];if(1===e.nodeType&&e.nodeName.toLowerCase()===t){if(n)return e;r.push(e)}}if(!n)return r}function la(e,t){let n;if(null!==e&&""!==t)for(n=e.parentNode;1===n.nodeType;){if(n.tagName.toLowerCase()===t)return n;n=n.parentNode}}class ua{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=3===e.nodeType?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var n=aa(e||this.startContainer),r=aa(t||this.endContainer);if(n[0]==r[0])for(var i=0;i<n.length;i++)if(n[i]!=r[i])return n[i-1]}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const ca=class{constructor(e,t){var n=e.indexOf("://")>-1,r=e;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!n&&!1!==t&&"string"!=typeof t&&window&&window.location&&(this.base=window.location.href),n||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(e){this.Url=void 0,this.base&&(r=new vo(this.base).resolve(r))}this.Path=new vo(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t;return e.indexOf("://")>-1?e:(t=go().resolve(this.directory,e),this.origin+t)}relative(e){return go().relative(e,this.directory)}toString(){return this.href}};class da{constructor(e,t,n){var r;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof da))return new da(e,t,n);if("string"==typeof t?this.base=this.parseComponent(t):"object"==typeof t&&t.steps&&(this.base=t),"string"===(r=this.checkType(e)))return this.str=e,Fo(this,this.parse(e));if("range"===r)return Fo(this,this.fromRange(e,this.base,n));if("node"===r)return Fo(this,this.fromNode(e,this.base,n));if("EpubCFI"===r&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":!e||"object"!=typeof e||"Range"!==qo(e)&&void 0===e.startContainer?e&&"object"==typeof e&&void 0!==e.nodeType?"node":!!(e&&"object"==typeof e&&e instanceof da)&&"EpubCFI":"range"}parse(e){var t,n,r,i={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof e?{spinePos:-1}:(0===e.indexOf("epubcfi(")&&")"===e[e.length-1]&&(e=e.slice(8,e.length-1)),(t=this.getChapterComponent(e))?(i.base=this.parseComponent(t),n=this.getPathComponent(e),i.path=this.parseComponent(n),(r=this.getRange(e))&&(i.range=!0,i.start=this.parseComponent(r[0]),i.end=this.parseComponent(r[1])),i.spinePos=i.base.steps[1].index,i):{spinePos:-1})}parseComponent(e){var t,n={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),i=r[0].split("/");return r.length>1&&(t=r[1],n.terminal=this.parseTerminal(t)),""===i[0]&&i.shift(),n.steps=i.map(function(e){return this.parseStep(e)}.bind(this)),n}parseStep(e){var t,n,r,i,o;if((i=e.match(/\[(.*)\]/))&&i[1]&&(o=i[1]),n=parseInt(e),!isNaN(n))return n%2==0?(t="element",r=n/2-1):(t="text",r=(n-1)/2),{type:t,index:r,id:o||null}}parseTerminal(e){var t,n,r=e.match(/\[(.*)\]/);return r&&r[1]?(t=parseInt(e.split("[")[0]),n=r[1]):t=parseInt(e),ko(t)||(t=null),{offset:t,assertion:n}}getChapterComponent(e){return e.split("!")[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return 3===t.length&&[t[1],t[2]]}getCharecterOffsetComponent(e){return e.split(":")[1]||""}joinSteps(e,t){return e?e.map((function(e){var n="";return"element"===e.type&&(n+=2*(e.index+1)),"text"===e.type&&(n+=1+2*e.index),!t&&e.id&&(n+="["+e.id+"]"),n})).join("/"):""}segmentString(e,t){var n="/";return n+=this.joinSteps(e.steps,t),e.terminal&&null!=e.terminal.offset&&(n+=":"+e.terminal.offset),!t&&e.terminal&&null!=e.terminal.assertion&&(n+="["+e.terminal.assertion+"]"),n}toString(e){var t="epubcfi(";return t+=this.segmentString(this.base,e),t+="!",t+=this.segmentString(this.path,e),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start,e)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end,e)),t+")"}compare(e,t){var n,r,i,o;if("string"==typeof e&&(e=new da(e)),"string"==typeof t&&(t=new da(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(n=e.path.steps.concat(e.start.steps),i=e.start.terminal):(n=e.path.steps,i=e.path.terminal),t.range?(r=t.path.steps.concat(t.start.steps),o=t.start.terminal):(r=t.path.steps,o=t.path.terminal);for(var a=0;a<n.length;a++){if(!n[a])return-1;if(!r[a])return 1;if(n[a].index>r[a].index)return 1;if(n[a].index<r[a].index)return-1}return n.length<r.length?-1:i.offset>o.offset?1:i.offset<o.offset?-1:0}step(e){var t=3===e.nodeType?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var n,r=this.filter(e,t);if(r)return n=3===r.nodeType?"text":"element",{id:r.id,tagName:r.tagName,type:n,index:this.filteredPosition(r,t)}}pathTo(e,t,n){for(var r,i={steps:[],terminal:{offset:null,assertion:null}},o=e;o&&o.parentNode&&o.parentNode.nodeType!=Node.DOCUMENT_NODE&&o.parentNode.nodeType!=Node.DOCUMENT_FRAGMENT_NODE&&(o.parentNode.nodeType!=Node.ELEMENT_NODE||!o.parentNode.classList.contains("cfi-stop"));)(r=n?this.filteredStep(o,n):this.step(o))&&i.steps.unshift(r),o=o.parentNode;return null!=t&&t>=0&&(i.terminal.offset=t,e.nodeType!==Node.TEXT_NODE||i.steps.length&&"text"==i.steps[i.steps.length-1].type||i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!(!e||!t)&&e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,n){var r={range:!1,base:{},path:{},start:null,end:null},i=e.startContainer,o=e.endContainer,a=e.startOffset,s=e.endOffset,l=!1;if(n&&(l=null!=i.ownerDocument.querySelector("."+n)),"string"==typeof t?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):"object"==typeof t&&(r.base=t),e.collapsed)l&&(a=this.patchOffset(i,a,n)),r.path=this.pathTo(i,a,n);else{r.range=!0,l&&(a=this.patchOffset(i,a,n)),r.start=this.pathTo(i,a,n),l&&(s=this.patchOffset(o,s,n)),r.end=this.pathTo(o,s,n),r.path={steps:[],terminal:null};var u,c=r.start.steps.length;for(u=0;u<c&&this.equalStep(r.start.steps[u],r.end.steps[u]);u++)u===c-1?r.start.terminal===r.end.terminal&&(r.path.steps.push(r.start.steps[u]),r.range=!1):r.path.steps.push(r.start.steps[u]);r.start.steps=r.start.steps.slice(r.path.steps.length),r.end.steps=r.end.steps.slice(r.path.steps.length)}return r}fromNode(e,t,n){var r={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof t?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):"object"==typeof t&&(r.base=t),r.path=this.pathTo(e,null,n),r}filter(e,t){var n,r,i,o,a,s=!1;return 3===e.nodeType?(s=!0,i=e.parentNode,n=e.parentNode.classList.contains(t)):(s=!1,n=e.classList.contains(t)),n&&s?(o=i.previousSibling,a=i.nextSibling,o&&3===o.nodeType?r=o:a&&3===a.nodeType&&(r=a),r||e):!(n&&!s)&&e}patchOffset(e,t,n){if(3!=e.nodeType)throw new Error("Anchor must be a text node");var r=e,i=t;for(e.parentNode.classList.contains(n)&&(r=e.parentNode);r.previousSibling;){if(1===r.previousSibling.nodeType){if(!r.previousSibling.classList.contains(n))break;i+=r.previousSibling.textContent.length}else i+=r.previousSibling.textContent.length;r=r.previousSibling}return i}normalizedMap(e,t,n){var r,i,o,a={},s=-1,l=e.length;for(r=0;r<l;r++)1===(i=e[r].nodeType)&&e[r].classList.contains(n)&&(i=3),r>0&&3===i&&3===o?a[r]=s:t===i&&(s+=1,a[r]=s),o=i;return a}position(e){var t,n;return 1===e.nodeType?((t=e.parentNode.children)||(t=oa(e.parentNode)),n=Array.prototype.indexOf.call(t,e)):n=(t=this.textNodes(e.parentNode)).indexOf(e),n}filteredPosition(e,t){var n,r;return 1===e.nodeType?(n=e.parentNode.children,r=this.normalizedMap(n,1,t)):(n=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(n=(e=e.parentNode).parentNode.childNodes),r=this.normalizedMap(n,3,t)),r[Array.prototype.indexOf.call(n,e)]}stepsToXpath(e,t=!1){var n=["."];return t||n.push("*"),e.forEach((function(e){var t=e.index+1;e.id?n.push("*[position()="+t+" and @id='"+e.id+"']"):"text"===e.type?n.push("text()["+t+"]"):n.push("*["+t+"]")})),n.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach((function(e){var n=e.index+1;e.id?t.push("#"+e.id):"text"===e.type||t.push("*:nth-child("+n+")")})),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter((function(e){return 3===e.nodeType||!(!t||!e.classList.contains(t))}))}walkToNode(e,t,n,r){var i,o=t||document,a=r||o.documentElement;r=r||o;var s,l=e.length;for(s=0;s<l&&("element"===(i=e[s]).type?a=i.id?r.getRootNode({composed:!0}).getElementById(i.id):(a.children||oa(a))[i.index]:"text"===i.type&&(a=this.textNodes(a,n)[i.index]),a);s++);return a}findNode(e,t,n,r){var i,o,a=t||document;if(r=r||a,n||"undefined"==typeof XPathEvaluator)i=n?this.walkToNode(e,a,n,r):this.walkToNode(e,a,r);else{let t=new XPathEvaluator;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){o=this.stepsToXpath(e,!0);for(let e of r.childNodes)if(i=t.evaluate(o,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue)break}else o=this.stepsToXpath(e),i=t.evaluate(o,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}return i}fixMiss(e,t,n,r,i,o){i=i||n;var a,s,l=this.findNode(e.slice(0,-1),n,r,i),u=l.childNodes,c=this.normalizedMap(u,3,r),d=e[e.length-1].index;for(let e in c){if(!c.hasOwnProperty(e))return;if(o||c[e]===d){if(!(t>(s=(a=u[e]).textContent.length))){l=1===a.nodeType?a.childNodes[0]:a;break}t-=s}}return{container:l,offset:t}}toRange(e,t,n,r){var i,o,a,s,l,u=e||document;n=n||u;var c,d,h,p=this,f=!!t&&null!=n.querySelector("."+t);if(i=void 0!==u.createRange?u.createRange():new ua,p.range?(o=p.start,c=p.path.steps.concat(o.steps),s=this.findNode(c,u,f?t:null,n),a=p.end,d=p.path.steps.concat(a.steps),l=this.findNode(d,u,f?t:null,n)):(o=p.path,c=p.path.steps,s=this.findNode(p.path.steps,u,f?t:null,n)),!s)return console.log("No startContainer found for",this.toString()),null;try{null!=o.terminal.offset?i.setStart(s,o.terminal.offset):i.setStart(s,0)}catch(e){h=this.fixMiss(c,o.terminal.offset,u,f?t:null,n,r&&r.calibreCompat),i.setStart(h.container,h.offset)}if(l)try{null!=a.terminal.offset?i.setEnd(l,a.terminal.offset):i.setEnd(l,0)}catch(e){h=this.fixMiss(d,p.end.terminal.offset,u,f?t:null,n,r&&r.calibreCompat),i.setEnd(h.container,h.offset)}return i}isCfiString(e){return"string"==typeof e&&0===e.indexOf("epubcfi(")&&")"===e[e.length-1]}generateChapterComponent(e,t,n){var r="/"+2*(e+1)+"/";return r+=2*(parseInt(t)+1),n&&(r+="["+n+"]"),r}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}const ha=da,pa=class{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if("function"==typeof arguments[e])this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let n=0;n<this.hooks.length;n++)if(t=this.hooks[n],t===e){this.hooks.splice(n,1);break}}trigger(){var e=arguments,t=this.context,n=[];return this.hooks.forEach((function(r){try{var i=r.apply(t,e)}catch(e){console.log(e)}i&&"function"==typeof i.then&&n.push(i)})),Promise.all(n)}list(){return this.hooks}clear(){return this.hooks=[]}};function fa(e,t){var n,r,i=t.url,o=i.indexOf("://")>-1;e&&(r=Xo(e,"head"),(n=Xo(r,"base"))||(n=e.createElement("base"),r.insertBefore(n,r.firstChild)),!o&&window&&window.location&&(i=window.location.origin+i),n.setAttribute("href",i))}function ma(e,t){var n,r,i=t.canonical;e&&(n=Xo(e,"head"),(r=Xo(n,"link[rel='canonical']"))?r.setAttribute("href",i):((r=e.createElement("link")).setAttribute("rel","canonical"),r.setAttribute("href",i),n.appendChild(r)))}function ga(e,t){var n,r,i=t.idref;e&&(n=Xo(e,"head"),(r=Xo(n,"link[property='dc.identifier']"))?r.setAttribute("content",i):((r=e.createElement("meta")).setAttribute("name","dc.identifier"),r.setAttribute("content",i),n.appendChild(r)))}const va=[[null,"src"],[null,"href"],["http://www.w3.org/1999/xlink","href"],[null,"data"]],ya=function(e,t,n,r){var i,o="undefined"!=typeof window&&window.URL,a=o?"blob":"arraybuffer",s=new ra,l=new XMLHttpRequest,u=XMLHttpRequest.prototype;for(i in"overrideMimeType"in u||Object.defineProperty(u,"overrideMimeType",{value:function(){}}),n&&(l.withCredentials=!0),l.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e=!1;if(""!==this.responseType&&"document"!==this.responseType||(e=this.responseXML),200===this.status||0===this.status||e){var n;if(!this.response&&!e)return s.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),s.promise;if(403===this.status)return s.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),s.promise;n=e?this.responseXML:Ho(t)?Ko(this.response,"text/xml"):"xhtml"==t?Ko(this.response,"application/xhtml+xml"):"html"==t||"htm"==t?Ko(this.response,"text/html"):"json"==t?JSON.parse(this.response):"blob"==t?o?this.response:new Blob([this.response]):this.response,s.resolve(n)}else s.reject({status:this.status,message:this.response,stack:(new Error).stack})}},l.onerror=function(e){s.reject(e)},l.open("GET",e,!0),r)l.setRequestHeader(i,r[i]);return"json"==t&&l.setRequestHeader("Accept","application/json"),t||(t=new vo(e).extension),"blob"==t&&(l.responseType=a),Ho(t)&&l.overrideMimeType("text/xml"),"binary"==t&&(l.responseType="arraybuffer"),l.send(),s.promise},ba=class{constructor(e,t){this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.type=e.type,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new pa(this),this.hooks.content=new pa(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||ya,n=new ra,r=n.promise;if(this.contents)n.resolve(this.contents);else{let e;e=this.type&&this.type.includes("xml")?"xhtml":"text/html"===this.type?"html":null,t(this.url,e).then(function(e){return this.document=e,this.contents=e.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch((function(e){n.reject(e)}))}return r}base(){return fa(this.document,this)}render(e){var t=new ra,n=t.promise;return this.output,this.load(e).then(function(e){var t=new XMLSerializer;return this.output=t.serializeToString(e),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch((function(e){t.reject(e)})),n}find(e){var t=this,n=[],r=e.toLowerCase();return Jo(t.document,(function(e){!function(e){for(var i,o,a,s=e.textContent.toLowerCase(),l=t.document.createRange(),u=-1;-1!=o;)-1!=(o=s.indexOf(r,u+1))&&((l=t.document.createRange()).setStart(e,o),l.setEnd(e,o+r.length),i=t.cfiFromRange(l),a=e.textContent.length<150?e.textContent:"..."+(a=e.textContent.substring(o-75,o+75))+"...",n.push({cfi:i,excerpt:a})),u=o}(e)})),n}search(e,t=5){if(void 0===document.createTreeWalker)return this.find(e);let n=[];const r=this,i=e.toLowerCase(),o=function(e){const t=e.reduce(((e,t)=>e+t.textContent),"").toLowerCase().indexOf(i);if(-1!=t){const o=0,a=t+i.length;let s=0,l=0;if(t<e[o].length){let i;for(;s<e.length-1&&(l+=e[s].length,!(a<=l));)s+=1;let u=e[o],c=e[s],d=r.document.createRange();d.setStart(u,t);let h=e.slice(0,s).reduce(((e,t)=>e+t.textContent.length),0);d.setEnd(c,h>a?a:a-h),i=r.cfiFromRange(d);let p=e.slice(0,s+1).reduce(((e,t)=>e+t.textContent),"");p.length>150&&(p=p.substring(t-75,t+75),p="..."+p+"..."),n.push({cfi:i,excerpt:p})}}},a=document.createTreeWalker(r.document,NodeFilter.SHOW_TEXT,null,!1);let s,l=[];for(;s=a.nextNode();)l.push(s),l.length==t&&(o(l.slice(0,t)),l=l.slice(1,t));return l.length>0&&o(l),n}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach((function(e){var n,r,i=e.replace("rendition:",""),o=i.indexOf("-");-1!=o&&(n=i.slice(0,o),r=i.slice(o+1),t[n]=r)})),t}cfiFromRange(e){return new ha(e,this.cfiBase).toString()}cfiFromElement(e){return new ha(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}},_a=class{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new pa,this.hooks.content=new pa,this.hooks.content.register(fa),this.hooks.content.register(ma),this.hooks.content.register(ga),this.epubcfi=new ha,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,n){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach(((e,r)=>{var i,o=this.manifest[e.idref];e.index=r,e.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,e.index,e.id),e.href&&(e.url=t(e.href,!0),e.canonical=n(e.href)),o&&(e.href=o.href,e.url=t(e.href,!0),e.canonical=n(e.href),e.type=o.type,o.properties.length&&e.properties.push.apply(e.properties,o.properties)),"yes"===e.linear?(e.prev=function(){let t=e.index;for(;t>0;){let e=this.get(t-1);if(e&&e.linear)return e;t-=1}}.bind(this),e.next=function(){let t=e.index;for(;t<this.spineItems.length-1;){let e=this.get(t+1);if(e&&e.linear)return e;t+=1}}.bind(this)):(e.prev=function(){},e.next=function(){}),i=new ba(e,this.hooks),this.append(i)})),this.loaded=!0}get(e){var t=0;if(void 0===e)for(;t<this.spineItems.length;){let e=this.spineItems[t];if(e&&e.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new ha(e).spinePos:"number"==typeof e||!1===isNaN(e)?t=e:"string"==typeof e&&0===e.indexOf("#")?t=this.spineById[e.substring(1)]:"string"==typeof e&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;e.index=t,this.spineItems.push(e);try{this.spineByHref[decodeURIComponent(e.href)]=t,this.spineByHref[decodeURI(e.href)]=t}catch(e){}return this.spineByHref[encodeURIComponent(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach((function(e,t){e.index=t})),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each((e=>e.destroy())),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}},wa=class{constructor(e){this._q=[],this.context=e,this.tick=_o,this.running=!1,this.paused=!1}enqueue(){var e,t,n=[].shift.call(arguments),r=arguments;if(!n)throw new Error("No Task Provided");return t="function"==typeof n?{task:n,args:r,deferred:e=new ra,promise:e.promise}:{promise:n},this._q.push(t),0!=this.paused||this.running||this.run(),t.promise}dequeue(){var e,t,n;return!this._q.length||this.paused?((e=new ra).deferred.resolve(),e.promise):(t=(e=this._q.shift()).task)?(n=t.apply(this.context,e.args))&&"function"==typeof n.then?n.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,n),e.promise):e.promise?e.promise:void 0}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new ra),this.tick.call(window,(()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)})),1==this.paused&&(this.paused=!1),this.defered.promise}flush(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}},Sa="0.3",Ca="openFailed",Ea="changed";bo()(class{constructor(e,t,n){this.spine=e,this.request=t,this.pause=n||100,this.q=new wa(this),this.epubcfi=new ha,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var n=new ra,r=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(r),e.unload(),this.processingTimeout=setTimeout((()=>n.resolve(r)),this.pause),n.promise}.bind(this))}parse(e,t,n){var r,i,o=[],a=Xo(e.ownerDocument,"body"),s=0,l=n||this.break;if(Jo(a,function(e){var n,a=e.length,u=0;if(0===e.textContent.trim().length)return!1;for(0==s&&((r=this.createRange()).startContainer=e,r.startOffset=0),(n=l-s)>a&&(s+=a,u=a);u<a;)if(n=l-s,0===s&&(u+=1,(r=this.createRange()).startContainer=e,r.startOffset=u),u+n>=a)s+=a-u,u=a;else{u+=n,r.endContainer=e,r.endOffset=u;let i=new ha(r,t).toString();o.push(i),s=0}i=e}.bind(this)),r&&r.startContainer&&i){r.endContainer=i,r.endOffset=i.length;let e=new ha(r,t).toString();o.push(e),s=0}return o}generateFromWords(e,t,n){var r=e?new ha(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(e){e.linear&&(r?e.index>=r.spinePos&&this.q.enqueue(this.processWords.bind(this),e,t,r,n):this.q.enqueue(this.processWords.bind(this),e,t,r,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,n,r){return r&&this._locationsWords.length>=r?Promise.resolve():e.load(this.request).then(function(i){var o=new ra,a=this.parseWords(i,e,t,n),s=r-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=r?a.slice(0,s):a),e.unload(),this.processingTimeout=setTimeout((()=>o.resolve(a)),this.pause),o.promise}.bind(this))}countWords(e){return(e=(e=(e=e.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length}parseWords(e,t,n,r){var i,o=t.cfiBase,a=[],s=Xo(e.ownerDocument,"body"),l=n,u=!r||r.spinePos!==t.index;return r&&t.index===r.spinePos&&(i=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument)),Jo(s,function(e){if(!u){if(e!==i)return!1;u=!0}if(e.textContent.length<10&&0===e.textContent.trim().length)return!1;var t,n=this.countWords(e.textContent),r=0;if(0===n)return!1;for((t=l-this._wordCounter)>n&&(this._wordCounter+=n,r=n);r<n;)if(r+(t=l-this._wordCounter)>=n)this._wordCounter+=n-r,r=n;else{r+=t;let n=new ha(e,o);a.push({cfi:n.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}.bind(this)),a}locationFromCfi(e){let t;return ha.prototype.isCfiString(e)&&(e=new ha(e)),0===this._locations.length?-1:(t=Io(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(0===this._locations.length)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return e&&this.total?e/this.total:0}cfiFromLocation(e){var t=-1;return"number"!=typeof e&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let e=new ha(this._locations[this.total]);return e.collapse(),e.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return this._locations="string"==typeof e?JSON.parse(e):e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if("string"==typeof e)this._currentCfi=e;else{if("number"!=typeof e)return;this._current=e}0!==this._locations.length&&("string"==typeof e?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(Ea,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}.prototype);const xa=class{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(!(t=Xo(e,"rootfile")))throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=go().dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}},Aa=class{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,n,r;if(!e)throw new Error("Package File Not Found");if(!(t=Xo(e,"metadata")))throw new Error("No Metadata Found");if(!(n=Xo(e,"manifest")))throw new Error("No Manifest Found");if(!(r=Xo(e,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,r),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=Uo(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=r.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread");let n=e.querySelector("meta[name='primary-writing-mode']");return t.primary_writing_mode=n?n.getAttribute("content"):"",t}parseManifest(e){var t={},n=Zo(e,"item");return Array.prototype.slice.call(n).forEach((function(e){var n=e.getAttribute("id"),r=e.getAttribute("href")||"",i=e.getAttribute("media-type")||"",o=e.getAttribute("media-overlay")||"",a=e.getAttribute("properties")||"";t[n]={href:r,type:i,overlay:o,properties:a.length?a.split(" "):[]}})),t}parseSpine(e,t){var n=[],r=Zo(e,"itemref");return Array.prototype.slice.call(r).forEach((function(e,t){var r=e.getAttribute("idref"),i=e.getAttribute("properties")||"",o=i.length?i.split(" "):[],a={id:e.getAttribute("id"),idref:r,linear:e.getAttribute("linear")||"yes",properties:o,index:t};n.push(a)})),n}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var n=e.getElementById(t);return n&&"identifier"===n.localName&&"http://purl.org/dc/elements/1.1/"===n.namespaceURI&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Qo(e,"item",{properties:"nav"});return!!t&&t.getAttribute("href")}findNcxPath(e,t){var n,r=Qo(e,"item",{"media-type":"application/x-dtbncx+xml"});return r||(n=t.getAttribute("toc"))&&(r=e.querySelector(`#${n}`)),!!r&&r.getAttribute("href")}findCoverPath(e){Xo(e,"package").getAttribute("version");var t=Qo(e,"item",{properties:"cover-image"});if(t)return t.getAttribute("href");var n=Qo(e,"meta",{name:"cover"});if(n){var r=n.getAttribute("content"),i=e.getElementById(r);return i?i.getAttribute("href"):""}return!1}getElementText(e,t){var n,r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t);return r&&0!==r.length&&(n=r[0]).childNodes.length?n.childNodes[0].nodeValue:""}getPropertyText(e,t){var n=Qo(e,"meta",{property:t});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map(((e,t)=>(e.index=t,e.linear=e.linear||"yes",e))),e.resources.forEach(((e,t)=>{this.manifest[t]=e,e.rel&&"cover"===e.rel[0]&&(this.coverPath=e.href)})),this.spineNodeIndex=0,this.toc=e.toc.map(((e,t)=>(e.label=e.title,e))),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}},ka=class{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t,n,r=e.nodeType;r&&(t=Xo(e,"html"),n=Xo(e,"ncx")),r?t?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):n&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,n=0;n<e.length;n++)(t=e[n]).href&&(this.tocByHref[t.href]=n),t.id&&(this.tocById[t.id]=n),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(0===e.indexOf("#")?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,n){if(0===n.length)return;const r=n[t];if(!r||e!==r.id&&e!==r.href){let r;for(let i=0;i<n.length&&(r=this.getByIndex(e,t,n[i].subitems),!r);++i);return r}return r}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=ia(e,"nav","toc"),n=[];if(!t)return n;let r=sa(t,"ol",!0);return r?n=this.parseNavList(r):n}parseNavList(e,t){const n=[];if(!e)return n;if(!e.children)return n;for(let r=0;r<e.children.length;r++){const i=this.navItem(e.children[r],t);i&&n.push(i)}return n}navItem(e,t){let n=e.getAttribute("id")||void 0,r=sa(e,"a",!0)||sa(e,"span",!0);if(!r)return;let i=r.getAttribute("href")||"";n||(n=i);let o=r.textContent||"",a=[],s=sa(e,"ol",!0);return s&&(a=this.parseNavList(s,n)),{id:n,href:i,label:o,subitems:a,parent:t}}parseLandmarks(e){var t,n,r=ia(e,"nav","landmarks"),i=r?Zo(r,"li"):[],o=i.length,a=[];if(!i||0===o)return a;for(t=0;t<o;++t)(n=this.landmarkItem(i[t]))&&(a.push(n),this.landmarksByType[n.type]=t);return a}landmarkItem(e){let t=sa(e,"a",!0);if(!t)return;let n=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:t.getAttribute("href")||"",label:t.textContent||"",type:n}}parseNcx(e){var t,n,r=Zo(e,"navPoint"),i=r.length,o={},a=[];if(!r||0===i)return a;for(t=0;t<i;++t)o[(n=this.ncxItem(r[t])).id]=n,n.parent?o[n.parent].subitems.push(n):a.push(n);return a}ncxItem(e){var t,n=e.getAttribute("id")||!1,r=Xo(e,"content").getAttribute("src"),i=Xo(e,"navLabel"),o=i.textContent?i.textContent:"",a=e.parentNode;return!a||"navPoint"!==a.nodeName&&"navPoint"!==a.nodeName.split(":").slice(-1)[0]||(t=a.getAttribute("id")),{id:n,href:r,label:o,subitems:[],parent:t}}load(e){return e.map((e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e)))}forEach(e){return this.toc.forEach(e)}};var Da={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},Pa=function(){var e,t,n,r,i={};for(e in Da)if(Da.hasOwnProperty(e))for(t in Da[e])if(Da[e].hasOwnProperty(t))if("string"==typeof(n=Da[e][t]))i[n]=e+"/"+t;else for(r=0;r<n.length;r++)i[n[r]]=e+"/"+t;return i}();const Ta=function(e){return e&&Pa[e.split(".").pop().toLowerCase()]||"text/plain"},Fa=class{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map((function(t){return e[t]})),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.absoluteUrls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter((function(e){if("application/xhtml+xml"===e.type||"text/html"===e.type)return!0})),this.assets=this.resources.filter((function(e){if("application/xhtml+xml"!==e.type&&"text/html"!==e.type)return!0})),this.css=this.resources.filter((function(e){if("text/css"===e.type)return!0}))}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.absoluteUrls=this.urls.map((e=>this.settings.resolver(e))),this.cssUrls=this.css.map((function(e){return e.href}))}createUrl(e){var t=new ca(e),n=Ta(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(e,"blob").then((e=>na(e))).then((e=>Go(e,n))):this.settings.request(e,"blob").then((e=>jo(e,n)))}replacements(){if("none"===this.settings.replacements)return new Promise(function(e){e(this.urls)}.bind(this));var e=this.urls.map((e=>{var t=this.settings.resolver(e);return this.createUrl(t).catch((e=>(console.error(e),null)))}));return Promise.all(e).then((e=>(this.replacementUrls=e.filter((e=>"string"==typeof e)),e)))}replaceCss(e,t){var n=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach(function(r){var i=this.createCssFile(r,e,t).then(function(e){var t=this.urls.indexOf(r);t>-1&&(this.replacementUrls[t]=e)}.bind(this));n.push(i)}.bind(this)),Promise.all(n)}createCssFile(e){if(go().isAbsolute(e))return new Promise((function(e){e()}));var t,n=this.settings.resolver(e);t=this.settings.archive?this.settings.archive.getText(n):this.settings.request(n,"text");var r=this.urls.map((e=>{var t=this.settings.resolver(e);return new vo(n).relative(t)}));return t?t.then((e=>(e=function(e,t,n){return t.forEach(((t,r)=>{t&&n[r]&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=e.replace(new RegExp(t,"g"),n[r]))})),e}(e,r,this.replacementUrls),"base64"===this.settings.replacements?Go(e,"text/css"):jo(e,"text/css"))),(e=>new Promise((function(e){e()})))):new Promise((function(e){e()}))}relativeTo(e,t){t=t||this.settings.resolver;let n=new vo(e);return this.urls.map(function(e){var r=t(e);return n.relative(r)}.bind(this))}get(e){var t=this.urls.indexOf(e);if(-1!==t)return this.replacementUrls.length?new Promise(function(e,n){e(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){let n=new vo(t);return function(e,t,n,r){let i=new Map;for(let[e,r]of t.entries()){let t=n[e];if(r&&t){try{r=decodeURIComponent(r)}catch(e){}i.set(r,t)}}function o(e,t,n){let o=e.getAttributeNS(t,n);o&&(o=r.resolve(o),(i.has(o)||(o=decodeURIComponent(o),i.has(o)))&&(o=i.get(o),e.setAttributeNS(t,n,o)))}let a,s=e.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,(e=>va.some((([t,n])=>e.hasAttributeNS(t,n)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP));for(;a=s.nextNode();)try{for(let[e,t]of va)o(a,e,t)}catch(e){console.error(e)}return e}(e,this.absoluteUrls,this.replacementUrls,n)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}};var Ra=r(2502),Ia=r.n(Ra);const Oa=class{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new(Ia())}catch(e){throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return ya(e,"binary").then(function(e){return this.zip.loadAsync(e,{base64:t})}.bind(this))}request(e,t){var n,r=new ra,i=new vo(e);return t||(t=i.extension),(n="blob"==t?this.getBlob(e):this.getText(e))?n.then(function(e){let n=this.handleResponse(e,t);r.resolve(n)}.bind(this)):r.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),r.promise}handleResponse(e,t){var n;return"json"==t?n=JSON.parse(e):Ho(t)?n=Ko(e,"text/xml"):"xhtml"==t?(n=Ko(e,"application/xhtml+xml")).getElementsByTagName("parsererror").length&&(console.warn("XHTML parse error! Retrying as text/html"),Yo(n=Ko(e,"text/html"))):"html"==t||"htm"==t?Yo(n=Ko(e,"text/html")):n=e,n}getBlob(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return t=t||Ta(r.name),r.async("uint8array").then((function(e){return new Blob([e],{type:t})}))}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return r.async("string").then((function(e){return e}))}getBase64(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return t=t||Ta(r.name),r.async("base64").then((function(e){return"data:"+t+";base64,"+e}))}createUrl(e,t){var n,r,i=new ra,o=window.URL||window.webkitURL||window.mozURL,a=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(a?(r=this.getBase64(e))&&r.then(function(t){this.urlCache[e]=t,i.resolve(t)}.bind(this)):(r=this.getBlob(e))&&r.then(function(t){n=o.createObjectURL(t),this.urlCache[e]=n,i.resolve(n)}.bind(this)),r||i.reject({message:"File not found in the epub: "+e,stack:(new Error).stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}},Ba=class{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=Xo(e,"display_options");return t?(Zo(t,"option").forEach((e=>{let t="";switch(e.childNodes.length&&(t=e.childNodes[0].nodeValue),e.attributes.name.value){case"interactive":this.interactive=t;break;case"fixed-layout":this.fixedLayout=t;break;case"open-to-spread":this.openToSpread=t;break;case"orientation-lock":this.orientationLock=t}})),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}},Ma="META-INF/container.xml",La="binary",Na="base64",Va="epub",za="json";class Ua{constructor(e,t){void 0===t&&"string"!=typeof e&&e instanceof Blob==0&&e instanceof ArrayBuffer==0&&(t=e,e=void 0),this.settings=Fo(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0}),Fo(this.settings,t),this.opening=new ra,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new ra,spine:new ra,metadata:new ra,cover:new ra,navigation:new ra,resources:new ra,displayOptions:new ra},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||ya,this.spine=new _a,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,e&&this.open(e,this.settings.openAs).catch((t=>{var n=new Error("Cannot load book at "+e);this.emit(Ca,n)}))}open(e,t){var n,r=t||this.determineType(e);return r===La?(this.archived=!0,this.url=new ca("/",""),n=this.openEpub(e)):r===Na?(this.archived=!0,this.url=new ca("/",""),n=this.openEpub(e,r)):r===Va?(this.archived=!0,this.url=new ca("/",""),n=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):"opf"==r?(this.url=new ca(e),n=this.openPackaging(this.url.Path.toString())):r==za?(this.url=new ca(e),n=this.openManifest(this.url.Path.toString())):(this.url=new ca(e),n=this.openContainer(Ma).then(this.openPackaging.bind(this))),n}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then((()=>this.openContainer(Ma))).then((e=>this.openPackaging(e)))}openContainer(e){return this.load(e).then((e=>(this.container=new xa(e),this.resolve(this.container.packagePath))))}openPackaging(e){return this.path=new vo(e),this.load(e).then((e=>(this.packaging=new Aa(e),this.unpack(this.packaging))))}openManifest(e){return this.path=new vo(e),this.load(e).then((e=>(this.packaging=new Aa,this.packaging.load(e),this.unpack(this.packaging))))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var n=e;return e.indexOf("://")>-1?e:(this.path&&(n=this.path.resolve(e)),0!=t&&this.url&&(n=this.url.resolve(n)),n)}}canonical(e){return e?this.settings.canonical?this.settings.canonical(e):this.resolve(e,!0):""}determineType(e){var t;return"base64"===this.settings.encoding?Na:"string"!=typeof e?La:((t=new ca(e).path().extension)&&(t=t.replace(/\?.*$/,"")),t?"epub"===t?Va:"opf"===t?"opf":"json"===t?za:void 0:"directory")}unpack(e){this.package=e,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then((e=>{this.displayOptions=new Ba(e),this.loading.displayOptions.resolve(this.displayOptions)})).catch((e=>{this.displayOptions=new Ba,this.loading.displayOptions.resolve(this.displayOptions)})):(this.displayOptions=new Ba,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new Fa(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then((()=>{this.loading.navigation.resolve(this.navigation)})),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then((()=>{this.loaded.displayOptions.then((()=>{this.opening.resolve(this)}))})).catch((e=>{console.error(e)})):this.loaded.displayOptions.then((()=>{this.opening.resolve(this)}))}loadNavigation(e){let t=e.navPath||e.ncxPath,n=e.toc;return n?new Promise(((e,t)=>{this.navigation=new ka(n),e(this.navigation)})):t?this.load(t,"xml").then((e=>(this.navigation=new ka(e),this.navigation))):new Promise(((e,t)=>{this.navigation=new ka,e(this.navigation)}))}section(e){return this.spine.get(e)}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new Oa,this.archive.open(e,t)}coverUrl(){return this.loaded.cover.then((()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null))}replacements(){return this.spine.hooks.content.register(((e,t)=>{this.resources.substitute(e,t.url)})),this.resources.replacements().then((()=>this.resources.replaceCss()))}getRange(e){var t=new ha(e),n=this.spine.get(t.spinePos),r=this.load.bind(this);return n?n.load(r).then((function(e){return t.toRange(n.document)})):new Promise(((e,t)=>{t("CFI could not be found")}))}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${Sa}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}bo()(Ua.prototype);const Ha=Ua;function Wa(e,t){return new Ha(e,t)}Wa.VERSION=Sa,void 0!==r.g&&(r.g.EPUBJS_VERSION=Sa),Wa.Book=Ha,Wa.CFI=ha,Wa.utils=e;const ja=Wa;function $a(e){let t=e.ownerDocument.createNodeIterator(e,NodeFilter.SHOW_TEXT),n=[],r=null;for(;r=t.nextNode();)n.push(r);return n}function Ga(e){return $a(e).filter((e=>{let t=Ka(e);return!!t&&!t.closest("style, script")}))}function qa(e){return!!e&&"object"==typeof e&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function Ka(e){let t=e;for(;t&&!qa(t);)t=t.parentNode;return t}const Ya=new Set(["block","list-item","table-cell","table","flex"]),Xa=new Set(["DIV","P","LI","OL","UL","TABLE","THEAD","TBODY","TR","TD","TH","DL","DT","DD","FORM","FIELDSET","SECTION","HEADER","FOOTER","ASIDE","NAV","ARTICLE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ASIDE","NAV","ARTICLE"]);function Za(e){let t=getComputedStyle(e).display;return t&&Ya.has(t)||Xa.has(e.tagName)}function Qa(e){let t=e;for(;t;){if(Za(t))return t;t=t.parentElement}return null}function Ja(e){return{[Symbol.iterator]:function*(){let t;for(;t=e.nextNode();)yield t}}}function es(e){let t=Ka(e);return!!t&&("rtl"===getComputedStyle(t).direction||getComputedStyle(t).writingMode.endsWith("-rl"))}function ts(e){let t=Ka(e);return!!t&&getComputedStyle(t).writingMode.startsWith("vertical-")}class ns{constructor(e){this.startContainer=e.startContainer,this.startOffset=e.startOffset,this.endContainer=e.endContainer,this.endOffset=e.endOffset}compareBoundaryPoints(e,t){return this.toRange().compareBoundaryPoints(e,t instanceof ns?t.toRange():t)}getClientRects(){return this.toRange().getClientRects()}getBoundingClientRect(){return this.toRange().getBoundingClientRect()}toRange(){let e=new Range;return e.setStart(this.startContainer,this.startOffset),e.setEnd(this.endContainer,this.endOffset),e}toString(){return this.toRange().toString()}}function rs(e){let t=e.commonAncestorContainer.ownerDocument;if((e=e.cloneRange()).startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&e.startContainer.nodeType===Node.ELEMENT_NODE&&"IMG"===e.startContainer.childNodes[e.startOffset].nodeName)return e;if(e.startContainer.nodeType!==Node.TEXT_NODE){let n=e.startContainer.childNodes.length?e.startContainer.childNodes[Math.max(e.startOffset,0)]:null;if(!n||n.nodeType!==Node.TEXT_NODE){let r=t.createTreeWalker(t,NodeFilter.SHOW_TEXT);r.currentNode=n||e.startContainer,n=r.nextNode()}if(n){let t=0;if(n.nodeValue)for(;t<n.nodeValue.length&&"\n"==n.nodeValue.charAt(t);)t++;e.setStart(n,t)}}if(e.endContainer.nodeType!==Node.TEXT_NODE){let n=e.endContainer.childNodes.length?e.endContainer.childNodes[Math.min(e.endOffset-1,e.endContainer.childNodes.length-1)]:null;if(!n||n.nodeType!==Node.TEXT_NODE){let r=t.createTreeWalker(n||e.endContainer,NodeFilter.SHOW_TEXT);for(let e of Ja(r))n=e}if(n){let t=0;if(n.nodeValue)for(t=n.nodeValue.length;t>0&&"\n"==n.nodeValue.charAt(t-1);)t--;e.setEnd(n,t)}}return dr&&cr()&&e.endContainer.nodeType===Node.TEXT_NODE&&e.endOffset>0&&/\s/.test(e.endContainer.nodeValue.charAt(e.endOffset-1))&&e.setEnd(e.endContainer,e.endOffset-1),e}function is(e){let t=e.commonAncestorContainer.ownerDocument;if(!t)return[];let n=t.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT,(t=>e.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP)),r=[],i=n.currentNode;for(;i;){if(!i.nodeValue){i=n.nextNode();continue}let t=document.createRange();t.setStart(i,e.startContainer==i?e.startOffset:0),t.setEnd(i,e.endContainer==i?e.endOffset:i.nodeValue.length),r.push(t),i=n.nextNode()}return r}function os(...e){if(!e.length)return document.createRange();let t=e[0].cloneRange();for(let n=1;n<e.length;n++){let r=e[n];t.comparePoint(r.startContainer,r.startOffset)<0&&t.setStart(r.startContainer,r.startOffset),t.comparePoint(r.endContainer,r.endOffset)>0&&t.setEnd(r.endContainer,r.endOffset)}return t}function as(){return"function"==typeof document.caretPositionFromPoint||"function"==typeof document.caretRangeFromPoint}function ss(e,t,n){e.body.classList.add("force-enable-selection-everywhere");try{if("function"==typeof e.caretPositionFromPoint)return e.caretPositionFromPoint(t,n);if("function"==typeof e.caretRangeFromPoint){const r=e.caretRangeFromPoint(t,n);return r?{offsetNode:r.startContainer,offset:r.startOffset,getClientRect:()=>r.getBoundingClientRect()}:null}return null}finally{e.body.classList.remove("force-enable-selection-everywhere")}}function ls(e){let t=e.startContainer;for(;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.parentNode;return t}function us(e){var t,n,r;let i=e.getBoundingClientRect(),o=null===(t=("ownerDocument"in e?e:e.startContainer).ownerDocument)||void 0===t?void 0:t.defaultView;return i.x+=null!==(n=null==o?void 0:o.scrollX)&&void 0!==n?n:0,i.y+=null!==(r=null==o?void 0:o.scrollY)&&void 0!==r?r:0,i}function cs(e){var t;let n=e.getClientRects(),r=null===(t=("ownerDocument"in e?e:e.startContainer).ownerDocument)||void 0===t?void 0:t.defaultView;for(let e of n){var i,o;e.x+=null!==(i=null==r?void 0:r.scrollX)&&void 0!==i?i:0,e.y+=null!==(o=null==r?void 0:r.scrollY)&&void 0!==o?o:0}return n}let ds=function(e){return e.EPUB3="http://www.idpf.org/epub/linking/cfi/epub-cfi.html",e}({});function hs(e,t){e=rs(e);let n=t.ownerDocument.createNodeIterator(t,NodeFilter.SHOW_TEXT),r={type:"TextPositionSelector"},i=0;for(let t of Ja(n))t===e.startContainer&&(r.start=i+e.startOffset),t===e.endContainer&&(r.end=i+e.endOffset),t.nodeValue&&(i+=t.nodeValue.length);return void 0===r.start||void 0===r.end?null:r}function ps(e,t){let n=t.ownerDocument.createNodeIterator(t,NodeFilter.SHOW_TEXT),r=t.ownerDocument.createRange(),i=0;for(let t of Ja(n)){if(!t.nodeValue)continue;let n=e.start-i;n>=0&&n<=t.nodeValue.length&&r.setStart(t,n);let o=e.end-i;o>=0&&o<=t.nodeValue.length&&r.setEnd(t,o),i+=t.nodeValue.length}return r}function fs(e){let t="",n=[];for(let r of e){let e=r.data.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"');n.push({charData:r,start:t.length,end:t.length+e.length-1}),t+=e}return{text:t,charDataRanges:n}}const ms=class{constructor(e){n(this,"_pos",null),n(this,"_initialPos",null),n(this,"_worker",null),n(this,"_cancelled",!1),this.findState=e.findState,this._onSetFindState=e.onSetFindState,this._annotationKeyPrefix=e.annotationKeyPrefix,this._buf=[]}async run(e,t){t instanceof ns&&(t=t.toRange());let n=[],r={text:e.text,internalCharDataRanges:e.charDataRanges.map((e=>{let t=n.length;return n.push(e.charData),{charDataID:t,start:e.start,end:e.end}}))},i=await this._executeSearch(r,this.findState.query,{caseSensitive:this.findState.caseSensitive,entireWord:this.findState.entireWord});for(let e of i){let r=new Range;r.setStart(n[e.startCharDataID],e.startIndex),r.setEnd(n[e.endCharDataID],e.endIndex);let i=new ns(r),o={range:i,highlight:{type:"highlight",color:"rgba(180, 0, 170, 1)",text:"",key:"findResult_"+(this._annotationKeyPrefix||"")+"_"+this._buf.length,range:i}};null===this._initialPos&&t&&hl.compareBoundaryPoints(Range.START_TO_START,r,t)>=0&&(this._initialPos=this._buf.length),this._buf.push(o)}this._setFindState()}cancel(){this._worker&&(this._worker.terminate(),this._worker=null),this._cancelled=!0}prev(e=!0){if(null===this._pos)null===this._initialPos?this._pos=this._buf.length-1:(this._pos=this._initialPos,this._initialPos=null);else if(this._pos--,e)this._pos%=this._buf.length,this._pos<0&&(this._pos=this._buf.length-1);else if(this._pos<0)return this._pos=0,null;return this._setFindState(),this.current}next(e=!0){if(null===this._pos)null===this._initialPos?this._pos=0:(this._pos=this._initialPos,this._initialPos=null);else if(this._pos++,e)this._pos%=this._buf.length;else if(this._pos>=this._buf.length)return this._pos=this._buf.length-1,null;return this._setFindState(),this.current}get position(){return this._pos}set position(e){this._pos=e,this._setFindState()}get initialPosition(){return this._initialPos}get current(){return null===this._pos||this._pos<0||this._pos>=this._buf.length?null:this._buf[this._pos]}getResults(){return this._buf}getAnnotations(){let e=null!==this._pos&&this._pos>=0&&this._pos<this._buf.length?this._buf[this._pos]:null,t=[];if(this.findState.highlightAll)for(let n of this._buf)e===n?t.push({...n.highlight,color:"rgba(0, 100, 0, 1)"}):t.push(n.highlight);else e&&t.push({...e.highlight,color:"rgba(0, 100, 0, 1)"});return t}getSnippets(){return this._buf.map((({range:e})=>{let t=e.toString();if(e.startContainer.nodeValue&&e.startOffset>0){let n=e.startContainer.nodeValue.substring(0,e.startOffset),r=n.match(/\b([\w\W]){1,40}$/);r&&(t=r[0].trimStart()+t,r[0]!=n&&(t=""+t))}if(e.endContainer.nodeValue&&e.endOffset<e.endContainer.nodeValue.length){let n=e.endContainer.nodeValue.substring(e.endOffset),r=n.match(/^([\w\W]){1,40}\b/);r&&(t+=r[0].trimEnd(),r[0]!=n&&(t+=""))}return t}))}_executeSearch(e,t,n){if(this._worker)throw new Error("Search is already running");let i=new Worker(new URL(r.p+r.u(131),r.b)),o=new Promise(((e,t)=>{i.onmessage=t=>{e(t.data)},i.onerror=e=>{t(e.error)}}));return i.postMessage({context:e,term:t,options:n}),this._worker=i,o}_setFindState(){var e;this._cancelled||this._onSetFindState&&this._onSetFindState({total:this._buf.length,index:null===this._pos?0:this._pos,snippets:this.getSnippets(),range:null===(e=this.current)||void 0===e?void 0:e.range})}};class gs{constructor(e){n(this,"_processors",[]),n(this,"_processorPromises",[]),n(this,"_selectedProcessor",null),n(this,"_totalResults",0),n(this,"_cancelled",!1),this.view=e.view,this.findState=e.findState,this._onSetFindState=e.onSetFindState}async run(e,t){var n,r;this._cancelled=!1;let i=null!==(n=null===(r=this.view.flow.startSection)||void 0===r?void 0:r.index)&&void 0!==n?n:0;for(let n=i;n<i+this.view.renderers.length;n++){let r=this.view.renderers[n%this.view.renderers.length],i=await this._getOrCreateProcessor(r,this._selectedProcessor?void 0:e);if(this._cancelled)return;this._selectedProcessor===i&&(null==t||t())}}cancel(){for(let e of this._processors)null==e||e.cancel();this._cancelled=!0}async prev(){if(this._selectedProcessor){if(this._selectedProcessor.prev(!1))return this.updateFindState(),this._selectedProcessor.current;this.updateFindState(),this._selectedProcessor.position=null}let e=this._selectedProcessor?this._processors.indexOf(this._selectedProcessor)-1:-1;e<0&&(e+=this.view.renderers.length),this._selectedProcessor=await this._getOrCreateProcessor(this.view.renderers[e]),this._selectedProcessor.position=null;let t=this._selectedProcessor;do{if(this._selectedProcessor.getResults().length){let e=this._selectedProcessor.prev(!1);return this.updateFindState(),e}e--,e<0&&(e+=this.view.renderers.length),this._selectedProcessor=await this._getOrCreateProcessor(this.view.renderers[e])}while(this._selectedProcessor!==t);return null}async next(){if(this._selectedProcessor){if(this._selectedProcessor.next(!1))return this.updateFindState(),this._selectedProcessor.current;this.updateFindState(),this._selectedProcessor.position=null}let e=this._selectedProcessor?this._processors.indexOf(this._selectedProcessor)+1:0;e%=this.view.renderers.length,this._selectedProcessor=await this._getOrCreateProcessor(this.view.renderers[e]),this._selectedProcessor.position=null;let t=this._selectedProcessor;do{if(this._selectedProcessor.getResults().length){let e=this._selectedProcessor.next(!1);return this.updateFindState(),e}e++,e%=this.view.renderers.length,this._selectedProcessor=await this._getOrCreateProcessor(this.view.renderers[e])}while(this._selectedProcessor!==t);return null}getAnnotations(){let e=[];for(let[n,r]of this._processors.entries()){var t;if(r&&null!==(t=this.view.renderers[n])&&void 0!==t&&t.mounted){r.findState.highlightAll=this.findState.highlightAll;for(let t of r.getAnnotations())e.push(t)}}return e}_getOrCreateProcessor(e,t){let n=e.section.index;return void 0!==this._processorPromises[n]?this._processorPromises[n]:this._processorPromises[n]=(async()=>{if(void 0!==this._processors[n])return this._processors[n];let r=new ms({findState:this.findState,annotationKeyPrefix:"section"+n});return await r.run(e.searchContext,t),this._processors[n]=r,this._selectedProcessor||null===r.initialPosition||(this._selectedProcessor=r),this._totalResults+=r.getResults().length,this.updateFindState(),r})()}updateFindState(){if(!this._cancelled&&this._onSetFindState){let n,r=0,i=!1,o=[];for(let a of this._processors)if(a){if(this._selectedProcessor)if(this._selectedProcessor==a){var e,t;let o=null!==(e=a.position)&&void 0!==e?e:0;r+=o,i=!0,n=null===(t=a.getAnnotations()[o])||void 0===t?void 0:t.range}else i||(r+=a.getResults().length);o.push(...a.getSnippets())}this._onSetFindState({total:this._totalResults,index:r,snippets:o,range:n})}}}const vs=class{constructor(e){n(this,"_handlePointerMove",(()=>{this._outside=!0})),this._open=e.open,this._openingTimeout=null,this._lastRef=null,this._outside=!1,window.addEventListener("pointermove",this._handlePointerMove)}destroy(){window.removeEventListener("pointermove",this._handlePointerMove)}setOpen(e){this._open=e}open(e,t){this._outside=!1,this._closingTimeout&&(clearTimeout(this._closingTimeout),this._closingTimeout=null),this._openingTimeout&&this._lastRef===e||(this._openingTimeout&&clearTimeout(this._openingTimeout),this._openingTimeout=setTimeout((()=>{this._openingTimeout=null,this._outside||t(),this._closingTimeout&&(clearTimeout(this._closingTimeout),this._closingTimeout=null)}),100))}close(e){this._outside=!1,this._openingTimeout&&(clearTimeout(this._openingTimeout),this._openingTimeout=null),this._open&&(this._closingTimeout||(this._closingTimeout=setTimeout((()=>{this._closingTimeout=null,this._outside||e()}),500)))}};function ys(e){let t=Math.min(...e.map((e=>e.left))),n=Math.min(...e.map((e=>e.top))),r=Math.max(...e.map((e=>e.right))),i=Math.max(...e.map((e=>e.bottom)));return new DOMRect(t,n,r-t,i-n)}function bs(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}function _s(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function ws(e,t,n=50){return _s(e,{left:t.scrollX-n,right:t.scrollX+t.innerWidth+n,top:t.scrollY-n,bottom:t.scrollY+t.innerHeight+n})}const Ss=e=>{let{iframe:t,annotations:n,selectedAnnotationIDs:r,onPointerDown:i,onPointerUp:a,onContextMenu:s,onDragStart:l,onResizeStart:u,onResizeEnd:c}=e,[d,h]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1),[m,g]=(0,o.useState)(!1),v=d||p||m;(0,o.useEffect)((()=>{const e=t.contentWindow;if(!e)return;let n=e=>{g(e.altKey),0!=e.button||e.composedPath()[0].closest(".annotation-container")||f(!0)},r=e=>{g(e.altKey),0==e.button&&f(!1)},i=e=>{"Alt"==e.key&&g(!0)},o=e=>{"Alt"==e.key&&g(!1)};return e.addEventListener("pointerdown",n,{passive:!0}),e.addEventListener("pointerup",r,{passive:!0}),e.addEventListener("keydown",i,{capture:!0,passive:!0}),e.addEventListener("keyup",o,{capture:!0,passive:!0}),window.addEventListener("keydown",i,{capture:!0,passive:!0}),window.addEventListener("keyup",o,{capture:!0,passive:!0}),()=>{e.removeEventListener("pointerdown",n),e.removeEventListener("pointerup",r),e.removeEventListener("keydown",i,{capture:!0}),e.removeEventListener("keyup",o,{capture:!0}),window.removeEventListener("keydown",i,{capture:!0}),window.removeEventListener("keyup",o,{capture:!0})}}),[t.contentWindow]);let y=(0,o.useCallback)(((e,t)=>{i(e.id,t)}),[i]),b=(0,o.useCallback)(((e,t)=>{a(e.id,t)}),[a]),_=(0,o.useCallback)(((e,t)=>{s(e.id,t)}),[s]),w=(0,o.useCallback)(((e,t)=>{l(e.id,t)}),[l]),S=(0,o.useCallback)((e=>{h(!0),u(e.id)}),[u]),C=(0,o.useCallback)(((e,t,n)=>{h(!1),c(e.id,t,n)}),[c]),E=(0,o.useRef)(null),x=[],A=0,k=[],D=[];for(let e of n)"highlight"===e.type||"underline"===e.type?e.id&&r.includes(e.id)?(x.push(e),A++):x.splice(x.length-A,0,e):"note"==e.type&&(e.id?k.push(e):D.push(e));return o.createElement(o.Fragment,null,o.createElement("svg",{className:Tt()("annotation-container blended",{"disable-pointer-events":v})},x.map((e=>e.id?o.createElement(Cs,{annotation:e,key:e.key,selected:r.includes(e.id),singleSelection:1==r.length,onPointerDown:y,onPointerUp:b,onContextMenu:_,onDragStart:w,onResizeStart:S,onResizeEnd:C,widgetContainer:E.current}):o.createElement("g",{className:"disable-pointer-events",key:e.key},o.createElement(Cs,{annotation:e,selected:!1,singleSelection:!1,widgetContainer:E.current})))),D.map((e=>o.createElement(xs,{annotation:e,key:e.key})))),o.createElement("svg",{className:Tt()("annotation-container",{"disable-pointer-events":v}),ref:E},o.createElement(As,{annotations:k,selectedAnnotationIDs:r,onPointerDown:y,onPointerUp:b,onContextMenu:_,onDragStart:w})))};Ss.displayName="AnnotationOverlay";let Cs=e=>{let{annotation:t,selected:n,singleSelection:r,onPointerDown:i,onPointerUp:a,onContextMenu:s,onDragStart:l,onResizeStart:u,onResizeEnd:c,widgetContainer:d}=e,[h,p]=(0,o.useState)(!1),[f,m]=(0,o.useState)(t.range),g=(0,o.useRef)(null),v=(0,o.useRef)(null),y=hr?g:v,b=(0,o.useCallback)((e=>{null==i||i(t,e)}),[t,i]),_=(0,o.useCallback)((e=>{null==a||a(t,e)}),[t,a]),w=(0,o.useCallback)((e=>{null==s||s(t,e)}),[t,s]),S=(0,o.useCallback)((e=>{if(!l||void 0===t.text)return;let n=y.current;if(n){let t=n.getBoundingClientRect();e.dataTransfer.setDragImage(n,e.clientX-t.left,e.clientY-t.top)}l(t,e.dataTransfer)}),[t,y,l]),C=(0,o.useCallback)((e=>{p(!0),m(e.range),null==u||u(e)}),[u]),E=(0,o.useCallback)(((e,t)=>{p(!1),null==c||c(e,f,t)}),[c,f]),x=(0,o.useCallback)(((e,t)=>{m(t)}),[]),A=n&&r&&!t.readOnly&&as();(0,o.useEffect)((()=>{!A&&h&&E(t,!0)}),[A,t,E,h]);let{rects:k,interactiveRects:D,commentIconPosition:P}=(0,o.useMemo)((()=>{let e,n=is(h?f:t.range),r=new Map,i=new Set;for(let e of n){var o;let t=null===(o=e.startContainer.parentElement)||void 0===o?void 0:o.closest("a, area");for(let n of cs(e)){if(0==n.width||0==n.height)continue;let e=JSON.stringify(n);r.has(e)||(r.set(e,n),t&&i.add(n))}}if(t.comment){let t=n[0].cloneRange();!function(e){var t;e.startContainer.nodeValue&&(null===(t=e.startContainer.nodeValue)||void 0===t?void 0:t.length)>e.startOffset?e.setEnd(e.startContainer,e.startOffset+1):e.collapse(!0)}(t);let r=us(t);e={x:r.x,y:r.y}}else e=null;return{rects:r,interactiveRects:i,commentIconPosition:e}}),[t,h,f]),T=ts(t.range.commonAncestorContainer),F=es(t.range.commonAncestorContainer),R="underline"===t.type,I=(0,o.useMemo)((()=>o.createElement("g",{ref:v},[...k.entries()].map((([e,t])=>o.createElement("rect",{x:T&&R?t.x+(F?-3:t.width):t.x,y:!T&&R?t.y+t.height:t.y,width:T&&R?3:t.width,height:!T&&R?3:t.height,opacity:"50%",key:e}))))),[k,F,R,T]),O=(0,o.useMemo)((()=>!h&&[...k.entries()].map((([e,n])=>o.createElement("foreignObject",{x:n.x,y:n.y,width:n.width,height:n.height,className:"needs-pointer-events",key:e+"-foreign"},o.createElement("div",{className:Tt()("annotation-div",{"disable-pointer-events":D.has(n)}),style:hr?{position:"absolute",top:`${n.y}px`,left:`${n.x}px`,width:`${n.width}px`,height:`${n.height}px`}:void 0,draggable:!0,onPointerDown:b,onPointerUp:_,onContextMenu:w,onDragStart:S,"data-annotation-id":t.id}))))),[t,w,S,b,_,D,h,k]),B=(0,o.useMemo)((()=>A&&o.createElement(Ps,{annotation:t,highlightRects:[...k.values()],onResizeStart:C,onResizeEnd:E,onResize:x})),[A,t,x,E,C,k]);return k.size?o.createElement(o.Fragment,null,o.createElement("g",{tabIndex:-1,"data-annotation-id":t.id,fill:t.color,ref:g},I,O,B),d&&(n&&!h||P)&&qn.createPortal(o.createElement(o.Fragment,null,n&&!h&&o.createElement(Ds,{range:t.range}),P&&o.createElement(Ts,Dt({},P,{color:t.color}))),d)):null};Cs.displayName="HighlightOrUnderline",Cs=(0,o.memo)(Cs);const Es=e=>{let{annotation:t,staggerIndex:n,selected:r,onPointerDown:i,onPointerUp:a,onContextMenu:s,onDragStart:l}=e,u=(0,o.useRef)(null),c=t.range.commonAncestorContainer.ownerDocument,d=(0,o.useCallback)((e=>{if(!l||void 0===t.comment)return;let n=u.current;if(n){let t=n.getBoundingClientRect();e.dataTransfer.setDragImage(n,e.clientX-t.left,e.clientY-t.top)}l(t,e.dataTransfer)}),[t,l]);if(!c||!c.defaultView)return null;let h=t.range.getBoundingClientRect();h.x+=c.defaultView.scrollX,h.y+=c.defaultView.scrollY;let p=es(t.range.commonAncestorContainer),f=15*(n||0),m=h.left+(p?-25:h.width+25)+(p?-1:1)*f,g=h.top+f;return o.createElement(Ts,{ref:u,annotation:t,x:m,y:g,color:t.color,opacity:t.id?"100%":"50%",selected:r,large:!0,tabIndex:-1,onPointerDown:i&&(e=>i(t,e)),onPointerUp:a&&(e=>a(t,e)),onContextMenu:s&&(e=>s(t,e)),onDragStart:d})};Es.displayName="Note";let xs=e=>{let{annotation:t}=e,n=t.range.commonAncestorContainer.ownerDocument;if(!n||!n.defaultView)return null;let r=t.range.getBoundingClientRect();return r.x+=n.defaultView.scrollX,r.y+=n.defaultView.scrollY,o.createElement(ks,{rect:r,preview:!0,key:t.key})};xs.displayName="NotePreview",xs=(0,o.memo)(xs);const As=e=>{let{annotations:t,selectedAnnotationIDs:n,onPointerDown:r,onPointerUp:i,onContextMenu:a,onDragStart:s}=e,l=new Map;return o.createElement(o.Fragment,null,t.map((e=>{let t=l.has(e.sortIndex)?l.get(e.sortIndex):0;return l.set(e.sortIndex,t+1),e.id?o.createElement(Es,{annotation:e,staggerIndex:t,key:e.key,selected:n.includes(e.id),onPointerDown:r,onPointerUp:i,onContextMenu:a,onDragStart:s}):o.createElement("div",{className:"disable-pointer-events",key:e.key},o.createElement(Es,{annotation:e,staggerIndex:t,key:e.key,selected:!1}))})))};As.displayName="StaggeredNotes";let ks=e=>{let{rect:t,preview:n}=e;return o.createElement("rect",{x:t.left-5,y:t.top-5,width:t.width+10,height:t.height+10,fill:"none",stroke:n?"#aaaaaa":"#6d95e0",strokeDasharray:"10 6",strokeWidth:2})};ks.displayName="SelectionBorder",ks=(0,o.memo)(ks,((e,t)=>{return n=e.rect,r=t.rect,n.left===r.left&&n.top===r.top&&n.right===r.right&&n.bottom===r.bottom&&e.preview===t.preview;var n,r}));let Ds=e=>{var t;let{range:n}=e,r=null===(t=Ka(n.commonAncestorContainer))||void 0===t?void 0:t.closest("[data-section-index]");if(r){let e=Array.from(cs(r)),t=Array.from(cs(n));return o.createElement(o.Fragment,null,e.filter((e=>ws(e,r.ownerDocument.defaultView))).map(((e,n)=>{let r=t.filter((t=>_s(t,e)));return r.length?o.createElement(ks,{rect:ys(r),key:n}):null})))}return o.createElement(ks,{rect:us(n)})};Ds.displayName="SelectionBorder";const Ps=e=>{let{annotation:t,highlightRects:n,onResize:r,onResizeEnd:i,onResizeStart:a}=e,[s,l]=(0,o.useState)(!1),[u,c]=(0,o.useState)(null),[d,h]=(0,o.useState)(null),p=(0,o.useCallback)((e=>{0===e.button&&(e.preventDefault(),e.target.setPointerCapture(e.pointerId))}),[]),f=(0,o.useCallback)((e=>{0===e.button&&s&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}),[s]),m=(0,o.useCallback)(((e,n)=>{l(n),c({elem:e.target,pointerId:e.pointerId}),a(t)}),[t,a]),g=(0,o.useCallback)((()=>{l(!1),u&&(c(null),h(null),i(t,!1))}),[t,i,u]),v=(0,o.useCallback)((e=>{"Escape"===e.key&&s&&u&&(u.elem.releasePointerCapture(u.pointerId),l(!1),c(null),i(t,!0))}),[u,i,t,s]);const y=t.range.commonAncestorContainer.ownerDocument,b=null==y?void 0:y.defaultView;(0,o.useEffect)((()=>{if(b)return b.addEventListener("keydown",v,!0),()=>b.removeEventListener("keydown",v,!0)}),[b,v]);let _=(0,o.useCallback)((e=>{let{clientX:n,clientY:i}=e,o="start"===s;if(hr){let t=e.target.getBoundingClientRect();n>=t.left&&n<=t.right&&(n=o?t.left-1:t.right+1)}let a=ss(e.view.document,n,i);if(a){var l;if(a.offsetNode.nodeType==Node.ELEMENT_NODE&&a.offsetNode.closest("svg"))return;let e=t.range.comparePoint(a.offsetNode,a.offset),n=t.range.cloneRange();if(o?e<=0?n.setStart(a.offsetNode,a.offset):(n.setStart(n.endContainer,n.endOffset),n.setEnd(a.offsetNode,a.offset)):e>=0?n.setEnd(a.offsetNode,a.offset):(n.setEnd(n.startContainer,n.startOffset),n.setStart(a.offsetNode,a.offset)),n.collapsed||!n.toString().trim().length||0==n.getClientRects().length||null!=y&&y.querySelector("[data-section-index]")&&(null===(l=Ka(n.commonAncestorContainer))||void 0===l||!l.closest("[data-section-index]")))return;let i=n.getBoundingClientRect();if(!i.width||!i.height)return;r(t,n)}b&&h(e)}),[t,y,r,s,b]);if((0,o.useEffect)((()=>{if(!b||!s||!d)return;let e=d.clientY<50?-10:d.clientY>=b.innerHeight-50?10:0;if(!e)return;b.scrollBy({top:e});let t=b.setInterval((()=>{b.scrollBy({top:e})}),20);return()=>b.clearInterval(t)}),[d,s,b]),(0,o.useEffect)((()=>{if(!b||!s||!d)return;let e=()=>{_(d)};return b.addEventListener("scroll",e),()=>b.removeEventListener("scroll",e)}),[_,d,s,b]),!n.length)return null;let w=ts(t.range.commonAncestorContainer),S=n[0],C=n[n.length-1];return o.createElement(o.Fragment,null,o.createElement("rect",{x:w?S.left:S.left-3,y:w?S.top-3:S.top,width:w?S.width:3,height:w?3:S.height,fill:t.color,className:Tt()("resizer inherit-pointer-events",{"resizer-vertical":w}),onPointerDown:p,onPointerUp:f,onPointerCancel:f,onPointerMove:"start"==s?e=>_(e):void 0,onGotPointerCapture:e=>m(e,"start"),onLostPointerCapture:g}),o.createElement("rect",{x:w?C.left:C.right,y:w?C.bottom:C.top,width:w?C.width:3,height:w?3:C.height,fill:t.color,className:Tt()("resizer inherit-pointer-events",{"resizer-vertical":w}),onPointerDown:p,onPointerUp:f,onPointerCancel:f,onPointerMove:"end"==s?e=>_(e):void 0,onGotPointerCapture:e=>m(e,"end"),onLostPointerCapture:g}))};Ps.displayName="Resizer";let Ts=o.forwardRef(((e,t)=>{var n,r,i;let a=e.large?24:14,s=e.x-a/2,l=e.y-a/2;return o.createElement(o.Fragment,null,o.createElement("svg",{color:e.color,opacity:e.opacity,x:s,y:l,width:a,height:a,viewBox:"0 0 24 24","data-annotation-id":null===(n=e.annotation)||void 0===n?void 0:n.id,ref:t},o.createElement(Ot,null)),e.selected&&o.createElement(ks,{rect:new DOMRect(s,l,a,a)}),o.createElement("foreignObject",{x:s,y:l,width:a,height:a,className:"needs-pointer-events",tabIndex:e.tabIndex,"data-annotation-id":null===(r=e.annotation)||void 0===r?void 0:r.id},o.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",className:"annotation-div",draggable:!0,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp,onContextMenu:e.onContextMenu,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,"data-annotation-id":null===(i=e.annotation)||void 0===i?void 0:i.id})))}));function Fs(e){let t=[];for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t}Ts.displayName="CommentIcon",Ts=(0,o.memo)(Ts);class Rs{constructor(e){this._onUpdate=e.onUpdate,this._onNavigate=e.onNavigate,this._backStack=[],this._forwardStack=[],this._currentLocation=null,this._lastPushIsTransient=!1,this._lastSaveTime=0}get canNavigateBack(){return this._backStack.length>0}get canNavigateForward(){return this._forwardStack.length>0}save(e,t=!1){_r(this._backStack.at(-1),e)||(t&&(this._lastPushIsTransient||this.canNavigateForward)||!this._lastPushIsTransient&&Date.now()-this._lastSaveTime<2e3?this._currentLocation=e:(null!==this._currentLocation&&this._backStack.push(this._currentLocation),this._currentLocation=e,this._forwardStack=[]),this._lastPushIsTransient=t,this._lastSaveTime=Date.now(),this._onUpdate())}navigateBack(){this.canNavigateBack&&(this._currentLocation&&this._forwardStack.push(this._currentLocation),this._currentLocation=this._backStack.pop(),this._onNavigate(this._currentLocation),this._onUpdate())}navigateForward(){this.canNavigateForward&&(this._currentLocation&&this._backStack.push(this._currentLocation),this._currentLocation=this._forwardStack.pop(),this._onNavigate(this._currentLocation),this._onUpdate())}}const Is=class{constructor(e){n(this,"MIN_SCALE",.6),n(this,"MAX_SCALE",1.8),n(this,"_annotations",[]),n(this,"_annotationsByID",new Map),n(this,"_displayedAnnotationCache",new WeakMap),n(this,"_boundingPageRectCache",new WeakMap),n(this,"_suspendHistorySaving",!1),n(this,"_highlightedPosition",null),n(this,"_pointerMovedWhileDown",!1),n(this,"_gotPointerUp",!1),n(this,"_handledPointerIDs",new Set),n(this,"_lastScrollTime",null),n(this,"_isCtrlKeyDown",!1),n(this,"_lastSelectionRange",null),n(this,"_iframeCoordScaleFactor",1),n(this,"_previewAnnotation",null),n(this,"_touchAnnotationStartPosition",null),n(this,"_draggingNoteAnnotation",null),n(this,"_resizingAnnotationID",null),n(this,"_lastPinchDistance",0),n(this,"_lastKeyboardFocusedAnnotationID",null),n(this,"scale",1),n(this,"_tryUseToolDebounced",Ti(this._tryUseTool.bind(this),500)),n(this,"_handleAnnotationContextMenu",((e,t)=>{if(this._selectionContainsPoint(t.clientX,t.clientY))return;t.preventDefault(),t.stopPropagation();let n=this._iframe.getBoundingClientRect();this._selectedAnnotationIDs.includes(e)?this._options.onOpenAnnotationContextMenu({ids:this._selectedAnnotationIDs,x:n.x+t.clientX*this._iframeCoordScaleFactor,y:n.y+t.clientY*this._iframeCoordScaleFactor,view:!0}):(this._options.onSelectAnnotations([e],t.nativeEvent),this._options.onOpenAnnotationContextMenu({ids:[e],x:n.x+t.clientX*this._iframeCoordScaleFactor,y:n.y+t.clientY*this._iframeCoordScaleFactor,view:!0}))})),n(this,"_handleAnnotationPointerDown",((e,t)=>{if(0==t.button){if(this._selectedAnnotationIDs.length){let e=this._getAnnotationsAtPoint(t.clientX,t.clientY);if(!e.length||this._selectedAnnotationIDs.some((t=>e.includes(t))))return;this._options.onSelectAnnotations([e[0]],t.nativeEvent),(this._options.mobile||1==this._selectedAnnotationIDs.length)&&this._openAnnotationPopup(this._annotationsByID.get(e[0]))}else{if(this._selectionContainsPoint(t.clientX,t.clientY))return;this._options.onSelectAnnotations([e],t.nativeEvent),(this._options.mobile||1==this._selectedAnnotationIDs.length)&&this._openAnnotationPopup(this._annotationsByID.get(e))}this._iframeDocument.body.focus(),this._lastKeyboardFocusedAnnotationID=null}this._handledPointerIDs.add(t.pointerId)})),n(this,"_handleAnnotationPointerUp",((e,t)=>{if(this._handledPointerIDs.has(t.pointerId))return void this._handledPointerIDs.delete(t.pointerId);if(0!=t.button||!this._selectedAnnotationIDs.length)return;let n=this._getAnnotationsAtPoint(t.clientX,t.clientY),r=this._selectedAnnotationIDs.find((e=>n.includes(e)));if(!r)return;let i=n[(n.indexOf(r)+1)%n.length];this._options.onSelectAnnotations([i],t.nativeEvent),1==this._selectedAnnotationIDs.length&&this._openAnnotationPopup(this._annotationsByID.get(i)),this._lastKeyboardFocusedAnnotationID=null})),n(this,"_handleAnnotationDragStart",((e,t)=>{let n=this._iframeWindow.getSelection();if(n&&!n.isCollapsed){let e=n.toString();e.length>100&&(e=e.slice(0,100)+"");let r=getComputedStyle(Ka(n.anchorNode)),i=r.fontSize+" "+r.fontFamily,o=document.createElement("canvas"),a=o.getContext("2d");a.font=i;let s=a.measureText(e);return o.width=s.width,o.height=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent,a.font=i,a.textBaseline="top",a.fillText(e,0,0),void t.setDragImage(o,0,0)}let r=this._annotationsByID.get(e);this._options.onSetDataTransferAnnotations(t,r),1!=this._selectedAnnotationIDs.length||"note"!==r.type||r.readOnly||(this._draggingNoteAnnotation=r),this._previewAnnotation=null,this._renderAnnotations()})),n(this,"_handleAnnotationResizeStart",(e=>{this._resizingAnnotationID=e,this._options.onSetAnnotationPopup(null),this._iframeDocument.body.classList.add("resizing-annotation")})),n(this,"_handleAnnotationResizeEnd",((e,t,n)=>{if(this._resizingAnnotationID=null,this._iframeDocument.body.classList.remove("resizing-annotation"),n)return;let r=this._annotationsByID.get(e);this._options.onUpdateAnnotations([this._updateAnnotationRange(r,t)]),this._preventNextClickEvent()})),this._options=e,this._container=e.container,this._selectedAnnotationIDs=e.selectedAnnotationIDs,this._showAnnotations=e.showAnnotations,this._lightTheme=e.lightTheme,this._darkTheme=e.darkTheme,this._colorScheme=e.colorScheme,this._annotationPopup=e.annotationPopup,this._selectionPopup=e.selectionPopup,this._overlayPopup=e.overlayPopup,this._findState=e.findState,this._overlayPopupDelayer=new vs({open:!!this._overlayPopup}),this._history=new Rs({onUpdate:()=>this._updateViewStats(),onNavigate:e=>this.navigate(e,{skipHistory:!0,behavior:"auto"})}),this._a11yVirtualCursorTarget=null,this._a11yShouldFocusVirtualCursorTarget=!1,this._iframe=document.createElement("iframe"),this._iframe.sandbox.add("allow-same-origin","allow-modals"),"zotero"!==e.platform&&this._iframe.sandbox.add("allow-scripts"),this._iframe.setAttribute("csp",this._getCSP()),this.initializedPromise=this._initialize(),e.container.append(this._iframe)}async _initialize(){return this._iframe.srcdoc=await this._getSrcDoc(),new Promise(((e,t)=>{this._iframe.addEventListener("load",(()=>{this._iframeWindow=this._iframe.contentWindow,this._iframeDocument=this._iframe.contentDocument,Promise.resolve(this._handleIFrameLoaded()).then((()=>this._iframe.classList.add("loaded"))).then(e,t)}),{once:!0})}))}_getCSP(){let e=this._options.data.url?new URL(this._options.data.url):null,t=e&&(e.protocol.startsWith("http")?e.origin:e.protocol);return`default-src ${t||"'none'"}; img-src ${(t||"")+" data: blob:"}; style-src ${(t||"")+" data: 'unsafe-inline'"}; font-src ${(t||"")+" data: blob:"}; script-src 'unsafe-eval'; child-src 'none'; form-action 'none'`}async _handleIFrameLoaded(){this._iframeWindow.addEventListener("contextmenu",this._handleContextMenu.bind(this)),this._iframeWindow.addEventListener("keydown",this._handleKeyDown.bind(this),!0),this._iframeWindow.addEventListener("keyup",this._handleKeyUp.bind(this)),this._iframeWindow.addEventListener("click",this._handleClick.bind(this)),this._iframeDocument.body.addEventListener("pointerover",this._handlePointerOver.bind(this)),this._iframeDocument.body.addEventListener("pointerout",this._handlePointerLeave.bind(this)),this._iframeDocument.body.addEventListener("pointerdown",this._handlePointerDown.bind(this),!0),this._iframeDocument.body.addEventListener("pointerup",this._handlePointerUp.bind(this)),this._iframeDocument.body.addEventListener("pointercancel",this._handlePointerUp.bind(this)),this._iframeDocument.body.addEventListener("pointermove",this._handlePointerMove.bind(this)),this._iframeDocument.addEventListener("touchstart",this._handleTouchStart.bind(this)),this._iframeDocument.addEventListener("touchmove",this._handleTouchMove.bind(this),{passive:!1}),this._iframeWindow.addEventListener("dragstart",this._handleDragStart.bind(this),{capture:!0}),this._iframeWindow.addEventListener("dragenter",this._handleDragEnter.bind(this)),this._iframeWindow.addEventListener("dragover",this._handleDragOver.bind(this)),this._iframeWindow.addEventListener("dragend",this._handleDragEnd.bind(this)),this._iframeWindow.addEventListener("drop",this._handleDrop.bind(this)),this._iframeDocument.addEventListener("copy",this._handleCopy.bind(this)),this._iframeWindow.addEventListener("resize",this._handleResize.bind(this)),this._iframeWindow.addEventListener("focus",this._handleFocus.bind(this)),this._iframeDocument.addEventListener("scroll",this._handleScroll.bind(this),{passive:!0}),this._iframeDocument.addEventListener("scroll",this._handleScrollCapture.bind(this),{passive:!0,capture:!0}),this._iframeDocument.addEventListener("wheel",this._handleWheelCapture.bind(this),{passive:!1,capture:!0}),this._iframeDocument.addEventListener("selectionchange",this._handleSelectionChange.bind(this));let e=this._iframeDocument.createElement("style");e.innerHTML="body{-webkit-touch-callout:none !important;touch-action:manipulation}body.resizing-annotation,body.resizing-annotation *,body.creating-touch-annotation,body.creating-touch-annotation *{user-select:none !important;-webkit-user-select:none !important}body.force-enable-selection-everywhere,body.force-enable-selection-everywhere *{user-select:auto !important;-webkit-user-select:auto !important}body[data-tool=note],body[data-tool=note] *{cursor:default !important}",this._iframeDocument.head.append(e);let t=this._iframeDocument.createElement("div");t.id="annotation-overlay",this._annotationShadowRoot=t.attachShadow({mode:"open"}),this._iframeDocument.body.append(t),this._annotationShadowRoot.addEventListener("focusin",this._handleAnnotationFocusIn.bind(this)),this._annotationRenderRootEl=this._iframeDocument.createElement("div"),this._annotationRenderRootEl.id="annotation-render-root",this._annotationShadowRoot.append(this._annotationRenderRootEl),this._annotationRenderRoot=(0,i.s)(this._annotationRenderRootEl);let n=this._iframeDocument.createElement("style");n.innerHTML=":host,#annotation-render-root{position:absolute;inset:0;writing-mode:horizontal-tb;pointer-events:none}.annotation-container{z-index:9999;pointer-events:none;position:absolute;inset:0;background:rgba(0,0,0,0);overflow:visible}.annotation-container:focus-visible{outline:none}.annotation-container.blended{mix-blend-mode:multiply}.annotation-div{cursor:default;width:100%;height:100%;pointer-events:auto}.inherit-pointer-events{pointer-events:auto}.disable-pointer-events{pointer-events:none !important}.disable-pointer-events .inherit-pointer-events{pointer-events:none !important}.disable-pointer-events .needs-pointer-events{display:none !important}.resizer{cursor:col-resize;touch-action:none}.resizer.resizer-vertical{cursor:row-resize;touch-action:none}@media(any-pointer: coarse){.resizer{stroke:rgba(0,0,0,0);stroke-width:20px;margin:-10px}}#annotation-render-root[data-color-scheme=dark] .annotation-container.blended{mix-blend-mode:screen}@media print{:host{display:none !important}}",this._annotationShadowRoot.append(n),this._iframeDocument.documentElement.classList.toggle("is-safari",hr),this.setAnnotations(this._options.annotations),this.setTool(this._options.tool),this._updateColorScheme(),this._iframeWindow.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>this._updateColorScheme())),await this._handleViewCreated(this._options.viewState||{}),setTimeout((()=>{this._handleViewUpdate()}))}_getContainingRoot(e){return this._iframeDocument.body.contains(e)?this._iframeDocument.body:null}async _pushHistoryPoint(e=!1){e||(this._suspendHistorySaving=!0,await wr(this._iframeDocument,100),this._suspendHistorySaving=!1);let t=this._getHistoryLocation();t&&this._history.save(t,e)}_isExternalLink(e){let t=e.getAttribute("href");return!!t&&(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("mailto:")||t.startsWith("tel:"))}_getViewportBoundingRect(e){let t=e.getBoundingClientRect();return new DOMRect(t.x+this._iframe.getBoundingClientRect().x-this._container.getBoundingClientRect().x,t.y+this._iframe.getBoundingClientRect().y-this._container.getBoundingClientRect().y,t.width,t.height)}_getBoundingPageRectCached(e){if(this._boundingPageRectCache.has(e))return this._boundingPageRectCache.get(e);let t=us(e);return this._boundingPageRectCache.set(e,t),t}_scaleDOMRect(e){return new DOMRect(e.x*this._iframeCoordScaleFactor,e.y*this._iframeCoordScaleFactor,e.width*this._iframeCoordScaleFactor,e.height*this._iframeCoordScaleFactor)}_getAnnotationFromTextSelection(e,t){let n,r=this._iframeDocument.getSelection();if(!r||r.isCollapsed)return null;if("highlight"===e||"underline"===e)n=os(...Fs(r));else{if("note"!==e)return null;{let e=Ka(r.getRangeAt(0).commonAncestorContainer);if(!e)return null;let t=Qa(e);if(!t)return null;n=this._iframeDocument.createRange(),n.selectNode(t)}}return this._getAnnotationFromRange(n,e,t)}_tryUseTool(){if(this._updateViewStats(),"pointer"!=this._tool.type){if("highlight"==this._tool.type||"underline"==this._tool.type){if(this._gotPointerUp){var e;let t=this._touchAnnotationStartPosition?this._previewAnnotation:this._getAnnotationFromTextSelection(this._tool.type,this._tool.color);t&&t.text&&this._options.onAddAnnotation(t),null===(e=this._iframeWindow.getSelection())||void 0===e||e.removeAllRanges(),this._previewAnnotation=null}else this._previewAnnotation=this._getAnnotationFromTextSelection(this._tool.type,this._tool.color);this._renderAnnotations()}}else if(this._gotPointerUp){let e=this._iframeWindow.getSelection();e&&!e.isCollapsed&&this._openSelectionPopup(e)}}_getFocusState(){let e=()=>{var e;let t=this._iframeDocument.activeElement;var n;return t===this._annotationShadowRoot.host?(t=this._annotationShadowRoot.activeElement,null!==(n=t)&&void 0!==n&&n.matches('[tabindex="-1"]')||(t=null)):null!==(e=t)&&void 0!==e&&e.matches("a, area")||(t=null),t},t=()=>{let e=[...this._iframeDocument.querySelectorAll("a, area"),...this._annotationShadowRoot.querySelectorAll('[tabindex="-1"]')];return e=e.filter((e=>{let t=getComputedStyle(e);return"visible"===t.visibility&&"none"!==t.display&&ws(us(e),this._iframeWindow,0)})),e.sort(((e,t)=>{let n,r;return e.getRootNode()===this._annotationShadowRoot&&e.hasAttribute("data-annotation-id")&&(n=this.toDisplayedRange(this._annotationsByID.get(e.getAttribute("data-annotation-id")).position)),n||(n=this._iframeDocument.createRange(),n.selectNode(e)),t.getRootNode()===this._annotationShadowRoot&&t.hasAttribute("data-annotation-id")&&(r=this.toDisplayedRange(this._annotationsByID.get(t.getAttribute("data-annotation-id")).position)),r||(r=this._iframeDocument.createRange(),r.selectNode(t)),n.compareBoundaryPoints(Range.START_TO_START,r)})),e},n={get focusedElement(){let t=e();return Object.defineProperty(this,"focusedElement",{value:t}),t},get focusedElementIndex(){let e=n.focusedElement?n.focusableElements.indexOf(n.focusedElement):-1;return Object.defineProperty(this,"focusedElementIndex",{value:e}),e},get focusableElements(){let e=t();return Object.defineProperty(this,"focusableElements",{value:e}),e}};return n}_updateAnnotationRange(e,t){let n=this._getAnnotationFromRange(t,e.type);if(!n)throw new Error("Invalid updated range");return{...e,position:n.position,pageLabel:n.pageLabel,sortIndex:n.sortIndex,text:n.text}}_handleViewUpdate(){this._updateViewState(),this._updateViewStats(),this._displayedAnnotationCache=new WeakMap,this._boundingPageRectCache=new WeakMap,this._renderAnnotations(!0),this._repositionPopups()}_repositionPopups(){if(this._annotationPopup){let{annotation:e}=this._annotationPopup;e&&this._openAnnotationPopup(e)}if(this._selectionPopup){let e=this._iframeWindow.getSelection();e&&this._openSelectionPopup(e)}this._options.onSetOverlayPopup()}_renderAnnotations(e=!1){var t;if(!this._annotationRenderRootEl)return;if(!this._showAnnotations)return void this._annotationRenderRootEl.replaceChildren();let n=this._annotations.map((e=>{if(this._displayedAnnotationCache.has(e))return this._displayedAnnotationCache.get(e);let t=this.toDisplayedRange(e.position);if(!t)return null;let n={id:e.id,type:e.type,color:e.color,sortIndex:e.sortIndex,text:e.text,comment:e.comment,readOnly:e.readOnly,key:e.id,range:t};return this._displayedAnnotationCache.set(e,n),n})).filter((e=>!!e)),r=null===(t=this._find)||void 0===t?void 0:t.getAnnotations();if(r&&n.push(...r.map((e=>({...e,range:e.range.toRange()})))),this._highlightedPosition){let e=this.toDisplayedRange(this._highlightedPosition);e&&n.push({type:"highlight",color:ei,key:"_highlightedPosition",range:e})}if(this._previewAnnotation){let e=this.toDisplayedRange(this._previewAnnotation.position);var i;e&&n.push({sourceID:null===(i=this._draggingNoteAnnotation)||void 0===i?void 0:i.id,type:this._previewAnnotation.type,color:this._previewAnnotation.color,sortIndex:this._previewAnnotation.sortIndex,text:this._previewAnnotation.text,comment:this._previewAnnotation.comment,key:"_previewAnnotation",range:e})}n=n.filter((e=>e.id===this._resizingAnnotationID||ws(this._getBoundingPageRectCached(e.range),this._iframeWindow)));let a=()=>this._annotationRenderRoot.render(o.createElement(Ss,{iframe:this._iframe,annotations:n,selectedAnnotationIDs:this._selectedAnnotationIDs,onPointerDown:this._handleAnnotationPointerDown,onPointerUp:this._handleAnnotationPointerUp,onContextMenu:this._handleAnnotationContextMenu,onDragStart:this._handleAnnotationDragStart,onResizeStart:this._handleAnnotationResizeStart,onResizeEnd:this._handleAnnotationResizeEnd}));e?(0,qn.flushSync)(a):a()}_openSelectionPopup(e){if(e.isCollapsed)return;let t=rs(os(...Fs(e))),n=this._scaleDOMRect(this._getViewportBoundingRect(t)),r=[n.left,n.top,n.right,n.bottom],i=this._getAnnotationFromRange(t,"highlight");i?this._options.onSetSelectionPopup({rect:r,annotation:i}):this._options.onSetSelectionPopup(null)}_openAnnotationPopup(e){if(!e){if(1!=this._selectedAnnotationIDs.length)return void console.log("No selected annotation to open popup for");if(!(e=this._annotationsByID.get(this._selectedAnnotationIDs[0])))return void console.log("Selected annotation not found")}let t;var n;if("note"==e.type&&(t=null===(n=this._annotationRenderRootEl.querySelector(`[data-annotation-id="${e.id}"]`))||void 0===n?void 0:n.getBoundingClientRect()),!t){let n=this.toDisplayedRange(e.position);if(!n)return void this._options.onSetAnnotationPopup();t=this._getViewportBoundingRect(n)}t=this._scaleDOMRect(t);let r=[t.left,t.top,t.right,t.bottom];this._options.onSetAnnotationPopup({rect:r,annotation:e})}_normalizeAnnotations(){this._options.onUpdateAnnotations(this._annotations.map((e=>{let t=this.toDisplayedRange(e.position);if(!t)return console.warn("Could not create range for annotation",e),e;t=rs(t);let n=this._getAnnotationFromRange(t,e.type,e.color);return n?{...e,...n}:(console.warn("Could not create annotation from normalized range",e),e)})))}_updateColorScheme(){let e,t=Sr(this._colorScheme);e="light"===t&&this._lightTheme?this._lightTheme:"dark"===t&&this._darkTheme?this._darkTheme:{id:"light",label:"",background:"#ffffff",foreground:"#121212"};let n=Cr(e.background,e.foreground),r=[this._iframeDocument.documentElement,this._annotationRenderRootEl];for(let t of r)t.dataset.colorScheme=n,t.style.colorScheme=n,t.style.setProperty("--background-color",e.background),t.style.setProperty("--text-color",e.foreground);this._theme=e,this._themeColorScheme=n}_handlePointerOver(e){const t=e.target.closest("a");if(t&&(this._isExternalLink(t)?t.title=t.href:this._handlePointerOverInternalLink(t)),"note"==this._tool.type){let t=this._getNoteTargetRange(e);t&&(this._previewAnnotation=this._getAnnotationFromRange(t,"note",this._tool.color),this._renderAnnotations())}}_handlePointerLeave(e){const t=e.target.closest("a");t&&!this._isExternalLink(t)&&e.relatedTarget&&this._handlePointerLeftInternalLink()}_handlePointerOverInternalLink(e){}_handlePointerLeftInternalLink(){}_handleDragEnter(e){if(!this._draggingNoteAnnotation)return;e.preventDefault();let t=this._getNoteTargetRange(e);t&&(this._previewAnnotation=this._getAnnotationFromRange(t,"note",this._draggingNoteAnnotation.color),this._renderAnnotations())}_handleDragOver(e){this._draggingNoteAnnotation&&this._previewAnnotation&&e.preventDefault()}_handleDrop(){if(!this._draggingNoteAnnotation||!this._previewAnnotation)return;let e={...this._draggingNoteAnnotation,position:this._previewAnnotation.position,pageLabel:this._previewAnnotation.pageLabel,sortIndex:this._previewAnnotation.sortIndex,text:this._previewAnnotation.text};this._previewAnnotation=null,this._options.onUpdateAnnotations([e])}_getNoteTargetRange(e){let t=e.composedPath()[0],n=this._iframeDocument.createRange();if("IMG"===t.tagName)n.selectNode(t);else if(t.closest("[data-annotation-id]")){let e=this._annotationsByID.get(t.closest("[data-annotation-id]").getAttribute("data-annotation-id")),r=this.toDisplayedRange(e.position);n.setStart(r.startContainer,r.startOffset),n.setEnd(r.endContainer,r.endOffset)}else{let r=as()&&ss(this._iframeDocument,e.clientX,e.clientY),i=Ka(r?r.offsetNode:t);if(!i)return null;let o=Qa(i);if(!o)return null;n.selectNode(o)}let r=n.getBoundingClientRect();return r.right<=0||r.left>=this._iframeWindow.innerWidth||r.bottom<=0||r.top>=this._iframeWindow.innerHeight?null:n}_handleClick(e){let t=e.target.closest("a");t&&(e.preventDefault(),e.altKey||(this._isExternalLink(t)?this._options.onOpenLink(t.href):this._handleInternalLinkClick(t)))}_handleKeyDown(e){this._isCtrlKeyDown="Control"===e.key;let t=gr(e),n=vr(e),r=this._getFocusState();if("Escape"!==t||this._resizingAnnotationID){if("Shift-Tab"===t)return r.focusedElement?r.focusedElement.blur():this._options.onTabOut(!0),void e.preventDefault();if("Tab"===t)return r.focusedElement||!this._iframeDocument.getSelection().isCollapsed||this._selectedAnnotationIDs.length?this._options.onTabOut():r.focusableElements.length?r.focusableElements[0].focus({preventScroll:!0}):this._options.onTabOut(),void e.preventDefault();if(r.focusedElement){var i,o;if(!window.rtl&&"ArrowRight"===t||window.rtl&&"ArrowLeft"===t||"ArrowDown"===t)return null===(i=r.focusableElements[(r.focusedElementIndex+1)%r.focusableElements.length])||void 0===i||i.focus({preventScroll:!0}),void e.preventDefault();if(!window.rtl&&"ArrowLeft"===t||window.rtl&&"ArrowRight"===t||"ArrowUp"===t)return null===(o=r.focusableElements[(r.focusedElementIndex-1+r.focusableElements.length)%r.focusableElements.length])||void 0===o||o.focus({preventScroll:!0}),void e.preventDefault();if(["Enter","Space"].includes(t)){if(r.focusedElement.matches("a, area"))return r.focusedElement.click(),void e.preventDefault();if(r.focusedElement.hasAttribute("data-annotation-id")){let t=r.focusedElement.getAttribute("data-annotation-id"),n=this._annotationsByID.get(t);if(n)return this._options.onSelectAnnotations([t],e),1==this._selectedAnnotationIDs.length&&this._openAnnotationPopup(n),this._lastKeyboardFocusedAnnotationID=t,r.focusedElement.blur(),void e.preventDefault()}}}else 1===this._selectedAnnotationIDs.length&&"Enter"===t&&this._openAnnotationPopup(this._annotationsByID.get(this._selectedAnnotationIDs[0]));if(1===this._selectedAnnotationIDs.length&&t.includes("Shift-Arrow")){let n=this._annotationsByID.get(this._selectedAnnotationIDs[0]),r=this.toDisplayedRange(n.position);if(!r)return void e.preventDefault();if("note"===n.type){let i=this._getContainingRoot(r.startContainer);if(!i)throw new Error("Annotation is outside of root?");let o=this._iframeDocument.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,(e=>Za(e)&&!e.contains(r.startContainer)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP));o.currentNode=r.startContainer;let a=this._iframeDocument.createRange();t.endsWith("Arrow"+(window.rtl?"Left":"Right"))||t.endsWith("ArrowDown")?o.nextNode():o.previousNode(),a.selectNode(o.currentNode);try{n=this._updateAnnotationRange(n,a)}catch(t){return void e.preventDefault()}this._options.onUpdateAnnotations([n]),this._navigateToSelector(n.position,{block:"center",behavior:"smooth",skipHistory:!0,ifNeeded:!0})}else{let i,o=t.startsWith("Cmd-")||t.startsWith("Ctrl-");i="ArrowUp"===e.key||"ArrowDown"===e.key?"line":e.altKey?"word":"character";let a=this._iframeDocument.getSelection();a.removeAllRanges(),a.addRange(r),o?a.collapseToStart():a.collapseToEnd(),a.modify("move","ArrowRight"===e.key||"ArrowDown"===e.key?"right":"left",i);let s=a.getRangeAt(0);o?s.setEnd(r.endContainer,r.endOffset):s.setStart(r.startContainer,r.startOffset),a.removeAllRanges(),s.collapsed||this._options.onUpdateAnnotations([this._updateAnnotationRange(n,s)])}return this._options.onSetAnnotationPopup(null),void e.preventDefault()}if(this._selectedAnnotationIDs.length||"Ctrl-Alt-Digit1"!==n&&"Ctrl-Alt-Digit2"!==n&&"Ctrl-Alt-Digit3"!==n)this._options.onKeyDown(e);else{let t;switch(n){case"Ctrl-Alt-Digit1":t="highlight";break;case"Ctrl-Alt-Digit2":t="underline";break;case"Ctrl-Alt-Digit3":t="note"}let r=this._getAnnotationFromTextSelection(t,this._options.tools[t].color);if(!r&&"note"===t){let e=ss(this._iframeDocument,this._iframeWindow.innerWidth/2,this._iframeWindow.innerHeight/2),n=e&&Ka(e.offsetNode),i=n&&Qa(n);if(i){let e=this._iframeDocument.createRange();e.selectNode(i),r=this._getAnnotationFromRange(e,t,this._options.tools[t].color)}}var a;r&&(this._options.onAddAnnotation(r,!0),this._navigateToSelector(r.position,{block:"center",behavior:"smooth",skipHistory:!0,ifNeeded:!0}),null===(a=this._iframeWindow.getSelection())||void 0===a||a.removeAllRanges(),"note"===t&&(this._renderAnnotations(!0),this._openAnnotationPopup())),e.preventDefault()}}else{var s,l;this._selectedAnnotationIDs.length?(this._options.onSelectAnnotations([],e),this._lastKeyboardFocusedAnnotationID&&(null===(l=this._annotationRenderRootEl.querySelector(`[tabindex="-1"][data-annotation-id="${this._lastKeyboardFocusedAnnotationID}"]`))||void 0===l||l.focus({preventScroll:!0}))):r.focusedElement&&r.focusedElement.blur(),null===(s=this._iframeWindow.getSelection())||void 0===s||s.removeAllRanges()}}_handleKeyUp(e){"Control"===e.key&&(this._isCtrlKeyDown=!1),this._options.onKeyUp(e)}_handleDragStart(e){if(this._previewAnnotation=null,!e.dataTransfer)return;let t=this._getAnnotationFromTextSelection("highlight");t&&(console.log("Dragging text",t),this._options.onSetDataTransferAnnotations(e.dataTransfer,t,!0))}_handleDragEnd(e){this._draggingNoteAnnotation=null,this._previewAnnotation=null,this._renderAnnotations()}_handleContextMenu(e){if("web"===this._options.platform)return;e.preventDefault();let t,n=this._iframe.getBoundingClientRect(),r=e.target.closest("a");r&&this._isExternalLink(r)&&(t={type:"external-link",url:r.href}),this._options.onOpenViewContextMenu({x:n.x+e.clientX*this._iframeCoordScaleFactor,y:n.y+e.clientY*this._iframeCoordScaleFactor,overlay:t})}_handleSelectionChange(){let e=this._iframeDocument.getSelection();!e||e.isCollapsed?this._options.onSetSelectionPopup(null):(this._updateViewStats(),this._tryUseTool()),null!=e&&e.rangeCount&&(this._lastSelectionRange=new ns(e.getRangeAt(0)))}_getAnnotationsAtPoint(e,t){return this._annotationShadowRoot.elementsFromPoint(e,t).map((e=>e.getAttribute("data-annotation-id"))).filter(Boolean).sort()}_handleCopy(e){if(e.clipboardData){if(this._selectedAnnotationIDs.length){let t=this._annotationsByID.get(this._selectedAnnotationIDs[0]);if(!t)return;console.log("Copying annotation",t),this._options.onSetDataTransferAnnotations(e.clipboardData,t)}else{let t=this._getAnnotationFromTextSelection("highlight");if(!t)return;console.log("Copying text",t),this._options.onSetDataTransferAnnotations(e.clipboardData,t,!0)}e.preventDefault()}}_handlePointerDown(e){if(1&~e.buttons||!e.isPrimary||(this._gotPointerUp=!1,this._pointerMovedWhileDown=!1,"touch"!==e.pointerType&&"pen"!==e.pointerType||"highlight"!==this._tool.type&&"underline"!==this._tool.type||e.target===this._annotationShadowRoot.host||(this._touchAnnotationStartPosition=ss(this._iframeDocument,e.clientX,e.clientY),this._iframeDocument.body.classList.add("creating-touch-annotation"),e.stopPropagation())),this._options.onSetOverlayPopup(),this._a11yVirtualCursorTarget=null,!(1&~e.buttons)&&"note"==this._tool.type&&this._previewAnnotation)return this._options.onAddAnnotation(this._previewAnnotation,!0),this._previewAnnotation=null,this._renderAnnotations(!0),this._openAnnotationPopup(),e.preventDefault(),void this._preventNextClickEvent();e.target!==this._annotationShadowRoot.host&&this._selectedAnnotationIDs.length&&this._options.onSelectAnnotations([],e)}_handlePointerUp(e){e.isPrimary&&(this._gotPointerUp=!0,"pointercancel"===e.type?(this._previewAnnotation=null,this._renderAnnotations()):this._pointerMovedWhileDown||"highlight"!=this._tool.type&&"underline"!=this._tool.type?this._tryUseTool():this._tryUseToolDebounced(),this._touchAnnotationStartPosition=null,this._iframeDocument.body.classList.remove("creating-touch-annotation"))}_handlePointerMove(e){if(!(1&~e.buttons)&&e.isPrimary&&(this._pointerMovedWhileDown=!0,this._touchAnnotationStartPosition&&("touch"===e.pointerType||"pen"===e.pointerType)&&("highlight"===this._tool.type||"underline"===this._tool.type))){let t=ss(this._iframeDocument,e.clientX,e.clientY);if(t){let e=this._iframeDocument.createRange();e.setStart(this._touchAnnotationStartPosition.offsetNode,this._touchAnnotationStartPosition.offset),e.setEnd(t.offsetNode,t.offset),e.collapsed&&(e.setStart(t.offsetNode,t.offset),e.setEnd(this._touchAnnotationStartPosition.offsetNode,this._touchAnnotationStartPosition.offset));let n=this._getAnnotationFromRange(e,this._tool.type,this._tool.color);n&&(this._previewAnnotation=n,this._renderAnnotations())}e.stopPropagation()}}_handleTouchStart(e){2===e.touches.length&&(this._lastPinchDistance=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY))}_handleTouchMove(e){if(!this._touchAnnotationStartPosition||"highlight"!==this._tool.type&&"underline"!==this._tool.type){if(2===e.touches.length){e.preventDefault();let t=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY);this.zoomBy((t/this._lastPinchDistance-1)/10),this._lastPinchDistance=t}}else e.preventDefault()}_handleResize(){this._handleViewUpdate()}_handleScroll(e){this._lastScrollTime=e.timeStamp,requestAnimationFrame((()=>{this._renderAnnotations(),this._repositionPopups()}))}_handleScrollCapture(e){let t=e.target;if(t!==this._iframeDocument){for(let e of this._annotations){var n;null!==(n=this.toDisplayedRange(e.position))&&void 0!==n&&n.intersectsNode(t)&&this._displayedAnnotationCache.delete(e)}requestAnimationFrame((()=>{this._renderAnnotations(!0),this._repositionPopups()}))}}_handleWheelCapture(e){if(!(e.ctrlKey||e.metaKey&&lr()))return void(this._lastScrollTime=e.timeStamp);if(e.preventDefault(),e.stopPropagation(),null!==this._lastScrollTime&&e.timeStamp-this._lastScrollTime<100)return void(this._lastScrollTime=e.timeStamp);let t=e.deltaMode,n=Math.exp(-e.deltaY/100);if(e.ctrlKey&&!this._isCtrlKeyDown&&t===WheelEvent.DOM_DELTA_PIXEL&&0===e.deltaX&&(Math.abs(n-1)<.05||lr())&&0===e.deltaZ)this.zoomBy(n-1);else{let n=-e.deltaY;t===WheelEvent.DOM_DELTA_LINE||t===WheelEvent.DOM_DELTA_PAGE?n*=.01:n*=.001,this.zoomBy(n)}}_handleFocus(){this._options.onFocus(),Er(this._a11yVirtualCursorTarget)}_handleAnnotationFocusIn(e){let t=e.target.dataset.annotationId;t&&this._options.onFocusAnnotation(this._annotationsByID.get(t))}_preventNextClickEvent(){let e=e=>{e.stopImmediatePropagation(),e.preventDefault()};this._iframeDocument.addEventListener("click",e,{once:!0,capture:!0}),setTimeout((()=>{this._iframeDocument.removeEventListener("click",e)}),500)}_selectionContainsPoint(e,t){let n=this._iframeDocument.getSelection();return!!n&&bs(ys(Fs(n).map((e=>e.getBoundingClientRect()))),e,t)}destroy(){this._overlayPopupDelayer.destroy()}setTool(e){this._tool=e,this._iframeDocument.body.dataset.tool=e.type;let t="highlight"==e.type||"underline"==e.type?"transparent":ei;t.startsWith("#")&&(t+="80"),this._iframeDocument.documentElement.style.setProperty("--selection-color",t),this._previewAnnotation&&"note"!==e.type&&(this._previewAnnotation=null),this._renderAnnotations()}setAnnotations(e){this._annotations=e,this._annotationsByID=new Map(e.map((e=>[e.id,e]))),this._renderAnnotations(),this._repositionPopups()}setShowAnnotations(e){this._showAnnotations=e,this._renderAnnotations()}setLightTheme(e){this._lightTheme=e,this._updateColorScheme()}setDarkTheme(e){this._darkTheme=e,this._updateColorScheme()}setColorScheme(e){this._colorScheme=e,this._updateColorScheme()}setSelectedAnnotationIDs(e){var t;this._selectedAnnotationIDs=e,this._options.onSetAnnotationPopup(),this._renderAnnotations(),null===(t=this._iframeWindow.getSelection())||void 0===t||t.empty(),this._updateViewStats()}get selectedAnnotationIDs(){return this._selectedAnnotationIDs.slice()}setAnnotationPopup(e){this._annotationPopup=e}setSelectionPopup(e){this._selectionPopup=e}setOverlayPopup(e){this._overlayPopup=e,this._overlayPopupDelayer.setOpen(!!e)}setOutline(e){this._outline=e}focus(){this._iframe.focus()}zoomIn(){this.zoomBy(.1)}zoomOut(){this.zoomBy(-.1)}zoomBy(e){let t=this.scale;void 0===t&&(t=1),t+=e,t=Math.max(this.MIN_SCALE,Math.min(this.MAX_SCALE,t)),this._setScale(t),this._handleViewUpdate()}zoomReset(){this._setScale(1),this._handleViewUpdate()}_setHighlight(e){this._highlightedPosition=e,this._renderAnnotations(!0),setTimeout((()=>{this._highlightedPosition===e&&(this._highlightedPosition=null,this._renderAnnotations(!0))}),2e3)}navigate(e,t={}){if(e.annotationID){var n;t.block||(t.block="center"),null!==(n=t.ifNeeded)&&void 0!==n||(t.ifNeeded=!0);let r=this._annotationsByID.get(e.annotationID);if(!r)return;let i=r.position;this._navigateToSelector(i,t)}else if(e.position){var r;t.block||(t.block="center"),null!==(r=t.ifNeeded)&&void 0!==r||(t.ifNeeded=!0);let n=e.position;this._navigateToSelector(n,t),this._setHighlight(n)}}navigateBack(){this._history.navigateBack()}navigateForward(){this._history.navigateForward()}};var Os=r(3410),Bs=r.n(Os);const Ms=new Set(["html","head","body","base","meta"]);class Ls{constructor(e){n(this,"trackedSelectors",{table:new Set(["table","mtable","pre"]),sup:new Set(["sup"]),sub:new Set(["sub"]),writingMode:new Map,breakBefore:new Set,breakAfter:new Set}),n(this,"_sheets",new Map),n(this,"_textCache",new Map),this._document=e}async add(e){if(this._sheets.has(e))return this._sheets.get(e).scopeClass;let t=`__scope_${this._sheets.size}`;this._sheets.set(e,{scopeClass:t});let n,r=function(e){for(let[t,n]of Ns)e=e.replace(t,n);return e}(e),i=!1;try{n=new this._document.defaultView.CSSStyleSheet,await n.replace(r)}catch(e){let t=this._document.createElement("style");if(t.innerHTML=r,t.sheet)n=t.sheet;else{let e=new Promise((e=>t.addEventListener("load",(()=>e(t.sheet)))));this._document.head.append(t),n=await e,i=!0}}return this._visitStyleSheet(n,t),i||this._document.adoptedStyleSheets.push(n),this._sheets.set(e,{sheet:n,scopeClass:t}),t}async addByURL(e){let t;return this._textCache.has(e)?t=this._textCache.get(e):(t=await(await fetch(e)).text(),this._textCache.set(e,t)),this.add(t)}_visitStyleSheet(e,t){for(let n of e.cssRules)this._visitRule(n,t)}_visitRule(e,t){if("CSSStyleRule"===e.constructor.name){let n=e;n.selectorText=Bs()((e=>{e.walk((e=>{(0,Os.isSelector)(e)?e.replaceWith(Bs().selector({value:"",nodes:[Bs().className({value:t}),Bs().combinator({value:" "}),Bs().selector({...e})]})):(0,Os.isTag)(e)&&Ms.has(e.value.toLowerCase())&&e.replaceWith(Bs().tag({...e,value:"replaced-"+e.value}))}))})).processSync(n.selectorText);let r=n.style;"table"!==r.display&&"inline-table"!==r.display||this.trackedSelectors.table.add(n.selectorText),"super"===r.verticalAlign?this.trackedSelectors.sup.add(n.selectorText):"sub"===r.verticalAlign&&this.trackedSelectors.sub.add(n.selectorText),r.writingMode&&this.trackedSelectors.writingMode.set(n.selectorText,r.writingMode),"page"!==r.breakBefore&&"always"!==r.pageBreakBefore||this.trackedSelectors.breakBefore.add(n.selectorText),"page"!==r.breakAfter&&"always"!==r.pageBreakAfter||this.trackedSelectors.breakAfter.add(n.selectorText),r.fontFamily&&/\bmono(space)?\b/i.test(r.fontFamily)&&r.setProperty("font-family",r.fontFamily,"important"),r.fontSize&&(r.fontSize=function(e){if(e.toLowerCase()in Us)return Us[e.toLowerCase()];let t=e.match(/^([0-9.]+)([a-zA-Z]+)$/);if(t){let e=parseFloat(t[1]),n=t[2].toLowerCase();if("px"===n)return e/Vs+"rem";if(n in Hs)return e*Hs[n]*zs+"rem"}return e}(r.fontSize))}else if("CSSImportRule"===e.constructor.name){let n=e;n.styleSheet&&this._visitStyleSheet(n.styleSheet,t)}if("cssRules"in e)for(let n of e.cssRules)this._visitRule(n,t)}}const Ns=Object.entries({"text-transform":["text-transform",{"-epub-fullwidth":"full-width"}],"-epub-hyphens":["hyphens",{}],"-epub-line-break":["line-break",{}],"-epub-text-align-last":["text-align-last",{}],"-epub-word-break":["word-break",{}],"-epub-text-emphasis":["text-emphasis",{}],"-epub-text-emphasis-color":["text-emphasis-color",{}],"-epub-text-emphasis-style":["text-emphasis-style",{}],"-epub-text-emphasis-position":["text-emphasis-position",{}],"-epub-text-underline-position":["text-underline-position",{alphabetic:"auto"}],"-epub-ruby-position":["ruby-position",{}],"-epub-writing-mode":["writing-mode",{}],"-epub-text-orientation":["text-orientation",{"vertical-right":"mixed","sideways-right":"sideways","rotate-right":"sideways","rotate-normal":"sideways"}],"-epub-text-combine":["text-combine-upright",{horizontal:"all"}],"-epub-text-combine-horizontal":["text-combine-upright",{}],"-epub-text-combine-upright":["text-combine-upright",{}]}).flatMap((([e,[t,n]])=>[[new RegExp(`(^|[^a-zA-Z-])${e}(\\s*:)`,"gi"),"$1"+t+"$2"],...Object.entries(n).map((([e,n])=>[new RegExp(`((?:^|[^a-zA-Z-])${t}\\s*:\\s*)${e}($|[^a-zA-Z-])`,"gi"),"$1"+n+"$2"]))])),Vs=13,zs=96/72/Vs,Us={"xx-small":"0.5rem","x-small":"0.625rem",small:"0.75rem",medium:"1rem",large:"1.125rem","x-large":"1.5rem","xx-large":"2rem","xxx-large":"2.55rem"},Hs={mm:2.8346456693,cm:28.346456693,in:72,pc:12,q:.708661417325,pt:1},Ws=class{constructor(e){n(this,"error",!1),this.section=e.section,this._sectionsContainer=e.sectionsContainer,this._document=e.document;let t=this._document.createElement("div");t.id="section-"+this.section.index,t.classList.add("section-container","cfi-stop"),t.setAttribute("data-section-index",String(this.section.index)),this.container=t;let r=this._document.createElement("template");r.setAttribute("data-section-index",String(this.section.index)),this._sectionsContainer.append(r),this.containerTemplate=r}unmount(){this.container.parentElement&&this.container.replaceWith(this.containerTemplate)}mount(){this.containerTemplate.parentElement&&this.containerTemplate.replaceWith(this.container)}get mounted(){return this.container.parentElement===this._sectionsContainer}async render(e,t){if(this.body)throw new Error("Already rendered");if(!this.section.url)return console.error("Section has no URL",this.section),void this._displayError("Missing content");let n=await this.section.render(e);try{await async function(e,t){var n;let{container:r,cssRewriter:i}=t,o=r.ownerDocument,a=(new DOMParser).parseFromString(e,"application/xhtml+xml");if(a.getElementsByTagName("parsererror").length)throw new Error("Invalid XHTML");let s=a.createTreeWalker(a,NodeFilter.SHOW_ELEMENT),l=[],u=null;for(;u=s.nextNode();){let e=u.localName;switch(e){case"style":r.classList.add(await i.add(u.innerHTML||"")),l.push(u);break;case"link":{let e=u;if(/\bstylesheet\b/i.test(e.rel)){try{r.classList.add(await i.addByURL(e.href))}catch(e){console.error(e)}l.push(u)}break}case"title":l.push(u);break;case"object":if(u.hasAttribute("data")&&null!==(n=u.getAttribute("type"))&&void 0!==n&&n.startsWith("image/")){let e=o.createElement("img");for(let t of u.getAttributeNames())"data"!==t&&"title"!==t&&e.setAttribute(t,u.getAttribute(t));e.src=u.getAttribute("data"),e.alt=u.getAttribute("title")||u.textContent||"",u.replaceWith(e),s.currentNode=e}break;case"img":{let e=u;e.loading="eager",e.decoding="sync",e.closest('a, [*|type="frontmatter"]')||(e.setAttribute("aria-label","Zoom In"),e.classList.add("clickable-image"));break}default:if(Ms.has(e)){let t=o.createElement("replaced-"+e);for(let e of u.attributes)t.setAttributeNode(e.cloneNode());t.append(...u.childNodes),u.replaceWith(t),s.currentNode=t}}}for(let e of l)e.remove();r.append(...a.childNodes);let c=r.querySelector("replaced-html");if(!c&&(c=r.firstElementChild,!c))throw new Error("Missing documentElement");let d=r.querySelector("replaced-body");d||(d=c);let h=(e,t)=>{for(let n of e)for(let e of Array.from(r.querySelectorAll(n)))try{t(e)}catch(e){}};h(i.trackedSelectors.table,(e=>{e.classList.add("table-like"),e.hasAttribute("role")||e.setAttribute("role","table")})),h(i.trackedSelectors.sup,(e=>e.classList.add("sup-like"))),h(i.trackedSelectors.sub,(e=>e.classList.add("sub-like"))),h(i.trackedSelectors.breakBefore,(e=>e.classList.add("break-before"))),h(i.trackedSelectors.breakAfter,(e=>e.classList.add("break-after")));let p=d;for(;p;)p.classList.remove("break-before"),p=p.firstElementChild;let f=d;for(;f;)f.classList.remove("break-after"),f=f.lastElementChild;let m="";for(let[e,t]of i.trackedSelectors.writingMode)try{if(c.matches(e)||d.matches(e)){m=t;break}}catch(e){}r.dataset.writingMode=m}(n,{container:this.container,cssRewriter:t});let e=this.container.querySelector("replaced-body");if(!e)return console.error("Section has no body",this.section),void this._displayError("Missing content");this.body=e}catch(e){console.error("Error rendering section "+this.section.index+" ("+this.section.href+")",e),this._displayError("Invalid content")}}_displayError(e){let t=this._document.createElement("div");t.style.color="red",t.style.fontSize="1.5em",t.style.fontWeight="bold",t.style.textAlign="center",t.append(`[Section ${this.section.index}: ${e}]`),this.container.replaceChildren(t),this.body=t,this.error=!0}get searchContext(){let e=fs(Ga(this.container));return Object.defineProperty(this,"searchContext",{value:e}),e}};var js=r(7086),$s=r.n(js);function Gs(e){return e.replace(/^epubcfi\((.+)\)$/,"$1")}function qs(e){return e.startsWith("epubcfi(")&&e.endsWith(")")?e:`epubcfi(${e})`}class Ks{static generate(e){let t=new Ks,n=e.renderers.map((e=>e.body));return t._addPhysicalPages(n),t._tree.length||t._addEPUBLocations(n),t._freeze(e),t}static load(e,t){let n=new Ks,r=JSON.parse(e);if(!r)return null;if(!r.version||r.version<Ks.VERSION)return console.warn(`Page mappings are old: ${r.version} < ${Ks.VERSION}`),null;let{mappings:i}=r;return Array.isArray(i)?(n._tree.setPairs(i.map((([e,n])=>[t.getRange(qs(e)),n])).filter((([e,t])=>!!e&&"string"==typeof t)).map((([e,t])=>[new ns(e),t]))),n._isPhysical=r.isPhysical,n._freeze(t),n):(console.error("Unable to load persisted page mapping",e),null)}constructor(){n(this,"_tree",new($s())(void 0,((e,t)=>hl.compareBoundaryPoints(Range.START_TO_START,e,t)||hl.compareBoundaryPoints(Range.END_TO_END,e,t)))),n(this,"_isPhysical",!1)}get length(){return this._tree.length}get isPhysical(){return this._isPhysical}_addPhysicalPages(e){if(this._tree.length)throw new Error("Page mapping already populated");let t=(new Date).getTime(),n=Ys.map((t=>{console.log("Trying matcher",t.selector);let n=[],r=0,i=0;for(let o of e){let e=o.querySelectorAll(t.selector),a=0;for(let r of e){let e=t.extract(r);if(!e)continue;let i=r.ownerDocument.createRange();i.selectNode(r),i=rs(i),i.collapse(!0),n.push([new ns(i),e]),a++}a&&(r+=a,i++)}if(i<e.length/2)return console.log(`Aborting due to insufficient sections with page numbers (${i}/${e.length})`),{mapping:[],score:0,matcher:t};let o=null;for(let[,e]of n){if(null!==o){let t=parseInt(o),n=parseInt(e);if(!Number.isNaN(t)&&!Number.isNaN(n)){if(n<t){console.log(`Decreasing page numbers: ${o} -> ${e}`),r/=4;break}if(n>t+3){console.log(`Non-continuous page numbers: ${o} -> ${e}`),r/=2;break}}}o=e}let a=new Set;for(let[,e]of n){if(a.has(e)){if(/^\D{2,}$/.test(e))return console.log("Aborting due to non-numeric duplicate page number",e),{mapping:[],score:0,matcher:t};console.log("Duplicate page number",e),r/=2;break}a.add(e)}return console.log(`Score: ${r} (${n.length} matches)`),{mapping:n,score:r,matcher:t}}));n=n.filter((({score:e})=>e>0)).sort(((e,t)=>t.mapping.length-e.mapping.length));let r=n[0];r?(this._tree.setPairs(r.mapping),this._isPhysical=!0,console.log(`Added ${this._tree.length} physical page mappings in ${(((new Date).getTime()-t)/1e3).toFixed(2)}s using ${r.matcher.selector}`)):console.log("Not enough page numbers to be confident -- reverting to EPUB locations")}_addEPUBLocations(e){if(this._tree.length)throw new Error("Page mapping already populated");let t=(new Date).getTime(),n=0;for(let t of e){let e=Ga(t),r=0;for(let t of e){if(/^\s*$/.test(t.data))continue;let e=0,i=t.length;if(i<=r)r-=i;else for(;i>r;){e+=r,i-=r;let o=t.ownerDocument.createRange();o.setStart(t,e),o.collapse(!0),this._tree.set(new ns(o),(n+1).toString()),r=pl,n++}}}console.log(`Added ${this._tree.length} EPUB location mappings in ${(((new Date).getTime()-t)/1e3).toFixed(2)}s`)}_freeze(e){this._tree.freeze();let t=Ks.VERSION,n=this._isPhysical,r=this._tree.toArray().map((([t,n])=>{let r=e.getCFI(t.toRange());return r?[Gs(r.toString(!0)),n]:null})).filter(Boolean);this._json=JSON.stringify({version:t,isPhysical:n,mappings:r})}getPageIndex(e){var t;let n=null===(t=this._tree.getPairOrNextLower(new ns(e)))||void 0===t?void 0:t[0];return n?this._tree.keysArray().indexOf(n):null}getPageLabel(e){var t,n;return null!==(t=null===(n=this._tree.getPairOrNextLower(new ns(e)))||void 0===n?void 0:n[1])&&void 0!==t?t:null}get firstRange(){var e,t;return null!==(e=null===(t=this._tree.minKey())||void 0===t?void 0:t.toRange())&&void 0!==e?e:null}getRange(e){for(let[t,n]of this._tree.entries())if(n===e)return t;return null}ranges(){return this._tree.keys()}pageLabels(){return this._tree.values()}entries(){return this._tree.entries()}toJSON(){if(!this._json)throw new Error("Not yet frozen");return this._json}}n(Ks,"VERSION",13);const Ys=[{selector:'[id*="page" i]:not(#pagetop):not(#pagebottom):empty',extract:e=>e.id.replace(/page[-_]?/i,"").replace(/^(.*_)+/,"")},{selector:'[id*="page" i]:not(#pagetop):not(#pagebottom)',extract:e=>e.id.replace(/page[-_]?/i,"").replace(/^(.*_)+/,"")},{selector:'[*|type="pagebreak"]',extract:e=>{var t;return null!==(t=e.getAttribute("title"))&&void 0!==t?t:void 0}}],Xs=Ks;class Zs{constructor(e){n(this,"_cachedStartSection",null),n(this,"_cachedStartRange",null),n(this,"_cachedStartCFI",null),n(this,"_cachedStartCFIOffset",null),n(this,"_scale",1),n(this,"_isRTL",!1),n(this,"_isVertical",!1),n(this,"_nextHistoryPushIsFromNavigation",!1),n(this,"invalidate",Ti((()=>{this._cachedStartRange=null,this._cachedStartCFIOffset=null,this._cachedStartCFI=null,this.update(),this._onUpdateViewState(),this._onUpdateViewStats(),this._pushHistoryPoint()}),200)),n(this,"_pushHistoryPoint",(()=>{this._onPushHistoryPoint(!this._nextHistoryPushIsFromNavigation),this._nextHistoryPushIsFromNavigation=!1})),this._view=e.view,this._iframe=e.iframe,this._iframeWindow=e.iframe.contentWindow,this._iframeDocument=e.iframe.contentDocument,this._scale=e.view.scale,this._onUpdateViewState=e.onUpdateViewState,this._onUpdateViewStats=e.onUpdateViewStats,this._onViewUpdate=e.onViewUpdate,this._onPushHistoryPoint=e.onPushHistoryPoint,this._isRTL=es(this._iframeDocument.body),this._iframeWindow.addEventListener("scroll",this._pushHistoryPoint),this._intersectionObserver=new IntersectionObserver((()=>this.invalidate()),{threshold:[0,1]});for(let e of this._view.pageMapping.ranges()){let t=Ka(e.startContainer);t&&this._intersectionObserver.observe(t)}}destroy(){this._iframeWindow.removeEventListener("scroll",this._pushHistoryPoint),this._intersectionObserver.disconnect()}get startSection(){return this._cachedStartSection||this.update(),this._cachedStartSection}get startRange(){var e,t;return this._cachedStartRange||this.update(),null!==(e=null===(t=this._cachedStartRange)||void 0===t?void 0:t.toRange())&&void 0!==e?e:null}get startCFI(){return this._cachedStartCFI||this.update(),this._cachedStartCFI}get startCFIOffset(){return null===this._cachedStartCFIOffset&&this.update(),this._cachedStartCFIOffset}get startRangeIsBeforeFirstMapping(){if(!this.startRange)return!0;let e=this._view.pageMapping.firstRange;return!!e&&hl.compareBoundaryPoints(Range.START_TO_START,this.startRange,e)<0}_getFirstVisibleRange(e,t){if(!e.mounted)return null;let n=this instanceof Js,r=!n&&this._isVertical&&this._isRTL,i=n?this._iframe.clientWidth:this._iframe.clientHeight,o=n?this._iframe.clientHeight:this._iframe.clientWidth,a=NodeFilter.SHOW_TEXT|(t?0:NodeFilter.SHOW_ELEMENT),s=this._iframeDocument.createNodeIterator(e.container,a,(e=>{var t;return e.nodeType==Node.TEXT_NODE&&null!==(t=e.nodeValue)&&void 0!==t&&t.trim().length||"IMG"===e.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP})),l=null;for(let e of Ja(s)){let t=this._iframeDocument.createRange();e.nodeType==Node.ELEMENT_NODE?t.selectNode(e):t.selectNodeContents(e);let a=t.getBoundingClientRect();if(!a.width&&!a.height)continue;let s=n?a.left:a.top,u=n?a.right:a.bottom,c=n?a.top:a.left,d=n?a.bottom:a.right;if(r&&(c=this._iframe.clientWidth-c,d=this._iframe.clientHeight-d),s>i||c>o)return l;if((s>=0||s<0&&u>0)&&(c>=0||c<0&&d>0))return t;l=t}return null}canNavigateLeft(){return this._view.pageProgressionRTL?this.canNavigateToNextPage():this.canNavigateToPreviousPage()}canNavigateRight(){return this._view.pageProgressionRTL?this.canNavigateToPreviousPage():this.canNavigateToNextPage()}navigateLeft(){this._view.pageProgressionRTL?this.navigateToNextPage():this.navigateToPreviousPage()}navigateRight(){this._view.pageProgressionRTL?this.navigateToPreviousPage():this.navigateToNextPage()}setScale(e){this._scale=e}}class Qs extends Zs{constructor(e){super(e),this._iframe.classList.add("flow-mode-scrolled"),this._iframeDocument.body.classList.add("flow-mode-scrolled"),this._isVertical=ts(this._iframeDocument.body);for(let e of this._view.renderers)e.mount();hr&&setTimeout((()=>{this._iframeDocument.body.style.overflowY="auto"}))}destroy(){super.destroy(),this._iframe.classList.remove("flow-mode-scrolled"),this._iframeDocument.body.classList.remove("flow-mode-scrolled"),hr&&(this._iframeDocument.body.style.overflowY="")}scrollIntoView(e,t){let n=(e instanceof ns?e.toRange():e).getBoundingClientRect();if(null!=t&&t.ifNeeded&&n.top>=0&&n.bottom<this._iframe.clientHeight&&n.left>=0&&n.left<this._iframe.clientWidth)return;if(null!=t&&t.skipHistory||(this._nextHistoryPushIsFromNavigation=!0),"smooth"==(null==t?void 0:t.behavior)&&(Math.abs(n.top+n.bottom/2)>2*this._iframe.clientHeight||Math.abs(n.left+n.right/2)>2*this._iframe.clientWidth)&&(t.behavior="auto"),"nodeType"in e)return e.scrollIntoView(t),void this.invalidate();let r=n.x,i=n.y;ts(e.startContainer)?(t&&"center"==t.block&&(r+=n.width/2,r-=this._iframe.clientWidth/2),t&&void 0!==t.offsetBlock&&(r-=t.offsetBlock)):(r+=n.width/2,t&&"center"==t.block&&(i+=n.height/2,i-=this._iframe.clientHeight/2),t&&void 0!==t.offsetBlock&&(i-=t.offsetBlock)),this._iframeWindow.scrollBy({...t,left:r,top:i}),this.invalidate()}get scrollPadding(){return Qs.SCROLL_PADDING_UNSCALED*this._scale}canNavigateToPreviousPage(){return this._isVertical?Math.abs(this._iframeWindow.scrollX)>=this._iframe.clientWidth-this.scrollPadding:this._iframeWindow.scrollY>=this._iframe.clientHeight-this.scrollPadding}canNavigateToNextPage(){return this._isVertical?Math.abs(this._iframeWindow.scrollX)<=this._iframeDocument.documentElement.scrollWidth-2*this._iframe.clientWidth+this.scrollPadding:this._iframeWindow.scrollY<=this._iframeDocument.documentElement.scrollHeight-2*this._iframe.clientHeight+this.scrollPadding}navigateToPreviousPage(){this.canNavigateToPreviousPage()&&(this._isVertical?this._iframeWindow.scrollBy({left:this._iframe.clientWidth+this.scrollPadding}):this._iframeWindow.scrollBy({top:-this._iframe.clientHeight+this.scrollPadding}),this._onViewUpdate())}navigateToNextPage(){this.canNavigateToNextPage()&&(this._isVertical?this._iframeWindow.scrollBy({left:-this._iframe.clientWidth-this.scrollPadding}):this._iframeWindow.scrollBy({top:this._iframe.clientHeight-this.scrollPadding}),this._onViewUpdate())}navigateToFirstPage(){this._isVertical?this._iframeWindow.scrollTo({left:0}):this._iframeWindow.scrollTo({top:0}),this._onViewUpdate()}navigateToLastPage(){this._isVertical?this._iframeWindow.scrollTo({left:this._iframeDocument.documentElement.scrollWidth}):this._iframeWindow.scrollTo({top:this._iframeDocument.documentElement.scrollHeight}),this._onViewUpdate()}update(){let e=!1;for(let t of this._view.renderers){if(!t.mounted)continue;let n=ws(us(t.container),this._iframeWindow);if(e){if(!n)break}else{if(!n)continue;this._cachedStartSection=t.section;let r=this._getFirstVisibleRange(t,!1),i=this._getFirstVisibleRange(t,!0);if(r&&(r.collapse(!1),this._cachedStartRange=new ns(r)),i){i.collapse(!0),this._cachedStartCFI=new ha(i,t.section.cfiBase);let e=i.getBoundingClientRect();this._cachedStartCFIOffset=ts(t.body)?e.left:e.top}r&&i&&(e=!0)}}}setSpreadMode(){}}n(Qs,"SCROLL_PADDING_UNSCALED",35);class Js extends Zs{constructor(e){super(e),n(this,"_touchDown",!1),n(this,"_touchStartX",0),n(this,"_touchStartY",0),n(this,"_handleKeyDown",(e=>{if(e.defaultPrevented)return;let{key:t,shiftKey:n}=e;if(!n){if("ArrowUp"==t)return this.navigateToPreviousPage(),void e.preventDefault();if("ArrowDown"==t)return this.navigateToNextPage(),void e.preventDefault();if("PageUp"==t)return this.navigateToPreviousPage(),void e.preventDefault();if("PageDown"==t)return this.navigateToNextPage(),void e.preventDefault();if("Home"==t)return this.navigateToFirstPage(),void e.preventDefault();if("End"==t)return this.navigateToLastPage(),void e.preventDefault()}" "==t&&(n?this.navigateToPreviousPage():this.navigateToNextPage(),e.preventDefault())})),n(this,"_handlePointerDown",(e=>{if(e.isPrimary&&("touch"===e.pointerType||"pen"===e.pointerType)&&!e.composedPath()[0].closest(".annotation-container")){if(hr){var t;let n=null===(t=Fs(this._iframeWindow.getSelection())[0])||void 0===t?void 0:t.getBoundingClientRect();if(n&&n.width&&n.height&&(n.x-=40,n.y-=40,n.width+=80,n.height+=80,bs(n,e.clientX,e.clientY)))return void console.log("Ignoring pointerdown near selection")}this._touchDown=!0,this._touchStartX=e.clientX,this._touchStartY=e.clientY}})),n(this,"_handlePointerMove",(e=>{if(!this._touchDown||!e.isPrimary||e.buttons%1!=0)return;let t=(e.clientX-this._touchStartX)/100;t<0&&!this.canNavigateRight()?t=Math.max(t,-.6):t>0&&!this.canNavigateLeft()&&(t=Math.min(t,.6)),this._swipeIndicators.style.setProperty("--swipe-amount",t.toString())})),n(this,"_handlePointerUp",(e=>{if(!this._touchDown||!e.isPrimary)return;e.preventDefault(),this._swipeIndicators.style.setProperty("--swipe-amount","0"),this._touchDown=!1;let t=(e.clientX-this._touchStartX)/100;t<=-1?this.navigateRight():t>=1?this.navigateLeft():this._iframeWindow.getSelection().isCollapsed&&!this._view.selectedAnnotationIDs.length&&Math.abs(e.clientX-this._touchStartX)<10&&Math.abs(e.clientY-this._touchStartY)<10&&!e.target.closest("a, .clickable-image")&&(e.clientX>=this._iframeWindow.innerWidth-150?this.navigateRight():e.clientX<=150&&this.navigateLeft())})),n(this,"_handlePointerCancel",(e=>{this._touchDown&&e.isPrimary&&(this._touchDown=!1,this._swipeIndicators.style.setProperty("--swipe-amount","0"))})),n(this,"_handleWheel",Ti((e=>{for(let t of function*(e,t){let n=e;for(;n;)n=n.closest("table, .table-like"),n&&(yield n,n=n.parentElement)}(e.target))if(t.clientHeight<t.scrollHeight)return;e.deltaY<0?(this.navigateToPreviousPage(),e.preventDefault()):e.deltaY>0&&(this.navigateToNextPage(),e.preventDefault())}),100,{leading:!0,trailing:!1,maxWait:400})),n(this,"_handleSelectionChange",(()=>{this._swipeIndicators.style.setProperty("--swipe-amount","0"),this._touchDown=!1})),this._sectionsContainer=this._iframeDocument.body.querySelector(":scope > .sections"),this._swipeIndicators=this._iframeDocument.querySelector(".swipe-indicators"),this._iframeDocument.addEventListener("keydown",this._handleKeyDown,{capture:!0}),this._iframeDocument.addEventListener("pointerdown",this._handlePointerDown),this._iframeDocument.addEventListener("pointermove",this._handlePointerMove),this._iframeDocument.addEventListener("pointerup",this._handlePointerUp),this._iframeDocument.addEventListener("pointerout",this._handlePointerCancel),this._iframeDocument.addEventListener("pointercancel",this._handlePointerCancel),this._iframeDocument.addEventListener("wheel",this._handleWheel,{passive:!1}),this._iframeDocument.addEventListener("selectionchange",this._handleSelectionChange),this._iframe.classList.add("flow-mode-paginated"),this._iframeDocument.body.classList.add("flow-mode-paginated")}destroy(){super.destroy(),this._iframeDocument.removeEventListener("keydown",this._handleKeyDown,{capture:!0}),this._iframeDocument.removeEventListener("pointerdown",this._handlePointerDown),this._iframeDocument.removeEventListener("pointermove",this._handlePointerMove),this._iframeDocument.removeEventListener("pointerup",this._handlePointerUp),this._iframeDocument.removeEventListener("pointerout",this._handlePointerCancel),this._iframeDocument.removeEventListener("pointercancel",this._handlePointerCancel),this._iframeDocument.removeEventListener("wheel",this._handleWheel),this._iframeDocument.removeEventListener("selectionchange",this._handleSelectionChange),this._iframe.classList.remove("flow-mode-paginated"),this._iframeDocument.body.classList.remove("flow-mode-paginated")}get _spreadWidth(){return this._sectionsContainer.offsetWidth+parseFloat(getComputedStyle(this._sectionsContainer).columnGap)}get _spreadHeight(){return this._sectionsContainer.offsetHeight+parseFloat(getComputedStyle(this._sectionsContainer).columnGap)}get currentSectionIndex(){return this._currentSectionIndex}set currentSectionIndex(e){if(e===this._currentSectionIndex)return;let t=this._currentSectionIndex;if(this._currentSectionIndex=e,this._sectionsContainer.scrollTo({left:0,top:0}),void 0===t)for(let e of this._view.renderers)e.unmount();else this._view.renderers[t].unmount();this._view.renderers[e].mount(),this._onViewUpdate()}scrollIntoView(e,t){let n=hl.getContainingSectionIndex(e);if(null===n)return;null!=t&&t.skipHistory||(this._nextHistoryPushIsFromNavigation=!0),this.currentSectionIndex=n;let r=(e instanceof ns?e.toRange():e).getBoundingClientRect(),i=r.x+this._sectionsContainer.scrollLeft,o=r.y+this._sectionsContainer.scrollTop;"center"===(null==t?void 0:t.block)&&(i+=r.width/2);let a=this._spreadWidth,s=this._spreadHeight;this._sectionsContainer.scrollTo({left:Math.floor(i/a)*a,top:Math.floor(o/s)*s}),this._onViewUpdate()}canNavigateToPreviousPage(){return!!this.canNavigateToPreviousSection()||this._sectionsContainer.scrollLeft>0||this._sectionsContainer.scrollTop>0}canNavigateToNextPage(){return!!this.canNavigateToNextSection()||this._sectionsContainer.scrollLeft<this._sectionsContainer.scrollWidth-this._sectionsContainer.offsetWidth||this._sectionsContainer.scrollTop<this._sectionsContainer.scrollHeight-this._sectionsContainer.offsetHeight}atStartOfSection(){return 0==this._sectionsContainer.scrollLeft&&0==this._sectionsContainer.scrollTop}atEndOfSection(){return this._sectionsContainer.scrollLeft>this._sectionsContainer.scrollWidth-this._sectionsContainer.offsetWidth-this._spreadWidth&&this._sectionsContainer.scrollTop>this._sectionsContainer.scrollHeight-this._sectionsContainer.offsetHeight-this._spreadHeight}canNavigateToPreviousSection(){return this.currentSectionIndex>0}canNavigateToNextSection(){return this.currentSectionIndex<this._view.renderers.length-1}navigateToPreviousSection(){this.canNavigateToPreviousSection()&&this.currentSectionIndex--}navigateToNextSection(){this.canNavigateToNextSection()&&this.currentSectionIndex++}navigateToPreviousPage(){if(this.canNavigateToPreviousPage()){if(this.atStartOfSection())return this.navigateToPreviousSection(),this._sectionsContainer.scrollTo({left:this._sectionsContainer.scrollWidth,top:this._sectionsContainer.scrollHeight}),void this._onViewUpdate();0===this._sectionsContainer.scrollLeft?this._sectionsContainer.scrollTo({left:0,top:this._sectionsContainer.scrollTop-this._spreadHeight,behavior:"auto"}):this._sectionsContainer.scrollBy({left:-this._spreadWidth,behavior:"auto"}),this._onViewUpdate()}}navigateToNextPage(){this.canNavigateToNextPage()&&(this.atEndOfSection()?this.navigateToNextSection():(this._sectionsContainer.scrollLeft===this._sectionsContainer.scrollWidth-this._sectionsContainer.offsetWidth?this._sectionsContainer.scrollTo({left:0,top:this._sectionsContainer.scrollTop+this._spreadHeight,behavior:"auto"}):this._sectionsContainer.scrollBy({left:this._spreadWidth,behavior:"auto"}),this._onViewUpdate()))}navigateToFirstPage(){this.currentSectionIndex=this._view.renderers[0].section.index,this._sectionsContainer.scrollTo({left:0,top:0}),this._onViewUpdate()}navigateToLastPage(){this.currentSectionIndex=this._view.renderers[this._view.renderers.length-1].section.index,this._sectionsContainer.scrollTo({left:this._sectionsContainer.scrollWidth,top:0}),this._onViewUpdate()}update(){let e=!1;for(let t of this._view.renderers.values()){if(!t.mounted)continue;let n=t.container.offsetLeft<this._iframeWindow.scrollX+this._iframe.clientWidth&&t.container.offsetLeft+t.container.offsetWidth>=this._iframeWindow.scrollX;if(e){if(!n)break}else{if(!n)continue;this._cachedStartSection=t.section;let r=this._getFirstVisibleRange(t,!0),i=this._getFirstVisibleRange(t,!0);r&&(r.collapse(!1),this._cachedStartRange=new ns(r)),i&&(i.collapse(!1),this._cachedStartCFI=new ha(i,t.section.cfiBase),this._cachedStartCFIOffset=0),r&&i&&(e=!0)}}}setSpreadMode(e){this._sectionsContainer.classList.toggle("spread-mode-none",e===cl.None),this._sectionsContainer.classList.toggle("spread-mode-odd",e===cl.Odd)}}var el=r(8083);const tl=new RegExp("((?:^|\\s*/)\\s*)("+Array.from(Ms).join("|")+")","g");function nl(e){let t=e.match(/^\/body\/DocFragment\[(\d+)]\/(.+)\.(\d+)$/);if(!t)throw new Error("Unable to parse KOReader position: "+e);return{fragmentIndex:parseInt(t[1]),xpath:t[2].replace(tl,((e,t,n)=>t+"replaced-"+n)),charIndex:parseInt(t[3])}}function rl(e,t){"string"==typeof e&&(e=nl(e));let n=t[e.fragmentIndex-1];if(!n)return null;let r=n.body.parentElement,i=r.ownerDocument.evaluate(e.xpath,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE);return i.singleNodeValue?{node:i.singleNodeValue,offset:e.charIndex}:null}function il(e,t){let n=rl(e.pos0,t),r=rl(e.pos1,t);if(!n||!r)return null;if(hl.getContainingSectionIndex(n.node)!==hl.getContainingSectionIndex(r.node))throw new Error("Start and end points are in different sections");let i=n.node.ownerDocument.createRange();return i.setStart(n.node,n.offset),i.setEnd(r.node,r.offset),i}function ol(e){function t(e,t){var n,r;return null!==(n=null===(r=e.fields.find((e=>"TableValue"!==e.type&&("StringLiteral"===e.key.type&&e.key.value===t||"Identifier"===e.key.type&&e.key.name===t))))||void 0===r?void 0:r.value)&&void 0!==n?n:null}let n=(0,el.parse)(new TextDecoder("x-user-defined").decode(e),{comments:!1,scope:!1,locations:!1,ranges:!1,encodingMode:"x-user-defined"}).body.find((e=>"ReturnStatement"===e.type));if(!n)throw new Error("Invalid KOReader metadata: no top-level return statement");let r=n.arguments[0];if("TableConstructorExpression"!==r.type)throw new Error("Invalid KOReader metadata: does not return table");let i=t(r,"annotations");if("TableConstructorExpression"!==(null==i?void 0:i.type))throw new Error('Invalid KOReader metadata: "annotations" is not a table');let o=[];e:for(let e of i.fields){var a,s;let n=e.value;if("TableConstructorExpression"!==n.type)throw new Error('Invalid KOReader metadata: "annotations" entry is not a table');let r={note:t(n,"note"),pos0:t(n,"pos0"),pos1:t(n,"pos1"),text:t(n,"text"),datetime:t(n,"datetime"),color:t(n,"color")};for(let e of["pos0","pos1","text","datetime"]){let t=r[e];if(!t){console.error(`Invalid KOReader metadata: annotation is missing required field "${e}"`);continue e}if(t&&"StringLiteral"!==t.type){console.error(`Invalid KOReader metadata: annotation field "${e}" is not a string`);continue e}}o.push({note:null===(a=r.note)||void 0===a?void 0:a.value,pos0:nl(r.pos0.value),pos1:nl(r.pos1.value),text:r.text.value,datetime:r.datetime.value,color:null===(s=r.color)||void 0===s?void 0:s.value})}return o}function al(e,t){let n=t[e.spine_index];if(!n)return null;let r=new ha(qs(n.section.cfiBase+"!"+e.start_cfi.replace(/^\/2\//,"/"))),i=new ha(qs(n.section.cfiBase+"!"+e.end_cfi.replace(/^\/2\//,"/")));try{let e=r.toRange(n.container.ownerDocument,void 0,n.container,{calibreCompat:!0}),t=i.toRange(n.container.ownerDocument,void 0,n.container,{calibreCompat:!0});return e.setEnd(t.endContainer,t.endOffset),e}catch(e){return console.error(e),null}}function sl(e){let t=[];if(e.startsWith("encoding=json+base64:\n")){let n=JSON.parse(atob(e.substring(22)));for(let e of n)"removed"in e&&e.removed||"highlight"!==e.type||t.push(e)}else{let n=(new DOMParser).parseFromString(e,"text/xml").querySelectorAll('meta[name="calibre:annotation"][content]');for(let e of n){let n;try{n=JSON.parse(e.getAttribute("content"))}catch(e){console.error(e);continue}"EPUB"!==n.format||"removed"in n.annotation&&n.annotation.removed||"highlight"!==n.annotation.type||t.push(n.annotation)}}return t}class ll extends Map{constructor(e=500){super(),this._capacity=e}get(e){let t=super.get(e);return void 0!==t&&(super.delete(e),super.set(e,t)),t}set(e,t){return super.has(e)?super.delete(e):super.size===this._capacity&&super.delete(super.keys().next().value),super.set(e,t),this}}class ul extends Is{constructor(e){if(super(e),n(this,"_find",null),n(this,"_lastResizeWidth",null),n(this,"_lastResizeHeight",null),n(this,"_sectionRenderers",[]),n(this,"_rangeCache",new ll),n(this,"_hrefTargetCache",new Map),n(this,"_lastNavigationTime",0),n(this,"a11yRecordCurrentPage",Ti((()=>{var e;if(!this.flow.startRange)return;if(null!==(e=this._findState)&&void 0!==e&&e.active)return;let t=Ka(this.flow.startRange.startContainer);this._a11yVirtualCursorTarget=t,this._a11yShouldFocusVirtualCursorTarget&&(this._a11yShouldFocusVirtualCursorTarget=!1,Er(this._a11yVirtualCursorTarget))}),gl)),e.data.buf)this.book=ja(e.data.buf.buffer),delete this._options.data.buf;else if(e.data.url)this.book=ja(e.data.url,{openAs:"epub"});else{if(!e.data.book)throw new Error("buf, url, or book is required");this.book=e.data.book}}_getSrcDoc(){return"<!DOCTYPE html><html><body></body></html>"}getData(){return{book:this.book}}_handleIFrameLoaded(){return this._iframeDocument.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),super._handleIFrameLoaded()}async _handleViewCreated(e){var t;await this.book.opened;let n=this._iframeDocument.createElement("meta");n.setAttribute("http-equiv","Content-Security-Policy"),n.setAttribute("content",this._getCSP()),this._iframeDocument.head.prepend(n);let r=this._iframeDocument.createElement("style");r.innerHTML='.swipe-indicators{display:none}@media screen{html{margin:0 !important;padding:0 !important}body{margin:0 !important;padding:0 !important}body.flow-mode-scrolled,body.flow-mode-scrolled>.sections{overflow-x:visible}body.flow-mode-scrolled>.sections{margin-inline:40px}body.flow-mode-scrolled>.sections>.section-container{margin-inline:auto;margin-block-end:100px;contain:layout paint;contain:layout paint style;contain:layout paint inline-size;contain:layout paint style inline-size}:root[data-page-width=narrow] body.flow-mode-scrolled>.sections>.section-container{max-inline-size:650px}:root[data-page-width=normal] body.flow-mode-scrolled>.sections>.section-container{max-inline-size:800px}:root[data-page-width=full] body.flow-mode-scrolled>.sections>.section-container{max-inline-size:100%}body.flow-mode-scrolled>.sections>.section-container.hidden{visibility:hidden;pointer-events:none}body.flow-mode-scrolled replaced-body section{margin-block-end:100px}body.flow-mode-scrolled replaced-body img,body.flow-mode-scrolled replaced-body svg,body.flow-mode-scrolled replaced-body audio,body.flow-mode-scrolled replaced-body video{max-inline-size:min(100vw - 80px,100%) !important;max-inline-size:min(100vi - 80px,100%) !important;max-block-size:100vh;object-fit:contain}body.flow-mode-paginated{margin:40px !important;overflow:hidden;overscroll-behavior:none}body.flow-mode-paginated .swipe-indicators{display:contents}body.flow-mode-paginated .swipe-indicators .swipe-indicator-left,body.flow-mode-paginated .swipe-indicators .swipe-indicator-right{display:block;position:fixed;top:calc(50% - 50px);width:80px;height:100px;background-color:#bdbdbd;z-index:9999;pointer-events:none}body.flow-mode-paginated .swipe-indicators .swipe-indicator-left{left:calc((min(var(--swipe-amount, 0),1) - 1)*80px);opacity:calc(min(var(--swipe-amount, 0),1)*.8);border-radius:0 80px 80px 0}body.flow-mode-paginated .swipe-indicators .swipe-indicator-right{left:calc(100vw + max(var(--swipe-amount, 0),-1)*80px);opacity:calc(max(var(--swipe-amount, 0),-1)*-0.8);border-radius:80px 0 0 80px}body.flow-mode-paginated>.sections{max-width:calc(100vw - 80px);min-height:calc(100vh - 80px);max-height:calc(100vh - 80px);margin-inline:auto;column-fill:auto;-webkit-column-fill:auto;column-gap:60px;column-width:800px;overflow:hidden;overscroll-behavior:none}body.flow-mode-paginated>.sections.spread-mode-odd{column-width:calc(50vw - 80px);--media-max-width: calc(50vw - 80px)}body.flow-mode-paginated>.sections.spread-mode-none{column-gap:100vw;--media-max-width: calc(100vw - 80px)}:root[data-page-width=narrow] body.flow-mode-paginated>.sections.spread-mode-none{max-inline-size:650px;column-width:650px}:root[data-page-width=normal] body.flow-mode-paginated>.sections.spread-mode-none{max-inline-size:800px;column-width:800px}:root[data-page-width=full] body.flow-mode-paginated>.sections.spread-mode-none{max-inline-size:calc(100vw - 80px);column-width:calc(100vw - 80px)}body.flow-mode-paginated>.sections>.section-container{contain:layout paint;contain:layout paint style}body.flow-mode-paginated>.sections>.section-container.hidden{display:none}:root.is-safari body.flow-mode-paginated>.sections>.section-container{contain:layout;contain:layout style}body.flow-mode-paginated replaced-body section{position:relative !important}body.flow-mode-paginated replaced-body section+section,body.flow-mode-paginated replaced-body .break-before{margin-block-start:100vh}body.flow-mode-paginated replaced-body .break-after{margin-block-end:100vh}body.flow-mode-paginated replaced-body img,body.flow-mode-paginated replaced-body svg,body.flow-mode-paginated replaced-body audio,body.flow-mode-paginated replaced-body video{max-width:min(.98*var(--media-max-width),100%) !important;max-height:calc(.98*(100vh - 80px)) !important;object-fit:contain;position:static !important;width:auto;height:auto}body.flow-mode-paginated replaced-body div{max-inline-size:var(--media-max-width)}body.flow-mode-paginated replaced-body table,body.flow-mode-paginated replaced-body mtable{display:block;overflow:auto;max-block-size:calc(100vh - 80px);max-block-size:calc(100vb - 80px);border:none !important}body.flow-mode-paginated replaced-body .table-like:not(table,mtable),body.flow-mode-paginated replaced-body ol,body.flow-mode-paginated replaced-body ul{display:flex;flex-direction:column}}@media screen and (max-width: 800px){body.flow-mode-paginated replaced-body *{max-inline-size:100vw;max-inline-size:100vi}}@media print{body>.sections>.section-container,body>.sections>.section-container section{break-after:page}}@namespace epub url("http://www.idpf.org/2007/ops");:root{--link-color: #0000ee;--visited-link-color: #551a8b}:root[data-color-scheme=dark]{--link-color: #63caff;--visited-link-color: #0099e5}:root{font-size:calc(var(--content-scale)*13pt) !important;background-color:var(--background-color) !important;color:var(--text-color) !important}:root:not(.hyphenate) *{hyphens:none !important}:root[data-color-scheme=dark] :not(:link):not(:visited){color:inherit !important;background-color:rgba(0,0,0,0) !important}body>.sections>.section-container ::selection{background-color:var(--selection-color)}replaced-html{display:block}replaced-head{display:none !important}replaced-body{--content-line-height-compensation: 1;--content-line-height: calc( (1em + (2ex - 1ch) - ((1rem - 16px) * 0.1667)) * var(--content-line-height-compensation) * var(--content-line-height-adjust, 1.2) );--content-word-spacing: calc(var(--content-word-spacing-adjust, 0) * 1%);--content-letter-spacing: calc(var(--content-letter-spacing-adjust, 0) * 1em);display:block;margin:unset !important;padding:unset !important;width:unset !important;height:unset !important;min-width:unset !important;min-height:unset !important;max-width:unset !important;max-height:unset !important;background:unset !important;color:unset !important;border:unset !important;overflow:unset !important;font-size:unset !important;text-align:justify;text-rendering:optimizeLegibility}replaced-body::before,replaced-body::after{content:unset !important;display:none !important}:root:not(.use-original-font) replaced-body{font-family:var(--content-font-family, "Georgia", serif)}replaced-body:lang(bn),replaced-body:lang(km),replaced-body:lang(ml),replaced-body:lang(ta),replaced-body:lang(th){--content-line-height-compensation: 1.067}replaced-body:lang(he),replaced-body:lang(hi),replaced-body:lang(kn),replaced-body:lang(pa){--content-line-height-compensation: 1.1}replaced-body:lang(am),replaced-body:lang(chr),replaced-body:lang(gu),replaced-body:lang(ja),replaced-body:lang(ko),replaced-body:lang(or),replaced-body:lang(si),replaced-body:lang(zh){--content-line-height-compensation: 1.167}replaced-body,replaced-body *{line-height:var(--content-line-height) !important;word-spacing:var(--content-word-spacing) !important;letter-spacing:var(--content-letter-spacing) !important}replaced-body p,replaced-body [role=paragraph]{line-height:var(--content-line-height) !important;word-spacing:var(--content-word-spacing) !important;letter-spacing:var(--content-letter-spacing) !important;background:rgba(0,0,0,0) !important;color:inherit !important;widows:2;orphans:2;hyphens:auto}:root:not(.use-original-font) replaced-body p,:root:not(.use-original-font) replaced-body [role=paragraph]{font-family:var(--content-font-family, "Georgia", serif)}replaced-body a{text-decoration:none}replaced-body :link{color:var(--link-color) !important}replaced-body :visited{color:var(--visited-link-color) !important}replaced-body .sup-like,replaced-body .sub-like{line-height:1 !important;position:relative !important;font-size:66.6% !important}replaced-body .sup-like{vertical-align:super !important;bottom:0 !important}replaced-body .sub-like{vertical-align:sub !important;bottom:-0.2ex}body:not(.footnote-popup-content) replaced-body aside[epub|type=footnote],body:not(.footnote-popup-content) replaced-body aside[epub|type=rearnote],body:not(.footnote-popup-content) replaced-body aside[epub|type=note]{display:none}replaced-body img.clickable-image{cursor:zoom-in}body.footnote-popup-content replaced-body{text-align:start}body.footnote-popup-content *{list-style-type:none !important;border:0 !important}body.footnote-popup-content .section-container{padding:16px}#annotation-overlay{display:contents}.a11y-cursor-target{outline:none}',this._iframeDocument.head.append(r);let i=this._iframeDocument.createElement("div");i.classList.add("swipe-indicators");let o=this._iframeDocument.createElement("div");o.classList.add("swipe-indicator-left"),i.append(o);let a=this._iframeDocument.createElement("div");if(a.classList.add("swipe-indicator-right"),i.append(a),this._iframeDocument.body.append(i),this._sectionsContainer=this._iframeDocument.createElement("div"),this._sectionsContainer.classList.add("sections"),this._sectionsContainer.lang=this.book.packaging.metadata.language,this._sectionsContainer.hidden=!0,this._iframeDocument.body.append(this._sectionsContainer),await this._displaySections(),this._sectionRenderers.some((e=>e.error))&&await this._isEncrypted())return this._options.onEPUBEncrypted(),void this._sectionsContainer.remove();if(this.pageProgressionRTL="rtl"===this.book.packaging.metadata.direction,!this.pageProgressionRTL)try{let e=new Intl.Locale(this.book.packaging.metadata.language).maximize();this.pageProgressionRTL=!!e.script&&fl.has(e.script),this.pageProgressionRTL&&console.log("Guessed RTL page progression from maximized locale: "+e)}catch(e){}if(!this.pageProgressionRTL){let e=this._iframeDocument.documentElement.style.writingMode||"";this.pageProgressionRTL=e.endsWith("rl"),this.pageProgressionRTL&&console.log("Guessed RTL page progression from writing mode: "+e)}if(this._options.fontFamily&&this.setFontFamily(this._options.fontFamily),this.setHyphenate(null===(t=this._options.hyphenate)||void 0===t||t),this._sectionsContainer.hidden=!1,this.pageMapping=this._initPageMapping(e.savedPageMapping),this._initOutline(),this._addAriaNavigationLandmarks(),this._setScale(e.scale||1),e.flowMode?this.setFlowMode(e.flowMode):this.setFlowMode("paginated"),e.spreadMode?this.setSpreadMode(e.spreadMode):this.setSpreadMode(cl.None),e.appearance?this.setAppearance(e.appearance):this.setAppearance(ml),this._options.location)this.navigate(this._options.location,{behavior:"instant"});else if(e.cfi&&"_start"!==e.cfi){let t=qs(e.cfi);await new Promise((e=>requestAnimationFrame(e))),this.navigate({pageNumber:t},{behavior:"auto",offsetBlock:e.cfiElementOffset})}else this.navigateToFirstPage();this._lastResizeWidth=this._iframeWindow.innerWidth,this._lastResizeHeight=this._iframeWindow.innerHeight,this._handleViewUpdate(),this.book.archive.zip=null}async _isEncrypted(){try{return(await this.book.archive.request("/META-INF/encryption.xml","text")).includes("<EncryptedData")}catch(e){return!1}}async _displaySection(e,t){let n=new Ws({section:e,sectionsContainer:this._sectionsContainer,document:this._iframeDocument});await n.render(this.book.archive.request.bind(this.book.archive),t),n.body.lang=this.book.packaging.metadata.language,this._sectionRenderers[e.index]=n}async _displaySections(){let e=new Ls(this._iframeDocument);for(let t of this.book.spine.spineItems)await this._displaySection(t,e);this._iframeDocument.documentElement.style.writingMode=this.book.packaging.metadata.primary_writing_mode||function(e){let t,n=0,r=new Map;for(let o of e){var i;let e=null!==(i=r.get(o))&&void 0!==i?i:0;r.set(o,++e),e>n&&(n=e,t=o)}return t}(this._sectionRenderers.map((e=>e.container.dataset.writingMode)).filter(Boolean))||""}_initPageMapping(e){let t=null;if(e&&(t=Xs.load(e,this)),(!e||!t)&&(t=Xs.generate(this),window.dev&&(t=Xs.load(t.toJSON(),this),!t)))throw new Error("Failed to round-trip page mapping");return t}_initOutline(){let e=new vo(this.book.packaging.navPath||this.book.packaging.ncxPath||""),t=n=>{var r;return{title:n.label,location:{href:e.resolve(n.href).replace(/^\//,"")},items:null===(r=n.subitems)||void 0===r?void 0:r.map(t),expanded:!0}};this._options.onSetOutline(this.book.navigation.toc.map(t))}_getOutlinePath(){let e=[],t=null;if(!this.flow.startRange||!this._outline)return e;let n=(r,i,o)=>{const a=[...o,i];let s=this._getHrefTarget(r.location.href);if(s&&!(ul.compareRangeToPoint(this.flow.startRange,s,0)<0)&&((!t||ul.compareDocumentPositions(s,t)>=0)&&(t=s,e=a),r.items))for(let[e,t]of r.items.entries())n(t,e,a)};for(let[e,t]of this._outline.entries())n(t,e,[]);return e}getCFI(e){var t;let n;n="nodeType"in e?e:e.commonAncestorContainer;let r=null===(t=Ka(n))||void 0===t?void 0:t.closest("[data-section-index]");if(!r)return null;let i=this.book.section(r.getAttribute("data-section-index"));return new ha(e,i.cfiBase)}getRange(e,t=!1){if(!this._sectionRenderers.length)return null;let n=e.toString();"string"==typeof e&&(e=new ha(e));let r=this._sectionRenderers[e.spinePos];if(!r)return console.error("Unable to find view for CFI",n),null;if(!r.mounted&&t&&r.mount(),this._rangeCache.has(n))return this._rangeCache.get(n);try{let t=e.toRange(r.container.ownerDocument,void 0,r.container);if(!t)return console.error("Unable to get range for CFI",n),null;let i=new ns(t);return this._rangeCache.set(n,i),i}catch(e){return console.error("Unable to get range for CFI",n,e),null}}async _addAriaNavigationLandmarks(){let e=this._options.getLocalizedString(this.pageMapping.isPhysical?"pdfReader.page":"pdfReader.location");for(let[t,n]of this.pageMapping.entries()){let r=Ka(t.startContainer);r&&(r.setAttribute("role","navigation"),r.setAttribute("aria-label",`${e}: ${n}`))}}toSelector(e){e=rs(e);let t=this.getCFI(e);return t?{type:"FragmentSelector",conformsTo:ds.EPUB3,value:t.toString(!0)}:null}toDisplayedRange(e){if("FragmentSelector"===e.type){if(e.conformsTo!==ds.EPUB3)throw new Error(`Unsupported FragmentSelector.conformsTo: ${e.conformsTo}`);if(e.refinedBy)throw new Error("Refinement of FragmentSelectors is not supported");let t=this.getRange(e.value);if(!t)return null;let n=ul.getContainingSectionIndex(t);return null!==n&&this._sectionRenderers[n].mounted?t.toRange():null}throw new Error(`Unsupported Selector.type: ${e.type}`)}_getHistoryLocation(){var e;let t=null===(e=this.flow.startCFI)||void 0===e?void 0:e.toString();return t?{pageNumber:t}:null}_keepPosition(e){var t,n;let r=null===(t=this.flow)||void 0===t?void 0:t.startCFI,i=null===(n=this.flow)||void 0===n?void 0:n.startCFIOffset,o=null==e?void 0:e();return r&&this.navigate({pageNumber:r.toString()},{skipHistory:!0,behavior:"auto",offsetBlock:null!=i?i:void 0}),o}_navigateToSelector(e,t={}){!function(e){return"FragmentSelector"===e.type}(e)||e.conformsTo!==ds.EPUB3?console.warn("Not a CFI FragmentSelector",e):this.navigate({pageNumber:e.value},t)}_getAnnotationFromRange(e,t,n){var r;if((e=rs(e)).collapsed)return null;let i;if("highlight"==t||"underline"==t){let t;i="";for(let n of is(e)){if(t){let e=Ka(t.commonAncestorContainer),r=e&&Qa(e),o=Ka(n.commonAncestorContainer);r!==(o&&Qa(o))&&(i+="\n\n")}i+=n.toString().replace(/\s+/g," "),t=n}if(i=i.trim(),!i)return null}else i=void 0;let o=this.toSelector(e);if(!o)return null;let a=this.pageMapping.isPhysical&&this.pageMapping.getPageLabel(e)||"",s=null===(r=Ka(e.startContainer))||void 0===r?void 0:r.closest("[data-section-index]");if(!s)return null;let l=parseInt(s.getAttribute("data-section-index")),u=this._iframeDocument.createRange();return u.setStart(s,0),u.setEnd(e.startContainer,e.startOffset),{type:t,color:n,sortIndex:String(l).padStart(5,"0")+"|"+String(u.toString().length).padStart(8,"0"),pageLabel:a,position:o,text:i}}_getContainingRoot(e){var t,n;return null!==(t=null===(n=this._sectionRenderers.find((t=>t.container.contains(e))))||void 0===n?void 0:n.container)&&void 0!==t?t:null}_upsertAnnotation(e){let t=this._annotations.find((t=>t.text===e.text&&t.sortIndex===e.sortIndex));t?this._options.onUpdateAnnotations([{...t,comment:e.comment}]):this._options.onAddAnnotation(e)}getKOReaderAnnotationStats(e){try{let t=ol(e);if(t.length)return{count:t.length,lastModified:t.map((e=>new Date(e.datetime))).reduce(((e,t)=>t>e?t:e))}}catch(e){console.error(e)}return{count:0}}importAnnotationsFromKOReaderMetadata(e){for(let n of ol(e)){var t;let e,r=il(n,this._sectionRenderers);if(!r){console.warn("Unable to resolve annotation",n);continue}switch(n.color){case"red":case"orange":case"yellow":case"green":case"blue":case"purple":case"gray":e=n.color;break;case"olive":e="green";break;case"cyan":e="blue";break;default:n.color&&console.warn("Unknown KOReader color",n.color),e="yellow"}let i=null===(t=Qr.find((([t])=>t===`general.${e}`)))||void 0===t?void 0:t[1];if(!i)throw new Error("Missing color: "+i);let o=this._getAnnotationFromRange(r,"highlight",i);o?(o.comment=n.note,this._upsertAnnotation(o)):console.warn("Unable to resolve range",n)}}getCalibreAnnotationStats(e){try{let t=sl(e);if(t.length)return{count:t.length,lastModified:t.map((e=>new Date(e.timestamp))).reduce(((e,t)=>t>e?t:e))}}catch(e){console.error(e)}return{count:0}}importAnnotationsFromCalibreMetadata(e){for(let n of sl(e)){var t;let e=al(n,this._sectionRenderers);if(!e){console.warn("Unable to resolve annotation",n);continue}let r="highlight",i=Qr[0][1];switch(null===(t=n.style)||void 0===t?void 0:t.kind){case"color":switch(n.style.which){case"green":i=Qr[2][1];break;case"blue":i=Qr[3][1];break;case"purple":i=Qr[4][1];break;case"pink":i=Qr[5][1]}break;case"decoration":switch(n.style.which){case"strikeout":i=Qr[1][1];break;case"wavy":r="underline"}}let o=this._getAnnotationFromRange(e,r,i);o?(o.comment=n.notes||"",this._upsertAnnotation(o)):console.warn("Unable to resolve range",n)}}_handleVisibilityChange(){"visible"===this._iframeDocument.visibilityState&&(this._keepPosition(),this._handleViewUpdate())}_handleResize(){!this.flow||document.hidden||this._iframeWindow.innerWidth===this._lastResizeWidth&&this._iframeWindow.innerHeight===this._lastResizeHeight||(this._lastResizeWidth=this._iframeWindow.innerWidth,this._lastResizeHeight=this._iframeWindow.innerHeight,this._keepPosition(),this._handleViewUpdate())}_getInternalLinkHref(e){var t;if(this._isExternalLink(e))return null;let n=e.getAttribute("href"),r=null===(t=this._sectionRenderers.find((t=>t.container.contains(e))))||void 0===t?void 0:t.section;if(!r)return null;let i=new URL(n,new URL(r.canonical,"https://www.example.com/")),o=i.pathname+i.hash;try{o=decodeURIComponent(o)}catch(e){}return this.book.path.relative(o)}_splitHref(e){var t;let[n,r]=e.split("#");try{n=decodeURIComponent(n)}catch(e){}if(r)try{r=decodeURIComponent(r)}catch(e){}return[n,null!==(t=r)&&void 0!==t?t:null]}_getHrefTarget(e){if(this._hrefTargetCache.has(e))return this._hrefTargetCache.get(e);let[t,n]=this._splitHref(e),r=this.book.spine.get(t);if(!r)return console.error("Unable to find section for pathname",t),null;let i=this._sectionRenderers[r.index].container;if(!i)return console.error("Unable to find view for section",r.index),null;if(n){let e=i.querySelector("#"+CSS.escape(n));e?i=e:console.warn("Unable to resolve hash",e)}return this._hrefTargetCache.set(e,i),i}_handlePointerOverInternalLink(e){let t=this._getFootnoteTargetElement(e);t?this._overlayPopupDelayer.open(e,(()=>{this._openFootnoteOverlayPopup(e,t)})):this._overlayPopupDelayer.close((()=>{this._options.onSetOverlayPopup()}))}_handlePointerLeftInternalLink(){this._overlayPopupDelayer.close((()=>{this._options.onSetOverlayPopup()}))}_handleInternalLinkClick(e){let t=this._getInternalLinkHref(e);t&&this.navigate({href:t})}_handleClick(e){if(super._handleClick(e),e.defaultPrevented||0!==e.button)return;let t=e.target;if("IMG"===t.tagName&&t.classList.contains("clickable-image")&&t.naturalWidth&&t.naturalHeight){let n=t,r=n.getBoundingClientRect();this._options.onSetOverlayPopup({type:"image",src:n.currentSrc||n.src,title:n.title,alt:n.alt,rect:[r.left,r.top,r.right,r.bottom]}),e.preventDefault()}}_handleKeyDown(e){let{key:t}=e;if(super._handleKeyDown(e),!e.defaultPrevented&&(!e.shiftKey&&["ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(t)&&(this._a11yShouldFocusVirtualCursorTarget=!0),!e.shiftKey)){if("ArrowLeft"==t)return this.flow.navigateLeft(),void e.preventDefault();if("ArrowRight"==t)return this.flow.navigateRight(),void e.preventDefault()}}_updateViewState(){var e;let t;this.flow.startCFI?t=Gs(this.flow.startCFI.toString(!0)):this.flow.startRangeIsBeforeFirstMapping&&(t="_start");let n={scale:Math.round(1e3*this.scale)/1e3,cfi:t,cfiElementOffset:null!==(e=this.flow.startCFIOffset)&&void 0!==e?e:void 0,savedPageMapping:this.pageMapping.toJSON(),flowMode:this.flowMode,spreadMode:this.spreadMode,appearance:this.appearance};this._options.onChangeViewState(n)}_updateViewStats(){var e,t;let n=this.flow.startRange,r=n&&this.pageMapping.getPageIndex(n),i=n&&this.pageMapping.getPageLabel(n),o=this.flow.canNavigateToPreviousPage(),a=this.flow.canNavigateToNextPage(),s={pageIndex:null!=r?r:void 0,pageLabel:null!=i?i:"",pagesCount:this.pageMapping.length,usePhysicalPageNumbers:this.pageMapping.isPhysical,canCopy:!!this._selectedAnnotationIDs.length||!(null===(e=null===(t=this._iframeWindow.getSelection())||void 0===t?void 0:t.isCollapsed)||void 0===e||e),canZoomIn:void 0===this.scale||this.scale<this.MAX_SCALE,canZoomOut:void 0===this.scale||this.scale>this.MIN_SCALE,canZoomReset:void 0!==this.scale&&1!==this.scale,canNavigateBack:this._history.canNavigateBack,canNavigateForward:this._history.canNavigateForward,canNavigateToFirstPage:o,canNavigateToLastPage:a,canNavigateToPreviousPage:o,canNavigateToNextPage:a,canNavigateToPreviousSection:this.canNavigateToPreviousSection(),canNavigateToNextSection:this.canNavigateToNextSection(),flowMode:this.flowMode,spreadMode:this.spreadMode,appearance:this.appearance,outlinePath:Date.now()-this._lastNavigationTime>1500?this._getOutlinePath():void 0};this._options.onChangeViewStats(s),this.a11yRecordCurrentPage()}_handleViewUpdate(){super._handleViewUpdate(),this.flow.invalidate()}_openFootnoteOverlayPopup(e,t){let n=document.implementation.createHTMLDocument();n.documentElement.dataset.colorScheme=this._iframeDocument.documentElement.dataset.colorScheme;let r="";for(let e of[...this._iframeDocument.styleSheets,...this._iframeDocument.adoptedStyleSheets])for(let t of e.cssRules)r+=t.cssText+"\n\n";r+=`\n\t\t\t:root {\n\t\t\t\t--content-scale: ${this.scale};\n\t\t\t\t--content-font-family: ${this._iframeDocument.documentElement.style.getPropertyValue("--content-font-family")};\n\t\t\t\t--selection-color: ${this._iframeDocument.documentElement.style.getPropertyValue("--selection-color")};\n\t\t\t\t--background-color: ${this._iframeDocument.documentElement.style.getPropertyValue("--background-color")};\n\t\t\t\t--text-color: ${this._iframeDocument.documentElement.style.getPropertyValue("--text-color")};\n\t\t\t}\n\t\t`;let i=n.createElement("meta");i.setAttribute("http-equiv","Content-Security-Policy"),i.setAttribute("content",this._getCSP()),n.head.prepend(i);let o=n.createElement("div"),a=!1,s=/\bIbid\b/,l=t,u=l.cloneNode(!0);for(;!l.classList.contains("section-container");){let e=l.parentElement;if(!e)break;let t=e.cloneNode(!1);if(t.appendChild(u),!a&&l.previousElementSibling&&l.textContent&&s.test(l.textContent)){do{var c;l=l.previousElementSibling;let e=l.cloneNode(!0);t.prepend(e)}while(null!==(c=l.previousElementSibling)&&void 0!==c&&c.textContent&&s.test(l.previousElementSibling.textContent));a=!0}u=t,l=e}o.append(u);for(let e of o.querySelectorAll("a"))this._isExternalLink(e)||e.removeAttribute("href");n.body.append(o);let d=(new XMLSerializer).serializeToString(n),h=e.getBoundingClientRect(),p={type:"footnote",content:d,css:r,rect:[h.left,h.top,h.right,h.bottom],ref:e};this._options.onSetOverlayPopup(p)}_isFootnoteLink(e,t){var n,r,i;if("noteref"===e.getAttributeNS("http://www.idpf.org/2007/ops","type"))return!0;let o=null!==(n=null===(r=e.role)||void 0===r?void 0:r.split(" "))&&void 0!==n?n:[];if(o.includes("doc-noteref")||o.includes("doc-biblioref")||o.includes("doc-glossref"))return!0;if(o.includes("doc-link"))return!1;let a=e,s=3;for(;a&&s>0;){let e=getComputedStyle(a);if(!["inline","inline-block"].includes(e.display))break;if(["sub","super","top","bottom"].includes(e.verticalAlign))return!0;a=a.parentElement,s--}if(e.innerText.trim()&&1===e.children.length){let t=getComputedStyle(e.children[0]);if(["inline","inline-block"].includes(t.display)&&["sub","super","top","bottom"].includes(t.verticalAlign))return!0}let l=null===(i=e.closest("[data-section-index]"))||void 0===i?void 0:i.getAttribute("data-section-index"),u=l&&this.book.spine.get(l);if(!u)return!1;for(let n of t.querySelectorAll("a")){let t=this._getInternalLinkHref(n);if(!t)continue;let[r,i]=this._splitHref(t);if(r===u.href&&i===e.id)return!0}return!1}_getFootnoteTargetElement(e){let t=this._getInternalLinkHref(e);if(!t)return null;let[n,r]=this._splitHref(t);if(!n||!r)return null;let i=this.book.spine.get(n);if(!i)return null;let o=this._sectionRenderers[i.index].container.querySelector('[id="'+CSS.escape(r)+'"]');if(!o)return null;let a=o.getAttributeNS("http://www.idpf.org/2007/ops","type");return a&&["footnote","rearnote","note"].includes(a)||(o=Qa(o)||o),this._isFootnoteLink(e,o)?o:null}async setFindState(e){let t=this._findState;if(this._findState=e,!e.active&&t&&t.active!==e.active)console.log("Closing find popup"),this._find&&(this._find.cancel(),this._find=null,this._handleViewUpdate());else if(e.active)if(this._find&&t&&t.query===e.query&&t.caseSensitive===e.caseSensitive&&t.entireWord===e.entireWord&&t.active===e.active)t&&t.highlightAll!==e.highlightAll&&(this._find.findState.highlightAll=e.highlightAll,this._find.updateFindState(),this._renderAnnotations());else{var n,r;console.log("Initiating new search",e),null===(n=this._find)||void 0===n||n.cancel(),this._find=new gs({view:this,findState:{...e},onSetFindState:t=>{var n;this._options.onSetFindState({...e,result:{total:t.total,index:t.index,snippets:t.snippets,annotation:null!==(n=t.range&&this._getAnnotationFromRange(t.range.toRange(),"highlight"))&&void 0!==n?n:void 0,currentPageLabel:t.range?this.pageMapping.getPageLabel(t.range.toRange()):null,currentSnippet:t.snippets[t.index]}}),t.range&&(this._a11yVirtualCursorTarget=ls(t.range))}});let t=null!==(r=this.flow.startRange&&new ns(this.flow.startRange))&&void 0!==r?r:void 0,i=()=>this.findNext();await this._find.run(t,i)}}setFlowMode(e){e!=this.flowMode&&(this._keepPosition((()=>{this.flow&&this.flow.destroy(),this.flowMode=e,this.flow=new("paginated"==e?Js:Qs)({view:this,iframe:this._iframe,onUpdateViewState:()=>this._updateViewState(),onUpdateViewStats:()=>this._updateViewStats(),onViewUpdate:()=>this._handleViewUpdate(),onPushHistoryPoint:e=>{this._pushHistoryPoint(e)}}),this.flow.setSpreadMode(this.spreadMode)})),this._handleViewUpdate())}setSpreadMode(e){if(e!==cl.None&&e!==cl.Odd)throw new Error("Unsupported spread mode");e!=this.spreadMode&&(this._keepPosition((()=>{var t;this.spreadMode=e,null===(t=this.flow)||void 0===t||t.setSpreadMode(e)})),this._handleViewUpdate())}setAppearance(e){this._keepPosition((()=>{let t,n={...ml,...e};switch(this.appearance=n,this._iframeDocument.documentElement.style.setProperty("--content-line-height-adjust",String(n.lineHeight)),this._iframeDocument.documentElement.style.setProperty("--content-word-spacing-adjust",String(n.wordSpacing)),this._iframeDocument.documentElement.style.setProperty("--content-letter-spacing-adjust",String(n.letterSpacing)),this._iframeDocument.documentElement.classList.toggle("use-original-font",n.useOriginalFont),n.pageWidth){case dl.Narrow:t="narrow";break;case dl.Normal:t="normal";break;case dl.Full:t="full"}this._iframeDocument.documentElement.dataset.pageWidth=t})),this._handleViewUpdate()}setFontFamily(e){this._iframeDocument.documentElement.style.setProperty("--content-font-family",e),this._renderAnnotations(!0)}setHyphenate(e){this._iframeDocument.documentElement.classList.toggle("hyphenate",e),this._renderAnnotations(!0)}async findNext(){if(console.log("Find next"),this._find){let e=this._find,t=await e.next();t&&this.flow.scrollIntoView(t.range),this._renderAnnotations()}}async findPrevious(){if(console.log("Find previous"),this._find){let e=this._find,t=await e.prev();t&&this.flow.scrollIntoView(t.range),this._renderAnnotations()}}_setScale(e){this._keepPosition((()=>{var t;this.scale=e,this._iframeDocument.documentElement.style.setProperty("--content-scale",String(e)),null===(t=this.flow)||void 0===t||t.setScale(e)}))}navigate(e,t={}){if(console.log("Navigating to",e),this._lastNavigationTime=Date.now(),t.behavior||(t.behavior="smooth"),e.pageNumber){let n;if(t.block||(t.block="start"),e.pageNumber.startsWith("epubcfi("))n=this.getRange(e.pageNumber,!0);else{if(this.flow.startRange&&this.pageMapping.getPageLabel(this.flow.startRange)===e.pageNumber)return void console.log("Already on page",e.pageNumber);n=this.pageMapping.getRange(e.pageNumber)}if(!n)return void console.error("Unable to find range");this.flow.scrollIntoView(n,t)}else if(e.href){t.block||(t.block="start");let n=this._getHrefTarget(e.href);if(n&&(this.flow.scrollIntoView(n,t),n!==n.closest(".section-container"))){let e=this._iframeDocument.createRange();n.firstElementChild&&n.innerHTML.length>1e3?e.selectNode(n.firstElementChild||n.firstChild):e.selectNode(n);let t=this.toSelector(e);t&&this._setHighlight(t)}}else super.navigate(e,t)}navigateToFirstPage(){this.flow.navigateToFirstPage()}navigateToLastPage(){this.flow.navigateToLastPage()}canNavigateToPreviousPage(){return this.flow.canNavigateToPreviousPage()}canNavigateToNextPage(){return this.flow.canNavigateToNextPage()}navigateToPreviousPage(){this.flow.navigateToPreviousPage()}navigateToNextPage(){this.flow.navigateToNextPage()}canNavigateToPreviousSection(){var e;return!(null===(e=this.flow.startSection)||void 0===e||!e.prev())}canNavigateToNextSection(){var e;return!(null===(e=this.flow.startSection)||void 0===e||!e.next())}navigateToPreviousSection(){var e;let t=null===(e=this.flow.startSection)||void 0===e?void 0:e.prev();t&&this.navigate({href:t.href})}navigateToNextSection(){var e;let t=null===(e=this.flow.startSection)||void 0===e?void 0:e.next();t&&this.navigate({href:t.href})}async print(){this._iframe.classList.remove("loaded");let e=this._sectionRenderers.filter((e=>!e.mounted));for(let t of e)t.mount();await Promise.allSettled(Array.from(this._iframeDocument.images).map((e=>e.decode()))),"function"==typeof this._iframeWindow.zoteroPrint?await this._iframeWindow.zoteroPrint({overrideSettings:{title:this.book.packaging.metadata.title||"",docURL:"",headerStrLeft:"",headerStrCenter:"",headerStrRight:"",footerStrLeft:"",footerStrCenter:"",footerStrRight:""}}):this._iframeWindow.print();for(let t of e)t.unmount();this._iframe.classList.add("loaded")}setSidebarOpen(e){window.dispatchEvent(new Event("resize"))}get renderers(){return this._sectionRenderers}static getContainingSectionIndex(e){var t;let n;return n=Ka("nodeType"in e?e:e.startContainer.childNodes[e.startOffset]||e.startContainer),n=null===(t=n)||void 0===t?void 0:t.closest("[data-section-index]"),n?parseInt(n.getAttribute("data-section-index")):null}static _compareSectionIndices(e,t){let n=this.getContainingSectionIndex(e);if(null===n)throw new Error("a is not inside a section");let r=this.getContainingSectionIndex(t);if(null===r)throw new Error("b is not inside a section");return n-r}static compareBoundaryPoints(e,t,n){return t.startContainer.getRootNode()!==n.startContainer.getRootNode()?this._compareSectionIndices(t,n)||-1:t.compareBoundaryPoints(e,n)}static compareRangeToPoint(e,t,n){return e.startContainer.getRootNode()!==t.getRootNode()?this._compareSectionIndices(e,t)||-1:-e.comparePoint(t,n)}static compareDocumentPositions(e,t){return e.getRootNode()!==t.getRootNode()?this._compareSectionIndices(e,t)||-1:e.compareDocumentPosition(t)}}let cl=function(e){return e[e.Unknown=-1]="Unknown",e[e.None=0]="None",e[e.Odd=1]="Odd",e[e.Even=2]="Even",e}({}),dl=function(e){return e[e.Narrow=-1]="Narrow",e[e.Normal=0]="Normal",e[e.Full=1]="Full",e}({});const hl=ul,pl=1800,fl=new Set(["Adlm","Arab","Aran","Rohg","Hebr","Mand","Mend","Nkoo","Hung","Samr","Syrc","Thaa","Yezi"]),ml=Object.freeze({lineHeight:1.2,wordSpacing:0,letterSpacing:0,pageWidth:dl.Normal,useOriginalFont:!1}),gl=500;var vl;function yl(){return yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yl.apply(this,arguments)}const bl=e=>o.createElement("svg",yl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),vl||(vl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 4h7V3H0zm0 3h7V6H0zm0 3h7V9H0zm7 2H0v1h7zm2-8h7V3H9zm0 3h7V6H9zm0 3h7V9H9zm7 2H9v1h7z",clipRule:"evenodd"})));var _l;function wl(){return wl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wl.apply(this,arguments)}const Sl=e=>o.createElement("svg",wl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),_l||(_l=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14 4H2V3h12zm0 3H2V6h12zm0 3H2V9h12zM2 12h12v1H2z",clipRule:"evenodd"})));var Cl;function El(){return El=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},El.apply(this,arguments)}const xl=e=>o.createElement("svg",El({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Cl||(Cl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.707 0H2v16h13V5.293zM3 15V1h6v5h5v9zM13.293 5 10 1.707V5zM5 6h2V5H5zm0 3h7V8H5zm7 2H5v1h7z",clipRule:"evenodd"})));var Al;function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kl.apply(this,arguments)}const Dl=e=>o.createElement("svg",kl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Al||(Al=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 16V0h1v16zm9 0V0h1v16zm4-4.707V4.707L11.707 6 11 5.293l2.5-2.5 2.5 2.5-.707.707L14 4.707v6.586L15.293 10l.707.707-2.5 2.5-2.5-2.5.707-.707zM2 4h6V3H2zm0 3h6V6H2zm6 2H2v1h6zm-6 4h6v-1H2z",clipRule:"evenodd"})));var Pl;function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tl.apply(this,arguments)}const Fl=e=>o.createElement("svg",Tl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Pl||(Pl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 2H0V1h3.707l.147.146 5 5L9 6.293V15H0v-1h8V7H3v-.5zm1 .707V6h3.293zM11 1h5v1h-4v12h4v1h-5V1.5z",clipRule:"evenodd"})));var Rl;function Il(){return Il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Il.apply(this,arguments)}const Ol=e=>o.createElement("svg",Il({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Rl||(Rl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M1 4.5V0h1v4h12V0h1v5H1zm8 8V8H2v8H1V7h8.707l.147.146 5 5 .146.147V16h-1v-3H9zm4.293-.5L10 8.707V12z",clipRule:"evenodd"})));var Bl;function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ml.apply(this,arguments)}const Ll=e=>o.createElement("svg",Ml({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Bl||(Bl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 5.5V1h1v4h5V1h1v5H0zm9 0V1h1v4h5V1h1v5H9zM0 8h3.707l.147.146 3 3 .146.147V15H6v-3H3V9H1v6H0V8.5zm4 1.707V11h1.293zM9 8h3.707l.147.146 3 3 .146.147V15h-1v-3h-3V9h-2v6H9V8.5zm4 1.707V11h1.293z",clipRule:"evenodd"})));var Nl;function Vl(){return Vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vl.apply(this,arguments)}const zl=e=>o.createElement("svg",Vl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Nl||(Nl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 3H2.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25H8zm1 0v10h5.75a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25zM2.25 2C1.56 2 1 2.56 1 3.25v9.5c0 .69.56 1.25 1.25 1.25h12.5c.69 0 1.25-.56 1.25-1.25v-9.5C16 2.56 15.44 2 14.75 2zM5 5H3V4h2zm7 0h-2V4h2zM7 6v1H3V6zm7 0v1h-4V6z",clipRule:"evenodd"})));var Ul;function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hl.apply(this,arguments)}const Wl=e=>o.createElement("svg",Hl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Ul||(Ul=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2.25 2h11.5a.25.25 0 0 1 .25.25v11.5a.25.25 0 0 1-.25.25H2.25a.25.25 0 0 1-.25-.25V2.25A.25.25 0 0 1 2.25 2M1 2.25C1 1.56 1.56 1 2.25 1h11.5c.69 0 1.25.56 1.25 1.25v11.5c0 .69-.56 1.25-1.25 1.25H2.25C1.56 15 1 14.44 1 13.75zM4 5h2V4H4zm4 2V6H4v1z",clipRule:"evenodd"})));var jl;function $l(){return $l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$l.apply(this,arguments)}const Gl=e=>o.createElement("svg",$l({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),jl||(jl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12.75 2h-9.5a.25.25 0 0 0-.25.25V8h10V2.25a.25.25 0 0 0-.25-.25M3 14.75V9h10v5.75a.25.25 0 0 1-.25.25h-9.5a.25.25 0 0 1-.25-.25M3.25 1C2.56 1 2 1.56 2 2.25v12.5c0 .69.56 1.25 1.25 1.25h9.5c.69 0 1.25-.56 1.25-1.25V2.25C14 1.56 13.44 1 12.75 1zM4 4h2V3H4zm4 2V5H4v1zm-4 5h2v-1H4zm4 2v-1H4v1z",clipRule:"evenodd"})));var ql;function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kl.apply(this,arguments)}const Yl=e=>o.createElement("svg",Kl({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",viewBox:"0 0 16 16"},e),ql||(ql=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2h-.5v12h15V5.293l-.146-.147-3-3L13.207 2H13zm.5 11V3h6v10zm7 0h6V5.707L12.793 3H9.5zM4.672 7.258h-1v-.051c0-.206.036-.405.11-.598.075-.195.188-.37.34-.527.15-.156.339-.281.566-.375.229-.094.498-.14.808-.14.367 0 .688.065.961.195s.484.308.633.535c.15.224.226.478.226.762 0 .244-.046.463-.14.656-.091.19-.209.368-.352.535-.14.164-.289.332-.445.504L5.168 10.09v.05h2.238V11H3.723v-.656l1.949-2.102c.096-.101.19-.207.281-.316.091-.112.167-.232.227-.36a.953.953 0 0 0 .09-.41.712.712 0 0 0-.387-.648.845.845 0 0 0-.41-.098.81.81 0 0 0-.43.11.75.75 0 0 0-.277.293.824.824 0 0 0-.094.386v.035zm7.18.59v.812h.59c.192 0 .357.035.495.106a.74.74 0 0 1 .445.695.744.744 0 0 1-.116.426.798.798 0 0 1-.336.289 1.204 1.204 0 0 1-.512.101 1.305 1.305 0 0 1-.477-.09.885.885 0 0 1-.332-.238.608.608 0 0 1-.14-.344H10.5c.01.271.09.521.238.75.151.227.367.41.649.547.284.136.626.204 1.027.204.276 0 .535-.036.777-.106.245-.073.461-.177.649-.312a1.47 1.47 0 0 0 .437-.504 1.37 1.37 0 0 0 .157-.676c-.003-.284-.067-.516-.192-.695a1.268 1.268 0 0 0-.453-.415 1.342 1.342 0 0 0-.504-.164V8.18a1.279 1.279 0 0 0 .824-.586 1.11 1.11 0 0 0 .16-.637c-.002-.27-.079-.51-.23-.719a1.478 1.478 0 0 0-.629-.496 2.331 2.331 0 0 0-.965-.176c-.291.003-.55.042-.777.118a1.677 1.677 0 0 0-.57.316c-.157.133-.276.29-.36.469-.083.18-.129.373-.136.582h.98a.662.662 0 0 1 .066-.25.712.712 0 0 1 .172-.215.836.836 0 0 1 .258-.149.989.989 0 0 1 .336-.054.87.87 0 0 1 .59.199.653.653 0 0 1 .234.523.674.674 0 0 1-.101.38.742.742 0 0 1-.293.265.917.917 0 0 1-.43.098z",clipRule:"evenodd"})));var Xl;function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zl.apply(this,arguments)}const Ql=e=>o.createElement("svg",Zl({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Xl||(Xl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 0h7.707L15 5.293V16H2zm1 1v14h11V6H9V1zm7 .707L13.293 5H10z",clipRule:"evenodd"})));var Jl;function eu(){return eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eu.apply(this,arguments)}const tu=e=>o.createElement("svg",eu({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),Jl||(Jl=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M1.5 2H1v12h15V5.293l-.146-.147-3-3L12.707 2H12.5zM2 13V3h6v10zm7 0h6V5.707L12.293 3H9zm-3.062-2H4.89V6.684H4.84c-.133.093-.267.188-.402.285l-.407.289a129.5 129.5 0 0 0-.402.285v-.969l.633-.453.629-.453h1.047zm4.234-3.742h1V7.199c0-.138.031-.267.094-.386a.75.75 0 0 1 .277-.293.81.81 0 0 1 .43-.11c.153 0 .29.033.41.098a.712.712 0 0 1 .387.648c0 .146-.03.283-.09.41-.06.128-.136.248-.227.36-.091.11-.185.215-.281.316l-1.95 2.102V11h3.684v-.86h-2.238v-.05l1.21-1.336c.157-.172.306-.34.446-.504.143-.167.26-.345.352-.535.094-.193.14-.412.14-.656a1.33 1.33 0 0 0-.226-.762 1.51 1.51 0 0 0-.633-.535 2.213 2.213 0 0 0-.96-.196c-.31 0-.58.047-.81.141a1.655 1.655 0 0 0-.566.375 1.568 1.568 0 0 0-.34.527c-.073.193-.11.392-.11.598z",clipRule:"evenodd"})));var nu;function ru(){return ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ru.apply(this,arguments)}const iu=e=>o.createElement("svg",ru({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),nu||(nu=o.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.75 9.75v-7H11v7h7V11h-7v7H9.75v-7h-7V9.75z",clipRule:"evenodd"})));function ou({params:e,enablePageWidth:t,onChange:n}){const r=Ft();if(!e)return null;function i(t){"checkbox"===t.target.type?e[t.target.name]=t.target.checked:e[t.target.name]=parseFloat(t.target.value),n(e)}function a(t){e[t]=ml[t],n(e)}return o.createElement("div",{className:"epub-appearance"},o.createElement("div",{className:"row"},o.createElement("label",{htmlFor:"line-height"},o.createElement(Xn,{id:"pdfReader.epubAppearance.lineHeight"})),o.createElement("input",{"data-tabstop":1,tabIndex:-1,type:"range",id:"line-height",name:"lineHeight",value:e.lineHeight,min:"0.80",max:"2.50",step:"0.05",onChange:i}),o.createElement("span",{className:"value"},e.lineHeight),o.createElement("button",{"data-tabstop":1,tabIndex:-1,className:Tt()("toolbar-button",{hidden:e.lineHeight===ml.lineHeight}),"aria-label":r.formatMessage({id:"pdfReader.epubAppearance.lineHeight.revert"}),onClick:()=>a("lineHeight")},o.createElement(fo,null))),o.createElement("div",{className:"row"},o.createElement("label",{htmlFor:"word-spacing"},o.createElement(Xn,{id:"pdfReader.epubAppearance.wordSpacing"})),o.createElement("input",{"data-tabstop":1,tabIndex:-1,type:"range",id:"word-spacing",name:"wordSpacing",value:e.wordSpacing,min:"-100",max:"100",step:"5",onChange:i}),o.createElement("span",{className:"value"},e.wordSpacing,"%"),o.createElement("button",{"data-tabstop":1,tabIndex:-1,className:Tt()("toolbar-button",{hidden:e.wordSpacing===ml.wordSpacing}),"aria-label":r.formatMessage({id:"pdfReader.epubAppearance.wordSpacing.revert"}),onClick:()=>a("wordSpacing")},o.createElement(fo,null))),o.createElement("div",{className:"row"},o.createElement("label",{htmlFor:"letter-spacing"},o.createElement(Xn,{id:"pdfReader.epubAppearance.letterSpacing"})),o.createElement("input",{"data-tabstop":1,tabIndex:-1,type:"range",id:"letter-spacing",name:"letterSpacing",value:e.letterSpacing,min:"-0.1",max:"0.1",step:"0.005",onChange:i}),o.createElement("span",{className:"value"},1e3*e.letterSpacing,"%"),o.createElement("button",{"data-tabstop":1,tabIndex:-1,className:Tt()("toolbar-button",{hidden:e.letterSpacing===ml.letterSpacing}),"aria-label":r.formatMessage({id:"pdfReader.epubAppearance.letterSpacing.revert"}),onClick:()=>a("letterSpacing")},o.createElement(fo,null))),o.createElement("div",{className:"row"},o.createElement("label",{htmlFor:"page-width"},o.createElement(Xn,{id:"pdfReader.epubAppearance.pageWidth"})),o.createElement("input",{"data-tabstop":1,tabIndex:-1,type:"range",id:"page-width",name:"pageWidth",value:e.pageWidth,min:"-1",max:"1",step:"1",onChange:i,disabled:!t}),o.createElement("span",{className:"value"},(e.pageWidth+3)/4*100,"%"),o.createElement("button",{"data-tabstop":1,tabIndex:-1,className:Tt()("toolbar-button",{hidden:e.pageWidth===ml.pageWidth}),"aria-label":r.formatMessage({id:"pdfReader.epubAppearance.pageWidth.revert"}),onClick:()=>a("pageWidth"),disabled:!t},o.createElement(fo,null))),o.createElement("div",{className:"checkbox-row"},o.createElement("input",{"data-tabstop":1,tabIndex:-1,type:"checkbox",id:"use-original-font",name:"useOriginalFont",checked:e.useOriginalFont,onChange:i}),o.createElement("label",{htmlFor:"use-original-font"},o.createElement(Xn,{id:"pdfReader.epubAppearance.useOriginalFont"}))))}function au({theme:e,active:t,onSet:n,onOpenContextMenu:r}){let i=Ft();const a=ii.some((t=>t.id===e.id)),{platform:s}=(0,o.useContext)(hd);function l(t){n(e.id)}function u(t){t.stopPropagation(),t.preventDefault();let{x:n,y:i}=br(t);r({theme:e,x:n,y:i}),"click"===t.type&&t.currentTarget.classList.add("context-menu-open")}let c=`pdfReader.theme.${e.id}`,d=i.messages[c]?i.formatMessage({id:c}):e.label;return"web"===s?o.createElement("div",{className:Tt()("theme",{active:t}),style:{backgroundColor:e.background||"#ffffff",color:e.foreground||"#000000"}},o.createElement("button",{tabIndex:-1,title:d,onClick:l},d),!a&&o.createElement("button",{title:i.formatMessage({id:"pdfReader.themeOptions"}),tabIndex:-1,className:"theme-context-menu",onClick:u},o.createElement(Gr,null))):o.createElement("button",{tabIndex:-1,className:Tt()("theme",{active:t}),style:{backgroundColor:e.background||"#ffffff",color:e.foreground||"#000000"},title:d,onClick:l,onContextMenu:u},d)}const su=function(e){let t=(0,o.useRef)(),n=Ft();const{type:r,platform:i}=(0,o.useContext)(hd);(0,o.useLayoutEffect)((()=>{window.focus()}),[]);let a=[...ii,...e.customThemes||[]];a=Array.from(new Map(a.map((e=>[e.id,e]))).values());let s="light"===Sr(e.colorScheme)?e.lightTheme:e.darkTheme;return o.createElement("div",{ref:t,className:"toolbar-popup-overlay overlay",onPointerDown:function(n){n.target===t.current&&e.onClose()}},o.createElement("div",{className:Tt()("modal-popup appearance-popup")},"pdf"===r&&o.createElement("div",{className:"group"},o.createElement("div",{className:"option"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.scrollMode"})),o.createElement("div",{className:"split-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()({active:0===e.viewStats.scrollMode}),title:n.formatMessage({id:"pdfReader.vertical"}),onClick:()=>e.onChangeScrollMode(0)},o.createElement(Ol,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:1===e.viewStats.scrollMode}),title:n.formatMessage({id:"pdfReader.horizontal"}),onClick:()=>e.onChangeScrollMode(1)},o.createElement(Fl,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:2===e.viewStats.scrollMode}),title:n.formatMessage({id:"pdfReader.wrapped"}),onClick:()=>e.onChangeScrollMode(2)},o.createElement(Ll,null)))),o.createElement("div",{className:"option"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.spreadMode"})),o.createElement("div",{className:"split-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()({active:0===e.viewStats.spreadMode}),title:n.formatMessage({id:"pdfReader.none"}),onClick:()=>e.onChangeSpreadMode(0)},o.createElement(Ql,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:1===e.viewStats.spreadMode}),title:n.formatMessage({id:"pdfReader.odd"}),onClick:()=>e.onChangeSpreadMode(1)},o.createElement(tu,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:2===e.viewStats.spreadMode}),title:n.formatMessage({id:"pdfReader.even"}),onClick:()=>e.onChangeSpreadMode(2)},o.createElement(Yl,null))))),"epub"===r&&o.createElement("div",{className:"group"},o.createElement("div",{className:"option"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.flowMode"})),o.createElement("div",{className:"split-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()({active:"paginated"===e.viewStats.flowMode}),title:n.formatMessage({id:"pdfReader.paginated"}),onClick:()=>e.onChangeFlowMode("paginated")},o.createElement(xl,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:"scrolled"===e.viewStats.flowMode}),title:n.formatMessage({id:"pdfReader.scrolled"}),onClick:()=>e.onChangeFlowMode("scrolled")},o.createElement(Dl,null)))),o.createElement("div",{className:"option"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.columns"})),o.createElement("div",{className:"split-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()({active:0===e.viewStats.spreadMode}),title:n.formatMessage({id:"pdfReader.single"}),onClick:()=>e.onChangeSpreadMode(0),disabled:"scrolled"===e.viewStats.flowMode},o.createElement(Sl,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:1===e.viewStats.spreadMode}),title:n.formatMessage({id:"pdfReader.double"}),onClick:()=>e.onChangeSpreadMode(1),disabled:"scrolled"===e.viewStats.flowMode},o.createElement(bl,null))))),o.createElement("div",{className:"group"},o.createElement("div",{className:"option"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.splitView"})),o.createElement("div",{className:"split-toggle","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()({active:!e.splitType}),title:n.formatMessage({id:"pdfReader.none"}),onClick:()=>e.onChangeSplitType()},o.createElement(Wl,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:"vertical"===e.splitType}),title:n.formatMessage({id:"pdfReader.vertical"}),onClick:()=>e.onChangeSplitType("vertical")},o.createElement(zl,null)),o.createElement("button",{tabIndex:-1,className:Tt()({active:"horizontal"===e.splitType}),title:n.formatMessage({id:"pdfReader.horizontal"}),onClick:()=>e.onChangeSplitType("horizontal")},o.createElement(Gl,null))))),"epub"===r&&o.createElement("div",{className:"group"},o.createElement(ou,{params:e.viewStats.appearance,enablePageWidth:"paginated"!==e.viewStats.flowMode||0===e.viewStats.spreadMode,onChange:e.onChangeAppearance})),o.createElement("div",{className:"group"},o.createElement("div",{className:"option themes"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.themes"})),o.createElement("div",{className:"themes","data-tabstop":1},o.createElement("button",{tabIndex:-1,className:Tt()("theme original",{active:!s}),style:{backgroundColor:"#ffffff",color:"#000000"},title:n.formatMessage({id:"pdfReader.theme.original"}),onClick:()=>e.onChangeTheme()},o.createElement(Xn,{id:"pdfReader.theme.original"})),a.map(((t,n)=>o.createElement(au,{key:n,theme:t,active:s&&t.id===s.id,onSet:e.onChangeTheme,onOpenContextMenu:e.onOpenThemeContextMenu}))),o.createElement("button",{tabIndex:-1,className:"theme add",onClick:e.onAddTheme,title:n.formatMessage({id:"pdfReader.addTheme"})},o.createElement(iu,null)))))))};function lu(e){return/^#?([a-fA-F0-9]{6})$/.test(e)}function uu({color:e,onChange:t}){let n=(0,o.useRef)();function r(e){t(e.target.value.toUpperCase())}return o.createElement("div",{className:"color-picker"},o.createElement("input",{type:"color",ref:n,value:e,onChange:r}),o.createElement("div",{className:"button-outer"},o.createElement("button",{className:"button",type:"button",style:{backgroundColor:lu(e)&&e||"transparent"},title:lu(e)&&e,tabIndex:-1,"data-tabstop":1,onClick:function(){n.current.click()}})),o.createElement("input",{type:"text",tabIndex:-1,"data-tabstop":1,value:e,placeholder:"#000000",pattern:"^#[0-9a-fA-F]{6}$",maxLength:7,onFocus:function(e){e.target.select()},onChange:r}))}const cu=function({params:e,customThemes:t,colorScheme:n,lightTheme:r,darkTheme:i,onSaveCustomThemes:a,onClose:s}){var l,u,c;let d="light"===Sr()?r:i,h="#FFFFFF",p="#000000";d&&(h=d.background,p=d.foreground);let f=(0,o.useRef)(),[m,g]=(0,o.useState)((null===(l=e.theme)||void 0===l?void 0:l.label)||""),[v,y]=(0,o.useState)((null===(u=e.theme)||void 0===u?void 0:u.background)||h),[b,_]=(0,o.useState)((null===(c=e.theme)||void 0===c?void 0:c.foreground)||p);(0,o.useLayoutEffect)((()=>{f.current.focus()}),[]);let w=!!m.trim().length&&lu(v)&&lu(b);return o.createElement(lo,{className:"theme-popup"},o.createElement("form",{onSubmit:function(n){n.preventDefault(),function(n){let r={},i=new Map(t.map((e=>[e.id,e])));if(e.theme)r={...e.theme};else{let e=1;for(;;){let t="custom"+e;if(!i.has(t)){r.id=t;break}e++}}r.label=m.trim(),r.background=v,r.foreground=b,e.theme?i.set(e.theme.id,r):i.set(r.id,r),a(Array.from(i.values()))}()}},o.createElement("div",{className:"grid"},o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.themeName"})),o.createElement("div",{className:"input"},o.createElement("input",{type:"text",ref:f,tabIndex:-1,value:m,"data-tabstop":1,onInput:function(e){g(e.target.value)}})),o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.background"})),o.createElement("div",{className:"input"},o.createElement(uu,{color:v,onChange:function(e){y(e)}})),o.createElement("label",null,o.createElement(Xn,{id:"pdfReader.foreground"})),o.createElement("div",{className:"input"},o.createElement(uu,{color:b,onChange:function(e){_(e)}}))),o.createElement("div",{className:"row buttons"},o.createElement("button",{tabIndex:-1,"data-tabstop":1,className:"form-button",type:"button",onClick:s},o.createElement(Xn,{id:"general.cancel"})),o.createElement("button",{tabIndex:-1,"data-tabstop":1,type:"submit",className:"form-button primary",disabled:!w},o.createElement(Xn,{id:"general.save"})))))};function du(e){let{primary:t,state:n,categories:r}=e;console.log("View categories:",r);let i=t?"primary":"secondary";return o.createElement("div",{className:i+"-view"},o.createElement("div",{"data-tabstop":1,tabIndex:-1,"data-proxy":`#${i}-view > iframe`,style:{position:"absolute"}}),n[i+"ViewSelectionPopup"]&&!n.readOnly&&o.createElement(Pi,{params:n[i+"ViewSelectionPopup"],textSelectionAnnotationMode:n.textSelectionAnnotationMode,enableAddToNote:n.enableAddToNote,onAddToNote:e.onAddToNote,onAddAnnotation:e.onAddAnnotation,onChangeTextSelectionAnnotationMode:e.onChangeTextSelectionAnnotationMode,categories:r,onContentSelect:e.onContentSelect}),n[i+"ViewAnnotationPopup"]&&(!n.sidebarOpen||"annotations"!==n.sidebarView)&&n.annotations.find((e=>e.id===n[i+"ViewAnnotationPopup"].annotation.id))&&o.createElement(Bi,{type:e.type,readOnly:n.readOnly,params:n[i+"ViewAnnotationPopup"],annotation:n.annotations.find((e=>e.id===n[i+"ViewAnnotationPopup"].annotation.id)),onChange:t=>e.onUpdateAnnotations([t]),onDragStart:()=>{},onOpenTagsPopup:e.onOpenTagsPopup,onOpenPageLabelPopup:e.onOpenPageLabelPopup,onOpenAnnotationContextMenu:e.onOpenAnnotationContextMenu,onSetDataTransferAnnotations:e.onSetDataTransferAnnotations}),n[i+"ViewOverlayPopup"]&&o.createElement(Qi,{params:n[i+"ViewOverlayPopup"],onOpenLink:e.onOpenLink,onNavigate:e.onNavigate,onClose:function(){e.onCloseOverlayPopup(t)}}),n[i+"ViewFindState"].popupOpen&&o.createElement(Oi,{params:n[i+"ViewFindState"],onChange:function(n){e.onChangeFindState(t,n)},onFindNext:function(){e.onFindNext(t)},onFindPrevious:function(){e.onFindPrevious(t)},onAddAnnotation:e.onAddAnnotation,tools:e.tools}))}const hu=o.forwardRef(((e,t)=>{let[n,r]=(0,o.useState)(e.state),i=((0,o.useRef)(),(0,o.useRef)());(0,o.useImperativeHandle)(t,(()=>({setState:r,sidebarScrollAnnotationIntoView:e=>{var t;return null===(t=i.current)||void 0===t?void 0:t.scrollAnnotationIntoView(e)},sidebarEditAnnotationText:e=>{var t;return null===(t=i.current)||void 0===t?void 0:t.editAnnotationText(e)}})));let a=n.primary?n.primaryViewFindState:n.secondaryViewFindState,s=n.primary?n.primaryViewStats:n.secondaryViewStats;return o.createElement(o.Fragment,null,o.createElement("div",null,o.createElement(Gn,{type:e.type,pageIndex:s.pageIndex||0,pageLabel:s.pageLabel||"",pagesCount:s.pagesCount||0,usePhysicalPageNumbers:s.usePhysicalPageNumbers,percentage:s.percentage||"",sidebarOpen:n.sidebarOpen,enableZoomOut:s.canZoomOut,enableZoomIn:s.canZoomIn,enableZoomReset:s.canZoomReset,enableNavigateBack:s.canNavigateBack,enableNavigateToPreviousPage:s.canNavigateToPreviousPage,enableNavigateToNextPage:s.canNavigateToNextPage,appearancePopup:n.appearancePopup,findPopupOpen:a.popupOpen,themes:n.themes,onChangeTheme:e.onChangeTheme,tool:n.tool,readOnly:n.readOnly,stackedView:null!==n.bottomPlaceholderHeight,showContextPaneToggle:n.showContextPaneToggle,onToggleSidebar:e.onToggleSidebar,onZoomIn:e.onZoomIn,onZoomOut:e.onZoomOut,onZoomReset:e.onZoomReset,onNavigateBack:e.onNavigateBack,onNavigateToPreviousPage:e.onNavigateToPreviousPage,onNavigateToNextPage:e.onNavigateToNextPage,onChangePageNumber:e.onChangePageNumber,onChangeTool:e.onChangeTool,onOpenColorContextMenu:e.onOpenColorContextMenu,onToggleAppearancePopup:e.onToggleAppearancePopup,onToggleFind:e.onToggleFind,onToggleContextPane:e.onToggleContextPane}),o.createElement("div",null,!0===n.sidebarOpen&&o.createElement(ki,{type:e.type,view:n.sidebarView,filter:n.filter,outline:n.outline,outlineQuery:n.outlineQuery,onUpdateOutline:e.onUpdateOutline,onUpdateOutlineQuery:e.onUpdateOutlineQuery,onChangeView:e.onChangeSidebarView,onChangeFilter:e.onChangeFilter,thumbnailsView:o.createElement(Vi,{pageLabels:n.pageLabels,thumbnails:n.thumbnails,currentPageIndex:s.pageIndex||0,onOpenThumbnailContextMenu:e.onOpenThumbnailContextMenu,onRenderThumbnails:e.onRenderThumbnails,onNavigate:e.onNavigate}),annotationsView:o.createElement(li,{ref:i,type:e.type,readOnly:n.readOnly,filter:n.filter,annotations:n.annotations,selectedIDs:n.selectedAnnotationIDs,authorName:n.authorName,onSelectAnnotations:e.onSelectAnnotations,onUpdateAnnotations:e.onUpdateAnnotations,onDeleteAnnotations:e.onDeleteAnnotations,onOpenTagsPopup:e.onOpenTagsPopup,onOpenPageLabelPopup:e.onOpenPageLabelPopup,onOpenAnnotationContextMenu:e.onOpenAnnotationContextMenu,onOpenSelectorContextMenu:e.onOpenSelectorContextMenu,onChangeFilter:e.onChangeFilter,onSetDataTransferAnnotations:e.onSetDataTransferAnnotations,onClickContent:e.onClickContent}),outlineView:o.createElement(Hi,{outline:n.outline,currentOutlinePath:s.outlinePath,onNavigate:e.onNavigate,onOpenLink:e.onOpenLink,onUpdate:e.onUpdateOutline})})),!0===n.sidebarOpen&&o.createElement(Mi,{onResize:e.onResizeSidebar})),o.createElement("div",{className:"split-view"},o.createElement(du,Dt({},e,{primary:!0,state:n,categories:n.categories})),o.createElement(Li,{onResize:e.onResizeSplitView}),n.splitType&&o.createElement(du,Dt({},e,{primary:!1,state:n,categories:n.categories}))),n.contextMenu&&o.createElement(oo,{params:n.contextMenu,onClose:e.onCloseContextMenu}),n.labelPopup&&o.createElement(so,{params:n.labelPopup,onUpdateAnnotations:e.onUpdateAnnotations,onClose:e.onCloseLabelPopup}),n.passwordPopup&&o.createElement(uo,{params:n.passwordPopup,onEnterPassword:e.onEnterPassword}),n.printPopup&&o.createElement(co,{params:n.printPopup}),n.errorMessage&&o.createElement("div",{className:"error-bar",tabIndex:-1},n.errorMessage),n.appearancePopup&&o.createElement(su,{customThemes:n.customThemes,colorScheme:n.colorScheme,lightTheme:n.lightTheme,darkTheme:n.darkTheme,splitType:n.splitType,viewStats:s,onChangeSplitType:e.onChangeSplitType,onChangeScrollMode:e.onChangeScrollMode,onChangeSpreadMode:e.onChangeSpreadMode,onChangeFlowMode:e.onChangeFlowMode,onChangeAppearance:e.onChangeAppearance,onAddTheme:e.onAddTheme,onChangeTheme:e.onChangeTheme,onOpenThemeContextMenu:e.onOpenThemeContextMenu,onClose:()=>e.onToggleAppearancePopup(!1)}),n.themePopup&&o.createElement(cu,{params:n.themePopup,customThemes:n.customThemes,colorScheme:n.colorScheme,lightTheme:n.lightTheme,darkTheme:n.darkTheme,onSaveCustomThemes:e.onSaveCustomThemes,onClose:e.onCloseThemePopup}),o.createElement("div",{id:"a11yAnnouncement","aria-live":"polite"}))}));function pu(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1]),Math.min(e[2],t[2]),Math.min(e[3],t[3])]}function fu(e,t){if(e.nextPageRects&&e.pageIndex+1===t){let t=e.nextPageRects;return[Math.min(...t.map((e=>e[0]))),Math.min(...t.map((e=>e[1]))),Math.max(...t.map((e=>e[2]))),Math.max(...t.map((e=>e[3])))]}if(e.rects&&(e.pageIndex===t||void 0===t)){let t=e.rects;if(e.rotation){let n=t[0],r=Su(n,e.rotation),i=yu([n[0],n[1]],r),o=yu([n[2],n[3]],r),a=yu([n[2],n[1]],r),s=yu([n[0],n[3]],r);return[Math.min(i[0],o[0],a[0],s[0]),Math.min(i[1],o[1],a[1],s[1]),Math.max(i[0],o[0],a[0],s[0]),Math.max(i[1],o[1],a[1],s[1])]}return[Math.min(...t.map((e=>e[0]))),Math.min(...t.map((e=>e[1]))),Math.max(...t.map((e=>e[2]))),Math.max(...t.map((e=>e[3])))]}if(e.paths){let t=e.paths[0][0],n=e.paths[0][1],r=[t,n,t,n];for(let t of e.paths)for(let e=0;e<t.length-1;e+=2){let n=t[e],i=t[e+1];r[0]=Math.min(r[0],n),r[1]=Math.min(r[1],i),r[2]=Math.max(r[2],n),r[3]=Math.max(r[3],i)}return r}}function mu(e,t){return!(t[0]>e[2]||t[2]<e[0]||t[1]>e[3]||t[3]<e[1])}function gu(e,t){let[n,r]=t.rects[0];if(e.nextPageRects&&e.pageIndex+1===t.pageIndex)for(let t=0;t<e.nextPageRects.length;t++){let[i,o]=e.nextPageRects.slice(t,t+2);if(!(n>i[2]||n<i[0]||r>i[3]||r<i[1]))return!0;if(o&&n>i[0]&&n>o[0]&&n<i[2]&&n<o[2]&&r<i[3]&&r>o[1]&&i[1]-o[3]<Math.min(i[3]-i[1],o[3]-o[1]))return!0}else if(e.pageIndex===t.pageIndex)if(e.rects)for(let t=0;t<e.rects.length;t++){let[i,o]=e.rects.slice(t,t+2);if(!(n>i[2]||n<i[0]||r>i[3]||r<i[1]))return!0;if(o&&n>i[0]&&n>o[0]&&n<i[2]&&n<o[2]&&r<i[3]&&r>o[1]&&i[1]-o[3]<Math.min(i[3]-i[1],o[3]-o[1]))return!0}else if(e.paths){let t=Math.max(7,e.width);for(let i of e.paths)for(let e=0;e<i.length-1;e+=2){let o=i[e],a=i[e+1];if(Math.hypot(o-n,a-r)<t)return!0}}return!1}function vu(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}function yu(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}function bu(e,t){const n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}function _u(e,t,n){let r=((e=e.slice())[2]-e[0])/t;return n.includes("b")?e[1]=e[3]-r:n.includes("t")&&(e[3]=e[1]+r),e}function wu(e,t){const n=yu(e,t),r=yu(e.slice(2,4),t),i=yu([e[0],e[3]],t),o=yu([e[2],e[1]],t);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}function Su(e,t){t=t*Math.PI/180;let n=Math.cos(t),r=Math.sin(t),i=[n,r,-r,n,0,0],o=(e=function(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}(e))[0]+(e[2]-e[0])/2,a=e[1]+(e[3]-e[1])/2,s=wu(e,i),l=o-(s[0]+(s[2]-s[0])/2),u=a-(s[1]+(s[3]-s[1])/2);return i[4]=l,i[5]=u,i}function Cu(e,t,n,r,i){let o,a;return"tl"===i?(o=[e[2],e[1]],a=[t[2],t[1]]):"bl"===i?(o=[e[2],e[3]],a=[t[2],t[3]]):"br"===i?(o=[e[0],e[3]],a=[t[0],t[3]]):"tr"===i?(o=[e[0],e[1]],a=[t[0],t[1]]):"t"===i?(o=[e[2],e[1]],a=[t[2],t[1]]):"b"===i?(o=[e[0],e[3]],a=[t[0],t[3]]):"l"===i?(o=[e[2],e[1]],a=[t[2],t[1]]):"r"===i&&(o=[e[0],e[3]],a=[t[0],t[3]]),o=yu(o,n),a=yu(a,r),[1,0,0,1,a[0]-o[0],a[1]-o[1]]}function Eu(e,t,n){let r=(e[0][0]+e[2][0])/2,i=(e[0][1]+e[2][1])/2,o=[e[1][0]-e[0][0],e[1][1]-e[0][1]],a=[e[3][0]-e[0][0],e[3][1]-e[0][1]],s=Math.sqrt(o[0]**2+o[1]**2),l=Math.sqrt(a[0]**2+a[1]**2),u=[o[0]/s,o[1]/s],c=[a[0]/l,a[1]/l],d=(s+n)/s,h=(l+n)/l;return t.map((e=>{let t=[e[0]-r,e[1]-i],n=t[0]*u[0]+t[1]*u[1],o=t[0]*c[0]+t[1]*c[1],a=[d*n*u[0]+h*o*c[0],d*n*u[1]+h*o*c[1]];return[r+a[0],i+a[1]]}))}function xu(e,t){let n=yu(e,t),r=yu(e.slice(2,4),t);return[n[0],n[1],r[0],r[1]]}function Au(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}function ku(e,t){const n=e[2]-e[0],r=e[3]-e[1],i=t[2]-t[0],o=t[3]-t[1],a=n/r;if(a===i/o)return i/n;const s=o*a;return s<=i?s/n:i/a/r}function Du(e,t){const[n,r,i,o]=e,[a,s,l,u]=t,c=Math.max(n,a)>Math.min(i,l)?Math.max(n,a)-Math.min(i,l):0,d=Math.max(r,s)>Math.min(o,u)?Math.max(r,s)-Math.min(o,u):0;return Math.hypot(c,d)}function Pu(e,t){const n=e[0],r=e[1],i=e[2],o=e[3],a=t[0],s=t[1],l=(t[2]-a)/(i-n),u=(t[3]-s)/(o-r);return[l,0,0,u,a-n*l,s-r*u]}function Tu(e){return(e%360+360)%360}function Fu(e){let[t,n]=e;return Tu(-Math.atan2(n,t)*(180/Math.PI))}function Ru(e,t){let[n,r,i]=function(e){return`rgb(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)})`}(e).match(/\d+/g).map(Number);return n=Math.max(0,n*(1-t/100)),r=Math.max(0,r*(1-t/100)),i=Math.max(0,i*(1-t/100)),function(e,t,n){return"#"+[e,t,n].map((e=>{let t=e.toString(16);return 1===t.length?"0"+t:t})).join("")}(Math.round(n),Math.round(r),Math.round(i))}function Iu(e){let t=0;for(let n of e)t+=(n[2]-n[0])*(n[3]-n[1]);return t}function Ou(e,t,n){let r=null,i=null;for(let o of t){let t=o.rect;if("left"===n){if(e[0]>=t[2]){let n=Du([e[0],e[1],e[0],e[3]],[t[2],t[1],t[2],t[3]]);n>=0&&(!r||i>n)&&(r=o,i=n)}}else if("right"===n){if(t[0]>=e[2]){let n=Du([e[2],e[1],e[2],e[3]],[t[0],t[1],t[0],t[3]]);n>=0&&(!r||i>n)&&(r=o,i=n)}}else if("top"===n){if(t[3]<=e[1]){let n=Du([e[0],e[1],e[2],e[1]],[t[0],t[3],t[2],t[3]]);n>=0&&(!r||i>n)&&(r=o,i=n)}}else if("bottom"===n&&e[3]<=t[1]){let n=Du([e[0],e[3],e[2],e[3]],[t[0],t[1],t[2],t[1]]);n>=0&&(!r||i>n)&&(r=o,i=n)}}if(!r)for(let o of t){let t=o.rect;if(mu(e,t)||!n){let n=Du(e,t);(!r||i>n)&&(r=o,i=n)}}return r}function Bu(e,t,n){let r=[],i=t;for(let t=i;t<=n;t++){let o=e[t];if(o.lineBreakAfter||t===n){let n=e[i],a=o,s=[n.rect[0],n.inlineRect[1],a.rect[2],n.inlineRect[3]];r.push(s),i=t+1}}return r}function Mu([e,t,n,r],[i,o,a,s]){let l=a<e,u=n<i,c=s<t,d=r<o;return d&&l?Math.hypot(e-a,r-o):l&&c?Math.hypot(e-a,t-s):c&&u?Math.hypot(n-i,t-s):u&&d?Math.hypot(n-i,r-o):l?e-a:u?i-n:c?t-s:d?o-r:0}function Lu(e,t){let n=1/0,r=0;for(let i=0;i<e.length;i++){let o=Mu(e[i].rect,t);o<n&&(n=o,r=i)}return r}function Nu(e,t){return!(t[0]>e[2]||t[2]<e[0]||t[1]>e[3]||t[3]<e[1])}function Vu(e){return[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2,e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2]}function zu(e){let t=[],n=null;for(let r of e)n||(n=r.inlineRect.slice()),n=[Math.min(n[0],r.inlineRect[0]),Math.min(n[1],r.inlineRect[1]),Math.max(n[2],r.inlineRect[2]),Math.max(n[3],r.inlineRect[3])],r.lineBreakAfter&&(t.push(n),n=null);return n&&t.push(n),t}function Uu(e){let t=[];for(let n of e)n.ignorable||(t.push(n.c),(n.spaceAfter||n.lineBreakAfter)&&t.push(" ")),!n.ignorable&&n.paragraphBreakAfter&&t.push(" ");return t.join("").trim()}function Hu(e,t,n){let r,i;if(t<n)r=t,i=n-1;else{if(!(t>n))return{collapsed:!0,anchorOffset:t,headOffset:n,rects:[],text:""};r=n,i=t-1}let o=e.slice(r,i+1),a=Uu(o),s=zu(o);return s=s.map((e=>e.map((e=>parseFloat(e.toFixed(3)))))),{anchorOffset:t,headOffset:n,rects:s,text:a}}function Wu(e,t){let n,r,i=null,o=0;for(let a=0;a<e.length;a++)if(e[a].wordBreakAfter){let s=a,l=e.slice(o,s+1),u=[Math.min(...l.map((e=>e.inlineRect[0]))),Math.min(...l.map((e=>e.inlineRect[1]))),Math.max(...l.map((e=>e.inlineRect[2]))),Math.max(...l.map((e=>e.inlineRect[3])))],c=Mu(t,u);(null===i||c<i)&&(i=c,n=o,r=s),o=s+1}return{anchorOffset:n,headOffset:r+1}}function ju(e,t){let n,r,i=null,o=0;for(let a=0;a<e.length;a++)if(e[a].lineBreakAfter){let s=a,l=e.slice(o,s+1),u=[Math.min(...l.map((e=>e.inlineRect[0]))),Math.min(...l.map((e=>e.inlineRect[1]))),Math.max(...l.map((e=>e.inlineRect[2]))),Math.max(...l.map((e=>e.inlineRect[3])))],c=Mu(t,u);(null===i||c<i)&&(i=c,n=o,r=s),o=s+1}return{anchorOffset:n,headOffset:r+1}}function $u({chars:e,pageIndex:t,anchor:n,head:r,reverse:i}){let o=function({chars:e,anchor:t,head:n,reverse:r}){if(!e.length)return null;let i,o,a,s,l=r?e.length:0,u=r?0:e.length;if(Number.isInteger(t)?(l=t,l=l<0?0:l,l=l>e.length?e.length:l):Array.isArray(t)&&([i,o]=t,l=Lu(e,[i,o,i,o])),Number.isInteger(n)?(u=n,u=u<0?0:u,u=u>e.length?e.length:u):Array.isArray(n)&&([a,s]=n,u=Lu(e,[a,s,a,s])),Array.isArray(t)){let{rotation:t,rect:n,c:r}=e[l],a=!1;(a&&!t&&i<n[0]+(n[2]-n[0])/2||!a&&(!t&&i>n[0]+(n[2]-n[0])/2||90===t&&o>n[1]+(n[3]-n[1])/2||180===t&&i<n[0]+(n[2]-n[0])/2||270===t&&o<n[1]+(n[3]-n[1])/2))&&l++}if(Array.isArray(n)){let{rotation:t,rect:n,c:r}=e[u],i=!1;(i&&!t&&a<n[0]+(n[2]-n[0])/2||!i&&(!t&&a>n[0]+(n[2]-n[0])/2||90===t&&s>n[1]+(n[3]-n[1])/2||180===t&&a<n[0]+(n[2]-n[0])/2||270===t&&s<n[1]+(n[3]-n[1])/2))&&u++}return Hu(e,l,u)}({chars:e,anchor:n,head:r,reverse:i});return o?(o.position={pageIndex:t,rects:o.rects},delete o.rects,o):null}function Gu({chars:e,pageIndex:t,rects:n}){let r=function(e,t){if(!e.length)return null;let n=1/0;for(let r=0;r<e.length;r++)if(Nu(Vu(e[r].rect),t[0])){n=r;break}let r=0;for(let n=e.length-1;n>=0;n--)if(Nu(Vu(e[n].rect),t[t.length-1])){r=n;break}if(r++,n>r)return null;let i=Hu(e,n,r);return i.offset=i.anchorOffset,i.from=i.anchorOffset,i.to=i.headOffset,i}(e,n);return r?(r.position={pageIndex:t,rects:r.rects},delete r.rects,r):null}function qu(e,t){let{pageIndex:n}=t,r=0,i=0;if(e[t.pageIndex]){let{chars:n}=e[t.pageIndex],o=e[t.pageIndex].viewBox,a=function(e){var t;return null==e||null===(t=e.rects)||void 0===t?void 0:t.slice().sort(((e,t)=>t[2]-e[2]))[0]}(t)||fu(t);r=n.length&&Lu(n,a)||0,i=o[3]-o[1]-a[3],i<0&&(i=0)}return[n.toString().slice(0,5).padStart(5,"0"),r.toString().slice(0,6).padStart(6,"0"),Math.floor(i).toString().slice(0,5).padStart(5,"0")].join("|")}function Ku(e,t,n){if(!t.length)return[];let r=t.find((e=>e.anchor)),i={pageIndex:r.position.pageIndex,offset:r.anchorOffset};r=t.find((e=>e.head));let o={pageIndex:r.position.pageIndex,offset:r.headOffset};if(!e[o.pageIndex])return[];if("left"===n)if(0===o.offset){if(e[o.pageIndex-1]){let{chars:t}=e[o.pageIndex-1];t.length&&(o.pageIndex--,o.offset=t.length-1)}}else o.offset--;else if("right"===n){let{chars:t}=e[o.pageIndex];if(o.offset===t.length){if(e[o.pageIndex+1]){let{chars:t}=e[o.pageIndex+1];t.length&&(o.pageIndex++,o.offset=1)}}else o.offset++}else if("up"===n)if(0===o.offset){if(e[o.pageIndex-1]){let{chars:t}=e[o.pageIndex-1];t.length&&(o.pageIndex--,o.offset=t.length-1)}}else{let{chars:t}=e[o.pageIndex],n=function(e,t){t===e.length&&t--;let n=e.findLastIndex(((e,n)=>n<t&&e.lineBreakAfter));if(-1===n)return 0;let r=e.findLastIndex(((e,t)=>t<n&&e.lineBreakAfter));-1===r?r=0:r++;let i=null,o=null,a=e[t];for(let t=r;t<=n;t++){let n=e[t];(null===o||Mu(n.rect,a.rect)<o)&&(o=Mu(n.rect,a.rect),i=t)}return i}(t,o.offset);null!==n&&(o.offset=n)}else if("down"===n){let{chars:t}=e[o.pageIndex];if(o.offset===t.length){if(e[o.pageIndex+1]){let{chars:t}=e[o.pageIndex+1];t.length&&(o.pageIndex++,o.offset=1)}}else{let e=function(e,t){let n=e.findIndex(((e,n)=>n>=t&&e.lineBreakAfter));if(-1===n||n===e.length-1)return e.length;let r=n+1,i=e.findIndex(((e,t)=>t>=r&&e.lineBreakAfter)),o=null,a=null,s=e[t];for(let t=r;t<=i;t++){let n=e[t];(null===a||Mu(n.rect,s.rect)<a)&&(a=Mu(n.rect,s.rect),o=t)}return o}(t,o.offset);null!==e&&(o.offset=e)}}else"object"==typeof n&&(o=n);return Zu(e,i,o)}function Yu(e,t,n){if(!e[t.pageIndex])return[];let{chars:r}=e[t.pageIndex],i=Wu(r,t.rects[0]);r=e[n.pageIndex].chars;let o=Wu(r,n.rects[0]);if(!i||!o)return[];let a={pageIndex:t.pageIndex},s={pageIndex:n.pageIndex};return i.anchorOffset<=o.anchorOffset&&a.pageIndex===s.pageIndex||a.pageIndex<s.pageIndex?(a.offset=i.anchorOffset,s.offset=o.headOffset):(a.offset=i.headOffset,s.offset=o.anchorOffset),Zu(e,a,s)}function Xu(e,t,n){if(!e[t.pageIndex])return[];let{chars:r}=e[t.pageIndex],i=ju(r,t.rects[0]);r=e[n.pageIndex].chars;let o=ju(r,n.rects[0]);if(!i||!o)return[];let a={pageIndex:t.pageIndex},s={pageIndex:n.pageIndex};return i.anchorOffset<=o.anchorOffset&&a.pageIndex===s.pageIndex||a.pageIndex<s.pageIndex?(a.offset=i.anchorOffset,s.offset=o.headOffset):(a.offset=i.headOffset,s.offset=o.anchorOffset),Zu(e,a,s)}function Zu(e,t,n){let r=[],i=Math.min(t.pageIndex,n.pageIndex),o=Math.max(t.pageIndex,n.pageIndex),a=t.pageIndex>n.pageIndex;for(let s=i;s<=o;s++){if(!e[s])continue;let i,o;s===t.pageIndex&&(i=void 0!==t.offset?t.offset:[t.rects[0][0],t.rects[0][1]]),s===n.pageIndex&&(o=void 0!==n.offset?n.offset:[n.rects[0][0],n.rects[0][1]]);let{chars:l}=e[s],u=$u({chars:l,pageIndex:s,anchor:i,head:o,reverse:a});if(!u)return[];s===t.pageIndex&&(u.anchor=!0),s===n.pageIndex&&(u.head=!0),u.collapsed||(u.sortIndex=qu(e,u.position)),r.push(u)}return function(e,t){if(!t.length)return[];if(!0===t[0].collapsed)return t;let n,r,i=function(e,t){const n=[];return t.forEach((t=>{const r=t.position.pageIndex,i=e[r];if(!i)return;let{chars:o}=i;const a=t.anchorOffset,s=t.headOffset,l=Math.min(a,s),u=Math.max(a,s);n.push(...o.slice(l,u))})),n}(e,t);if(r=t[0].anchor?!t[0].head||t[0].anchorOffset<t[0].headOffset:t.at(-1).anchorOffset<t.at(-1).headOffset,n=r?!!i[0].isolated:!!i.at(-1).isolated,i=n?i.filter((e=>e.isolated)):i.filter((e=>!e.isolated)),0===i.length)return[];let o=t[0].headOffset<t[0].anchorOffset;t=[];let a={pageIndex:i[0].pageIndex,anchorOffset:i[0].offset,headOffset:i[0].offset};for(let e=0;e<i.length;e++){const n=i[e];n.pageIndex!==a.pageIndex?(t.push(a),a={pageIndex:n.pageIndex,anchorOffset:n.offset,headOffset:n.offset+1}):a.headOffset=n.offset+1}if(t.push(a),o)for(let e of t){let t=e.anchorOffset;e.anchorOffset=e.headOffset,e.headOffset=t}1===t.length?(t[0].anchor=!0,t[0].head=!0):r?(t[0].anchor=!0,t.at(-1).head=!0):(t.at(-1).anchor=!0,t[0].head=!0);for(let n of t){let{chars:t}=e[n.pageIndex],r=Math.min(n.anchorOffset,n.headOffset),i=Math.max(n.anchorOffset,n.headOffset),o=zu(t.slice(r,i));n.position={pageIndex:n.pageIndex,rects:o},n.sortIndex=qu(e,n.position),n.text=Uu(t.slice(r,i)),n.anchorOffset===n.headOffset&&(n.collapsed=!0)}return t}(e,r)}function Qu(e,t){if(!e[t.pageIndex])return[];let{chars:n}=e[t.pageIndex],r=[],i=Gu({chars:n,pageIndex:t.pageIndex,rects:t.rects});if(!i)return[];if(r=[i],t.nextPageRects){let{chars:n}=e[t.pageIndex+1];i=Gu({chars:n,pageIndex:t.pageIndex+1,rects:t.nextPageRects}),i&&r.push(i)}return 2===r.length?(r[0].anchor=!0,r[1].head=!0):(r[0].head=!0,r[0].anchor=!0),r}function Ju(e){2===(e=JSON.parse(JSON.stringify(e))).length&&(delete e[0].anchor,delete e[1].head,e[0].head=!0,e[1].anchor=!0);let t=e[0].anchorOffset;if(e[0].anchorOffset=e[0].headOffset,e[0].headOffset=t,2===e.length){let t=e[1].anchorOffset;e[1].anchorOffset=e[1].headOffset,e[1].headOffset=t}return e}function ec(e){return!e.length||e[0].collapsed?"":e.map((e=>e.text)).join("\n")}function tc(e,t){let n=[];for(let r of e)Nu(Vu(r.rect),t)&&n.push(r);return n.length?function(e){let t=e.reduce(((e,t)=>({...e,[t]:(e[t]||0)+1})),{});return+Object.keys(t).reduce(((e,n)=>t[e]>t[n]?e:n))}(n.map((e=>e.rotation))):0}function nc(e,t){let n,r=0,i=0,o=[e];for(;n=o.pop();)if(n.nodeType===Node.TEXT_NODE){r=0;for(let e=0;e<n.length;e++){if(n.nodeValue[e].trim()){if(t===i)return{node:n,offset:r};i++}r++}if(t===i)return{node:n,offset:r}}else{let e=n.childNodes.length;for(;e--;)o.push(n.childNodes[e])}}function rc(e,t){let n=t[0],r=Math.min(n.anchorOffset,n.headOffset),i=e.document.querySelector(`[data-page-number="${n.position.pageIndex+1}"] .textLayer`),{node:o,offset:a}=nc(i,r);n=t[t.length-1],r=Math.max(n.anchorOffset,n.headOffset),i=e.document.querySelector(`[data-page-number="${n.position.pageIndex+1}"] .textLayer`);let{node:s,offset:l}=nc(i,r),u=e.document.createRange();u.setStart(i,0),u.collapse(!0),u.setStart(o,a),u.setEnd(s,l);let c=e.getSelection();c.removeAllRanges(),c.addRange(u)}class ic{constructor(e,t){this.layer=e,this.originalPage=t,this.pageIndex=t.id-1,this.overlays=[],this.chars=[],this.selectionColor="#bad6fb",this.previouslyAffected=!1;let n=document.createElement("canvas");n.width=this.originalPage.canvas.width,n.height=this.originalPage.canvas.height,this.originalCanvas=n,this.originalContext=n.getContext("2d"),this.originalContext.drawImage(this.originalPage.canvas,0,0),this.actualContext=this.originalPage.canvas.getContext("2d")}getSortedObjects(){let e=[...this.layer._getPageAnnotations(this.pageIndex),...this.overlays];return e.sort(((e,t)=>e.sortIndex<t.sortIndex)),e}async redrawOriginalPage(){const{viewport:e,outputScale:t,pdfPage:n}=this.originalPage;n.pendingCleanup=!0,n._tryCleanup();const r=t.scaled?[t.sx,0,0,t.sy,0,0]:null,i=this.originalPage.pdfPage.render({canvasContext:this.originalContext,transform:r,viewport:e});await i.promise,this.previouslyAffected=!0}get transform(){let e=this.originalPage.currentCanvasWidth/this.originalPage.viewport.width;return vu([e,0,0,e,0,0],this.originalPage.viewport.transform)}get scale(){let[e,t]=this.transform;return Math.hypot(e,t)}getViewPoint(e,t=this.transform){return yu(e,t)}getPdfPoint(e){return bu(e,this.transform)}getViewRect(e,t=this.transform){let n=yu(e,t),r=yu(e.slice(2,4),t),[i,o]=n,[a,s]=r;return[Math.min(i,a),Math.min(o,s),Math.max(i,a),Math.max(o,s)]}p2v(e){let t=this.transform;if(e.rects){if(e.nextPageRects&&e.pageIndex+1===this.pageIndex)return{pageIndex:e.pageIndex,nextPageRects:e.nextPageRects.map((e=>{let[n,r]=yu(e,t),[i,o]=yu(e.slice(2,4),t);return[Math.min(n,i),Math.min(o,r),Math.max(n,i),Math.max(o,r)]}))};{let n={pageIndex:e.pageIndex,rects:e.rects.map((e=>{let[n,r]=yu(e,t),[i,o]=yu(e.slice(2,4),t);return[Math.min(n,i),Math.min(o,r),Math.max(n,i),Math.max(o,r)]}))};return e.fontSize&&(n.fontSize=e.fontSize*this.scale),e.rotation&&(n.rotation=e.rotation),n}}if(e.paths)return{pageIndex:e.pageIndex,width:e.width*this.scale,paths:e.paths.map((e=>{let n=[];for(let r=0;r<e.length-1;r+=2){let i=e[r],o=e[r+1];n.push(...yu([i,o],t))}return n}))}}v2p(e){let t=this.transform;return{pageIndex:e.pageIndex,rects:e.rects.map((e=>{let[n,r]=bu(e,t),[i,o]=bu(e.slice(2,4),t);return[Math.min(n,i),Math.min(o,r),Math.max(n,i),Math.max(o,r)]}))}}drawHover(){if(!this.layer._hover)return;this.actualContext.save(),"light"===this.layer._themeColorScheme?(this.actualContext.globalAlpha=.1,this.actualContext.globalCompositeOperation="multiply"):(this.actualContext.globalAlpha=.5,this.actualContext.globalCompositeOperation="lighten"),this.actualContext.fillStyle="#46b1ff";let e,t=this.layer._hover;if(t=this.p2v(t),t.pageIndex===this.pageIndex?e=t.rects:t.nextPageRects&&t.pageIndex+1===this.pageIndex&&(e=t.nextPageRects),e)for(let t of e)this.actualContext.fillRect(t[0],t[1],t[2]-t[0],t[3]-t[1]);this.actualContext.restore()}drawOverlays(){if(this.layer._pdfPages[this.pageIndex]){this.actualContext.save(),"light"===this.layer._themeColorScheme?(this.actualContext.globalAlpha=.1,this.actualContext.globalCompositeOperation="multiply"):(this.actualContext.globalAlpha=.4,this.actualContext.globalCompositeOperation="lighten"),this.actualContext.fillStyle="#76c6ff";for(let e of this.layer._pdfPages[this.pageIndex].overlays){if("citation"!==e.type&&("internal-link"!==e.type||"matched"!==e.source))continue;let{position:t}=e;t=this.p2v(t);let n=t.rects;if(t.nextPageRects&&t.pageIndex+1===this.pageIndex)n=t.nextPageRects;else if(t.pageIndex!==this.pageIndex)continue;for(let e of n)this.actualContext.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}this.actualContext.restore()}}drawNote(e,t){e.beginPath(),e.fillStyle=t;let n=[.5,.5,23.5,.5,23.5,23.5,11.5,23.5,.5,12.5,.5,.5];e.moveTo(n[0],n[1]);for(let t=2;t<n.length-1;t+=2)e.lineTo(n[t],n[t+1]);e.closePath(),e.fill(),e.beginPath(),e.fillStyle="rgba(255, 255, 255,0.4)",n=[.5,12.5,11.5,12.5,11.5,23.5,.5,12.5],e.moveTo(n[0],n[1]);for(let t=2;t<n.length-1;t+=2)e.lineTo(n[t],n[t+1]);e.closePath(),e.fill(),e.fillStyle="#000";let r=new Path2D("M0,0V12.707L11.293,24H24V0ZM11,22.293,1.707,13H11ZM23,23H12V12H1V1H23Z");e.fill(r)}drawCommentIndicators(e){let t=[];for(let n of e){if(!["highlight","underline","image"].includes(n.type)||!n.comment||n.position.pageIndex!==this.pageIndex)continue;let e=n.position,r=e.rects[0][0]-3.5,i=e.rects[0][3]-7/3;t.push({annotation:n,rect:[r,i,r+7,i+7]})}t.reverse(),t.sort(((e,t)=>e.rect[0]-t.rect[0]));for(let e of t)for(let i of t){if(i===e)break;if(n=e.rect,!((r=i.rect)[0]>n[2]||r[2]<n[0]||r[1]>n[3]||r[3]<n[1])){let t=(i.rect[2]-i.rect[0])/3*2;e.rect[0]=i.rect[0]+t,e.rect[2]=i.rect[2]+t}}var n,r;for(let e of t){this.actualContext.save();let t=Math.abs(this.getViewPoint([1/(24/7),0])[0]-this.getViewPoint([0,0])[0]),n=this.getViewRect(e.rect);this.actualContext.transform(t,0,0,t,n[0],n[1]),this.actualContext.globalAlpha=.5,this.drawNote(this.actualContext,e.annotation.color),this.actualContext.restore()}}_renderHighlight(e){let t=e.color,n=this.p2v(e.position);this.actualContext.save(),"light"===this.layer._themeColorScheme?(this.actualContext.globalCompositeOperation="multiply",this.actualContext.globalAlpha=.4):(this.actualContext.globalCompositeOperation="lighter",this.actualContext.globalAlpha=.3),this.actualContext.fillStyle=t;let r=n.rects;n.nextPageRects&&n.pageIndex+1===this.pageIndex&&(r=n.nextPageRects);for(let e of r)this.actualContext.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1]);this.actualContext.restore()}_renderUnderline(e){let t=e.color,n=this.layer._pdfPages[this.pageIndex];if(!n)return;let r,i,{chars:o}=n,a=this.p2v(e.position);this.actualContext.save(),"light"===this.layer._themeColorScheme?this.actualContext.globalCompositeOperation="multiply":this.actualContext.globalAlpha=.9,this.actualContext.fillStyle=t,a.nextPageRects&&a.pageIndex+1===this.pageIndex?(r=a.nextPageRects,i=e.position.nextPageRects[0]):(r=a.rects,i=e.position.rects[0]);let s=1;s*=this.scale;for(let e of r){let t=tc(o,i);t+=Fu(this.transform),t=Tu(t);let[n,r,a,l]=e,u=0===t&&[n,l-s,a,l]||90===t&&[a-s,l,a,r]||180===t&&[n,r,a,r-s]||270===t&&[n,l,n-s,r];this.actualContext.fillRect(u[0],u[1],u[2]-u[0],u[3]-u[1])}this.actualContext.restore()}_renderNote(e){let t=this.p2v(e.position);this.actualContext.save();let n=t.rects[0],r=this.scale*(22/24);this.actualContext.transform(r,0,0,r,n[0],n[1]),this.drawNote(this.actualContext,e.color),this.actualContext.restore()}_renderImage(e){let t=this.p2v(e.position);this.actualContext.save(),this.actualContext.strokeStyle=e.color,this.actualContext.lineWidth=3*devicePixelRatio;let n=t.rects[0],r=e.position.rects[0],i=r[2]-r[0],o=r[3]-r[1];(i<ti||o<ti)&&(this.actualContext.globalAlpha=.2),this.actualContext.strokeRect(n[0],n[1],n[2]-n[0],n[3]-n[1]),this.actualContext.restore()}_renderInk(e){let t=this.p2v(e.position);this.actualContext.save(),this.actualContext.beginPath(),this.actualContext.strokeStyle=Ru(e.color,5),this.actualContext.lineWidth=t.width,this.actualContext.lineCap="round",this.actualContext.lineJoin="round";for(let e of t.paths){this.actualContext.moveTo(...e.slice(0,2));for(let t=0;t<e.length-1;t+=2){let n=e[t],r=e[t+1];0===t&&this.actualContext.moveTo(n,r),this.actualContext.lineTo(n,r)}}this.actualContext.stroke(),this.actualContext.restore()}_renderFindResults(){if(!(this.layer._findController&&this.layer._findController.highlightMatches&&this.layer._findController._matchesCountTotal&&this.layer._pdfPages[this.pageIndex]))return;let{selected:e}=this.layer._findController,t=this.layer._findController.getMatchPositions(this.pageIndex,this.layer._pdfPages[this.pageIndex]);if(t&&t.length){this.actualContext.save();for(let n=0;n<t.length;n++){let r=t[n];if(e.pageIdx===this.pageIndex&&n===e.matchIdx)this.actualContext.fillStyle="dark"===this.layer._themeColorScheme?"rgba(0,100,0,0.6)":"rgba(0,100,0,0.3)";else{if(!this.layer._findController.state.highlightAll)continue;this.actualContext.fillStyle="dark"===this.layer._themeColorScheme?"rgba(180,0,170,0.6)":"rgba(180,0,170,0.3)"}r=this.p2v(r);for(let e of r.rects){let t=5,n=e[0],r=e[1],i=e[2]-e[0],o=e[3]-e[1];this.actualContext.beginPath(),this.actualContext.moveTo(n+t,r),this.actualContext.lineTo(n+i-t,r),this.actualContext.quadraticCurveTo(n+i,r,n+i,r+t),this.actualContext.lineTo(n+i,r+o-t),this.actualContext.quadraticCurveTo(n+i,r+o,n+i-t,r+o),this.actualContext.lineTo(n+t,r+o),this.actualContext.quadraticCurveTo(n,r+o,n,r+o-t),this.actualContext.lineTo(n,r+t),this.actualContext.quadraticCurveTo(n,r,n+t,r),this.actualContext.closePath(),this.actualContext.fill()}}this.actualContext.restore()}}render(){if(!this.actualContext)return;let e=this.layer._getPageAnnotations(this.pageIndex),t=this.layer._selectedAnnotationIDs,n=this.layer._selectionRanges,r=this.layer.action,i=(this.layer._annotationTextSelectionData,this.layer._focusedObject),o=this.layer._highlightedPosition,a=this.originalPage.div.ownerDocument,s=this.originalPage.div.querySelector(".customAnnotationLayer");s||(s=a.createElement("div"),s.className="customAnnotationLayer",this.originalPage.div.append(s));let l=Array.from(s.children);for(let t of e)if("text"===t.type&&t.position.pageIndex===this.pageIndex){let e=t.position;r&&r.position&&["resize","rotate"].includes(r.type)&&r.annotation.id===t.id&&(e=r.position);let n=e.rects[0],i=l.find((e=>e.getAttribute("data-id")===t.id)),o=this.layer._readOnly||t.readOnly,u=this.originalPage.viewport,c=(n[0]+n[2])/2,d=(n[1]+n[3])/2,h=vu(Au([u.scale,0,0,u.scale,0,0]),u.transform),[p,f]=yu([c,d],h),m=n[2]-n[0],g=n[3]-n[1],v=f-g/2,y=p-m/2,b=u.rotation-(e.rotation||0),_=[`left: calc(${y}px * var(--scale-factor))`,`top: calc(${v}px * var(--scale-factor))`,`min-width: calc(${e.fontSize}px * var(--scale-factor))`,`min-height: calc(${e.fontSize}px * var(--scale-factor))`,`width: calc(${m}px * var(--scale-factor))`,`height: calc(${g}px * var(--scale-factor))`,`color: ${Ru(t.color,5)}`,`font-size: calc(${e.fontSize}px * var(--scale-factor))`,`font-family: ${window.computedFontFamily}`,`transform: rotate(${b}deg)`];_=_.join(";"),i||(i=a.createElement("textarea"),i.setAttribute("data-id",t.id),i.dir="auto",i.className="textAnnotation",i.disabled=o,i.addEventListener("blur",(e=>{i.classList.remove("focusable")})),i.addEventListener("keydown",(e=>{"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),i.blur())})),s.append(i)),i.getAttribute("style")!==_&&i.setAttribute("style",_),i.getAttribute("data-comment")!==t.comment&&(i.value=t.comment,i.setAttribute("data-comment",t.comment)),i.disabled!=o&&(i.disabled=o)}let u=Array.from(this.layer._iframeWindow.document.querySelectorAll(`[data-page-number="${this.pageIndex+1}"] .textAnnotation`));for(let t of u){let n=t.getAttribute("data-id");e.find((e=>e.id===n))||t.remove()}this.actualContext.save(),this.actualContext.drawImage(this.originalCanvas,0,0);for(let n of e)if("highlight"!==n.type||"updateAnnotationRange"===(null==r?void 0:r.type)&&r.annotation.id===n.id||this._renderHighlight(n),"underline"!==n.type||"updateAnnotationRange"===(null==r?void 0:r.type)&&r.annotation.id===n.id){if("note"===n.type)this._renderNote(n);else if("image"===n.type)t.includes(n.id)||this._renderImage(n);else if("ink"===n.type)if(r&&r.position&&"resize"===r.type&&n.id===r.annotation.id)this._renderInk({...n,position:r.position});else if(r&&r.triggered&&"erase"===r.type&&r.annotations.has(n.id)){let{position:e}=r.annotations.get(n.id);this._renderInk({...n,position:e})}else this._renderInk(n)}else this._renderUnderline(n);if("updateAnnotationRange"===(null==r?void 0:r.type)&&(r.annotation.position.pageIndex===this.pageIndex||r.annotation.position.nextPageRects&&r.annotation.position.pageIndex+1===this.pageIndex)&&("highlight"===r.annotation.type?this._renderHighlight(r.annotation):"underline"===r.annotation.type&&this._renderUnderline(r.annotation)),this.drawCommentIndicators(e),this.drawOverlays(),this.drawHover(),this._renderFindResults(),!t.length&&i&&(i.pageIndex===this.pageIndex||i.object.position.nextPageRects&&i.pageIndex===this.pageIndex)){let e=i.object.position;this.actualContext.strokeStyle=window.computedColorFocusBorder,this.actualContext.lineWidth=3*devicePixelRatio;let t=5*devicePixelRatio,n=fu(e,this.pageIndex);n=this.getViewRect(n),n=[n[0]-t,n[1]-t,n[2]+t,n[3]+t];let r=10*devicePixelRatio;this.actualContext.beginPath(),this.actualContext.moveTo(n[0]+r,n[1]),this.actualContext.lineTo(n[2]-r,n[1]),this.actualContext.arcTo(n[2],n[1],n[2],n[1]+r,r),this.actualContext.lineTo(n[2],n[3]-r),this.actualContext.arcTo(n[2],n[3],n[2]-r,n[3],r),this.actualContext.lineTo(n[0]+r,n[3]),this.actualContext.arcTo(n[0],n[3],n[0],n[3]-r,r),this.actualContext.lineTo(n[0],n[1]+r),this.actualContext.arcTo(n[0],n[1],n[0]+r,n[1],r),this.actualContext.stroke()}if("updateAnnotationRange"!==(null==r?void 0:r.type)||null==r||!r.triggered){this.actualContext.save();let n=e.filter((e=>t.includes(e.id)));for(let e of n){this.actualContext.strokeStyle="#6d95e0",this.actualContext.beginPath(),this.actualContext.setLineDash([5*devicePixelRatio,3*devicePixelRatio]),this.actualContext.lineWidth=2*devicePixelRatio;let t=5*devicePixelRatio,n=fu(e.position,this.pageIndex),i=0;"text"===e.type&&(n=e.position.rects[0]),["image","text","ink"].includes(e.type)&&(t=0,i=e.position.rotation,r&&["resize","rotate"].includes(r.type)&&r.triggered&&(n="text"===e.type?r.position.rects[0]:fu(r.position),i=r.position.rotation)),"image"===e.type&&(this.actualContext.lineWidth=3*devicePixelRatio);let o=this.transform;"text"===e.type&&(o=Su(n,i||0),o=vu(this.transform,o));let a=[n[0],n[1]],s=[n[2],n[1]],l=[n[2],n[3]],u=[n[0],n[3]],c=[n[0],n[1]+(n[3]-n[1])/2],d=[n[2],n[1]+(n[3]-n[1])/2],h=[n[0]+(n[2]-n[0])/2,n[3]],p=[n[0]+(n[2]-n[0])/2,n[1]],f=16,m=[n[0]+(n[2]-n[0])/2,n[3]+f];a=this.getViewPoint(a,o),s=this.getViewPoint(s,o),l=this.getViewPoint(l,o),u=this.getViewPoint(u,o),c=this.getViewPoint(c,o),d=this.getViewPoint(d,o),h=this.getViewPoint(h,o),p=this.getViewPoint(p,o),m=this.getViewPoint(m,o);let g=10*devicePixelRatio;"image"!==e.type&&([a,s,l,u,c,d,h,p]=Eu([a,s,l,u],[a,s,l,u,c,d,h,p],g)),this.actualContext.beginPath(),this.actualContext.moveTo(...a),this.actualContext.lineTo(...s),this.actualContext.lineTo(...l),this.actualContext.lineTo(...u),this.actualContext.closePath(),this.layer._readOnly||e.readOnly||"text"!==e.type||(this.actualContext.moveTo(...h),this.actualContext.lineTo(...m)),this.actualContext.stroke();const v=4*devicePixelRatio;this.actualContext.fillStyle="#81b3ff",this.layer._readOnly||e.readOnly||(["image","text","ink"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...a,v,0,2*Math.PI,!1),this.actualContext.fill()),["image","text","ink"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...s,v,0,2*Math.PI,!1),this.actualContext.fill()),["image","text","ink"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...u,v,0,2*Math.PI,!1),this.actualContext.fill()),["image","text","ink"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...l,v,0,2*Math.PI,!1),this.actualContext.fill()),["image","text"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...d,v,0,2*Math.PI,!1),this.actualContext.fill()),["image","text"].includes(e.type)&&(this.actualContext.beginPath(),this.actualContext.arc(...c,v,0,2*Math.PI,!1),this.actualContext.fill()),"image"===e.type&&(this.actualContext.beginPath(),this.actualContext.arc(...h,v,0,2*Math.PI,!1),this.actualContext.fill()),"image"===e.type&&(this.actualContext.beginPath(),this.actualContext.arc(...p,v,0,2*Math.PI,!1),this.actualContext.fill()),"text"===e.type&&(this.actualContext.beginPath(),this.actualContext.arc(...m,v,0,2*Math.PI,!1),this.actualContext.fill()))}this.actualContext.restore()}let c=e.find((e=>e.id===t[0]));if(c&&["highlight","underline"].includes(c.type)){let e=c;if("updateAnnotationRange"===(null==r?void 0:r.type)&&r.annotation&&(e=r.annotation),this.layer._pdfPages[this.pageIndex]&&(!e.position.nextPageRects||this.layer._pdfPages[this.pageIndex+1])){let t,n,{chars:r}=this.layer._pdfPages[this.pageIndex],i=this.p2v(e.position);this.actualContext.save(),"light"===this.layer._themeColorScheme&&(this.actualContext.globalCompositeOperation="multiply"),this.actualContext.fillStyle=e.color;let o=1*devicePixelRatio;if(e.position.nextPageRects)if(i.pageIndex+1===this.pageIndex){let{chars:t}=this.layer._pdfPages[this.pageIndex+1],r=tc(t,e.position.nextPageRects.at(-1));r+=Fu(this.transform),r=Tu(r);let[a,s,l,u]=i.nextPageRects.at(-1);n=0===r&&[l-o,s,l+o,u]||90===r&&[a,s-o,l,s+o]||180===r&&[a-o,s,a+o,u]||270===r&&[a,u-o,l,u+o]}else{let n=tc(r,e.position.rects[0]),[a,s,l,u]=i.rects[0];n+=Fu(this.transform),n=Tu(n),t=0===n&&[a-o,s,a+o,u]||90===n&&[a,u-o,l,u+o]||180===n&&[l-o,s,l+o,u]||270===n&&[a,s-o,l,s+o]}else{let a=tc(r,e.position.rects[0]);a+=Fu(this.transform),a=Tu(a);let[s,l,u,c]=i.rects[0];t=0===a&&[s-o,l,s+o,c]||90===a&&[s,c-o,u,c+o]||180===a&&[u-o,l,u+o,c]||270===a&&[s,l-o,u,l+o],a=tc(r,e.position.rects.at(-1)),a+=Fu(this.transform),a=Tu(a),[s,l,u,c]=i.rects.at(-1),n=0===a&&[u-o,l,u+o,c]||90===a&&[s,l-o,u,l+o]||180===a&&[s-o,l,s+o,c]||270===a&&[s,c-o,u,c+o]}if(!this.layer._readOnly&&!c.readOnly&&t){let e=t;this.actualContext.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}if(!this.layer._readOnly&&!c.readOnly&&n){let e=n;this.actualContext.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}this.actualContext.restore()}}if(this.actualContext.save(),n.length&&!n[0].collapsed&&["highlight","underline"].includes(this.layer._tool.type)){let e=this.layer._getAnnotationFromSelectionRanges(n,this.layer._tool.type,this.layer._tool.color);(e.position.pageIndex===this.pageIndex||e.position.nextPageRects&&e.position.pageIndex+1===this.pageIndex)&&("highlight"===e.type?this._renderHighlight(e):this._renderUnderline(e))}else for(let e of n){let{position:t}=e;if(t.pageIndex===this.pageIndex){t=this.p2v(t),this.actualContext.fillStyle=ei,"light"===this.layer._themeColorScheme?(this.actualContext.globalCompositeOperation="multiply",this.actualContext.globalAlpha=.4):(this.actualContext.globalCompositeOperation="lighten",this.actualContext.globalAlpha=.7);for(let e of t.rects)this.actualContext.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}}if(this.actualContext.restore(),r)if("moveAndDrag"===r.type&&r.triggered){if(r.annotation.position.pageIndex===this.pageIndex){this.actualContext.strokeStyle="#aaaaaa",this.actualContext.setLineDash([5*devicePixelRatio,3*devicePixelRatio]),this.actualContext.lineWidth=2*devicePixelRatio;let e=fu(r.position),t=this.transform;"text"===c.type&&(e=r.position.rects[0],t=Su(e,c.position.rotation||0),t=vu(this.transform,t));let n=[e[0],e[1]],i=[e[2],e[1]],o=[e[2],e[3]],a=[e[0],e[3]];n=this.getViewPoint(n,t),i=this.getViewPoint(i,t),o=this.getViewPoint(o,t),a=this.getViewPoint(a,t);let s=10*devicePixelRatio;[n,i,o,a]=Eu([n,i,o,a],[n,i,o,a],s),this.actualContext.beginPath(),this.actualContext.moveTo(...n),this.actualContext.lineTo(...i),this.actualContext.lineTo(...o),this.actualContext.lineTo(...a),this.actualContext.closePath(),this.actualContext.stroke()}}else"image"===r.type&&r.annotation?r.annotation.position.pageIndex===this.pageIndex&&this._renderImage(r.annotation):"ink"===r.type&&r.annotation&&r.annotation.position.pageIndex===this.pageIndex&&this._renderInk(r.annotation);if(o&&(o.pageIndex===this.pageIndex||o.nextPageRects&&o.pageIndex+1===this.pageIndex)){let e=o,t={position:e,color:ei};e.rects?this._renderHighlight(t):e.paths&&this._renderInk(t)}this.actualContext.restore()}nextPagePosition(e){return e.nextPageRects&&e.pageIndex+1===this.pageIndex}renderAnnotationOnCanvas(e,t){let n=t.getContext("2d"),r=window.devicePixelRatio,i=this.originalPage.viewport.transform,o=fu(e.position,this.pageIndex),a=this.getViewRect(o,i),s=a[2]-a[0],l=a[3]-a[1],u=200;s>u?(l=l*u/s,s=u):l>u&&(s=s*u/l,l=u),t.width=s*r,t.height=l*r,t.style.width=s+"px",t.style.height=l+"px";let c=t.width/(o[2]-o[0]);if(n.save(),"highlight"===e.type){n.transform(c,0,0,-c,0,l*r);let t=e.position;n.globalAlpha=.5,n.globalCompositeOperation="multiply",n.fillStyle=e.color||ei;let i=t.rects;t.nextPageRects&&t.pageIndex+1===this.pageIndex&&(i=t.nextPageRects),n.transform(1,0,0,1,-o[0],-o[1]);for(let e of i)n.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}else if("underline"===e.type){n.transform(c,0,0,-c,0,l*r);let t=e.position;n.globalCompositeOperation="multiply",n.fillStyle=e.color||ei;let i=t.rects;t.nextPageRects&&t.pageIndex+1===this.pageIndex&&(i=t.nextPageRects),n.transform(1,0,0,1,-o[0],-o[1]);for(let e of i)n.fillRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}else if("note"===e.type){let t=e.position.rects[0];c*=(t[2]-t[0])/24,n.transform(c,0,0,c,0,0),this.drawNote(n,e.color)}else if("image"===e.type){n.globalAlpha=.5,n.globalCompositeOperation="multiply",n.fillStyle=e.color;let t=this.originalPage.viewport.width/parseFloat(this.originalCanvas.width)*devicePixelRatio,r=s/(a[2]-a[0]),i=devicePixelRatio*r,o=r*t;n.transform(o,0,0,o,-a[0]*i,-a[1]*i),n.drawImage(this.originalCanvas,0,0)}n.restore()}}function oc(e,t,n=null){if(e.rects){if(n===e.pageIndex+1&&e.nextPageRects)return{pageIndex:e.pageIndex,nextPageRects:e.nextPageRects.map((e=>{let[n,r]=t.convertToViewportPoint(e[0],e[1]),[i,o]=t.convertToViewportPoint(e[2],e[3]);return[Math.min(n,i),Math.min(o,r),Math.max(n,i),Math.max(o,r)]}))};{let n={pageIndex:e.pageIndex,rects:e.rects.map((e=>{let[n,r]=t.convertToViewportPoint(e[0],e[1]),[i,o]=t.convertToViewportPoint(e[2],e[3]);return[Math.min(n,i),Math.min(o,r),Math.max(n,i),Math.max(o,r)]}))};return e.fontSize&&(n.fontSize=e.fontSize*t.scale),e.rotation&&(n.rotation=e.rotation),n}}if(e.paths)return{pageIndex:e.pageIndex,width:e.width*t.scale,paths:e.paths.map((e=>{let n=[];for(let r=0;r<e.length-1;r+=2){let i=e[r],o=e[r+1];n.push(...t.convertToViewportPoint(i,o))}return n}))}}const ac=500;class sc{constructor({container:e}){let t;this._enabled=!0,this._container=e,this._scrollVector=[0,0];let n=0,r=0,i=o=>{if(t){let i=o-t;if(0!==this._scrollVector[0]){r+=i/1e3*this._scrollVector[0];let t=Math.floor(r);r-=t,e.scrollLeft+=t}if(0!==this._scrollVector[1]){n+=i/1e3*this._scrollVector[1];let t=Math.floor(n);n-=t,e.scrollTop+=t}}t=o,e.ownerDocument.defaultView.requestAnimationFrame(i)};e.ownerDocument.defaultView.requestAnimationFrame(i),e.ownerDocument.defaultView.addEventListener("mousemove",this._handleMouseMove.bind(this)),e.ownerDocument.defaultView.addEventListener("mouseup",(()=>this.disable.bind(this)))}_handleMouseMove(e){if(1!==e.buttons)return void this.disable();if(!this._enabled)return;let t=this._container.getBoundingClientRect();t=[t.left,t.top,t.right,t.bottom],t=[t[0]+25,t[1]+25,t[2]-25,t[3]-25];let n=[e.clientX,e.clientY];var r=Math.max(t[0]-n[0],0,n[0]-t[2]),i=Math.max(t[1]-n[1],0,n[1]-t[3]);(r*=3)>ac&&(r=ac),(i*=3)>ac&&(i=ac),n[0]<t[0]&&(r*=-1),n[1]<t[1]&&(i*=-1),this._scrollVector=[r,i]}enable(){this._enabled=!0}disable(){this._enabled=!1,this._scrollVector=[0,0]}}var lc=r(9189),uc=r.n(lc);function cc(e,t,n,r){return pc(e,t),hc(n,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n,r),r}function dc(e,t,n){return pc(e,t),hc(n,"get"),function(e,t){return t.get?t.get.call(e):t.value}(e,n)}function hc(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function pc(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}class fc{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}}class mc{static getCanvas(e,t,n){const r=dc(this,mc,gc)||cc(this,mc,gc,n.document.createElement("canvas"));r.width=e,r.height=t;const i=r.getContext("2d",{alpha:!1});return i.save(),i.fillStyle="rgb(255, 255, 255)",i.fillRect(0,0,e,t),i.restore(),[r,r.getContext("2d")]}static destroyCanvas(){const e=dc(this,mc,gc);e&&(e.width=0,e.height=0),cc(this,mc,gc,null)}}var gc={writable:!0,value:null};class vc{constructor(e){this._pdfView=e.pdfView,this._onUpdate=e.onUpdate,this._window=e.window,this._thumbnails=[],this._initialized=!1,this._renderQueue=uc()({concurrency:1,autostart:!0}),this._init()}async _init(){let{pdfDocument:e}=this._window.PDFViewerApplication,t=await e.getPage(1),n=e.numPages,r=t.getViewport({scale:1});for(let e=1;e<=n;++e){let t=120,n=t/(r.width/r.height)|0;this._thumbnails.push({pageIndex:e-1,width:t,height:n})}this._onUpdate(this._thumbnails)}async _render(e){let t=this._thumbnails[e];if(null!=t&&t.image&&!t.forceRerender)return;let{pdfDocument:n}=this._window.PDFViewerApplication,r=await n.getPage(e+1),i=r.getViewport({scale:1}),o=i.width,a=120,s=a/(o/i.height)|0,l=a/o;const{ctx:u,canvas:c,transform:d}=this._getPageDrawContext(2,a,s),h=r.getViewport({scale:2*l}),p={canvasContext:u,transform:d,viewport:h},f=r.render(p);try{await f.promise}catch(e){console.log(e)}finally{await this._pdfView.renderPageAnnotationsOnCanvas(c,h,e);const t=this._reduceImage(c,a,s);this._thumbnails=this._thumbnails.slice(),this._thumbnails[e]={pageIndex:e,width:a,height:s,image:t.toDataURL()},c.width=0,c.height=0,this._window.PDFViewerApplication.eventBus.dispatch("thumbnailrendered",{source:this,pageNumber:this.id,pdfPage:this.pdfPage})}this._onUpdate(this._thumbnails)}async render(e=[],t){this._thumbnails.some((e=>e.forceRerender))||this._renderQueue.end();for(let n of e){let e=this._thumbnails[n];if(t){if(!e.image)continue;e.forceRerender=!0}this._renderQueue.unshift((async()=>this._render(n)))}}clear(){this._renderQueue.end(),this._thumbnails=this._thumbnails.map((e=>({...e,image:void 0}))),this._onUpdate(this._thumbnails)}_getPageDrawContext(e=1,t,n){const r=this._window.document.createElement("canvas"),i=r.getContext("2d",{alpha:!1}),o=new fc;return r.width=e*t*o.sx|0,r.height=e*n*o.sy|0,{ctx:i,canvas:r,transform:o.scaled?[o.sx,0,0,o.sy,0,0]:null}}_reduceImage(e,t,n){const{ctx:r,canvas:i}=this._getPageDrawContext(1,t,n);if(e.width<=2*i.width)return r.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),i;let o=i.width<<3,a=i.height<<3;const[s,l]=mc.getCanvas(o,a,this._window);for(;o>e.width||a>e.height;)o>>=1,a>>=1;for(l.drawImage(e,0,0,e.width,e.height,0,0,o,a);o>2*i.width;)l.drawImage(s,0,0,o,a,0,0,o>>1,a>>1),o>>=1,a>>=1;return r.drawImage(s,0,0,o,a,0,0,i.width,i.height),i}}const yc=30,bc=class{constructor(e){this._pdfView=e.pdfView,this._processing=!1,this._lastRendered=new Map}async _renderNext(){if(this._processing)return;this._processing=!0;let e=this._pdfView._annotations.find((e=>["image","ink"].includes(e.type)&&!e.image));if(e){let t=this._lastRendered.get(e.id);if(!t||t<e.dateModified){this._lastRendered.set(e.id,e.dateModified);let t=await this._renderAnnotationImage(e);t&&this._pdfView._onUpdateAnnotations([{id:e.id,image:t}]),setTimeout((()=>this._renderNext()))}}this._processing=!1}async _renderAnnotationImage(e){let{position:t,color:n}=e,r=await this._pdfView._iframeWindow.PDFViewerApplication.pdfDocument.getPage(t.pageIndex+1),i={pageIndex:t.pageIndex};if(t.rects)i.rects=t.rects;else{let e=fu(t);if(e=[e[0]-10,e[1]-10,e[2]+10,e[3]+10],e[2]-e[0]<yc){let t=e[0]+(e[2]-e[0])/2;e[0]=t-yc,e[2]=t+yc}if(e[3]-e[1]<yc){let t=e[1]+(e[3]-e[1])/2;e[1]=t-yc,e[3]=t+yc}i.rects=[pu(e,r.view)]}let o=i.rects[0],a=Math.sqrt(this._pdfView._iframeWindow.PDFViewerApplication.pdfViewer.maxCanvasPixels/((o[2]-o[0])*(o[3]-o[1]))),s=Math.min(4,a);i=oc(i,r.getViewport({scale:s})),o=i.rects[0];let l=r.getViewport({scale:s,offsetX:-o[0],offsetY:-o[1]});t=oc(t,l);let u=o[2]-o[0],c=o[3]-o[1],d=this._pdfView._iframeWindow.document.createElement("canvas"),h=d.getContext("2d",{alpha:!1});if(!u||!c)return"";d.width=u,d.height=c,d.style.width=u+"px",d.style.height=c+"px",h.skipBlender=!0;let p={canvasContext:h,viewport:l};if(await r.render(p).promise,t.paths){h.lineCap="round",h.lineJoin="round",h.lineWidth=t.width,h.beginPath(),h.strokeStyle=Ru(n,5);for(let e of t.paths)for(let t=0;t<e.length-1;t+=2){let n=e[t],r=e[t+1];0===t&&h.moveTo(n,r),h.lineTo(n,r)}h.stroke()}let f=d.toDataURL("image/png",1);return d.width=0,d.height=0,f}_trimCanvas(e,t,n=0){const r=e.width,i=e.height,o=t.getImageData(0,0,r,i),a=new Uint32Array(o.data.buffer);let s=r,l=i,u=0,c=0,d=!1;for(let e=0;e<i;e++)for(let t=0;t<r;t++)a[e*r+t]!==a[0]&&(t<s&&(s=t),t>u&&(u=t),e<l&&(l=e),e>c&&(c=e),d=!0);if(!d)return{canvas:e,rect:[0,0,r,i]};s=Math.max(0,s-n),l=Math.max(0,l-n),u=Math.min(r-1,u+n),c=Math.min(i-1,c+n);const h=u-s+1,p=c-l+1,f=t.getImageData(s,l,h,p);return e.width=h,e.height=p,t.putImageData(f,0,0),{canvas:e,rect:[s,l,s+h,l+p]}}async renderPreviewPage(e){let t=window.devicePixelRatio,n=await this._pdfView._iframeWindow.PDFViewerApplication.pdfDocument.getPage(e.pageIndex+1),r={pageIndex:e.pageIndex};r.rects=e.rects;let i=r.rects[0],o=Math.sqrt(this._pdfView._iframeWindow.PDFViewerApplication.pdfViewer.maxCanvasPixels/((i[2]-i[0])*(i[3]-i[1]))),a=Math.min(t,o),s=n.getViewport({scale:a}),l=oc(e,s),u=s.width,c=s.height,d=this._pdfView._iframeWindow.document.createElement("canvas"),h=d.getContext("2d",{alpha:!1,willReadFrequently:!0});if(!u||!c)return"";d.width=u,d.height=c,d.style.width=u+"px",d.style.height=c+"px";let p={canvasContext:h,viewport:s};await n.render(p).promise;let{canvas:f,rect:m}=this._trimCanvas(d,h,15);if(i=l.rects[0],h.fillStyle="#f57b7b",h.globalCompositeOperation="multiply",i[2]-i[0]<5||i[3]-i[1]<5){let e=7,t=(i[0]+i[2])/2,n=(i[1]+i[3])/2;t<m[0]?t=e:t>m[2]&&(t=m[2]-e),n<m[1]?n=e:n>m[3]&&(n=m[3]-e),h.beginPath(),h.arc(t,n,7,0,2*Math.PI,!1),h.fill()}else{let e=i[0]-m[0],t=i[1]-m[1];h.fillRect(e,t,i[2]-i[0],i[3]-i[1])}let g=f.width/a,v=f.height/a,y=l.rects[0].slice(),b=(y[0]+y[2])/2,_=(y[1]+y[3])/2;b-=m[0],_-=m[1],b/=a,_/=a;let w=f.toDataURL("image/png",1);return d.width=0,d.height=0,{image:w,width:g,height:v,x:b,y:_}}start(){this._renderNext()}stop(){}};function _c(e,t={}){let n=t.behavior||"auto",r=t.block||"start",i=t.inline||"nearest",o=t.container||null;for(let t of function(e){let t=[],n="commonAncestorContainer"in e?e.commonAncestorContainer:e;for(;n&&n.parentElement;)n=n.parentElement,wc(n)&&t.push(n);return t.push("startContainer"in e?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView),t}(e)){let l=Sc(e,r,i,t);if(s=Cc(t),((a=l).x!==s.x||a.y!==s.y)&&t.scrollTo({top:l.y,left:l.x,behavior:n}),null!==o&&Ec(t,o))break}var a,s}function wc(e){let t=getComputedStyle(e),n=t.overflowX,r=t.overflowY;return("auto"===n||"scroll"===n||"auto"===r||"scroll"===r)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Sc(e,t,n,r){let i=function(e){if("nodeType"in e&&e.nodeType!==Node.ELEMENT_NODE){let t=e.ownerDocument.createRange();t.selectNode(e),e=t}return e.getBoundingClientRect()}(e),o=qa(r)?r.getBoundingClientRect():new DOMRect(0,0,r.innerWidth,r.innerHeight),a=function(e,t,n){let r=e.left,i=e.right,o=t.left,a=t.right;switch(n){case"start":return r-o;case"center":return(r+i)/2-(o+a)/2;case"end":return i-a;default:return r>=o&&i<=a?0:r<o?r-o:i-a}}(i,o,n),s=function(e,t,n){let r=e.top,i=e.bottom,o=t.top,a=t.bottom;switch(n){case"start":return r-o;case"center":return(r+i)/2-(o+a)/2;case"end":return i-a;default:return r>=o&&i<=a?0:r<o?r-o:i-a}}(i,o,t),l=Cc(r);return{x:l.x+a,y:l.y+s}}function Cc(e){return qa(e)?{x:e.scrollLeft,y:e.scrollTop}:{x:e.scrollX,y:e.scrollY}}function Ec(e,t){if(!qa(e))return!1;if(e===t)return!0;let n=t;for(;n;){if(n===e)return!0;n=n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return!1}const xc=class extends Is{constructor(...e){super(...e),n(this,"_find",null),n(this,"_isDynamicThemeSupported",!0)}get _searchContext(){let e=fs(function(e){let t=e.ownerDocument.createRange();return $a(e).filter((e=>{t.selectNodeContents(e);let n=t.getBoundingClientRect();return n.width&&n.height}))}(this._iframeDocument.body));return Object.defineProperty(this,"_searchContext",{value:e}),e}async _getSrcDoc(){if(this._options.data.srcDoc)return this._options.data.srcDoc;if(this._options.data.buf||void 0!==this._options.data.url){let e;e=this._options.data.buf?this._options.data.buf:await fetch(this._options.data.url).then((e=>e.arrayBuffer()));let t=new TextDecoder("utf-8").decode(e);delete this._options.data.buf;let n=(new DOMParser).parseFromString(t,"text/html");for(let e of n.querySelectorAll("base"))e.remove();if(void 0!==this._options.data.url){let e=n.createElement("base");e.href=this._options.data.url,n.head.prepend(e)}for(let e of Array.from(n.querySelectorAll('meta[http-equiv="Content-Security-Policy" i]')))e.remove();let r=n.createElement("meta");r.setAttribute("http-equiv","Content-Security-Policy"),r.setAttribute("content",this._getCSP()),n.head.prepend(r);for(let e of Array.from(n.querySelectorAll("noscript")))e.remove();return(n.doctype?(new XMLSerializer).serializeToString(n.doctype):"")+n.documentElement.outerHTML}throw new Error("buf, url, or srcDoc is required")}getData(){var e;return{srcDoc:this._iframe.srcdoc,url:null===(e=this._iframeDocument.head.querySelector("base"))||void 0===e?void 0:e.href,importedFromURL:this._options.data.importedFromURL}}_handleIFrameLoaded(){let e=this._options.preview?100:500,t=0,n=!1,r=!1;for(let a of this._iframeDocument.styleSheets){var i,o;if(n||null===(i=a.ownerNode)||void 0===i||null===(i=i.textContent)||void 0===i||!i.startsWith(":root{--sf-img-")){if(!r&&null!==(o=a.ownerNode)&&void 0!==o&&null!==(o=o.textContent)&&void 0!==o&&o.startsWith("@font-face{")&&Array.prototype.every.call(a.cssRules,(e=>"CSSFontFaceRule"===e.constructor.name)))r=!0;else if(t+=a.cssRules.length,t>e){this._isDynamicThemeSupported=!1;break}}else n=!0}return this._iframeDocument.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),super._handleIFrameLoaded()}_handleViewCreated(e){var t;let n=this._iframeDocument.createElement("style");n.innerHTML="::selection{background-color:var(--selection-color)}.a11y-cursor-target{outline:none}body.force-static-theme{background:var(--background-color) !important;color:var(--text-color) !important}body.force-static-theme *{background-color:rgba(0,0,0,0) !important;color:var(--text-color)}",this._iframeDocument.head.append(n),this._setScale(null!==(t=e.scale)&&void 0!==t?t:1),this._options.location?this.navigate(this._options.location,{behavior:"instant"}):void 0!==e.scrollYPercent&&this._iframeWindow.scrollTo({top:e.scrollYPercent/100*(this._iframeDocument.body.scrollHeight-this._iframeDocument.documentElement.clientHeight)}),this._initOutline()}_getSnapshotLocation(){let e=this._iframeDocument.documentElement.firstChild;if((null==e?void 0:e.nodeType)===Node.COMMENT_NODE&&e.nodeValue.trim().startsWith("Page saved with SingleFile")){let t=e.nodeValue.match(/^\s*url: (https?:\/\/\S+)/m);if(t)return t[1]}return null}_initOutline(){let e=parseFloat(getComputedStyle(this._iframeDocument.body).fontSize),t=[];for(let n of this._iframeDocument.body.querySelectorAll("h1, h2, h3, h4, h5, h6")){if(n.closest("aside, nav, footer, template, [hidden]"))continue;if(!n.innerText.trim())continue;if(parseFloat(getComputedStyle(n).fontSize)<=e)continue;let r=this._iframeDocument.createRange();r.selectNode(n);let i=this.toSelector(r);if(!i)continue;let o=parseInt(n.tagName[1]);t.push({title:n.innerText.trim(),location:{position:i},items:[],expanded:!0,level:o})}let n=[],r=[];for(let e of t){for(;r.length&&r[r.length-1].level>=e.level;)r.pop();r.length?r[r.length-1].items.push(e):n.push(e),r.push(e)}this._options.onSetOutline(n)}_getAnnotationFromRange(e,t,n){if(e.collapsed)return null;let r="highlight"==t||"underline"==t?function(e){let t=e.commonAncestorContainer.ownerDocument;if(!t)return e.toString();let n=t.createElement("div");n.append(e.cloneContents()),t.body.append(n);let r=n.innerText;return n.remove(),r}(e).trim():void 0;if(""===r)return null;let i=this.toSelector(e);return i?{type:t,color:n,sortIndex:this._getSortIndex(e),position:i,text:r}:null}_getSortIndex(e){let t=this._iframeDocument.createNodeIterator(this._iframeDocument.documentElement,NodeFilter.SHOW_TEXT),n=0;for(let r of Ja(t)){if(e.startContainer.contains(r))return String(n+e.startOffset).padStart(8,"0");n+=r.nodeValue.trim().length}return"00000000"}toSelector(e){let t,n=e.commonAncestorContainer.ownerDocument;if(!n)return null;t=e.startContainer===e.endContainer&&e.startOffset==e.endOffset-1&&e.startContainer.nodeType==Node.ELEMENT_NODE?e.startContainer.childNodes[e.startOffset]:e.commonAncestorContainer;let r=function(e,t){if(!e.ownerDocument)return null;let n=Ka(e);if(!n)return null;let r=n,i=e=>1==t.querySelectorAll(e).length&&t.querySelector(e)==r,o="";for(;n&&n!==t;){let e=o?" > ":"";if(n.id)return`#${CSS.escape(n.id)}`+e+o;let t,r=n.tagName.toLowerCase(),a=n.previousElementSibling;if(a&&a.id){let t=`#${CSS.escape(a.id)} + ${r}${e}${o}`;if(i(t))return t}if(n.matches(":only-of-type")||n.matches(":only-child"))t="";else if(n.matches(":first-child"))t=":first-child";else if(n.matches(":first-of-type"))t=":first-of-type";else if(n.matches(":last-child"))t=":last-child";else if(n.matches(":last-of-type"))t=":last-of-type";else{if(!n.parentElement)break;t=`:nth-child(${[...n.parentElement.children].indexOf(n)+1})`}if(o=r+t+e+o,i(o))return o;n=n.parentElement}return null}(t,n.body);if(r){let t=n.body.querySelector(r);if(!t)return null;let i={type:"CssSelector",value:r};return e.toString().trim()!==(t.textContent||"").trim()&&(i.refinedBy=hs(e,t)||void 0),i}return hs(e,n.body)}toDisplayedRange(e){switch(e.type){case"CssSelector":{if(e.refinedBy&&"TextPositionSelector"!=e.refinedBy.type)throw new Error("CssSelectors can only be refined by TextPositionSelectors");let t,n=this._iframeDocument.querySelector(e.value);if(!n)return null;if(e.refinedBy?t=ps(e.refinedBy,n):(t=this._iframeDocument.createRange(),t.selectNodeContents(n)),!t.getClientRects().length)try{t.selectNode(t.commonAncestorContainer)}catch(e){return null}return t}case"TextPositionSelector":if(e.refinedBy)throw new Error("Refinement of TextPositionSelectors is not supported");return ps(e,this._iframeDocument.body);default:throw new Error(`Unsupported Selector.type: ${e.type}`)}}_getHistoryLocation(){return{scrollCoords:[this._iframeWindow.scrollX,this._iframeWindow.scrollY]}}_navigateToSelector(e,t={}){let n=this.toDisplayedRange(e);if(!n)return void console.warn("Not a valid snapshot selector",e);let r=ls(n);r&&(r.scrollIntoView(t),wr(this._iframeDocument).then((()=>{this._a11yVirtualCursorTarget=r}))),t.ifNeeded&&ws(us(n),this._iframeWindow,0)||_c(n,t)}_updateViewState(){let e=Math.round(1e3*this.scale)/1e3,t=this._iframeWindow.scrollY/(this._iframeDocument.body.scrollHeight-this._iframeDocument.documentElement.clientHeight)*100;isNaN(t)&&(t=0),t=Math.max(0,Math.min(100,t)),t=Math.round(10*t)/10;let n={scale:e,scrollYPercent:t};this._options.onChangeViewState(n)}_updateViewStats(){var e,t;let n={canCopy:!!this._selectedAnnotationIDs.length||!(null===(e=null===(t=this._iframeWindow.getSelection())||void 0===t?void 0:t.isCollapsed)||void 0===e||e),canZoomIn:void 0===this.scale||this.scale<this.MAX_SCALE,canZoomOut:void 0===this.scale||this.scale>this.MIN_SCALE,canZoomReset:void 0!==this.scale&&1!==this.scale,canNavigateBack:this._history.canNavigateBack,canNavigateForward:this._history.canNavigateForward};this._options.onChangeViewStats(n)}_updateColorScheme(){if(super._updateColorScheme(),this._isDynamicThemeSupported){if(this._iframeDocument.body.classList.remove("force-static-theme"),!("DarkReader"in this._iframeWindow)){let e=this._getSnapshotLocation()||"about:blank";this._iframeWindow.eval(`{ let location = new URL(${JSON.stringify(e)}); /**\r\n * Dark Reader v4.9.83\r\n * https://darkreader.org/\r\n */\r\n\r\n(function (global, factory) {\r\n    typeof exports === "object" && typeof module !== "undefined"\r\n        ? factory(exports)\r\n        : typeof define === "function" && define.amd\r\n          ? define(["exports"], factory)\r\n          : ((global =\r\n                typeof globalThis !== "undefined"\r\n                    ? globalThis\r\n                    : global || self),\r\n            factory((global.DarkReader = {})));\r\n})(this, function (exports) {\r\n    "use strict";\r\n\r\n    var MessageTypeUItoBG;\r\n    (function (MessageTypeUItoBG) {\r\n        MessageTypeUItoBG["GET_DATA"] = "ui-bg-get-data";\r\n        MessageTypeUItoBG["GET_DEVTOOLS_DATA"] = "ui-bg-get-devtools-data";\r\n        MessageTypeUItoBG["SUBSCRIBE_TO_CHANGES"] =\r\n            "ui-bg-subscribe-to-changes";\r\n        MessageTypeUItoBG["UNSUBSCRIBE_FROM_CHANGES"] =\r\n            "ui-bg-unsubscribe-from-changes";\r\n        MessageTypeUItoBG["CHANGE_SETTINGS"] = "ui-bg-change-settings";\r\n        MessageTypeUItoBG["SET_THEME"] = "ui-bg-set-theme";\r\n        MessageTypeUItoBG["TOGGLE_ACTIVE_TAB"] = "ui-bg-toggle-active-tab";\r\n        MessageTypeUItoBG["MARK_NEWS_AS_READ"] = "ui-bg-mark-news-as-read";\r\n        MessageTypeUItoBG["MARK_NEWS_AS_DISPLAYED"] =\r\n            "ui-bg-mark-news-as-displayed";\r\n        MessageTypeUItoBG["LOAD_CONFIG"] = "ui-bg-load-config";\r\n        MessageTypeUItoBG["APPLY_DEV_DYNAMIC_THEME_FIXES"] =\r\n            "ui-bg-apply-dev-dynamic-theme-fixes";\r\n        MessageTypeUItoBG["RESET_DEV_DYNAMIC_THEME_FIXES"] =\r\n            "ui-bg-reset-dev-dynamic-theme-fixes";\r\n        MessageTypeUItoBG["APPLY_DEV_INVERSION_FIXES"] =\r\n            "ui-bg-apply-dev-inversion-fixes";\r\n        MessageTypeUItoBG["RESET_DEV_INVERSION_FIXES"] =\r\n            "ui-bg-reset-dev-inversion-fixes";\r\n        MessageTypeUItoBG["APPLY_DEV_STATIC_THEMES"] =\r\n            "ui-bg-apply-dev-static-themes";\r\n        MessageTypeUItoBG["RESET_DEV_STATIC_THEMES"] =\r\n            "ui-bg-reset-dev-static-themes";\r\n        MessageTypeUItoBG["COLOR_SCHEME_CHANGE"] = "ui-bg-color-scheme-change";\r\n        MessageTypeUItoBG["HIDE_HIGHLIGHTS"] = "ui-bg-hide-highlights";\r\n    })(MessageTypeUItoBG || (MessageTypeUItoBG = {}));\r\n    var MessageTypeBGtoUI;\r\n    (function (MessageTypeBGtoUI) {\r\n        MessageTypeBGtoUI["CHANGES"] = "bg-ui-changes";\r\n    })(MessageTypeBGtoUI || (MessageTypeBGtoUI = {}));\r\n    var DebugMessageTypeBGtoUI;\r\n    (function (DebugMessageTypeBGtoUI) {\r\n        DebugMessageTypeBGtoUI["CSS_UPDATE"] = "debug-bg-ui-css-update";\r\n        DebugMessageTypeBGtoUI["UPDATE"] = "debug-bg-ui-update";\r\n    })(DebugMessageTypeBGtoUI || (DebugMessageTypeBGtoUI = {}));\r\n    var MessageTypeBGtoCS;\r\n    (function (MessageTypeBGtoCS) {\r\n        MessageTypeBGtoCS["ADD_CSS_FILTER"] = "bg-cs-add-css-filter";\r\n        MessageTypeBGtoCS["ADD_DYNAMIC_THEME"] = "bg-cs-add-dynamic-theme";\r\n        MessageTypeBGtoCS["ADD_STATIC_THEME"] = "bg-cs-add-static-theme";\r\n        MessageTypeBGtoCS["ADD_SVG_FILTER"] = "bg-cs-add-svg-filter";\r\n        MessageTypeBGtoCS["CLEAN_UP"] = "bg-cs-clean-up";\r\n        MessageTypeBGtoCS["FETCH_RESPONSE"] = "bg-cs-fetch-response";\r\n        MessageTypeBGtoCS["UNSUPPORTED_SENDER"] = "bg-cs-unsupported-sender";\r\n    })(MessageTypeBGtoCS || (MessageTypeBGtoCS = {}));\r\n    var DebugMessageTypeBGtoCS;\r\n    (function (DebugMessageTypeBGtoCS) {\r\n        DebugMessageTypeBGtoCS["RELOAD"] = "debug-bg-cs-reload";\r\n    })(DebugMessageTypeBGtoCS || (DebugMessageTypeBGtoCS = {}));\r\n    var MessageTypeCStoBG;\r\n    (function (MessageTypeCStoBG) {\r\n        MessageTypeCStoBG["COLOR_SCHEME_CHANGE"] = "cs-bg-color-scheme-change";\r\n        MessageTypeCStoBG["DARK_THEME_DETECTED"] = "cs-bg-dark-theme-detected";\r\n        MessageTypeCStoBG["DARK_THEME_NOT_DETECTED"] =\r\n            "cs-bg-dark-theme-not-detected";\r\n        MessageTypeCStoBG["FETCH"] = "cs-bg-fetch";\r\n        MessageTypeCStoBG["DOCUMENT_CONNECT"] = "cs-bg-document-connect";\r\n        MessageTypeCStoBG["DOCUMENT_FORGET"] = "cs-bg-document-forget";\r\n        MessageTypeCStoBG["DOCUMENT_FREEZE"] = "cs-bg-document-freeze";\r\n        MessageTypeCStoBG["DOCUMENT_RESUME"] = "cs-bg-document-resume";\r\n    })(MessageTypeCStoBG || (MessageTypeCStoBG = {}));\r\n    var DebugMessageTypeCStoBG;\r\n    (function (DebugMessageTypeCStoBG) {\r\n        DebugMessageTypeCStoBG["LOG"] = "debug-cs-bg-log";\r\n    })(DebugMessageTypeCStoBG || (DebugMessageTypeCStoBG = {}));\r\n    var MessageTypeCStoUI;\r\n    (function (MessageTypeCStoUI) {\r\n        MessageTypeCStoUI["EXPORT_CSS_RESPONSE"] = "cs-ui-export-css-response";\r\n    })(MessageTypeCStoUI || (MessageTypeCStoUI = {}));\r\n    var MessageTypeUItoCS;\r\n    (function (MessageTypeUItoCS) {\r\n        MessageTypeUItoCS["EXPORT_CSS"] = "ui-cs-export-css";\r\n    })(MessageTypeUItoCS || (MessageTypeUItoCS = {}));\r\n\r\n    const isNavigatorDefined = typeof navigator !== "undefined";\r\n    const userAgent = isNavigatorDefined\r\n        ? navigator.userAgentData &&\r\n          Array.isArray(navigator.userAgentData.brands)\r\n            ? navigator.userAgentData.brands\r\n                  .map(\r\n                      (brand) => \`\${brand.brand.toLowerCase()} \${brand.version}\`\r\n                  )\r\n                  .join(" ")\r\n            : navigator.userAgent.toLowerCase()\r\n        : "some useragent";\r\n    const platform = isNavigatorDefined\r\n        ? navigator.userAgentData &&\r\n          typeof navigator.userAgentData.platform === "string"\r\n            ? navigator.userAgentData.platform.toLowerCase()\r\n            : navigator.platform.toLowerCase()\r\n        : "some platform";\r\n    const isChromium =\r\n        userAgent.includes("chrome") || userAgent.includes("chromium");\r\n    const isFirefox =\r\n        userAgent.includes("firefox") ||\r\n        userAgent.includes("thunderbird") ||\r\n        userAgent.includes("librewolf");\r\n    const isSafari = userAgent.includes("safari") && !isChromium;\r\n    const isWindows = platform.startsWith("win");\r\n    const isMacOS = platform.startsWith("mac");\r\n    isNavigatorDefined && navigator.userAgentData\r\n        ? navigator.userAgentData.mobile\r\n        : userAgent.includes("mobile");\r\n    const isShadowDomSupported = typeof ShadowRoot === "function";\r\n    const isMatchMediaChangeEventListenerSupported =\r\n        typeof MediaQueryList === "function" &&\r\n        typeof MediaQueryList.prototype.addEventListener === "function";\r\n    (() => {\r\n        const m = userAgent.match(/chrom(?:e|ium)(?:\\/| )([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return "";\r\n    })();\r\n    (() => {\r\n        const m = userAgent.match(/(?:firefox|librewolf)(?:\\/| )([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return "";\r\n    })();\r\n    const isDefinedSelectorSupported = (() => {\r\n        try {\r\n            document.querySelector(":defined");\r\n            return true;\r\n        } catch (err) {\r\n            return false;\r\n        }\r\n    })();\r\n    const isCSSColorSchemePropSupported = (() => {\r\n        try {\r\n            if (typeof document === "undefined") {\r\n                return false;\r\n            }\r\n            const el = document.createElement("div");\r\n            if (!el || typeof el.style !== "object") {\r\n                return false;\r\n            }\r\n            if (typeof el.style.colorScheme === "string") {\r\n                return true;\r\n            }\r\n            el.setAttribute("style", "color-scheme: dark");\r\n            return el.style.colorScheme === "dark";\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    })();\r\n\r\n    async function getOKResponse(url, mimeType, origin) {\r\n        const response = await fetch(url, {\r\n            cache: "force-cache",\r\n            credentials: "omit",\r\n            referrer: origin\r\n        });\r\n        if (\r\n            isFirefox &&\r\n            mimeType === "text/css" &&\r\n            url.startsWith("moz-extension://") &&\r\n            url.endsWith(".css")\r\n        ) {\r\n            return response;\r\n        }\r\n        if (\r\n            mimeType &&\r\n            !response.headers.get("Content-Type").startsWith(mimeType)\r\n        ) {\r\n            throw new Error(\`Mime type mismatch when loading \${url}\`);\r\n        }\r\n        if (!response.ok) {\r\n            throw new Error(\r\n                \`Unable to load \${url} \${response.status} \${response.statusText}\`\r\n            );\r\n        }\r\n        return response;\r\n    }\r\n    async function loadAsDataURL(url, mimeType) {\r\n        const response = await getOKResponse(url, mimeType);\r\n        return await readResponseAsDataURL(response);\r\n    }\r\n    async function loadAsBlob(url, mimeType) {\r\n        const response = await getOKResponse(url, mimeType);\r\n        return await response.blob();\r\n    }\r\n    async function readResponseAsDataURL(response) {\r\n        const blob = await response.blob();\r\n        const dataURL = await new Promise((resolve) => {\r\n            const reader = new FileReader();\r\n            reader.onloadend = () => resolve(reader.result);\r\n            reader.readAsDataURL(blob);\r\n        });\r\n        return dataURL;\r\n    }\r\n    async function loadAsText(url, mimeType, origin) {\r\n        const response = await getOKResponse(url, mimeType, origin);\r\n        return await response.text();\r\n    }\r\n\r\n    const throwCORSError = async (url) => {\r\n        return Promise.reject(\r\n            new Error(\r\n                [\r\n                    "Embedded Dark Reader cannot access a cross-origin resource",\r\n                    url,\r\n                    "Overview your URLs and CORS policies or use",\r\n                    "\`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))\`.",\r\n                    "See if using \`DarkReader.setFetchMethod(window.fetch)\`",\r\n                    "before \`DarkReader.enable()\` works."\r\n                ].join(" ")\r\n            )\r\n        );\r\n    };\r\n    let fetcher = throwCORSError;\r\n    function setFetchMethod$1(fetch) {\r\n        if (fetch) {\r\n            fetcher = fetch;\r\n        } else {\r\n            fetcher = throwCORSError;\r\n        }\r\n    }\r\n    async function callFetchMethod(url) {\r\n        return await fetcher(url);\r\n    }\r\n\r\n    if (!window.chrome) {\r\n        window.chrome = {};\r\n    }\r\n    if (!chrome.runtime) {\r\n        chrome.runtime = {};\r\n    }\r\n    const messageListeners = new Set();\r\n    async function sendMessage(...args) {\r\n        if (args[0] && args[0].type === MessageTypeCStoBG.FETCH) {\r\n            const {id} = args[0];\r\n            try {\r\n                const {url, responseType} = args[0].data;\r\n                const response = await callFetchMethod(url);\r\n                let text;\r\n                if (responseType === "data-url") {\r\n                    text = await readResponseAsDataURL(response);\r\n                } else {\r\n                    text = await response.text();\r\n                }\r\n                messageListeners.forEach((cb) =>\r\n                    cb({\r\n                        type: MessageTypeBGtoCS.FETCH_RESPONSE,\r\n                        data: text,\r\n                        error: null,\r\n                        id\r\n                    })\r\n                );\r\n            } catch (error) {\r\n                console.error(error);\r\n                messageListeners.forEach((cb) =>\r\n                    cb({\r\n                        type: MessageTypeBGtoCS.FETCH_RESPONSE,\r\n                        data: null,\r\n                        error,\r\n                        id\r\n                    })\r\n                );\r\n            }\r\n        }\r\n    }\r\n    function addMessageListener(callback) {\r\n        messageListeners.add(callback);\r\n    }\r\n    if (typeof chrome.runtime.sendMessage === "function") {\r\n        const nativeSendMessage = chrome.runtime.sendMessage;\r\n        chrome.runtime.sendMessage = (...args) => {\r\n            sendMessage(...args);\r\n            nativeSendMessage.apply(chrome.runtime, args);\r\n        };\r\n    } else {\r\n        chrome.runtime.sendMessage = sendMessage;\r\n    }\r\n    if (!chrome.runtime.onMessage) {\r\n        chrome.runtime.onMessage = {};\r\n    }\r\n    if (typeof chrome.runtime.onMessage.addListener === "function") {\r\n        const nativeAddListener = chrome.runtime.onMessage.addListener;\r\n        chrome.runtime.onMessage.addListener = (...args) => {\r\n            addMessageListener(args[0]);\r\n            nativeAddListener.apply(chrome.runtime.onMessage, args);\r\n        };\r\n    } else {\r\n        chrome.runtime.onMessage.addListener = (...args) =>\r\n            addMessageListener(args[0]);\r\n    }\r\n\r\n    var ThemeEngine;\r\n    (function (ThemeEngine) {\r\n        ThemeEngine["cssFilter"] = "cssFilter";\r\n        ThemeEngine["svgFilter"] = "svgFilter";\r\n        ThemeEngine["staticTheme"] = "staticTheme";\r\n        ThemeEngine["dynamicTheme"] = "dynamicTheme";\r\n    })(ThemeEngine || (ThemeEngine = {}));\r\n\r\n    var AutomationMode;\r\n    (function (AutomationMode) {\r\n        AutomationMode["NONE"] = "";\r\n        AutomationMode["TIME"] = "time";\r\n        AutomationMode["SYSTEM"] = "system";\r\n        AutomationMode["LOCATION"] = "location";\r\n    })(AutomationMode || (AutomationMode = {}));\r\n\r\n    const DEFAULT_COLORS = {\r\n        darkScheme: {\r\n            background: "#181a1b",\r\n            text: "#e8e6e3"\r\n        },\r\n        lightScheme: {\r\n            background: "#dcdad7",\r\n            text: "#181a1b"\r\n        }\r\n    };\r\n    const DEFAULT_THEME = {\r\n        mode: 1,\r\n        brightness: 100,\r\n        contrast: 100,\r\n        grayscale: 0,\r\n        sepia: 0,\r\n        useFont: false,\r\n        fontFamily: isMacOS\r\n            ? "Helvetica Neue"\r\n            : isWindows\r\n              ? "Segoe UI"\r\n              : "Open Sans",\r\n        textStroke: 0,\r\n        engine: ThemeEngine.dynamicTheme,\r\n        stylesheet: "",\r\n        darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\r\n        darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\r\n        lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\r\n        lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\r\n        scrollbarColor: isMacOS ? "" : "auto",\r\n        selectionColor: "auto",\r\n        styleSystemControls: !isCSSColorSchemePropSupported,\r\n        lightColorScheme: "Default",\r\n        darkColorScheme: "Default",\r\n        immediateModify: false\r\n    };\r\n    ({\r\n        schemeVersion: 0,\r\n        enabled: true,\r\n        fetchNews: true,\r\n        theme: DEFAULT_THEME,\r\n        presets: [],\r\n        customThemes: [],\r\n        enabledByDefault: true,\r\n        enabledFor: [],\r\n        disabledFor: [],\r\n        changeBrowserTheme: false,\r\n        syncSettings: true,\r\n        syncSitesFixes: false,\r\n        automation: {\r\n            enabled: false,\r\n            mode: AutomationMode.NONE,\r\n            behavior: "OnOff"\r\n        },\r\n        time: {\r\n            activation: "18:00",\r\n            deactivation: "9:00"\r\n        },\r\n        location: {\r\n            latitude: null,\r\n            longitude: null\r\n        },\r\n        previewNewDesign: false,\r\n        enableForPDF: true,\r\n        enableForProtectedPages: false,\r\n        enableContextMenus: false,\r\n        detectDarkTheme: false\r\n    });\r\n\r\n    function isArrayLike(items) {\r\n        return items.length != null;\r\n    }\r\n    function forEach(items, iterator) {\r\n        if (isArrayLike(items)) {\r\n            for (let i = 0, len = items.length; i < len; i++) {\r\n                iterator(items[i]);\r\n            }\r\n        } else {\r\n            for (const item of items) {\r\n                iterator(item);\r\n            }\r\n        }\r\n    }\r\n    function push(array, addition) {\r\n        forEach(addition, (a) => array.push(a));\r\n    }\r\n    function toArray(items) {\r\n        const results = [];\r\n        for (let i = 0, len = items.length; i < len; i++) {\r\n            results.push(items[i]);\r\n        }\r\n        return results;\r\n    }\r\n\r\n    function logInfo(...args) {}\r\n    function logWarn(...args) {}\r\n\r\n    function throttle(callback) {\r\n        let pending = false;\r\n        let frameId = null;\r\n        let lastArgs;\r\n        const throttled = (...args) => {\r\n            lastArgs = args;\r\n            if (frameId) {\r\n                pending = true;\r\n            } else {\r\n                callback(...lastArgs);\r\n                frameId = requestAnimationFrame(() => {\r\n                    frameId = null;\r\n                    if (pending) {\r\n                        callback(...lastArgs);\r\n                        pending = false;\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        const cancel = () => {\r\n            cancelAnimationFrame(frameId);\r\n            pending = false;\r\n            frameId = null;\r\n        };\r\n        return Object.assign(throttled, {cancel});\r\n    }\r\n    function createAsyncTasksQueue() {\r\n        const tasks = [];\r\n        let frameId = null;\r\n        function runTasks() {\r\n            let task;\r\n            while ((task = tasks.shift())) {\r\n                task();\r\n            }\r\n            frameId = null;\r\n        }\r\n        function add(task) {\r\n            tasks.push(task);\r\n            if (!frameId) {\r\n                frameId = requestAnimationFrame(runTasks);\r\n            }\r\n        }\r\n        function cancel() {\r\n            tasks.splice(0);\r\n            cancelAnimationFrame(frameId);\r\n            frameId = null;\r\n        }\r\n        return {add, cancel};\r\n    }\r\n    const delayTokens = new Set();\r\n    function requestAnimationFrameOnce(token, callback) {\r\n        if (delayTokens.has(token)) {\r\n            return;\r\n        }\r\n        delayTokens.add(token);\r\n        requestAnimationFrame(() => {\r\n            delayTokens.delete(token);\r\n            callback();\r\n        });\r\n    }\r\n\r\n    function getDuration(time) {\r\n        let duration = 0;\r\n        if (time.seconds) {\r\n            duration += time.seconds * 1000;\r\n        }\r\n        if (time.minutes) {\r\n            duration += time.minutes * 60 * 1000;\r\n        }\r\n        if (time.hours) {\r\n            duration += time.hours * 60 * 60 * 1000;\r\n        }\r\n        if (time.days) {\r\n            duration += time.days * 24 * 60 * 60 * 1000;\r\n        }\r\n        return duration;\r\n    }\r\n\r\n    function removeNode(node) {\r\n        node && node.parentNode && node.parentNode.removeChild(node);\r\n    }\r\n    function watchForNodePosition(node, mode, onRestore = Function.prototype) {\r\n        const MAX_ATTEMPTS_COUNT = 10;\r\n        const RETRY_TIMEOUT = getDuration({seconds: 2});\r\n        const ATTEMPTS_INTERVAL = getDuration({seconds: 10});\r\n        const prevSibling = node.previousSibling;\r\n        let parent = node.parentNode;\r\n        if (!parent) {\r\n            throw new Error(\r\n                "Unable to watch for node position: parent element not found"\r\n            );\r\n        }\r\n        if (mode === "prev-sibling" && !prevSibling) {\r\n            throw new Error(\r\n                "Unable to watch for node position: there is no previous sibling"\r\n            );\r\n        }\r\n        let attempts = 0;\r\n        let start = null;\r\n        let timeoutId = null;\r\n        const restore = throttle(() => {\r\n            if (timeoutId) {\r\n                return;\r\n            }\r\n            attempts++;\r\n            const now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            } else if (attempts >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(() => {\r\n                        start = null;\r\n                        attempts = 0;\r\n                        timeoutId = null;\r\n                        restore();\r\n                    }, RETRY_TIMEOUT);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attempts = 1;\r\n            }\r\n            if (mode === "head") {\r\n                if (prevSibling && prevSibling.parentNode !== parent) {\r\n                    stop();\r\n                    return;\r\n                }\r\n            }\r\n            if (mode === "prev-sibling") {\r\n                if (prevSibling.parentNode == null) {\r\n                    stop();\r\n                    return;\r\n                }\r\n                if (prevSibling.parentNode !== parent) {\r\n                    updateParent(prevSibling.parentNode);\r\n                }\r\n            }\r\n            if (mode === "head" && !parent.isConnected) {\r\n                parent = document.head;\r\n            }\r\n            parent.insertBefore(\r\n                node,\r\n                prevSibling && prevSibling.isConnected\r\n                    ? prevSibling.nextSibling\r\n                    : parent.firstChild\r\n            );\r\n            observer.takeRecords();\r\n            onRestore && onRestore();\r\n        });\r\n        const observer = new MutationObserver(() => {\r\n            if (\r\n                (mode === "head" &&\r\n                    (node.parentNode !== parent ||\r\n                        !node.parentNode.isConnected)) ||\r\n                (mode === "prev-sibling" &&\r\n                    node.previousSibling !== prevSibling)\r\n            ) {\r\n                restore();\r\n            }\r\n        });\r\n        const run = () => {\r\n            observer.observe(parent, {childList: true});\r\n        };\r\n        const stop = () => {\r\n            clearTimeout(timeoutId);\r\n            observer.disconnect();\r\n            restore.cancel();\r\n        };\r\n        const skip = () => {\r\n            observer.takeRecords();\r\n        };\r\n        const updateParent = (parentNode) => {\r\n            parent = parentNode;\r\n            stop();\r\n            run();\r\n        };\r\n        run();\r\n        return {run, stop, skip};\r\n    }\r\n    function iterateShadowHosts(root, iterator) {\r\n        if (root == null) {\r\n            return;\r\n        }\r\n        const walker = document.createTreeWalker(\r\n            root,\r\n            NodeFilter.SHOW_ELEMENT,\r\n            {\r\n                acceptNode(node) {\r\n                    return node.shadowRoot == null\r\n                        ? NodeFilter.FILTER_SKIP\r\n                        : NodeFilter.FILTER_ACCEPT;\r\n                }\r\n            }\r\n        );\r\n        for (\r\n            let node = root.shadowRoot ? walker.currentNode : walker.nextNode();\r\n            node != null;\r\n            node = walker.nextNode()\r\n        ) {\r\n            if (node.classList.contains("surfingkeys_hints_host")) {\r\n                continue;\r\n            }\r\n            iterator(node);\r\n            iterateShadowHosts(node.shadowRoot, iterator);\r\n        }\r\n    }\r\n    let isDOMReady = () => {\r\n        return (\r\n            document.readyState === "complete" ||\r\n            document.readyState === "interactive"\r\n        );\r\n    };\r\n    function setIsDOMReady(newFunc) {\r\n        isDOMReady = newFunc;\r\n    }\r\n    const readyStateListeners = new Set();\r\n    function addDOMReadyListener(listener) {\r\n        isDOMReady() ? listener() : readyStateListeners.add(listener);\r\n    }\r\n    function removeDOMReadyListener(listener) {\r\n        readyStateListeners.delete(listener);\r\n    }\r\n    function isReadyStateComplete() {\r\n        return document.readyState === "complete";\r\n    }\r\n    const readyStateCompleteListeners = new Set();\r\n    function addReadyStateCompleteListener(listener) {\r\n        isReadyStateComplete()\r\n            ? listener()\r\n            : readyStateCompleteListeners.add(listener);\r\n    }\r\n    function cleanReadyStateCompleteListeners() {\r\n        readyStateCompleteListeners.clear();\r\n    }\r\n    if (!isDOMReady()) {\r\n        const onReadyStateChange = () => {\r\n            if (isDOMReady()) {\r\n                readyStateListeners.forEach((listener) => listener());\r\n                readyStateListeners.clear();\r\n                if (isReadyStateComplete()) {\r\n                    document.removeEventListener(\r\n                        "readystatechange",\r\n                        onReadyStateChange\r\n                    );\r\n                    readyStateCompleteListeners.forEach((listener) =>\r\n                        listener()\r\n                    );\r\n                    readyStateCompleteListeners.clear();\r\n                }\r\n            }\r\n        };\r\n        document.addEventListener("readystatechange", onReadyStateChange);\r\n    }\r\n    const HUGE_MUTATIONS_COUNT = 1000;\r\n    function isHugeMutation(mutations) {\r\n        if (mutations.length > HUGE_MUTATIONS_COUNT) {\r\n            return true;\r\n        }\r\n        let addedNodesCount = 0;\r\n        for (let i = 0; i < mutations.length; i++) {\r\n            addedNodesCount += mutations[i].addedNodes.length;\r\n            if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getElementsTreeOperations(mutations) {\r\n        const additions = new Set();\r\n        const deletions = new Set();\r\n        const moves = new Set();\r\n        mutations.forEach((m) => {\r\n            forEach(m.addedNodes, (n) => {\r\n                if (n instanceof Element && n.isConnected) {\r\n                    additions.add(n);\r\n                }\r\n            });\r\n            forEach(m.removedNodes, (n) => {\r\n                if (n instanceof Element) {\r\n                    if (n.isConnected) {\r\n                        moves.add(n);\r\n                        additions.delete(n);\r\n                    } else {\r\n                        deletions.add(n);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        const duplicateAdditions = [];\r\n        const duplicateDeletions = [];\r\n        additions.forEach((node) => {\r\n            if (additions.has(node.parentElement)) {\r\n                duplicateAdditions.push(node);\r\n            }\r\n        });\r\n        deletions.forEach((node) => {\r\n            if (deletions.has(node.parentElement)) {\r\n                duplicateDeletions.push(node);\r\n            }\r\n        });\r\n        duplicateAdditions.forEach((node) => additions.delete(node));\r\n        duplicateDeletions.forEach((node) => deletions.delete(node));\r\n        return {additions, moves, deletions};\r\n    }\r\n    const optimizedTreeObservers = new Map();\r\n    const optimizedTreeCallbacks = new WeakMap();\r\n    function createOptimizedTreeObserver(root, callbacks) {\r\n        let observer;\r\n        let observerCallbacks;\r\n        let domReadyListener;\r\n        if (optimizedTreeObservers.has(root)) {\r\n            observer = optimizedTreeObservers.get(root);\r\n            observerCallbacks = optimizedTreeCallbacks.get(observer);\r\n        } else {\r\n            let hadHugeMutationsBefore = false;\r\n            let subscribedForReadyState = false;\r\n            observer = new MutationObserver((mutations) => {\r\n                if (isHugeMutation(mutations)) {\r\n                    if (!hadHugeMutationsBefore || isDOMReady()) {\r\n                        observerCallbacks.forEach(({onHugeMutations}) =>\r\n                            onHugeMutations(root)\r\n                        );\r\n                    } else if (!subscribedForReadyState) {\r\n                        domReadyListener = () =>\r\n                            observerCallbacks.forEach(({onHugeMutations}) =>\r\n                                onHugeMutations(root)\r\n                            );\r\n                        addDOMReadyListener(domReadyListener);\r\n                        subscribedForReadyState = true;\r\n                    }\r\n                    hadHugeMutationsBefore = true;\r\n                } else {\r\n                    const elementsOperations =\r\n                        getElementsTreeOperations(mutations);\r\n                    observerCallbacks.forEach(({onMinorMutations}) =>\r\n                        onMinorMutations(root, elementsOperations)\r\n                    );\r\n                }\r\n            });\r\n            observer.observe(root, {childList: true, subtree: true});\r\n            optimizedTreeObservers.set(root, observer);\r\n            observerCallbacks = new Set();\r\n            optimizedTreeCallbacks.set(observer, observerCallbacks);\r\n        }\r\n        observerCallbacks.add(callbacks);\r\n        return {\r\n            disconnect() {\r\n                observerCallbacks.delete(callbacks);\r\n                if (domReadyListener) {\r\n                    removeDOMReadyListener(domReadyListener);\r\n                }\r\n                if (observerCallbacks.size === 0) {\r\n                    observer.disconnect();\r\n                    optimizedTreeCallbacks.delete(observer);\r\n                    optimizedTreeObservers.delete(root);\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    function getMatches(regex, input, group = 0) {\r\n        const matches = [];\r\n        let m;\r\n        while ((m = regex.exec(input))) {\r\n            matches.push(m[group]);\r\n        }\r\n        return matches;\r\n    }\r\n    function getHashCode(text) {\r\n        const len = text.length;\r\n        let hash = 0;\r\n        for (let i = 0; i < len; i++) {\r\n            const c = text.charCodeAt(i);\r\n            hash = ((hash << 5) - hash + c) & 4294967295;\r\n        }\r\n        return hash;\r\n    }\r\n    function escapeRegExpSpecialChars(input) {\r\n        return input.replaceAll(/[\\^$.*+?\\(\\)\\[\\]{}|\\-\\\\]/g, "\\\\$&");\r\n    }\r\n    function getParenthesesRange(input, searchStartIndex = 0) {\r\n        return getOpenCloseRange(input, searchStartIndex, "(", ")", []);\r\n    }\r\n    function getOpenCloseRange(\r\n        input,\r\n        searchStartIndex,\r\n        openToken,\r\n        closeToken,\r\n        excludeRanges\r\n    ) {\r\n        let indexOf;\r\n        if (excludeRanges.length === 0) {\r\n            indexOf = (token, pos) => input.indexOf(token, pos);\r\n        } else {\r\n            indexOf = (token, pos) =>\r\n                indexOfExcluding(input, token, pos, excludeRanges);\r\n        }\r\n        const {length} = input;\r\n        let depth = 0;\r\n        let firstOpenIndex = -1;\r\n        for (let i = searchStartIndex; i < length; i++) {\r\n            if (depth === 0) {\r\n                const openIndex = indexOf(openToken, i);\r\n                if (openIndex < 0) {\r\n                    break;\r\n                }\r\n                firstOpenIndex = openIndex;\r\n                depth++;\r\n                i = openIndex;\r\n            } else {\r\n                const closeIndex = indexOf(closeToken, i);\r\n                if (closeIndex < 0) {\r\n                    break;\r\n                }\r\n                const openIndex = indexOf(openToken, i);\r\n                if (openIndex < 0 || closeIndex <= openIndex) {\r\n                    depth--;\r\n                    if (depth === 0) {\r\n                        return {start: firstOpenIndex, end: closeIndex + 1};\r\n                    }\r\n                    i = closeIndex;\r\n                } else {\r\n                    depth++;\r\n                    i = openIndex;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function indexOfExcluding(input, search, position, excludeRanges) {\r\n        const i = input.indexOf(search, position);\r\n        const exclusion = excludeRanges.find((r) => i >= r.start && i < r.end);\r\n        if (exclusion) {\r\n            return indexOfExcluding(\r\n                input,\r\n                search,\r\n                exclusion.end,\r\n                excludeRanges\r\n            );\r\n        }\r\n        return i;\r\n    }\r\n    function splitExcluding(input, separator, excludeRanges) {\r\n        const parts = [];\r\n        let commaIndex = -1;\r\n        let currIndex = 0;\r\n        while (\r\n            (commaIndex = indexOfExcluding(\r\n                input,\r\n                separator,\r\n                currIndex,\r\n                excludeRanges\r\n            )) >= 0\r\n        ) {\r\n            parts.push(input.substring(currIndex, commaIndex).trim());\r\n            currIndex = commaIndex + 1;\r\n        }\r\n        parts.push(input.substring(currIndex).trim());\r\n        return parts;\r\n    }\r\n\r\n    let anchor;\r\n    const parsedURLCache = new Map();\r\n    function fixBaseURL($url) {\r\n        if (!anchor) {\r\n            anchor = document.createElement("a");\r\n        }\r\n        anchor.href = $url;\r\n        return anchor.href;\r\n    }\r\n    function parseURL($url, $base = null) {\r\n        const key = \`\${$url}\${$base ? \`;\${$base}\` : ""}\`;\r\n        if (parsedURLCache.has(key)) {\r\n            return parsedURLCache.get(key);\r\n        }\r\n        if ($base) {\r\n            const parsedURL = new URL($url, fixBaseURL($base));\r\n            parsedURLCache.set(key, parsedURL);\r\n            return parsedURL;\r\n        }\r\n        const parsedURL = new URL(fixBaseURL($url));\r\n        parsedURLCache.set($url, parsedURL);\r\n        return parsedURL;\r\n    }\r\n    function getAbsoluteURL($base, $relative) {\r\n        if ($relative.match(/^data\\\\?\\:/)) {\r\n            return $relative;\r\n        }\r\n        if (/^\\/\\//.test($relative)) {\r\n            return \`\${location.protocol}\${$relative}\`;\r\n        }\r\n        const b = parseURL($base);\r\n        const a = parseURL($relative, b.href);\r\n        return a.href;\r\n    }\r\n    function isRelativeHrefOnAbsolutePath(href) {\r\n        if (href.startsWith("data:")) {\r\n            return true;\r\n        }\r\n        const url = parseURL(href);\r\n        if (url.protocol !== location.protocol) {\r\n            return false;\r\n        }\r\n        if (url.hostname !== location.hostname) {\r\n            return false;\r\n        }\r\n        if (url.port !== location.port) {\r\n            return false;\r\n        }\r\n        return url.pathname === location.pathname;\r\n    }\r\n\r\n    function iterateCSSRules(rules, iterate, onImportError) {\r\n        forEach(rules, (rule) => {\r\n            if (isStyleRule(rule)) {\r\n                iterate(rule);\r\n            } else if (isImportRule(rule)) {\r\n                try {\r\n                    iterateCSSRules(\r\n                        rule.styleSheet.cssRules,\r\n                        iterate,\r\n                        onImportError\r\n                    );\r\n                } catch (err) {\r\n                    onImportError?.();\r\n                }\r\n            } else if (isMediaRule(rule)) {\r\n                const media = Array.from(rule.media);\r\n                const isScreenOrAllOrQuery = media.some(\r\n                    (m) =>\r\n                        m.startsWith("screen") ||\r\n                        m.startsWith("all") ||\r\n                        m.startsWith("(")\r\n                );\r\n                const isPrintOrSpeech = media.some(\r\n                    (m) => m.startsWith("print") || m.startsWith("speech")\r\n                );\r\n                if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onImportError);\r\n                }\r\n            } else if (isSupportsRule(rule)) {\r\n                if (CSS.supports(rule.conditionText)) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onImportError);\r\n                }\r\n            } else if (isLayerRule(rule)) {\r\n                iterateCSSRules(rule.cssRules, iterate, onImportError);\r\n            } else;\r\n        });\r\n    }\r\n    const shorthandVarDependantProperties = [\r\n        "background",\r\n        "border",\r\n        "border-color",\r\n        "border-bottom",\r\n        "border-left",\r\n        "border-right",\r\n        "border-top",\r\n        "outline",\r\n        "outline-color"\r\n    ];\r\n    const shorthandVarDepPropRegexps = isSafari\r\n        ? shorthandVarDependantProperties.map((prop) => {\r\n              const regexp = new RegExp(\`\${prop}:\\\\s*(.*?)\\\\s*;\`);\r\n              return [prop, regexp];\r\n          })\r\n        : null;\r\n    function iterateCSSDeclarations(style, iterate) {\r\n        forEach(style, (property) => {\r\n            const value = style.getPropertyValue(property).trim();\r\n            if (!value) {\r\n                return;\r\n            }\r\n            iterate(property, value);\r\n        });\r\n        const cssText = style.cssText;\r\n        if (cssText.includes("var(")) {\r\n            if (isSafari) {\r\n                shorthandVarDepPropRegexps.forEach(([prop, regexp]) => {\r\n                    const match = cssText.match(regexp);\r\n                    if (match && match[1]) {\r\n                        const val = match[1].trim();\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            } else {\r\n                shorthandVarDependantProperties.forEach((prop) => {\r\n                    const val = style.getPropertyValue(prop);\r\n                    if (val && val.includes("var(")) {\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        if (\r\n            cssText.includes("background-color: ;") &&\r\n            !style.getPropertyValue("background")\r\n        ) {\r\n            handleEmptyShorthand("background", style, iterate);\r\n        }\r\n        if (\r\n            cssText.includes("border-") &&\r\n            cssText.includes("-color: ;") &&\r\n            !style.getPropertyValue("border")\r\n        ) {\r\n            handleEmptyShorthand("border", style, iterate);\r\n        }\r\n    }\r\n    function handleEmptyShorthand(shorthand, style, iterate) {\r\n        const parentRule = style.parentRule;\r\n        if (isStyleRule(parentRule)) {\r\n            const sourceCSSText =\r\n                parentRule.parentStyleSheet?.ownerNode?.textContent;\r\n            if (sourceCSSText) {\r\n                let escapedSelector = escapeRegExpSpecialChars(\r\n                    parentRule.selectorText\r\n                );\r\n                escapedSelector = escapedSelector.replaceAll(/\\s+/g, "\\\\s*");\r\n                escapedSelector = escapedSelector.replaceAll(/::/g, "::?");\r\n                const regexp = new RegExp(\r\n                    \`\${escapedSelector}\\\\s*{[^}]*?\${shorthand}:\\\\s*([^;}]+)\`\r\n                );\r\n                const match = sourceCSSText.match(regexp);\r\n                if (match) {\r\n                    iterate(shorthand, match[1]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    const cssURLRegex = /url\\((('.*?')|(".*?")|([^\\)]*?))\\)/g;\r\n    const cssImportRegex =\r\n        /@import\\s*(url\\()?(('.+?')|(".+?")|([^\\)]*?))\\)? ?(screen)?;?/gi;\r\n    function getCSSURLValue(cssURL) {\r\n        return cssURL\r\n            .trim()\r\n            .replace(/[\\n\\r\\\\]+/g, "")\r\n            .replace(/^url\\((.*)\\)$/, "$1")\r\n            .trim()\r\n            .replace(/^"(.*)"$/, "$1")\r\n            .replace(/^'(.*)'$/, "$1")\r\n            .replace(/(?:\\\\(.))/g, "$1");\r\n    }\r\n    function getCSSBaseBath(url) {\r\n        const cssURL = parseURL(url);\r\n        return \`\${cssURL.origin}\${cssURL.pathname.replace(/\\?.*$/, "").replace(/(\\/)([^\\/]+)$/i, "$1")}\`;\r\n    }\r\n    function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\r\n        return $css.replace(cssURLRegex, (match) => {\r\n            const pathValue = getCSSURLValue(match);\r\n            try {\r\n                return \`url('\${getAbsoluteURL(cssBasePath, pathValue)}')\`;\r\n            } catch (err) {\r\n                return match;\r\n            }\r\n        });\r\n    }\r\n    const fontFaceRegex = /@font-face\\s*{[^}]*}/g;\r\n    function replaceCSSFontFace($css) {\r\n        return $css.replace(fontFaceRegex, "");\r\n    }\r\n    const styleRules = new WeakSet();\r\n    const importRules = new WeakSet();\r\n    const mediaRules = new WeakSet();\r\n    const supportsRules = new WeakSet();\r\n    const layerRules = new WeakSet();\r\n    function isStyleRule(rule) {\r\n        if (!rule) {\r\n            return false;\r\n        }\r\n        if (styleRules.has(rule)) {\r\n            return true;\r\n        }\r\n        if (rule.selectorText) {\r\n            styleRules.add(rule);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function isImportRule(rule) {\r\n        if (!rule) {\r\n            return false;\r\n        }\r\n        if (styleRules.has(rule)) {\r\n            return false;\r\n        }\r\n        if (importRules.has(rule)) {\r\n            return true;\r\n        }\r\n        if (rule.href) {\r\n            importRules.add(rule);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function isMediaRule(rule) {\r\n        if (!rule) {\r\n            return false;\r\n        }\r\n        if (styleRules.has(rule)) {\r\n            return false;\r\n        }\r\n        if (mediaRules.has(rule)) {\r\n            return true;\r\n        }\r\n        if (rule.media) {\r\n            mediaRules.add(rule);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function isSupportsRule(rule) {\r\n        if (!rule) {\r\n            return false;\r\n        }\r\n        if (styleRules.has(rule)) {\r\n            return false;\r\n        }\r\n        if (supportsRules.has(rule)) {\r\n            return true;\r\n        }\r\n        if (rule instanceof CSSSupportsRule) {\r\n            supportsRules.add(rule);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function isLayerRule(rule) {\r\n        if (!rule) {\r\n            return false;\r\n        }\r\n        if (styleRules.has(rule)) {\r\n            return false;\r\n        }\r\n        if (layerRules.has(rule)) {\r\n            return true;\r\n        }\r\n        if (rule instanceof CSSLayerBlockRule) {\r\n            layerRules.add(rule);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function evalMath(expression) {\r\n        const rpnStack = [];\r\n        const workingStack = [];\r\n        let lastToken;\r\n        for (let i = 0, len = expression.length; i < len; i++) {\r\n            const token = expression[i];\r\n            if (!token || token === " ") {\r\n                continue;\r\n            }\r\n            if (operators.has(token)) {\r\n                const op = operators.get(token);\r\n                while (workingStack.length) {\r\n                    const currentOp = operators.get(workingStack[0]);\r\n                    if (!currentOp) {\r\n                        break;\r\n                    }\r\n                    if (op.lessOrEqualThan(currentOp)) {\r\n                        rpnStack.push(workingStack.shift());\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                workingStack.unshift(token);\r\n            } else if (!lastToken || operators.has(lastToken)) {\r\n                rpnStack.push(token);\r\n            } else {\r\n                rpnStack[rpnStack.length - 1] += token;\r\n            }\r\n            lastToken = token;\r\n        }\r\n        rpnStack.push(...workingStack);\r\n        const stack = [];\r\n        for (let i = 0, len = rpnStack.length; i < len; i++) {\r\n            const op = operators.get(rpnStack[i]);\r\n            if (op) {\r\n                const args = stack.splice(0, 2);\r\n                stack.push(op.exec(args[1], args[0]));\r\n            } else {\r\n                stack.unshift(parseFloat(rpnStack[i]));\r\n            }\r\n        }\r\n        return stack[0];\r\n    }\r\n    class Operator {\r\n        constructor(precedence, method) {\r\n            this.precendce = precedence;\r\n            this.execMethod = method;\r\n        }\r\n        exec(left, right) {\r\n            return this.execMethod(left, right);\r\n        }\r\n        lessOrEqualThan(op) {\r\n            return this.precendce <= op.precendce;\r\n        }\r\n    }\r\n    const operators = new Map([\r\n        ["+", new Operator(1, (left, right) => left + right)],\r\n        ["-", new Operator(1, (left, right) => left - right)],\r\n        ["*", new Operator(2, (left, right) => left * right)],\r\n        ["/", new Operator(2, (left, right) => left / right)]\r\n    ]);\r\n\r\n    const isSystemDarkModeEnabled = () =>\r\n        matchMedia("(prefers-color-scheme: dark)").matches;\r\n\r\n    const hslaParseCache = new Map();\r\n    const rgbaParseCache = new Map();\r\n    function parseColorWithCache($color) {\r\n        $color = $color.trim();\r\n        if (rgbaParseCache.has($color)) {\r\n            return rgbaParseCache.get($color);\r\n        }\r\n        if ($color.includes("calc(")) {\r\n            $color = lowerCalcExpression($color);\r\n        }\r\n        const color = parse($color);\r\n        color && rgbaParseCache.set($color, color);\r\n        return color;\r\n    }\r\n    function parseToHSLWithCache(color) {\r\n        if (hslaParseCache.has(color)) {\r\n            return hslaParseCache.get(color);\r\n        }\r\n        const rgb = parseColorWithCache(color);\r\n        if (!rgb) {\r\n            return null;\r\n        }\r\n        const hsl = rgbToHSL(rgb);\r\n        hslaParseCache.set(color, hsl);\r\n        return hsl;\r\n    }\r\n    function clearColorCache() {\r\n        hslaParseCache.clear();\r\n        rgbaParseCache.clear();\r\n    }\r\n    function hslToRGB({h, s, l, a = 1}) {\r\n        if (s === 0) {\r\n            const [r, b, g] = [l, l, l].map((x) => Math.round(x * 255));\r\n            return {r, g, b, a};\r\n        }\r\n        const c = (1 - Math.abs(2 * l - 1)) * s;\r\n        const x = c * (1 - Math.abs(((h / 60) % 2) - 1));\r\n        const m = l - c / 2;\r\n        const [r, g, b] = (\r\n            h < 60\r\n                ? [c, x, 0]\r\n                : h < 120\r\n                  ? [x, c, 0]\r\n                  : h < 180\r\n                    ? [0, c, x]\r\n                    : h < 240\r\n                      ? [0, x, c]\r\n                      : h < 300\r\n                        ? [x, 0, c]\r\n                        : [c, 0, x]\r\n        ).map((n) => Math.round((n + m) * 255));\r\n        return {r, g, b, a};\r\n    }\r\n    function rgbToHSL({r: r255, g: g255, b: b255, a = 1}) {\r\n        const r = r255 / 255;\r\n        const g = g255 / 255;\r\n        const b = b255 / 255;\r\n        const max = Math.max(r, g, b);\r\n        const min = Math.min(r, g, b);\r\n        const c = max - min;\r\n        const l = (max + min) / 2;\r\n        if (c === 0) {\r\n            return {h: 0, s: 0, l, a};\r\n        }\r\n        let h =\r\n            (max === r\r\n                ? ((g - b) / c) % 6\r\n                : max === g\r\n                  ? (b - r) / c + 2\r\n                  : (r - g) / c + 4) * 60;\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        const s = c / (1 - Math.abs(2 * l - 1));\r\n        return {h, s, l, a};\r\n    }\r\n    function toFixed(n, digits = 0) {\r\n        const fixed = n.toFixed(digits);\r\n        if (digits === 0) {\r\n            return fixed;\r\n        }\r\n        const dot = fixed.indexOf(".");\r\n        if (dot >= 0) {\r\n            const zerosMatch = fixed.match(/0+$/);\r\n            if (zerosMatch) {\r\n                if (zerosMatch.index === dot + 1) {\r\n                    return fixed.substring(0, dot);\r\n                }\r\n                return fixed.substring(0, zerosMatch.index);\r\n            }\r\n        }\r\n        return fixed;\r\n    }\r\n    function rgbToString(rgb) {\r\n        const {r, g, b, a} = rgb;\r\n        if (a != null && a < 1) {\r\n            return \`rgba(\${toFixed(r)}, \${toFixed(g)}, \${toFixed(b)}, \${toFixed(a, 2)})\`;\r\n        }\r\n        return \`rgb(\${toFixed(r)}, \${toFixed(g)}, \${toFixed(b)})\`;\r\n    }\r\n    function rgbToHexString({r, g, b, a}) {\r\n        return \`#\${(a != null && a < 1\r\n            ? [r, g, b, Math.round(a * 255)]\r\n            : [r, g, b]\r\n        )\r\n            .map((x) => {\r\n                return \`\${x < 16 ? "0" : ""}\${x.toString(16)}\`;\r\n            })\r\n            .join("")}\`;\r\n    }\r\n    function hslToString(hsl) {\r\n        const {h, s, l, a} = hsl;\r\n        if (a != null && a < 1) {\r\n            return \`hsla(\${toFixed(h)}, \${toFixed(s * 100)}%, \${toFixed(l * 100)}%, \${toFixed(a, 2)})\`;\r\n        }\r\n        return \`hsl(\${toFixed(h)}, \${toFixed(s * 100)}%, \${toFixed(l * 100)}%)\`;\r\n    }\r\n    const rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\r\n    const hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\r\n    const hexMatch = /^#[0-9a-f]+$/i;\r\n    function parse($color) {\r\n        const c = $color.trim().toLowerCase();\r\n        if (c.match(rgbMatch)) {\r\n            return parseRGB(c);\r\n        }\r\n        if (c.match(hslMatch)) {\r\n            return parseHSL(c);\r\n        }\r\n        if (c.match(hexMatch)) {\r\n            return parseHex(c);\r\n        }\r\n        if (knownColors.has(c)) {\r\n            return getColorByName(c);\r\n        }\r\n        if (systemColors.has(c)) {\r\n            return getSystemColor(c);\r\n        }\r\n        if ($color === "transparent") {\r\n            return {r: 0, g: 0, b: 0, a: 0};\r\n        }\r\n        if (\r\n            (c.startsWith("color(") || c.startsWith("color-mix(")) &&\r\n            c.endsWith(")")\r\n        ) {\r\n            return domParseColor(c);\r\n        }\r\n        if (c.startsWith("light-dark(") && c.endsWith(")")) {\r\n            const match = c.match(\r\n                /^light-dark\\(\\s*([a-z]+(\\(.*\\))?),\\s*([a-z]+(\\(.*\\))?)\\s*\\)$/\r\n            );\r\n            if (match) {\r\n                const schemeColor = isSystemDarkModeEnabled()\r\n                    ? match[3]\r\n                    : match[1];\r\n                return parse(schemeColor);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getNumbers($color) {\r\n        const numbers = [];\r\n        let prevPos = 0;\r\n        let isMining = false;\r\n        const startIndex = $color.indexOf("(");\r\n        $color = $color.substring(startIndex + 1, $color.length - 1);\r\n        for (let i = 0; i < $color.length; i++) {\r\n            const c = $color[i];\r\n            if ((c >= "0" && c <= "9") || c === "." || c === "+" || c === "-") {\r\n                isMining = true;\r\n            } else if (isMining && (c === " " || c === "," || c === "/")) {\r\n                numbers.push($color.substring(prevPos, i));\r\n                isMining = false;\r\n                prevPos = i + 1;\r\n            } else if (!isMining) {\r\n                prevPos = i + 1;\r\n            }\r\n        }\r\n        if (isMining) {\r\n            numbers.push($color.substring(prevPos, $color.length));\r\n        }\r\n        return numbers;\r\n    }\r\n    function getNumbersFromString(str, range, units) {\r\n        const raw = getNumbers(str);\r\n        const unitsList = Object.entries(units);\r\n        const numbers = raw\r\n            .map((r) => r.trim())\r\n            .map((r, i) => {\r\n                let n;\r\n                const unit = unitsList.find(([u]) => r.endsWith(u));\r\n                if (unit) {\r\n                    n =\r\n                        (parseFloat(r.substring(0, r.length - unit[0].length)) /\r\n                            unit[1]) *\r\n                        range[i];\r\n                } else {\r\n                    n = parseFloat(r);\r\n                }\r\n                if (range[i] > 1) {\r\n                    return Math.round(n);\r\n                }\r\n                return n;\r\n            });\r\n        return numbers;\r\n    }\r\n    const rgbRange = [255, 255, 255, 1];\r\n    const rgbUnits = {"%": 100};\r\n    function parseRGB($rgb) {\r\n        const [r, g, b, a = 1] = getNumbersFromString($rgb, rgbRange, rgbUnits);\r\n        return {r, g, b, a};\r\n    }\r\n    const hslRange = [360, 1, 1, 1];\r\n    const hslUnits = {"%": 100, "deg": 360, "rad": 2 * Math.PI, "turn": 1};\r\n    function parseHSL($hsl) {\r\n        const [h, s, l, a = 1] = getNumbersFromString($hsl, hslRange, hslUnits);\r\n        return hslToRGB({h, s, l, a});\r\n    }\r\n    function parseHex($hex) {\r\n        const h = $hex.substring(1);\r\n        switch (h.length) {\r\n            case 3:\r\n            case 4: {\r\n                const [r, g, b] = [0, 1, 2].map((i) =>\r\n                    parseInt(\`\${h[i]}\${h[i]}\`, 16)\r\n                );\r\n                const a =\r\n                    h.length === 3 ? 1 : parseInt(\`\${h[3]}\${h[3]}\`, 16) / 255;\r\n                return {r, g, b, a};\r\n            }\r\n            case 6:\r\n            case 8: {\r\n                const [r, g, b] = [0, 2, 4].map((i) =>\r\n                    parseInt(h.substring(i, i + 2), 16)\r\n                );\r\n                const a =\r\n                    h.length === 6 ? 1 : parseInt(h.substring(6, 8), 16) / 255;\r\n                return {r, g, b, a};\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getColorByName($color) {\r\n        const n = knownColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function getSystemColor($color) {\r\n        const n = systemColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function lowerCalcExpression(color) {\r\n        let searchIndex = 0;\r\n        const replaceBetweenIndices = (start, end, replacement) => {\r\n            color =\r\n                color.substring(0, start) + replacement + color.substring(end);\r\n        };\r\n        while ((searchIndex = color.indexOf("calc(")) !== -1) {\r\n            const range = getParenthesesRange(color, searchIndex);\r\n            if (!range) {\r\n                break;\r\n            }\r\n            let slice = color.slice(range.start + 1, range.end - 1);\r\n            const includesPercentage = slice.includes("%");\r\n            slice = slice.split("%").join("");\r\n            const output = Math.round(evalMath(slice));\r\n            replaceBetweenIndices(\r\n                range.start - 4,\r\n                range.end,\r\n                output + (includesPercentage ? "%" : "")\r\n            );\r\n        }\r\n        return color;\r\n    }\r\n    const knownColors = new Map(\r\n        Object.entries({\r\n            aliceblue: 0xf0f8ff,\r\n            antiquewhite: 0xfaebd7,\r\n            aqua: 0x00ffff,\r\n            aquamarine: 0x7fffd4,\r\n            azure: 0xf0ffff,\r\n            beige: 0xf5f5dc,\r\n            bisque: 0xffe4c4,\r\n            black: 0x000000,\r\n            blanchedalmond: 0xffebcd,\r\n            blue: 0x0000ff,\r\n            blueviolet: 0x8a2be2,\r\n            brown: 0xa52a2a,\r\n            burlywood: 0xdeb887,\r\n            cadetblue: 0x5f9ea0,\r\n            chartreuse: 0x7fff00,\r\n            chocolate: 0xd2691e,\r\n            coral: 0xff7f50,\r\n            cornflowerblue: 0x6495ed,\r\n            cornsilk: 0xfff8dc,\r\n            crimson: 0xdc143c,\r\n            cyan: 0x00ffff,\r\n            darkblue: 0x00008b,\r\n            darkcyan: 0x008b8b,\r\n            darkgoldenrod: 0xb8860b,\r\n            darkgray: 0xa9a9a9,\r\n            darkgrey: 0xa9a9a9,\r\n            darkgreen: 0x006400,\r\n            darkkhaki: 0xbdb76b,\r\n            darkmagenta: 0x8b008b,\r\n            darkolivegreen: 0x556b2f,\r\n            darkorange: 0xff8c00,\r\n            darkorchid: 0x9932cc,\r\n            darkred: 0x8b0000,\r\n            darksalmon: 0xe9967a,\r\n            darkseagreen: 0x8fbc8f,\r\n            darkslateblue: 0x483d8b,\r\n            darkslategray: 0x2f4f4f,\r\n            darkslategrey: 0x2f4f4f,\r\n            darkturquoise: 0x00ced1,\r\n            darkviolet: 0x9400d3,\r\n            deeppink: 0xff1493,\r\n            deepskyblue: 0x00bfff,\r\n            dimgray: 0x696969,\r\n            dimgrey: 0x696969,\r\n            dodgerblue: 0x1e90ff,\r\n            firebrick: 0xb22222,\r\n            floralwhite: 0xfffaf0,\r\n            forestgreen: 0x228b22,\r\n            fuchsia: 0xff00ff,\r\n            gainsboro: 0xdcdcdc,\r\n            ghostwhite: 0xf8f8ff,\r\n            gold: 0xffd700,\r\n            goldenrod: 0xdaa520,\r\n            gray: 0x808080,\r\n            grey: 0x808080,\r\n            green: 0x008000,\r\n            greenyellow: 0xadff2f,\r\n            honeydew: 0xf0fff0,\r\n            hotpink: 0xff69b4,\r\n            indianred: 0xcd5c5c,\r\n            indigo: 0x4b0082,\r\n            ivory: 0xfffff0,\r\n            khaki: 0xf0e68c,\r\n            lavender: 0xe6e6fa,\r\n            lavenderblush: 0xfff0f5,\r\n            lawngreen: 0x7cfc00,\r\n            lemonchiffon: 0xfffacd,\r\n            lightblue: 0xadd8e6,\r\n            lightcoral: 0xf08080,\r\n            lightcyan: 0xe0ffff,\r\n            lightgoldenrodyellow: 0xfafad2,\r\n            lightgray: 0xd3d3d3,\r\n            lightgrey: 0xd3d3d3,\r\n            lightgreen: 0x90ee90,\r\n            lightpink: 0xffb6c1,\r\n            lightsalmon: 0xffa07a,\r\n            lightseagreen: 0x20b2aa,\r\n            lightskyblue: 0x87cefa,\r\n            lightslategray: 0x778899,\r\n            lightslategrey: 0x778899,\r\n            lightsteelblue: 0xb0c4de,\r\n            lightyellow: 0xffffe0,\r\n            lime: 0x00ff00,\r\n            limegreen: 0x32cd32,\r\n            linen: 0xfaf0e6,\r\n            magenta: 0xff00ff,\r\n            maroon: 0x800000,\r\n            mediumaquamarine: 0x66cdaa,\r\n            mediumblue: 0x0000cd,\r\n            mediumorchid: 0xba55d3,\r\n            mediumpurple: 0x9370db,\r\n            mediumseagreen: 0x3cb371,\r\n            mediumslateblue: 0x7b68ee,\r\n            mediumspringgreen: 0x00fa9a,\r\n            mediumturquoise: 0x48d1cc,\r\n            mediumvioletred: 0xc71585,\r\n            midnightblue: 0x191970,\r\n            mintcream: 0xf5fffa,\r\n            mistyrose: 0xffe4e1,\r\n            moccasin: 0xffe4b5,\r\n            navajowhite: 0xffdead,\r\n            navy: 0x000080,\r\n            oldlace: 0xfdf5e6,\r\n            olive: 0x808000,\r\n            olivedrab: 0x6b8e23,\r\n            orange: 0xffa500,\r\n            orangered: 0xff4500,\r\n            orchid: 0xda70d6,\r\n            palegoldenrod: 0xeee8aa,\r\n            palegreen: 0x98fb98,\r\n            paleturquoise: 0xafeeee,\r\n            palevioletred: 0xdb7093,\r\n            papayawhip: 0xffefd5,\r\n            peachpuff: 0xffdab9,\r\n            peru: 0xcd853f,\r\n            pink: 0xffc0cb,\r\n            plum: 0xdda0dd,\r\n            powderblue: 0xb0e0e6,\r\n            purple: 0x800080,\r\n            rebeccapurple: 0x663399,\r\n            red: 0xff0000,\r\n            rosybrown: 0xbc8f8f,\r\n            royalblue: 0x4169e1,\r\n            saddlebrown: 0x8b4513,\r\n            salmon: 0xfa8072,\r\n            sandybrown: 0xf4a460,\r\n            seagreen: 0x2e8b57,\r\n            seashell: 0xfff5ee,\r\n            sienna: 0xa0522d,\r\n            silver: 0xc0c0c0,\r\n            skyblue: 0x87ceeb,\r\n            slateblue: 0x6a5acd,\r\n            slategray: 0x708090,\r\n            slategrey: 0x708090,\r\n            snow: 0xfffafa,\r\n            springgreen: 0x00ff7f,\r\n            steelblue: 0x4682b4,\r\n            tan: 0xd2b48c,\r\n            teal: 0x008080,\r\n            thistle: 0xd8bfd8,\r\n            tomato: 0xff6347,\r\n            turquoise: 0x40e0d0,\r\n            violet: 0xee82ee,\r\n            wheat: 0xf5deb3,\r\n            white: 0xffffff,\r\n            whitesmoke: 0xf5f5f5,\r\n            yellow: 0xffff00,\r\n            yellowgreen: 0x9acd32\r\n        })\r\n    );\r\n    const systemColors = new Map(\r\n        Object.entries({\r\n            "ActiveBorder": 0x3b99fc,\r\n            "ActiveCaption": 0x000000,\r\n            "AppWorkspace": 0xaaaaaa,\r\n            "Background": 0x6363ce,\r\n            "ButtonFace": 0xffffff,\r\n            "ButtonHighlight": 0xe9e9e9,\r\n            "ButtonShadow": 0x9fa09f,\r\n            "ButtonText": 0x000000,\r\n            "CaptionText": 0x000000,\r\n            "GrayText": 0x7f7f7f,\r\n            "Highlight": 0xb2d7ff,\r\n            "HighlightText": 0x000000,\r\n            "InactiveBorder": 0xffffff,\r\n            "InactiveCaption": 0xffffff,\r\n            "InactiveCaptionText": 0x000000,\r\n            "InfoBackground": 0xfbfcc5,\r\n            "InfoText": 0x000000,\r\n            "Menu": 0xf6f6f6,\r\n            "MenuText": 0xffffff,\r\n            "Scrollbar": 0xaaaaaa,\r\n            "ThreeDDarkShadow": 0x000000,\r\n            "ThreeDFace": 0xc0c0c0,\r\n            "ThreeDHighlight": 0xffffff,\r\n            "ThreeDLightShadow": 0xffffff,\r\n            "ThreeDShadow": 0x000000,\r\n            "Window": 0xececec,\r\n            "WindowFrame": 0xaaaaaa,\r\n            "WindowText": 0x000000,\r\n            "-webkit-focus-ring-color": 0xe59700\r\n        }).map(([key, value]) => [key.toLowerCase(), value])\r\n    );\r\n    function getSRGBLightness(r, g, b) {\r\n        return (0.2126 * r + 0.7152 * g + 0.0722 * b) / 255;\r\n    }\r\n    let canvas$1;\r\n    let context$1;\r\n    function domParseColor($color) {\r\n        if (!context$1) {\r\n            canvas$1 = document.createElement("canvas");\r\n            canvas$1.width = 1;\r\n            canvas$1.height = 1;\r\n            context$1 = canvas$1.getContext("2d", {willReadFrequently: true});\r\n        }\r\n        context$1.fillStyle = $color;\r\n        context$1.fillRect(0, 0, 1, 1);\r\n        const d = context$1.getImageData(0, 0, 1, 1).data;\r\n        const color = \`rgba(\${d[0]}, \${d[1]}, \${d[2]}, \${(d[3] / 255).toFixed(2)})\`;\r\n        return parseRGB(color);\r\n    }\r\n\r\n    function scale(x, inLow, inHigh, outLow, outHigh) {\r\n        return ((x - inLow) * (outHigh - outLow)) / (inHigh - inLow) + outLow;\r\n    }\r\n    function clamp(x, min, max) {\r\n        return Math.min(max, Math.max(min, x));\r\n    }\r\n    function multiplyMatrices(m1, m2) {\r\n        const result = [];\r\n        for (let i = 0, len = m1.length; i < len; i++) {\r\n            result[i] = [];\r\n            for (let j = 0, len2 = m2[0].length; j < len2; j++) {\r\n                let sum = 0;\r\n                for (let k = 0, len3 = m1[0].length; k < len3; k++) {\r\n                    sum += m1[i][k] * m2[k][j];\r\n                }\r\n                result[i][j] = sum;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function createFilterMatrix(config) {\r\n        let m = Matrix.identity();\r\n        if (config.sepia !== 0) {\r\n            m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\r\n        }\r\n        if (config.brightness !== 100) {\r\n            m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\r\n        }\r\n        if (config.mode === 1) {\r\n            m = multiplyMatrices(m, Matrix.invertNHue());\r\n        }\r\n        return m;\r\n    }\r\n    function applyColorMatrix([r, g, b], matrix) {\r\n        const rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\r\n        const result = multiplyMatrices(matrix, rgb);\r\n        return [0, 1, 2].map((i) =>\r\n            clamp(Math.round(result[i][0] * 255), 0, 255)\r\n        );\r\n    }\r\n    const Matrix = {\r\n        identity() {\r\n            return [\r\n                [1, 0, 0, 0, 0],\r\n                [0, 1, 0, 0, 0],\r\n                [0, 0, 1, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        invertNHue() {\r\n            return [\r\n                [0.333, -0.667, -0.667, 0, 1],\r\n                [-0.667, 0.333, -0.667, 0, 1],\r\n                [-0.667, -0.667, 0.333, 0, 1],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        brightness(v) {\r\n            return [\r\n                [v, 0, 0, 0, 0],\r\n                [0, v, 0, 0, 0],\r\n                [0, 0, v, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        contrast(v) {\r\n            const t = (1 - v) / 2;\r\n            return [\r\n                [v, 0, 0, 0, t],\r\n                [0, v, 0, 0, t],\r\n                [0, 0, v, 0, t],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        sepia(v) {\r\n            return [\r\n                [\r\n                    0.393 + 0.607 * (1 - v),\r\n                    0.769 - 0.769 * (1 - v),\r\n                    0.189 - 0.189 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.349 - 0.349 * (1 - v),\r\n                    0.686 + 0.314 * (1 - v),\r\n                    0.168 - 0.168 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.272 - 0.272 * (1 - v),\r\n                    0.534 - 0.534 * (1 - v),\r\n                    0.131 + 0.869 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        grayscale(v) {\r\n            return [\r\n                [\r\n                    0.2126 + 0.7874 * (1 - v),\r\n                    0.7152 - 0.7152 * (1 - v),\r\n                    0.0722 - 0.0722 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.2126 - 0.2126 * (1 - v),\r\n                    0.7152 + 0.2848 * (1 - v),\r\n                    0.0722 - 0.0722 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [\r\n                    0.2126 - 0.2126 * (1 - v),\r\n                    0.7152 - 0.7152 * (1 - v),\r\n                    0.0722 + 0.9278 * (1 - v),\r\n                    0,\r\n                    0\r\n                ],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        }\r\n    };\r\n\r\n    function getBgPole(theme) {\r\n        const isDarkScheme = theme.mode === 1;\r\n        const prop = isDarkScheme\r\n            ? "darkSchemeBackgroundColor"\r\n            : "lightSchemeBackgroundColor";\r\n        return theme[prop];\r\n    }\r\n    function getFgPole(theme) {\r\n        const isDarkScheme = theme.mode === 1;\r\n        const prop = isDarkScheme\r\n            ? "darkSchemeTextColor"\r\n            : "lightSchemeTextColor";\r\n        return theme[prop];\r\n    }\r\n    const colorModificationCache = new Map();\r\n    function clearColorModificationCache() {\r\n        colorModificationCache.clear();\r\n    }\r\n    const rgbCacheKeys = ["r", "g", "b", "a"];\r\n    const themeCacheKeys$1 = [\r\n        "mode",\r\n        "brightness",\r\n        "contrast",\r\n        "grayscale",\r\n        "sepia",\r\n        "darkSchemeBackgroundColor",\r\n        "darkSchemeTextColor",\r\n        "lightSchemeBackgroundColor",\r\n        "lightSchemeTextColor"\r\n    ];\r\n    function getCacheId(rgb, theme) {\r\n        let resultId = "";\r\n        rgbCacheKeys.forEach((key) => {\r\n            resultId += \`\${rgb[key]};\`;\r\n        });\r\n        themeCacheKeys$1.forEach((key) => {\r\n            resultId += \`\${theme[key]};\`;\r\n        });\r\n        return resultId;\r\n    }\r\n    function modifyColorWithCache(\r\n        rgb,\r\n        theme,\r\n        modifyHSL,\r\n        poleColor,\r\n        anotherPoleColor\r\n    ) {\r\n        let fnCache;\r\n        if (colorModificationCache.has(modifyHSL)) {\r\n            fnCache = colorModificationCache.get(modifyHSL);\r\n        } else {\r\n            fnCache = new Map();\r\n            colorModificationCache.set(modifyHSL, fnCache);\r\n        }\r\n        const id = getCacheId(rgb, theme);\r\n        if (fnCache.has(id)) {\r\n            return fnCache.get(id);\r\n        }\r\n        const hsl = rgbToHSL(rgb);\r\n        const pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\r\n        const anotherPole =\r\n            anotherPoleColor == null\r\n                ? null\r\n                : parseToHSLWithCache(anotherPoleColor);\r\n        const modified = modifyHSL(hsl, pole, anotherPole);\r\n        const {r, g, b, a} = hslToRGB(modified);\r\n        const matrix = createFilterMatrix(theme);\r\n        const [rf, gf, bf] = applyColorMatrix([r, g, b], matrix);\r\n        const color =\r\n            a === 1\r\n                ? rgbToHexString({r: rf, g: gf, b: bf})\r\n                : rgbToString({r: rf, g: gf, b: bf, a});\r\n        fnCache.set(id, color);\r\n        return color;\r\n    }\r\n    function noopHSL(hsl) {\r\n        return hsl;\r\n    }\r\n    function modifyColor(rgb, theme) {\r\n        return modifyColorWithCache(rgb, theme, noopHSL);\r\n    }\r\n    function modifyLightSchemeColor(rgb, theme) {\r\n        const poleBg = getBgPole(theme);\r\n        const poleFg = getFgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            theme,\r\n            modifyLightModeHSL,\r\n            poleFg,\r\n            poleBg\r\n        );\r\n    }\r\n    function modifyLightModeHSL({h, s, l, a}, poleFg, poleBg) {\r\n        const isDark = l < 0.5;\r\n        let isNeutral;\r\n        if (isDark) {\r\n            isNeutral = l < 0.2 || s < 0.12;\r\n        } else {\r\n            const isBlue = h > 200 && h < 280;\r\n            isNeutral = s < 0.24 || (l > 0.8 && isBlue);\r\n        }\r\n        let hx = h;\r\n        let sx = l;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            } else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        const lx = scale(l, 0, 1, poleFg.l, poleBg.l);\r\n        return {h: hx, s: sx, l: lx, a};\r\n    }\r\n    const MAX_BG_LIGHTNESS = 0.4;\r\n    function modifyBgHSL({h, s, l, a}, pole) {\r\n        const isDark = l < 0.5;\r\n        const isBlue = h > 200 && h < 280;\r\n        const isNeutral = s < 0.12 || (l > 0.8 && isBlue);\r\n        if (isDark) {\r\n            const lx = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\r\n            if (isNeutral) {\r\n                const hx = pole.h;\r\n                const sx = pole.s;\r\n                return {h: hx, s: sx, l: lx, a};\r\n            }\r\n            return {h, s, l: lx, a};\r\n        }\r\n        let lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\r\n        if (isNeutral) {\r\n            const hx = pole.h;\r\n            const sx = pole.s;\r\n            return {h: hx, s: sx, l: lx, a};\r\n        }\r\n        let hx = h;\r\n        const isYellow = h > 60 && h < 180;\r\n        if (isYellow) {\r\n            const isCloserToGreen = h > 120;\r\n            if (isCloserToGreen) {\r\n                hx = scale(h, 120, 180, 135, 180);\r\n            } else {\r\n                hx = scale(h, 60, 120, 60, 105);\r\n            }\r\n        }\r\n        if (hx > 40 && hx < 80) {\r\n            lx *= 0.75;\r\n        }\r\n        return {h: hx, s, l: lx, a};\r\n    }\r\n    function modifyBackgroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        const pole = getBgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            {...theme, mode: 0},\r\n            modifyBgHSL,\r\n            pole\r\n        );\r\n    }\r\n    const MIN_FG_LIGHTNESS = 0.55;\r\n    function modifyBlueFgHue(hue) {\r\n        return scale(hue, 205, 245, 205, 220);\r\n    }\r\n    function modifyFgHSL({h, s, l, a}, pole) {\r\n        const isLight = l > 0.5;\r\n        const isNeutral = l < 0.2 || s < 0.24;\r\n        const isBlue = !isNeutral && h > 205 && h < 245;\r\n        if (isLight) {\r\n            const lx = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\r\n            if (isNeutral) {\r\n                const hx = pole.h;\r\n                const sx = pole.s;\r\n                return {h: hx, s: sx, l: lx, a};\r\n            }\r\n            let hx = h;\r\n            if (isBlue) {\r\n                hx = modifyBlueFgHue(h);\r\n            }\r\n            return {h: hx, s, l: lx, a};\r\n        }\r\n        if (isNeutral) {\r\n            const hx = pole.h;\r\n            const sx = pole.s;\r\n            const lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n            return {h: hx, s: sx, l: lx, a};\r\n        }\r\n        let hx = h;\r\n        let lx;\r\n        if (isBlue) {\r\n            hx = modifyBlueFgHue(h);\r\n            lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\r\n        } else {\r\n            lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n        }\r\n        return {h: hx, s, l: lx, a};\r\n    }\r\n    function modifyForegroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        const pole = getFgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            {...theme, mode: 0},\r\n            modifyFgHSL,\r\n            pole\r\n        );\r\n    }\r\n    function modifyBorderHSL({h, s, l, a}, poleFg, poleBg) {\r\n        const isDark = l < 0.5;\r\n        const isNeutral = l < 0.2 || s < 0.24;\r\n        let hx = h;\r\n        let sx = s;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            } else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        const lx = scale(l, 0, 1, 0.5, 0.2);\r\n        return {h: hx, s: sx, l: lx, a};\r\n    }\r\n    function modifyBorderColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        const poleFg = getFgPole(theme);\r\n        const poleBg = getBgPole(theme);\r\n        return modifyColorWithCache(\r\n            rgb,\r\n            {...theme, mode: 0},\r\n            modifyBorderHSL,\r\n            poleFg,\r\n            poleBg\r\n        );\r\n    }\r\n    function modifyShadowColor(rgb, theme) {\r\n        return modifyBackgroundColor(rgb, theme);\r\n    }\r\n    function modifyGradientColor(rgb, theme) {\r\n        return modifyBackgroundColor(rgb, theme);\r\n    }\r\n\r\n    function createTextStyle(config) {\r\n        const lines = [];\r\n        lines.push(\r\n            '*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*="vjs-"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*="mu-"], .glyphicon, .icon) {'\r\n        );\r\n        if (config.useFont && config.fontFamily) {\r\n            lines.push(\`  font-family: \${config.fontFamily} !important;\`);\r\n        }\r\n        if (config.textStroke > 0) {\r\n            lines.push(\r\n                \`  -webkit-text-stroke: \${config.textStroke}px !important;\`\r\n            );\r\n            lines.push(\`  text-stroke: \${config.textStroke}px !important;\`);\r\n        }\r\n        lines.push("}");\r\n        return lines.join("\\n");\r\n    }\r\n\r\n    var FilterMode;\r\n    (function (FilterMode) {\r\n        FilterMode[(FilterMode["light"] = 0)] = "light";\r\n        FilterMode[(FilterMode["dark"] = 1)] = "dark";\r\n    })(FilterMode || (FilterMode = {}));\r\n    function getCSSFilterValue(config) {\r\n        const filters = [];\r\n        if (config.mode === FilterMode.dark) {\r\n            filters.push("invert(100%) hue-rotate(180deg)");\r\n        }\r\n        if (config.brightness !== 100) {\r\n            filters.push(\`brightness(\${config.brightness}%)\`);\r\n        }\r\n        if (config.contrast !== 100) {\r\n            filters.push(\`contrast(\${config.contrast}%)\`);\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            filters.push(\`grayscale(\${config.grayscale}%)\`);\r\n        }\r\n        if (config.sepia !== 0) {\r\n            filters.push(\`sepia(\${config.sepia}%)\`);\r\n        }\r\n        if (filters.length === 0) {\r\n            return null;\r\n        }\r\n        return filters.join(" ");\r\n    }\r\n\r\n    function toSVGMatrix(matrix) {\r\n        return matrix\r\n            .slice(0, 4)\r\n            .map((m) => m.map((m) => m.toFixed(3)).join(" "))\r\n            .join(" ");\r\n    }\r\n    function getSVGFilterMatrixValue(config) {\r\n        return toSVGMatrix(createFilterMatrix(config));\r\n    }\r\n\r\n    function hexify(number) {\r\n        return (number < 16 ? "0" : "") + number.toString(16);\r\n    }\r\n    function generateUID() {\r\n        if ("randomUUID" in crypto) {\r\n            const uuid = crypto.randomUUID();\r\n            return (\r\n                uuid.substring(0, 8) +\r\n                uuid.substring(9, 13) +\r\n                uuid.substring(14, 18) +\r\n                uuid.substring(19, 23) +\r\n                uuid.substring(24)\r\n            );\r\n        }\r\n        if ("getRandomValues" in crypto) {\r\n            return Array.from(crypto.getRandomValues(new Uint8Array(16)))\r\n                .map((x) => hexify(x))\r\n                .join("");\r\n        }\r\n        return Math.floor(Math.random() * 2 ** 55).toString(36);\r\n    }\r\n\r\n    const resolvers$1 = new Map();\r\n    const rejectors = new Map();\r\n    async function bgFetch(request) {\r\n        return new Promise((resolve, reject) => {\r\n            const id = generateUID();\r\n            resolvers$1.set(id, resolve);\r\n            rejectors.set(id, reject);\r\n            chrome.runtime.sendMessage({\r\n                type: MessageTypeCStoBG.FETCH,\r\n                data: request,\r\n                id\r\n            });\r\n        });\r\n    }\r\n    chrome.runtime.onMessage.addListener(({type, data, error, id}) => {\r\n        if (type === MessageTypeBGtoCS.FETCH_RESPONSE) {\r\n            const resolve = resolvers$1.get(id);\r\n            const reject = rejectors.get(id);\r\n            resolvers$1.delete(id);\r\n            rejectors.delete(id);\r\n            if (error) {\r\n                reject && reject(error);\r\n            } else {\r\n                resolve && resolve(data);\r\n            }\r\n        }\r\n    });\r\n\r\n    const MAX_FRAME_DURATION = 1000 / 60;\r\n    class AsyncQueue {\r\n        constructor() {\r\n            this.queue = [];\r\n            this.timerId = null;\r\n        }\r\n        addTask(task) {\r\n            this.queue.push(task);\r\n            this.scheduleFrame();\r\n        }\r\n        stop() {\r\n            if (this.timerId !== null) {\r\n                cancelAnimationFrame(this.timerId);\r\n                this.timerId = null;\r\n            }\r\n            this.queue = [];\r\n        }\r\n        scheduleFrame() {\r\n            if (this.timerId) {\r\n                return;\r\n            }\r\n            this.timerId = requestAnimationFrame(() => {\r\n                this.timerId = null;\r\n                const start = Date.now();\r\n                let cb;\r\n                while ((cb = this.queue.shift())) {\r\n                    cb();\r\n                    if (Date.now() - start >= MAX_FRAME_DURATION) {\r\n                        this.scheduleFrame();\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const imageManager = new AsyncQueue();\r\n    async function getImageDetails(url) {\r\n        return new Promise(async (resolve, reject) => {\r\n            try {\r\n                const dataURL = url.startsWith("data:")\r\n                    ? url\r\n                    : await getDataURL(url);\r\n                const blob =\r\n                    tryConvertDataURLToBlobSync(dataURL) ??\r\n                    (await loadAsBlob(url));\r\n                let image;\r\n                if (dataURL.startsWith("data:image/svg+xml")) {\r\n                    image = await loadImage(dataURL);\r\n                } else {\r\n                    image =\r\n                        (await tryCreateImageBitmap(blob)) ??\r\n                        (await loadImage(dataURL));\r\n                }\r\n                imageManager.addTask(() => {\r\n                    const analysis = analyzeImage(image);\r\n                    resolve({\r\n                        src: url,\r\n                        dataURL: analysis.isLarge ? "" : dataURL,\r\n                        width: image.width,\r\n                        height: image.height,\r\n                        ...analysis\r\n                    });\r\n                });\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n    async function getDataURL(url) {\r\n        const parsedURL = new URL(url);\r\n        if (parsedURL.origin === location.origin) {\r\n            return await loadAsDataURL(url);\r\n        }\r\n        return await bgFetch({url, responseType: "data-url"});\r\n    }\r\n    async function tryCreateImageBitmap(blob) {\r\n        try {\r\n            return await createImageBitmap(blob);\r\n        } catch (err) {\r\n            logWarn(\r\n                \`Unable to create image bitmap for type \${blob.type}: \${String(err)}\`\r\n            );\r\n            return null;\r\n        }\r\n    }\r\n    const INCOMPLETE_DOC_LOADING_IMAGE_LIMIT = 256;\r\n    let loadingImagesCount = 0;\r\n    async function loadImage(url) {\r\n        return new Promise((resolve, reject) => {\r\n            const image = new Image();\r\n            image.onload = () => resolve(image);\r\n            image.onerror = () => reject(\`Unable to load image \${url}\`);\r\n            if (\r\n                ++loadingImagesCount <= INCOMPLETE_DOC_LOADING_IMAGE_LIMIT ||\r\n                isReadyStateComplete()\r\n            ) {\r\n                image.src = url;\r\n            } else {\r\n                addReadyStateCompleteListener(() => (image.src = url));\r\n            }\r\n        });\r\n    }\r\n    const MAX_ANALYSIS_PIXELS_COUNT = 32 * 32;\r\n    let canvas;\r\n    let context;\r\n    function createCanvas() {\r\n        const maxWidth = MAX_ANALYSIS_PIXELS_COUNT;\r\n        const maxHeight = MAX_ANALYSIS_PIXELS_COUNT;\r\n        canvas = document.createElement("canvas");\r\n        canvas.width = maxWidth;\r\n        canvas.height = maxHeight;\r\n        context = canvas.getContext("2d", {willReadFrequently: true});\r\n        context.imageSmoothingEnabled = false;\r\n    }\r\n    function removeCanvas() {\r\n        canvas = null;\r\n        context = null;\r\n    }\r\n    const LARGE_IMAGE_PIXELS_COUNT = 512 * 512;\r\n    function analyzeImage(image) {\r\n        if (!canvas) {\r\n            createCanvas();\r\n        }\r\n        let sw;\r\n        let sh;\r\n        if (image instanceof HTMLImageElement) {\r\n            sw = image.naturalWidth;\r\n            sh = image.naturalHeight;\r\n        } else {\r\n            sw = image.width;\r\n            sh = image.height;\r\n        }\r\n        if (sw === 0 || sh === 0) {\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: false,\r\n                isTooLarge: false\r\n            };\r\n        }\r\n        if (sw * sh > LARGE_IMAGE_PIXELS_COUNT) {\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: true\r\n            };\r\n        }\r\n        const sourcePixelsCount = sw * sh;\r\n        const k = Math.min(\r\n            1,\r\n            Math.sqrt(MAX_ANALYSIS_PIXELS_COUNT / sourcePixelsCount)\r\n        );\r\n        const width = Math.ceil(sw * k);\r\n        const height = Math.ceil(sh * k);\r\n        context.clearRect(0, 0, width, height);\r\n        context.drawImage(image, 0, 0, sw, sh, 0, 0, width, height);\r\n        const imageData = context.getImageData(0, 0, width, height);\r\n        const d = imageData.data;\r\n        const TRANSPARENT_ALPHA_THRESHOLD = 0.05;\r\n        const DARK_LIGHTNESS_THRESHOLD = 0.4;\r\n        const LIGHT_LIGHTNESS_THRESHOLD = 0.7;\r\n        let transparentPixelsCount = 0;\r\n        let darkPixelsCount = 0;\r\n        let lightPixelsCount = 0;\r\n        let i, x, y;\r\n        let r, g, b, a;\r\n        let l;\r\n        for (y = 0; y < height; y++) {\r\n            for (x = 0; x < width; x++) {\r\n                i = 4 * (y * width + x);\r\n                r = d[i + 0];\r\n                g = d[i + 1];\r\n                b = d[i + 2];\r\n                a = d[i + 3];\r\n                if (a / 255 < TRANSPARENT_ALPHA_THRESHOLD) {\r\n                    transparentPixelsCount++;\r\n                } else {\r\n                    l = getSRGBLightness(r, g, b);\r\n                    if (l < DARK_LIGHTNESS_THRESHOLD) {\r\n                        darkPixelsCount++;\r\n                    }\r\n                    if (l > LIGHT_LIGHTNESS_THRESHOLD) {\r\n                        lightPixelsCount++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        const totalPixelsCount = width * height;\r\n        const opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\r\n        const DARK_IMAGE_THRESHOLD = 0.7;\r\n        const LIGHT_IMAGE_THRESHOLD = 0.7;\r\n        const TRANSPARENT_IMAGE_THRESHOLD = 0.1;\r\n        return {\r\n            isDark: darkPixelsCount / opaquePixelsCount >= DARK_IMAGE_THRESHOLD,\r\n            isLight:\r\n                lightPixelsCount / opaquePixelsCount >= LIGHT_IMAGE_THRESHOLD,\r\n            isTransparent:\r\n                transparentPixelsCount / totalPixelsCount >=\r\n                TRANSPARENT_IMAGE_THRESHOLD,\r\n            isLarge: false\r\n        };\r\n    }\r\n    let isBlobURLSupported = null;\r\n    let canUseProxy = false;\r\n    let blobURLCheckRequested = false;\r\n    const blobURLCheckAwaiters = [];\r\n    document.addEventListener(\r\n        "__darkreader__inlineScriptsAllowed",\r\n        () => (canUseProxy = true),\r\n        {once: true}\r\n    );\r\n    async function requestBlobURLCheck() {\r\n        if (!canUseProxy) {\r\n            return;\r\n        }\r\n        if (blobURLCheckRequested) {\r\n            return await new Promise((resolve) =>\r\n                blobURLCheckAwaiters.push(resolve)\r\n            );\r\n        }\r\n        blobURLCheckRequested = true;\r\n        await new Promise((resolve) => {\r\n            document.addEventListener(\r\n                "__darkreader__blobURLCheckResponse",\r\n                (e) => {\r\n                    isBlobURLSupported = e.detail.blobURLAllowed;\r\n                    resolve();\r\n                    blobURLCheckAwaiters.forEach((r) => r());\r\n                    blobURLCheckAwaiters.splice(0);\r\n                },\r\n                {once: true}\r\n            );\r\n            document.dispatchEvent(\r\n                new CustomEvent("__darkreader__blobURLCheckRequest")\r\n            );\r\n        });\r\n    }\r\n    function isBlobURLCheckResultReady() {\r\n        return isBlobURLSupported != null || !canUseProxy;\r\n    }\r\n    function onCSPError(err) {\r\n        if (err.blockedURI === "blob") {\r\n            isBlobURLSupported = false;\r\n            document.removeEventListener("securitypolicyviolation", onCSPError);\r\n        }\r\n    }\r\n    document.addEventListener("securitypolicyviolation", onCSPError);\r\n    const objectURLs = new Set();\r\n    function getFilteredImageURL({dataURL, width, height}, theme) {\r\n        if (dataURL.startsWith("data:image/svg+xml")) {\r\n            dataURL = escapeXML(dataURL);\r\n        }\r\n        const matrix = getSVGFilterMatrixValue(theme);\r\n        const svg = [\r\n            \`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="\${width}" height="\${height}">\`,\r\n            "<defs>",\r\n            '<filter id="darkreader-image-filter">',\r\n            \`<feColorMatrix type="matrix" values="\${matrix}" />\`,\r\n            "</filter>",\r\n            "</defs>",\r\n            \`<image width="\${width}" height="\${height}" filter="url(#darkreader-image-filter)" xlink:href="\${dataURL}" />\`,\r\n            "</svg>"\r\n        ].join("");\r\n        if (!isBlobURLSupported) {\r\n            return \`data:image/svg+xml;base64,\${btoa(svg)}\`;\r\n        }\r\n        const bytes = new Uint8Array(svg.length);\r\n        for (let i = 0; i < svg.length; i++) {\r\n            bytes[i] = svg.charCodeAt(i);\r\n        }\r\n        const blob = new Blob([bytes], {type: "image/svg+xml"});\r\n        const objectURL = URL.createObjectURL(blob);\r\n        objectURLs.add(objectURL);\r\n        return objectURL;\r\n    }\r\n    const xmlEscapeChars = {\r\n        "<": "&lt;",\r\n        ">": "&gt;",\r\n        "&": "&amp;",\r\n        "'": "&apos;",\r\n        '"': "&quot;"\r\n    };\r\n    function escapeXML(str) {\r\n        return str.replace(/[<>&'"]/g, (c) => xmlEscapeChars[c] ?? c);\r\n    }\r\n    const dataURLBlobURLs = new Map();\r\n    function tryConvertDataURLToBlobSync(dataURL) {\r\n        const colonIndex = dataURL.indexOf(":");\r\n        const semicolonIndex = dataURL.indexOf(";", colonIndex + 1);\r\n        const commaIndex = dataURL.indexOf(",", semicolonIndex + 1);\r\n        const encoding = dataURL\r\n            .substring(semicolonIndex + 1, commaIndex)\r\n            .toLocaleLowerCase();\r\n        const mediaType = dataURL.substring(colonIndex + 1, semicolonIndex);\r\n        if (encoding !== "base64" || !mediaType) {\r\n            return null;\r\n        }\r\n        const characters = atob(dataURL.substring(commaIndex + 1));\r\n        const bytes = new Uint8Array(characters.length);\r\n        for (let i = 0; i < characters.length; i++) {\r\n            bytes[i] = characters.charCodeAt(i);\r\n        }\r\n        return new Blob([bytes], {type: mediaType});\r\n    }\r\n    async function tryConvertDataURLToBlobURL(dataURL) {\r\n        if (!isBlobURLSupported) {\r\n            return null;\r\n        }\r\n        const hash = getHashCode(dataURL);\r\n        let blobURL = dataURLBlobURLs.get(hash);\r\n        if (blobURL) {\r\n            return blobURL;\r\n        }\r\n        let blob = tryConvertDataURLToBlobSync(dataURL);\r\n        if (!blob) {\r\n            const response = await fetch(dataURL);\r\n            blob = await response.blob();\r\n        }\r\n        blobURL = URL.createObjectURL(blob);\r\n        dataURLBlobURLs.set(hash, blobURL);\r\n        return blobURL;\r\n    }\r\n    function cleanImageProcessingCache() {\r\n        imageManager && imageManager.stop();\r\n        removeCanvas();\r\n        objectURLs.forEach((u) => URL.revokeObjectURL(u));\r\n        objectURLs.clear();\r\n        dataURLBlobURLs.forEach((u) => URL.revokeObjectURL(u));\r\n        dataURLBlobURLs.clear();\r\n    }\r\n\r\n    const gradientLength = "gradient".length;\r\n    const conicGradient = "conic-";\r\n    const conicGradientLength = conicGradient.length;\r\n    const radialGradient = "radial-";\r\n    const linearGradient = "linear-";\r\n    function parseGradient(value) {\r\n        const result = [];\r\n        let index = 0;\r\n        let startIndex = conicGradient.length;\r\n        while ((index = value.indexOf("gradient", startIndex)) !== -1) {\r\n            let typeGradient;\r\n            [linearGradient, radialGradient, conicGradient].find(\r\n                (possibleType) => {\r\n                    if (index - possibleType.length >= 0) {\r\n                        const possibleGradient = value.substring(\r\n                            index - possibleType.length,\r\n                            index\r\n                        );\r\n                        if (possibleGradient === possibleType) {\r\n                            if (\r\n                                value.slice(\r\n                                    index - possibleType.length - 10,\r\n                                    index - possibleType.length - 1\r\n                                ) === "repeating"\r\n                            ) {\r\n                                typeGradient = \`repeating-\${possibleType}gradient\`;\r\n                                return true;\r\n                            }\r\n                            if (\r\n                                value.slice(\r\n                                    index - possibleType.length - 8,\r\n                                    index - possibleType.length - 1\r\n                                ) === "-webkit"\r\n                            ) {\r\n                                typeGradient = \`-webkit-\${possibleType}gradient\`;\r\n                                return true;\r\n                            }\r\n                            typeGradient = \`\${possibleType}gradient\`;\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n            if (!typeGradient) {\r\n                break;\r\n            }\r\n            const {start, end} = getParenthesesRange(\r\n                value,\r\n                index + gradientLength\r\n            );\r\n            const match = value.substring(start + 1, end - 1);\r\n            startIndex = end + 1 + conicGradientLength;\r\n            result.push({\r\n                typeGradient,\r\n                match,\r\n                offset: typeGradient.length + 2,\r\n                index: index - typeGradient.length + gradientLength,\r\n                hasComma: true\r\n            });\r\n        }\r\n        if (result.length) {\r\n            result[result.length - 1].hasComma = false;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function getPriority(ruleStyle, property) {\r\n        return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\r\n    }\r\n    function getModifiableCSSDeclaration(\r\n        property,\r\n        value,\r\n        rule,\r\n        variablesStore,\r\n        ignoreImageSelectors,\r\n        isCancelled\r\n    ) {\r\n        let modifier = null;\r\n        if (property.startsWith("--")) {\r\n            modifier = getVariableModifier(\r\n                variablesStore,\r\n                property,\r\n                value,\r\n                rule,\r\n                ignoreImageSelectors,\r\n                isCancelled\r\n            );\r\n        } else if (value.includes("var(")) {\r\n            modifier = getVariableDependantModifier(\r\n                variablesStore,\r\n                property,\r\n                value\r\n            );\r\n        } else if (property === "color-scheme") {\r\n            modifier = getColorSchemeModifier();\r\n        } else if (property === "scrollbar-color") {\r\n            modifier = getScrollbarColorModifier(value);\r\n        } else if (\r\n            (property.includes("color") &&\r\n                property !== "-webkit-print-color-adjust") ||\r\n            property === "fill" ||\r\n            property === "stroke" ||\r\n            property === "stop-color"\r\n        ) {\r\n            if (\r\n                property.startsWith("border") &&\r\n                property !== "border-color" &&\r\n                value === "initial"\r\n            ) {\r\n                const borderSideProp = property.substring(\r\n                    0,\r\n                    property.length - 6\r\n                );\r\n                const borderSideVal =\r\n                    rule.style.getPropertyValue(borderSideProp);\r\n                if (\r\n                    borderSideVal.startsWith("0px") ||\r\n                    borderSideVal === "none"\r\n                ) {\r\n                    property = borderSideProp;\r\n                    modifier = borderSideVal;\r\n                } else {\r\n                    modifier = value;\r\n                }\r\n            } else {\r\n                modifier = getColorModifier(property, value, rule);\r\n            }\r\n        } else if (\r\n            property === "background-image" ||\r\n            property === "list-style-image"\r\n        ) {\r\n            modifier = getBgImageModifier(\r\n                value,\r\n                rule,\r\n                ignoreImageSelectors,\r\n                isCancelled\r\n            );\r\n        } else if (property.includes("shadow")) {\r\n            modifier = getShadowModifier(value);\r\n        }\r\n        if (!modifier) {\r\n            return null;\r\n        }\r\n        return {\r\n            property,\r\n            value: modifier,\r\n            important: getPriority(rule.style, property),\r\n            sourceValue: value\r\n        };\r\n    }\r\n    function joinSelectors(...selectors) {\r\n        return selectors.filter(Boolean).join(", ");\r\n    }\r\n    function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\r\n        const lines = [];\r\n        if (!isIFrame) {\r\n            lines.push("html {");\r\n            lines.push(\r\n                \`    background-color: \${modifyBackgroundColor({r: 255, g: 255, b: 255}, theme)} !important;\`\r\n            );\r\n            lines.push("}");\r\n        }\r\n        if (isCSSColorSchemePropSupported && theme.mode === 1) {\r\n            lines.push("html {");\r\n            lines.push(\`    color-scheme: dark !important;\`);\r\n            lines.push("}");\r\n            lines.push("iframe {");\r\n            lines.push(\`    color-scheme: initial;\`);\r\n            lines.push("}");\r\n        }\r\n        const bgSelectors = joinSelectors(\r\n            isIFrame ? "" : "html, body",\r\n            styleSystemControls ? "input, textarea, select, button, dialog" : ""\r\n        );\r\n        if (bgSelectors) {\r\n            lines.push(\`\${bgSelectors} {\`);\r\n            lines.push(\r\n                \`    background-color: \${modifyBackgroundColor({r: 255, g: 255, b: 255}, theme)};\`\r\n            );\r\n            lines.push("}");\r\n        }\r\n        lines.push(\r\n            \`\${joinSelectors("html, body", styleSystemControls ? "input, textarea, select, button" : "")} {\`\r\n        );\r\n        lines.push(\r\n            \`    border-color: \${modifyBorderColor({r: 76, g: 76, b: 76}, theme)};\`\r\n        );\r\n        lines.push(\r\n            \`    color: \${modifyForegroundColor({r: 0, g: 0, b: 0}, theme)};\`\r\n        );\r\n        lines.push("}");\r\n        lines.push("a {");\r\n        lines.push(\r\n            \`    color: \${modifyForegroundColor({r: 0, g: 64, b: 255}, theme)};\`\r\n        );\r\n        lines.push("}");\r\n        lines.push("table {");\r\n        lines.push(\r\n            \`    border-color: \${modifyBorderColor({r: 128, g: 128, b: 128}, theme)};\`\r\n        );\r\n        lines.push("}");\r\n        lines.push("::placeholder {");\r\n        lines.push(\r\n            \`    color: \${modifyForegroundColor({r: 169, g: 169, b: 169}, theme)};\`\r\n        );\r\n        lines.push("}");\r\n        lines.push("input:-webkit-autofill,");\r\n        lines.push("textarea:-webkit-autofill,");\r\n        lines.push("select:-webkit-autofill {");\r\n        lines.push(\r\n            \`    background-color: \${modifyBackgroundColor({r: 250, g: 255, b: 189}, theme)} !important;\`\r\n        );\r\n        lines.push(\r\n            \`    color: \${modifyForegroundColor({r: 0, g: 0, b: 0}, theme)} !important;\`\r\n        );\r\n        lines.push("}");\r\n        if (theme.scrollbarColor) {\r\n            lines.push(getModifiedScrollbarStyle(theme));\r\n        }\r\n        if (theme.selectionColor) {\r\n            lines.push(getModifiedSelectionStyle(theme));\r\n        }\r\n        return lines.join("\\n");\r\n    }\r\n    function getSelectionColor(theme) {\r\n        let backgroundColorSelection;\r\n        let foregroundColorSelection;\r\n        if (theme.selectionColor === "auto") {\r\n            backgroundColorSelection = modifyBackgroundColor(\r\n                {r: 0, g: 96, b: 212},\r\n                {...theme, grayscale: 0}\r\n            );\r\n            foregroundColorSelection = modifyForegroundColor(\r\n                {r: 255, g: 255, b: 255},\r\n                {...theme, grayscale: 0}\r\n            );\r\n        } else {\r\n            const rgb = parseColorWithCache(theme.selectionColor);\r\n            const hsl = rgbToHSL(rgb);\r\n            backgroundColorSelection = theme.selectionColor;\r\n            if (hsl.l < 0.5) {\r\n                foregroundColorSelection = "#FFF";\r\n            } else {\r\n                foregroundColorSelection = "#000";\r\n            }\r\n        }\r\n        return {backgroundColorSelection, foregroundColorSelection};\r\n    }\r\n    function getModifiedSelectionStyle(theme) {\r\n        const lines = [];\r\n        const modifiedSelectionColor = getSelectionColor(theme);\r\n        const backgroundColorSelection =\r\n            modifiedSelectionColor.backgroundColorSelection;\r\n        const foregroundColorSelection =\r\n            modifiedSelectionColor.foregroundColorSelection;\r\n        ["::selection", "::-moz-selection"].forEach((selection) => {\r\n            lines.push(\`\${selection} {\`);\r\n            lines.push(\r\n                \`    background-color: \${backgroundColorSelection} !important;\`\r\n            );\r\n            lines.push(\`    color: \${foregroundColorSelection} !important;\`);\r\n            lines.push("}");\r\n        });\r\n        return lines.join("\\n");\r\n    }\r\n    function getModifiedScrollbarStyle(theme) {\r\n        const lines = [];\r\n        let colorTrack;\r\n        let colorIcons;\r\n        let colorThumb;\r\n        let colorThumbHover;\r\n        let colorThumbActive;\r\n        let colorCorner;\r\n        if (theme.scrollbarColor === "auto") {\r\n            colorTrack = modifyBackgroundColor({r: 241, g: 241, b: 241}, theme);\r\n            colorIcons = modifyForegroundColor({r: 96, g: 96, b: 96}, theme);\r\n            colorThumb = modifyBackgroundColor({r: 176, g: 176, b: 176}, theme);\r\n            colorThumbHover = modifyBackgroundColor(\r\n                {r: 144, g: 144, b: 144},\r\n                theme\r\n            );\r\n            colorThumbActive = modifyBackgroundColor(\r\n                {r: 96, g: 96, b: 96},\r\n                theme\r\n            );\r\n            colorCorner = modifyBackgroundColor(\r\n                {r: 255, g: 255, b: 255},\r\n                theme\r\n            );\r\n        } else {\r\n            const rgb = parseColorWithCache(theme.scrollbarColor);\r\n            const hsl = rgbToHSL(rgb);\r\n            const isLight = hsl.l > 0.5;\r\n            const lighten = (lighter) => ({\r\n                ...hsl,\r\n                l: clamp(hsl.l + lighter, 0, 1)\r\n            });\r\n            const darken = (darker) => ({\r\n                ...hsl,\r\n                l: clamp(hsl.l - darker, 0, 1)\r\n            });\r\n            colorTrack = hslToString(darken(0.4));\r\n            colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\r\n            colorThumb = hslToString(hsl);\r\n            colorThumbHover = hslToString(lighten(0.1));\r\n            colorThumbActive = hslToString(lighten(0.2));\r\n            colorCorner = hslToString(darken(0.5));\r\n        }\r\n        lines.push("::-webkit-scrollbar {");\r\n        lines.push(\`    background-color: \${colorTrack};\`);\r\n        lines.push(\`    color: \${colorIcons};\`);\r\n        lines.push("}");\r\n        lines.push("::-webkit-scrollbar-thumb {");\r\n        lines.push(\`    background-color: \${colorThumb};\`);\r\n        lines.push("}");\r\n        lines.push("::-webkit-scrollbar-thumb:hover {");\r\n        lines.push(\`    background-color: \${colorThumbHover};\`);\r\n        lines.push("}");\r\n        lines.push("::-webkit-scrollbar-thumb:active {");\r\n        lines.push(\`    background-color: \${colorThumbActive};\`);\r\n        lines.push("}");\r\n        lines.push("::-webkit-scrollbar-corner {");\r\n        lines.push(\`    background-color: \${colorCorner};\`);\r\n        lines.push("}");\r\n        if (isFirefox) {\r\n            lines.push("* {");\r\n            lines.push(\`    scrollbar-color: \${colorThumb} \${colorTrack};\`);\r\n            lines.push("}");\r\n        }\r\n        return lines.join("\\n");\r\n    }\r\n    function getModifiedFallbackStyle(theme, {strict}) {\r\n        const factory = defaultFallbackFactory;\r\n        return factory(theme, {strict});\r\n    }\r\n    function defaultFallbackFactory(theme, {strict}) {\r\n        const lines = [];\r\n        lines.push(\r\n            \`html, body, \${strict ? "body :not(iframe)" : "body > :not(iframe)"} {\`\r\n        );\r\n        lines.push(\r\n            \`    background-color: \${modifyBackgroundColor({r: 255, g: 255, b: 255}, theme)} !important;\`\r\n        );\r\n        lines.push(\r\n            \`    border-color: \${modifyBorderColor({r: 64, g: 64, b: 64}, theme)} !important;\`\r\n        );\r\n        lines.push(\r\n            \`    color: \${modifyForegroundColor({r: 0, g: 0, b: 0}, theme)} !important;\`\r\n        );\r\n        lines.push("}");\r\n        lines.push(\`div[style*="background-color: rgb(135, 135, 135)"] {\`);\r\n        lines.push(\`    background-color: #878787 !important;\`);\r\n        lines.push("}");\r\n        return lines.join("\\n");\r\n    }\r\n    const unparsableColors = new Set([\r\n        "inherit",\r\n        "transparent",\r\n        "initial",\r\n        "currentcolor",\r\n        "none",\r\n        "unset",\r\n        "auto"\r\n    ]);\r\n    function getColorModifier(prop, value, rule) {\r\n        if (unparsableColors.has(value.toLowerCase())) {\r\n            return value;\r\n        }\r\n        const rgb = parseColorWithCache(value);\r\n        if (!rgb) {\r\n            return null;\r\n        }\r\n        if (prop.includes("background")) {\r\n            if (\r\n                (rule.style.webkitMaskImage &&\r\n                    rule.style.webkitMaskImage !== "none") ||\r\n                (rule.style.webkitMask &&\r\n                    !rule.style.webkitMask.startsWith("none")) ||\r\n                (rule.style.mask && rule.style.mask !== "none") ||\r\n                (rule.style.getPropertyValue("mask-image") &&\r\n                    rule.style.getPropertyValue("mask-image") !== "none")\r\n            ) {\r\n                return (theme) => modifyForegroundColor(rgb, theme);\r\n            }\r\n            return (theme) => modifyBackgroundColor(rgb, theme);\r\n        }\r\n        if (prop.includes("border") || prop.includes("outline")) {\r\n            return (theme) => modifyBorderColor(rgb, theme);\r\n        }\r\n        return (theme) => modifyForegroundColor(rgb, theme);\r\n    }\r\n    const imageDetailsCache = new Map();\r\n    const awaitingForImageLoading = new Map();\r\n    function shouldIgnoreImage(selectorText, selectors) {\r\n        if (!selectorText || selectors.length === 0) {\r\n            return false;\r\n        }\r\n        if (selectors.some((s) => s === "*")) {\r\n            return true;\r\n        }\r\n        const ruleSelectors = selectorText.split(/,\\s*/g);\r\n        for (let i = 0; i < selectors.length; i++) {\r\n            const ignoredSelector = selectors[i];\r\n            if (ruleSelectors.some((s) => s === ignoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getBgImageModifier(\r\n        value,\r\n        rule,\r\n        ignoreImageSelectors,\r\n        isCancelled\r\n    ) {\r\n        try {\r\n            const gradients = parseGradient(value);\r\n            const urls = getMatches(cssURLRegex, value);\r\n            if (urls.length === 0 && gradients.length === 0) {\r\n                return value;\r\n            }\r\n            const getIndices = (matches) => {\r\n                let index = 0;\r\n                return matches.map((match) => {\r\n                    const valueIndex = value.indexOf(match, index);\r\n                    index = valueIndex + match.length;\r\n                    return {match, index: valueIndex};\r\n                });\r\n            };\r\n            const matches = gradients\r\n                .map((i) => ({type: "gradient", ...i}))\r\n                .concat(\r\n                    getIndices(urls).map((i) => ({\r\n                        type: "url",\r\n                        offset: 0,\r\n                        ...i\r\n                    }))\r\n                )\r\n                .sort((a, b) => (a.index > b.index ? 1 : -1));\r\n            const getGradientModifier = (gradient) => {\r\n                const {typeGradient, match, hasComma} = gradient;\r\n                const partsRegex =\r\n                    /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?([^\\(\\), ]|( (?!calc)))*),?/g;\r\n                const colorStopRegex =\r\n                    /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\r\n                const parts = getMatches(partsRegex, match, 1).map((part) => {\r\n                    part = part.trim();\r\n                    let rgb = parseColorWithCache(part);\r\n                    if (rgb) {\r\n                        return (theme) => modifyGradientColor(rgb, theme);\r\n                    }\r\n                    const space = part.lastIndexOf(" ");\r\n                    rgb = parseColorWithCache(part.substring(0, space));\r\n                    if (rgb) {\r\n                        return (theme) =>\r\n                            \`\${modifyGradientColor(rgb, theme)} \${part.substring(space + 1)}\`;\r\n                    }\r\n                    const colorStopMatch = part.match(colorStopRegex);\r\n                    if (colorStopMatch) {\r\n                        rgb = parseColorWithCache(colorStopMatch[3]);\r\n                        if (rgb) {\r\n                            return (theme) =>\r\n                                \`\${colorStopMatch[1]}(\${colorStopMatch[2] ? \`\${colorStopMatch[2]}, \` : ""}\${modifyGradientColor(rgb, theme)})\`;\r\n                        }\r\n                    }\r\n                    return () => part;\r\n                });\r\n                return (theme) => {\r\n                    return \`\${typeGradient}(\${parts.map((modify) => modify(theme)).join(", ")})\${hasComma ? ", " : ""}\`;\r\n                };\r\n            };\r\n            const getURLModifier = (urlValue) => {\r\n                if (\r\n                    shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)\r\n                ) {\r\n                    return null;\r\n                }\r\n                let url = getCSSURLValue(urlValue);\r\n                const isURLEmpty = url.length === 0;\r\n                const {parentStyleSheet} = rule;\r\n                const baseURL =\r\n                    parentStyleSheet && parentStyleSheet.href\r\n                        ? getCSSBaseBath(parentStyleSheet.href)\r\n                        : parentStyleSheet?.ownerNode?.baseURI ||\r\n                          location.origin;\r\n                url = getAbsoluteURL(baseURL, url);\r\n                return async (theme) => {\r\n                    if (isURLEmpty) {\r\n                        return "url('')";\r\n                    }\r\n                    let imageDetails = null;\r\n                    if (imageDetailsCache.has(url)) {\r\n                        imageDetails = imageDetailsCache.get(url);\r\n                    } else {\r\n                        try {\r\n                            if (!isBlobURLCheckResultReady()) {\r\n                                await requestBlobURLCheck();\r\n                            }\r\n                            if (awaitingForImageLoading.has(url)) {\r\n                                const awaiters =\r\n                                    awaitingForImageLoading.get(url);\r\n                                imageDetails = await new Promise((resolve) =>\r\n                                    awaiters.push(resolve)\r\n                                );\r\n                                if (!imageDetails) {\r\n                                    return null;\r\n                                }\r\n                            } else {\r\n                                awaitingForImageLoading.set(url, []);\r\n                                imageDetails = await getImageDetails(url);\r\n                                imageDetailsCache.set(url, imageDetails);\r\n                                awaitingForImageLoading\r\n                                    .get(url)\r\n                                    .forEach((resolve) =>\r\n                                        resolve(imageDetails)\r\n                                    );\r\n                                awaitingForImageLoading.delete(url);\r\n                            }\r\n                            if (isCancelled()) {\r\n                                return null;\r\n                            }\r\n                        } catch (err) {\r\n                            logWarn(err);\r\n                            if (awaitingForImageLoading.has(url)) {\r\n                                awaitingForImageLoading\r\n                                    .get(url)\r\n                                    .forEach((resolve) => resolve(null));\r\n                                awaitingForImageLoading.delete(url);\r\n                            }\r\n                        }\r\n                    }\r\n                    if (imageDetails) {\r\n                        const bgImageValue = getBgImageValue(\r\n                            imageDetails,\r\n                            theme\r\n                        );\r\n                        if (bgImageValue) {\r\n                            return bgImageValue;\r\n                        }\r\n                    }\r\n                    if (url.startsWith("data:")) {\r\n                        const blobURL = await tryConvertDataURLToBlobURL(url);\r\n                        if (blobURL) {\r\n                            return \`url("\${blobURL}")\`;\r\n                        }\r\n                    }\r\n                    return \`url("\${url}")\`;\r\n                };\r\n            };\r\n            const getBgImageValue = (imageDetails, theme) => {\r\n                const {isDark, isLight, isTransparent, isLarge, width} =\r\n                    imageDetails;\r\n                let result;\r\n                const logSrc = imageDetails.src.startsWith("data:")\r\n                    ? "data:"\r\n                    : imageDetails.src;\r\n                if (isLarge) {\r\n                    logInfo(\`Not modifying too large image \${logSrc}\`);\r\n                    result = null;\r\n                } else if (\r\n                    isDark &&\r\n                    isTransparent &&\r\n                    theme.mode === 1 &&\r\n                    width > 2\r\n                ) {\r\n                    logInfo(\`Inverting dark image \${logSrc}\`);\r\n                    const inverted = getFilteredImageURL(imageDetails, {\r\n                        ...theme,\r\n                        sepia: clamp(theme.sepia + 10, 0, 100)\r\n                    });\r\n                    result = \`url("\${inverted}")\`;\r\n                } else if (isLight && !isTransparent && theme.mode === 1) {\r\n                    logInfo(\`Dimming light image \${logSrc}\`);\r\n                    const dimmed = getFilteredImageURL(imageDetails, theme);\r\n                    result = \`url("\${dimmed}")\`;\r\n                } else if (theme.mode === 0 && isLight) {\r\n                    logInfo(\`Applying filter to image \${logSrc}\`);\r\n                    const filtered = getFilteredImageURL(imageDetails, {\r\n                        ...theme,\r\n                        brightness: clamp(theme.brightness - 10, 5, 200),\r\n                        sepia: clamp(theme.sepia + 10, 0, 100)\r\n                    });\r\n                    result = \`url("\${filtered}")\`;\r\n                } else {\r\n                    logInfo(\`Not modifying the image \${logSrc}\`);\r\n                    result = null;\r\n                }\r\n                return result;\r\n            };\r\n            const modifiers = [];\r\n            let matchIndex = 0;\r\n            let prevHasComma = false;\r\n            matches.forEach(\r\n                ({type, match, index, typeGradient, hasComma, offset}, i) => {\r\n                    const matchStart = index;\r\n                    const prefixStart = matchIndex;\r\n                    const matchEnd = matchStart + match.length + offset;\r\n                    matchIndex = matchEnd;\r\n                    if (prefixStart !== matchStart) {\r\n                        if (prevHasComma) {\r\n                            modifiers.push(() => {\r\n                                let betweenValue = value.substring(\r\n                                    prefixStart,\r\n                                    matchStart\r\n                                );\r\n                                if (betweenValue[0] === ",") {\r\n                                    betweenValue = betweenValue.substring(1);\r\n                                }\r\n                                return betweenValue;\r\n                            });\r\n                        } else {\r\n                            modifiers.push(() =>\r\n                                value.substring(prefixStart, matchStart)\r\n                            );\r\n                        }\r\n                    }\r\n                    prevHasComma = hasComma || false;\r\n                    if (type === "url") {\r\n                        modifiers.push(getURLModifier(match));\r\n                    } else if (type === "gradient") {\r\n                        modifiers.push(\r\n                            getGradientModifier({\r\n                                match,\r\n                                index,\r\n                                typeGradient: typeGradient,\r\n                                hasComma: hasComma || false,\r\n                                offset\r\n                            })\r\n                        );\r\n                    }\r\n                    if (i === matches.length - 1) {\r\n                        modifiers.push(() => value.substring(matchEnd));\r\n                    }\r\n                }\r\n            );\r\n            return (theme) => {\r\n                const results = modifiers\r\n                    .filter(Boolean)\r\n                    .map((modify) => modify(theme));\r\n                if (results.some((r) => r instanceof Promise)) {\r\n                    return Promise.all(results).then((asyncResults) => {\r\n                        return asyncResults.filter(Boolean).join("");\r\n                    });\r\n                }\r\n                const combinedResult = results.join("");\r\n                if (combinedResult.endsWith(", initial")) {\r\n                    return combinedResult.slice(0, -9);\r\n                }\r\n                return combinedResult;\r\n            };\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifierWithInfo(value) {\r\n        try {\r\n            let index = 0;\r\n            const colorMatches = getMatches(\r\n                /(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/gi,\r\n                value,\r\n                2\r\n            );\r\n            let notParsed = 0;\r\n            const modifiers = colorMatches.map((match, i) => {\r\n                const prefixIndex = index;\r\n                const matchIndex = value.indexOf(match, index);\r\n                const matchEnd = matchIndex + match.length;\r\n                index = matchEnd;\r\n                const rgb = parseColorWithCache(match);\r\n                if (!rgb) {\r\n                    notParsed++;\r\n                    return () => value.substring(prefixIndex, matchEnd);\r\n                }\r\n                return (theme) =>\r\n                    \`\${value.substring(prefixIndex, matchIndex)}\${modifyShadowColor(rgb, theme)}\${i === colorMatches.length - 1 ? value.substring(matchEnd) : ""}\`;\r\n            });\r\n            return (theme) => {\r\n                const modified = modifiers\r\n                    .map((modify) => modify(theme))\r\n                    .join("");\r\n                return {\r\n                    matchesLength: colorMatches.length,\r\n                    unparseableMatchesLength: notParsed,\r\n                    result: modified\r\n                };\r\n            };\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifier(value) {\r\n        const shadowModifier = getShadowModifierWithInfo(value);\r\n        if (!shadowModifier) {\r\n            return null;\r\n        }\r\n        return (theme) => shadowModifier(theme).result;\r\n    }\r\n    function getScrollbarColorModifier(value) {\r\n        const colorsMatch = value.match(\r\n            /^\\s*([a-z]+(\\(.*\\))?)\\s+([a-z]+(\\(.*\\))?)\\s*$/\r\n        );\r\n        if (!colorsMatch) {\r\n            return value;\r\n        }\r\n        const thumb = parseColorWithCache(colorsMatch[1]);\r\n        const track = parseColorWithCache(colorsMatch[3]);\r\n        if (!thumb || !track) {\r\n            return null;\r\n        }\r\n        return (theme) =>\r\n            \`\${modifyForegroundColor(thumb, theme)} \${modifyBackgroundColor(thumb, theme)}\`;\r\n    }\r\n    function getColorSchemeModifier() {\r\n        return (theme) => (theme.mode === 0 ? "dark light" : "dark");\r\n    }\r\n    function getVariableModifier(\r\n        variablesStore,\r\n        prop,\r\n        value,\r\n        rule,\r\n        ignoredImgSelectors,\r\n        isCancelled\r\n    ) {\r\n        return variablesStore.getModifierForVariable({\r\n            varName: prop,\r\n            sourceValue: value,\r\n            rule,\r\n            ignoredImgSelectors,\r\n            isCancelled\r\n        });\r\n    }\r\n    function getVariableDependantModifier(variablesStore, prop, value) {\r\n        return variablesStore.getModifierForVarDependant(prop, value);\r\n    }\r\n    function cleanModificationCache() {\r\n        clearColorModificationCache();\r\n        imageDetailsCache.clear();\r\n        cleanImageProcessingCache();\r\n        awaitingForImageLoading.clear();\r\n    }\r\n\r\n    const VAR_TYPE_BGCOLOR = 1 << 0;\r\n    const VAR_TYPE_TEXTCOLOR = 1 << 1;\r\n    const VAR_TYPE_BORDERCOLOR = 1 << 2;\r\n    const VAR_TYPE_BGIMG = 1 << 3;\r\n    class VariablesStore {\r\n        constructor() {\r\n            this.varTypes = new Map();\r\n            this.rulesQueue = [];\r\n            this.inlineStyleQueue = [];\r\n            this.definedVars = new Set();\r\n            this.varRefs = new Map();\r\n            this.unknownColorVars = new Set();\r\n            this.unknownBgVars = new Set();\r\n            this.undefinedVars = new Set();\r\n            this.initialVarTypes = new Map();\r\n            this.changedTypeVars = new Set();\r\n            this.typeChangeSubscriptions = new Map();\r\n            this.unstableVarValues = new Map();\r\n        }\r\n        clear() {\r\n            this.varTypes.clear();\r\n            this.rulesQueue.splice(0);\r\n            this.inlineStyleQueue.splice(0);\r\n            this.definedVars.clear();\r\n            this.varRefs.clear();\r\n            this.unknownColorVars.clear();\r\n            this.unknownBgVars.clear();\r\n            this.undefinedVars.clear();\r\n            this.initialVarTypes.clear();\r\n            this.changedTypeVars.clear();\r\n            this.typeChangeSubscriptions.clear();\r\n            this.unstableVarValues.clear();\r\n        }\r\n        isVarType(varName, typeNum) {\r\n            return (\r\n                this.varTypes.has(varName) &&\r\n                (this.varTypes.get(varName) & typeNum) > 0\r\n            );\r\n        }\r\n        addRulesForMatching(rules) {\r\n            this.rulesQueue.push(rules);\r\n        }\r\n        addInlineStyleForMatching(style) {\r\n            this.inlineStyleQueue.push(style);\r\n        }\r\n        matchVariablesAndDependents() {\r\n            if (\r\n                this.rulesQueue.length === 0 &&\r\n                this.inlineStyleQueue.length === 0\r\n            ) {\r\n                return;\r\n            }\r\n            this.changedTypeVars.clear();\r\n            this.initialVarTypes = new Map(this.varTypes);\r\n            this.collectRootVariables();\r\n            this.collectVariablesAndVarDep();\r\n            this.collectRootVarDependents();\r\n            this.varRefs.forEach((refs, v) => {\r\n                refs.forEach((r) => {\r\n                    if (this.varTypes.has(v)) {\r\n                        this.resolveVariableType(r, this.varTypes.get(v));\r\n                    }\r\n                });\r\n            });\r\n            this.unknownColorVars.forEach((v) => {\r\n                if (this.unknownBgVars.has(v)) {\r\n                    this.unknownColorVars.delete(v);\r\n                    this.unknownBgVars.delete(v);\r\n                    this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                } else if (\r\n                    this.isVarType(\r\n                        v,\r\n                        VAR_TYPE_BGCOLOR |\r\n                            VAR_TYPE_TEXTCOLOR |\r\n                            VAR_TYPE_BORDERCOLOR\r\n                    )\r\n                ) {\r\n                    this.unknownColorVars.delete(v);\r\n                } else {\r\n                    this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.unknownBgVars.forEach((v) => {\r\n                const hasColor =\r\n                    this.findVarRef(v, (ref) => {\r\n                        return (\r\n                            this.unknownColorVars.has(ref) ||\r\n                            this.isVarType(\r\n                                ref,\r\n                                VAR_TYPE_BGCOLOR |\r\n                                    VAR_TYPE_TEXTCOLOR |\r\n                                    VAR_TYPE_BORDERCOLOR\r\n                            )\r\n                        );\r\n                    }) != null;\r\n                if (hasColor) {\r\n                    this.iterateVarRefs(v, (ref) => {\r\n                        this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                    });\r\n                } else if (\r\n                    this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)\r\n                ) {\r\n                    this.unknownBgVars.delete(v);\r\n                } else {\r\n                    this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.changedTypeVars.forEach((varName) => {\r\n                if (this.typeChangeSubscriptions.has(varName)) {\r\n                    this.typeChangeSubscriptions\r\n                        .get(varName)\r\n                        .forEach((callback) => {\r\n                            callback();\r\n                        });\r\n                }\r\n            });\r\n            this.changedTypeVars.clear();\r\n        }\r\n        getModifierForVariable(options) {\r\n            return (theme) => {\r\n                const {\r\n                    varName,\r\n                    sourceValue,\r\n                    rule,\r\n                    ignoredImgSelectors,\r\n                    isCancelled\r\n                } = options;\r\n                const getDeclarations = () => {\r\n                    const declarations = [];\r\n                    const addModifiedValue = (\r\n                        typeNum,\r\n                        varNameWrapper,\r\n                        colorModifier\r\n                    ) => {\r\n                        if (!this.isVarType(varName, typeNum)) {\r\n                            return;\r\n                        }\r\n                        const property = varNameWrapper(varName);\r\n                        let modifiedValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            if (isConstructedColorVar(sourceValue)) {\r\n                                let value = insertVarValues(\r\n                                    sourceValue,\r\n                                    this.unstableVarValues\r\n                                );\r\n                                if (!value) {\r\n                                    value =\r\n                                        typeNum === VAR_TYPE_BGCOLOR\r\n                                            ? "#ffffff"\r\n                                            : "#000000";\r\n                                }\r\n                                modifiedValue = colorModifier(value, theme);\r\n                            } else {\r\n                                modifiedValue = replaceCSSVariablesNames(\r\n                                    sourceValue,\r\n                                    (v) => varNameWrapper(v),\r\n                                    (fallback) => colorModifier(fallback, theme)\r\n                                );\r\n                            }\r\n                        } else {\r\n                            modifiedValue = colorModifier(sourceValue, theme);\r\n                        }\r\n                        declarations.push({\r\n                            property,\r\n                            value: modifiedValue\r\n                        });\r\n                    };\r\n                    addModifiedValue(\r\n                        VAR_TYPE_BGCOLOR,\r\n                        wrapBgColorVariableName,\r\n                        tryModifyBgColor\r\n                    );\r\n                    addModifiedValue(\r\n                        VAR_TYPE_TEXTCOLOR,\r\n                        wrapTextColorVariableName,\r\n                        tryModifyTextColor\r\n                    );\r\n                    addModifiedValue(\r\n                        VAR_TYPE_BORDERCOLOR,\r\n                        wrapBorderColorVariableName,\r\n                        tryModifyBorderColor\r\n                    );\r\n                    if (this.isVarType(varName, VAR_TYPE_BGIMG)) {\r\n                        const property = wrapBgImgVariableName(varName);\r\n                        let modifiedValue = sourceValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            modifiedValue = replaceCSSVariablesNames(\r\n                                sourceValue,\r\n                                (v) => wrapBgColorVariableName(v),\r\n                                (fallback) => tryModifyBgColor(fallback, theme)\r\n                            );\r\n                        }\r\n                        const bgModifier = getBgImageModifier(\r\n                            modifiedValue,\r\n                            rule,\r\n                            ignoredImgSelectors,\r\n                            isCancelled\r\n                        );\r\n                        modifiedValue =\r\n                            typeof bgModifier === "function"\r\n                                ? bgModifier(theme)\r\n                                : bgModifier;\r\n                        declarations.push({\r\n                            property,\r\n                            value: modifiedValue\r\n                        });\r\n                    }\r\n                    return declarations;\r\n                };\r\n                const callbacks = new Set();\r\n                const addListener = (onTypeChange) => {\r\n                    const callback = () => {\r\n                        const decs = getDeclarations();\r\n                        onTypeChange(decs);\r\n                    };\r\n                    callbacks.add(callback);\r\n                    this.subscribeForVarTypeChange(varName, callback);\r\n                };\r\n                const removeListeners = () => {\r\n                    callbacks.forEach((callback) => {\r\n                        this.unsubscribeFromVariableTypeChanges(\r\n                            varName,\r\n                            callback\r\n                        );\r\n                    });\r\n                };\r\n                return {\r\n                    declarations: getDeclarations(),\r\n                    onTypeChange: {addListener, removeListeners}\r\n                };\r\n            };\r\n        }\r\n        getModifierForVarDependant(property, sourceValue) {\r\n            if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\r\n                const isBg = property.startsWith("background");\r\n                const isText = isTextColorProperty(property);\r\n                return (theme) => {\r\n                    let value = insertVarValues(\r\n                        sourceValue,\r\n                        this.unstableVarValues\r\n                    );\r\n                    if (!value) {\r\n                        value = isBg ? "#ffffff" : "#000000";\r\n                    }\r\n                    const modifier = isBg\r\n                        ? tryModifyBgColor\r\n                        : isText\r\n                          ? tryModifyTextColor\r\n                          : tryModifyBorderColor;\r\n                    return modifier(value, theme);\r\n                };\r\n            }\r\n            if (property === "background-color") {\r\n                return (theme) => {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        (v) => wrapBgColorVariableName(v),\r\n                        (fallback) => tryModifyBgColor(fallback, theme)\r\n                    );\r\n                };\r\n            }\r\n            if (isTextColorProperty(property)) {\r\n                return (theme) => {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        (v) => wrapTextColorVariableName(v),\r\n                        (fallback) => tryModifyTextColor(fallback, theme)\r\n                    );\r\n                };\r\n            }\r\n            if (\r\n                property === "background" ||\r\n                property === "background-image" ||\r\n                property === "box-shadow"\r\n            ) {\r\n                return (theme) => {\r\n                    const unknownVars = new Set();\r\n                    const modify = () => {\r\n                        const variableReplaced = replaceCSSVariablesNames(\r\n                            sourceValue,\r\n                            (v) => {\r\n                                if (this.isVarType(v, VAR_TYPE_BGCOLOR)) {\r\n                                    return wrapBgColorVariableName(v);\r\n                                }\r\n                                if (this.isVarType(v, VAR_TYPE_BGIMG)) {\r\n                                    return wrapBgImgVariableName(v);\r\n                                }\r\n                                unknownVars.add(v);\r\n                                return v;\r\n                            },\r\n                            (fallback) => tryModifyBgColor(fallback, theme)\r\n                        );\r\n                        if (property === "box-shadow") {\r\n                            const shadowModifier =\r\n                                getShadowModifierWithInfo(variableReplaced);\r\n                            const modifiedShadow = shadowModifier(theme);\r\n                            if (\r\n                                modifiedShadow.unparseableMatchesLength !==\r\n                                modifiedShadow.matchesLength\r\n                            ) {\r\n                                return modifiedShadow.result;\r\n                            }\r\n                        }\r\n                        return variableReplaced;\r\n                    };\r\n                    const modified = modify();\r\n                    if (unknownVars.size > 0) {\r\n                        const isFallbackResolved = modified.match(\r\n                            /^var\\(.*?, var\\(--darkreader-bg--.*\\)\\)$/\r\n                        );\r\n                        if (isFallbackResolved) {\r\n                            return modified;\r\n                        }\r\n                        return new Promise((resolve) => {\r\n                            for (const unknownVar of unknownVars.values()) {\r\n                                const callback = () => {\r\n                                    this.unsubscribeFromVariableTypeChanges(\r\n                                        unknownVar,\r\n                                        callback\r\n                                    );\r\n                                    const newValue = modify();\r\n                                    resolve(newValue);\r\n                                };\r\n                                this.subscribeForVarTypeChange(\r\n                                    unknownVar,\r\n                                    callback\r\n                                );\r\n                            }\r\n                        });\r\n                    }\r\n                    return modified;\r\n                };\r\n            }\r\n            if (\r\n                property.startsWith("border") ||\r\n                property.startsWith("outline")\r\n            ) {\r\n                return (theme) => {\r\n                    return replaceCSSVariablesNames(\r\n                        sourceValue,\r\n                        (v) => wrapBorderColorVariableName(v),\r\n                        (fallback) => tryModifyBorderColor(fallback, theme)\r\n                    );\r\n                };\r\n            }\r\n            return null;\r\n        }\r\n        subscribeForVarTypeChange(varName, callback) {\r\n            if (!this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.set(varName, new Set());\r\n            }\r\n            const rootStore = this.typeChangeSubscriptions.get(varName);\r\n            if (!rootStore.has(callback)) {\r\n                rootStore.add(callback);\r\n            }\r\n        }\r\n        unsubscribeFromVariableTypeChanges(varName, callback) {\r\n            if (this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.get(varName).delete(callback);\r\n            }\r\n        }\r\n        collectVariablesAndVarDep() {\r\n            this.rulesQueue.forEach((rules) => {\r\n                iterateCSSRules(rules, (rule) => {\r\n                    if (rule.style) {\r\n                        this.collectVarsFromCSSDeclarations(rule.style);\r\n                    }\r\n                });\r\n            });\r\n            this.inlineStyleQueue.forEach((style) => {\r\n                this.collectVarsFromCSSDeclarations(style);\r\n            });\r\n            this.rulesQueue.splice(0);\r\n            this.inlineStyleQueue.splice(0);\r\n        }\r\n        collectVarsFromCSSDeclarations(style) {\r\n            iterateCSSDeclarations(style, (property, value) => {\r\n                if (isVariable(property)) {\r\n                    this.inspectVariable(property, value);\r\n                }\r\n                if (isVarDependant(value)) {\r\n                    this.inspectVarDependant(property, value);\r\n                }\r\n            });\r\n        }\r\n        shouldProcessRootVariables() {\r\n            return (\r\n                this.rulesQueue.length > 0 &&\r\n                document.documentElement.getAttribute("style")?.includes("--")\r\n            );\r\n        }\r\n        collectRootVariables() {\r\n            if (!this.shouldProcessRootVariables()) {\r\n                return;\r\n            }\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                (property, value) => {\r\n                    if (isVariable(property)) {\r\n                        this.inspectVariable(property, value);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n        inspectVariable(varName, value) {\r\n            this.unstableVarValues.set(varName, value);\r\n            if (isVarDependant(value) && isConstructedColorVar(value)) {\r\n                this.unknownColorVars.add(varName);\r\n                this.definedVars.add(varName);\r\n            }\r\n            if (this.definedVars.has(varName)) {\r\n                return;\r\n            }\r\n            this.definedVars.add(varName);\r\n            const isColor = Boolean(\r\n                value.match(rawRGBSpaceRegex) ||\r\n                    value.match(rawRGBCommaRegex) ||\r\n                    parseColorWithCache(value)\r\n            );\r\n            if (isColor) {\r\n                this.unknownColorVars.add(varName);\r\n            } else if (\r\n                value.includes("url(") ||\r\n                value.includes("linear-gradient(") ||\r\n                value.includes("radial-gradient(")\r\n            ) {\r\n                this.resolveVariableType(varName, VAR_TYPE_BGIMG);\r\n            }\r\n        }\r\n        resolveVariableType(varName, typeNum) {\r\n            const initialType = this.initialVarTypes.get(varName) || 0;\r\n            const currentType = this.varTypes.get(varName) || 0;\r\n            const newType = currentType | typeNum;\r\n            this.varTypes.set(varName, newType);\r\n            if (newType !== initialType || this.undefinedVars.has(varName)) {\r\n                this.changedTypeVars.add(varName);\r\n                this.undefinedVars.delete(varName);\r\n            }\r\n            this.unknownColorVars.delete(varName);\r\n            this.unknownBgVars.delete(varName);\r\n        }\r\n        collectRootVarDependents() {\r\n            if (!this.shouldProcessRootVariables()) {\r\n                return;\r\n            }\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                (property, value) => {\r\n                    if (isVarDependant(value)) {\r\n                        this.inspectVarDependant(property, value);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n        inspectVarDependant(property, value) {\r\n            if (isVariable(property)) {\r\n                this.iterateVarDeps(value, (ref) => {\r\n                    if (!this.varRefs.has(property)) {\r\n                        this.varRefs.set(property, new Set());\r\n                    }\r\n                    this.varRefs.get(property).add(ref);\r\n                });\r\n            } else if (\r\n                property === "background-color" ||\r\n                property === "box-shadow"\r\n            ) {\r\n                this.iterateVarDeps(value, (v) =>\r\n                    this.resolveVariableType(v, VAR_TYPE_BGCOLOR)\r\n                );\r\n            } else if (isTextColorProperty(property)) {\r\n                this.iterateVarDeps(value, (v) =>\r\n                    this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR)\r\n                );\r\n            } else if (\r\n                property.startsWith("border") ||\r\n                property.startsWith("outline")\r\n            ) {\r\n                this.iterateVarDeps(value, (v) =>\r\n                    this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR)\r\n                );\r\n            } else if (\r\n                property === "background" ||\r\n                property === "background-image"\r\n            ) {\r\n                this.iterateVarDeps(value, (v) => {\r\n                    if (this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                        return;\r\n                    }\r\n                    const isBgColor =\r\n                        this.findVarRef(v, (ref) => {\r\n                            return (\r\n                                this.unknownColorVars.has(ref) ||\r\n                                this.isVarType(\r\n                                    ref,\r\n                                    VAR_TYPE_BGCOLOR |\r\n                                        VAR_TYPE_TEXTCOLOR |\r\n                                        VAR_TYPE_BORDERCOLOR\r\n                                )\r\n                            );\r\n                        }) != null;\r\n                    this.iterateVarRefs(v, (ref) => {\r\n                        if (isBgColor) {\r\n                            this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                        } else {\r\n                            this.unknownBgVars.add(ref);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n        iterateVarDeps(value, iterator) {\r\n            const varDeps = new Set();\r\n            iterateVarDependencies(value, (v) => varDeps.add(v));\r\n            varDeps.forEach((v) => iterator(v));\r\n        }\r\n        findVarRef(varName, iterator, stack = new Set()) {\r\n            if (stack.has(varName)) {\r\n                return null;\r\n            }\r\n            stack.add(varName);\r\n            const result = iterator(varName);\r\n            if (result) {\r\n                return varName;\r\n            }\r\n            const refs = this.varRefs.get(varName);\r\n            if (!refs || refs.size === 0) {\r\n                return null;\r\n            }\r\n            for (const ref of refs) {\r\n                const found = this.findVarRef(ref, iterator, stack);\r\n                if (found) {\r\n                    return found;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        iterateVarRefs(varName, iterator) {\r\n            this.findVarRef(varName, (ref) => {\r\n                iterator(ref);\r\n                return false;\r\n            });\r\n        }\r\n        setOnRootVariableChange(callback) {\r\n            this.onRootVariableDefined = callback;\r\n        }\r\n        putRootVars(styleElement, theme) {\r\n            const sheet = styleElement.sheet;\r\n            if (sheet.cssRules.length > 0) {\r\n                sheet.deleteRule(0);\r\n            }\r\n            const declarations = new Map();\r\n            iterateCSSDeclarations(\r\n                document.documentElement.style,\r\n                (property, value) => {\r\n                    if (isVariable(property)) {\r\n                        if (this.isVarType(property, VAR_TYPE_BGCOLOR)) {\r\n                            declarations.set(\r\n                                wrapBgColorVariableName(property),\r\n                                tryModifyBgColor(value, theme)\r\n                            );\r\n                        }\r\n                        if (this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\r\n                            declarations.set(\r\n                                wrapTextColorVariableName(property),\r\n                                tryModifyTextColor(value, theme)\r\n                            );\r\n                        }\r\n                        if (this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\r\n                            declarations.set(\r\n                                wrapBorderColorVariableName(property),\r\n                                tryModifyBorderColor(value, theme)\r\n                            );\r\n                        }\r\n                        this.subscribeForVarTypeChange(\r\n                            property,\r\n                            this.onRootVariableDefined\r\n                        );\r\n                    }\r\n                }\r\n            );\r\n            const cssLines = [];\r\n            cssLines.push(":root {");\r\n            for (const [property, value] of declarations) {\r\n                cssLines.push(\`    \${property}: \${value};\`);\r\n            }\r\n            cssLines.push("}");\r\n            const cssText = cssLines.join("\\n");\r\n            sheet.insertRule(cssText);\r\n        }\r\n    }\r\n    const variablesStore = new VariablesStore();\r\n    function getVariableRange(input, searchStart = 0) {\r\n        const start = input.indexOf("var(", searchStart);\r\n        if (start >= 0) {\r\n            const range = getParenthesesRange(input, start + 3);\r\n            if (range) {\r\n                return {start, end: range.end};\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getVariablesMatches(input) {\r\n        const ranges = [];\r\n        let i = 0;\r\n        let range;\r\n        while ((range = getVariableRange(input, i))) {\r\n            const {start, end} = range;\r\n            ranges.push({start, end, value: input.substring(start, end)});\r\n            i = range.end + 1;\r\n        }\r\n        return ranges;\r\n    }\r\n    function replaceVariablesMatches(input, replacer) {\r\n        const matches = getVariablesMatches(input);\r\n        const matchesCount = matches.length;\r\n        if (matchesCount === 0) {\r\n            return input;\r\n        }\r\n        const inputLength = input.length;\r\n        const replacements = matches.map((m) => replacer(m.value));\r\n        const parts = [];\r\n        parts.push(input.substring(0, matches[0].start));\r\n        for (let i = 0; i < matchesCount; i++) {\r\n            parts.push(replacements[i]);\r\n            const start = matches[i].end;\r\n            const end =\r\n                i < matchesCount - 1 ? matches[i + 1].start : inputLength;\r\n            parts.push(input.substring(start, end));\r\n        }\r\n        return parts.join("");\r\n    }\r\n    function getVariableNameAndFallback(match) {\r\n        const commaIndex = match.indexOf(",");\r\n        let name;\r\n        let fallback;\r\n        if (commaIndex >= 0) {\r\n            name = match.substring(4, commaIndex).trim();\r\n            fallback = match.substring(commaIndex + 1, match.length - 1).trim();\r\n        } else {\r\n            name = match.substring(4, match.length - 1).trim();\r\n            fallback = "";\r\n        }\r\n        return {name, fallback};\r\n    }\r\n    function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\r\n        const matchReplacer = (match) => {\r\n            const {name, fallback} = getVariableNameAndFallback(match);\r\n            const newName = nameReplacer(name);\r\n            if (!fallback) {\r\n                return \`var(\${newName})\`;\r\n            }\r\n            let newFallback;\r\n            if (isVarDependant(fallback)) {\r\n                newFallback = replaceCSSVariablesNames(\r\n                    fallback,\r\n                    nameReplacer,\r\n                    fallbackReplacer\r\n                );\r\n            } else if (fallbackReplacer) {\r\n                newFallback = fallbackReplacer(fallback);\r\n            } else {\r\n                newFallback = fallback;\r\n            }\r\n            return \`var(\${newName}, \${newFallback})\`;\r\n        };\r\n        return replaceVariablesMatches(value, matchReplacer);\r\n    }\r\n    function iterateVarDependencies(value, iterator) {\r\n        replaceCSSVariablesNames(value, (varName) => {\r\n            iterator(varName);\r\n            return varName;\r\n        });\r\n    }\r\n    function wrapBgColorVariableName(name) {\r\n        return \`--darkreader-bg\${name}\`;\r\n    }\r\n    function wrapTextColorVariableName(name) {\r\n        return \`--darkreader-text\${name}\`;\r\n    }\r\n    function wrapBorderColorVariableName(name) {\r\n        return \`--darkreader-border\${name}\`;\r\n    }\r\n    function wrapBgImgVariableName(name) {\r\n        return \`--darkreader-bgimg\${name}\`;\r\n    }\r\n    function isVariable(property) {\r\n        return property.startsWith("--");\r\n    }\r\n    function isVarDependant(value) {\r\n        return value.includes("var(");\r\n    }\r\n    function isConstructedColorVar(value) {\r\n        return value.match(/^\\s*(rgb|hsl)a?\\(/);\r\n    }\r\n    function isTextColorProperty(property) {\r\n        return (\r\n            property === "color" ||\r\n            property === "caret-color" ||\r\n            property === "-webkit-text-fill-color"\r\n        );\r\n    }\r\n    const rawRGBSpaceRegex = /^(\\d{1,3})\\s+(\\d{1,3})\\s+(\\d{1,3})$/;\r\n    const rawRGBCommaRegex = /^(\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})$/;\r\n    function parseRawColorValue(input) {\r\n        const match =\r\n            input.match(rawRGBSpaceRegex) ?? input.match(rawRGBCommaRegex);\r\n        if (match) {\r\n            const color = \`rgb(\${match[1]}, \${match[2]}, \${match[3]})\`;\r\n            return {isRaw: true, color};\r\n        }\r\n        return {isRaw: false, color: input};\r\n    }\r\n    function handleRawColorValue(input, theme, modifyFunction) {\r\n        const {isRaw, color} = parseRawColorValue(input);\r\n        const rgb = parseColorWithCache(color);\r\n        if (rgb) {\r\n            const outputColor = modifyFunction(rgb, theme);\r\n            if (isRaw) {\r\n                const outputInRGB = parseColorWithCache(outputColor);\r\n                return outputInRGB\r\n                    ? \`\${outputInRGB.r}, \${outputInRGB.g}, \${outputInRGB.b}\`\r\n                    : outputColor;\r\n            }\r\n            return outputColor;\r\n        }\r\n        return color;\r\n    }\r\n    function tryModifyBgColor(color, theme) {\r\n        return handleRawColorValue(color, theme, modifyBackgroundColor);\r\n    }\r\n    function tryModifyTextColor(color, theme) {\r\n        return handleRawColorValue(color, theme, modifyForegroundColor);\r\n    }\r\n    function tryModifyBorderColor(color, theme) {\r\n        return handleRawColorValue(color, theme, modifyBorderColor);\r\n    }\r\n    function insertVarValues(source, varValues, stack = new Set()) {\r\n        let containsUnresolvedVar = false;\r\n        const matchReplacer = (match) => {\r\n            const {name, fallback} = getVariableNameAndFallback(match);\r\n            if (stack.has(name)) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            stack.add(name);\r\n            const varValue = varValues.get(name) || fallback;\r\n            let inserted = null;\r\n            if (varValue) {\r\n                if (isVarDependant(varValue)) {\r\n                    inserted = insertVarValues(varValue, varValues, stack);\r\n                } else {\r\n                    inserted = varValue;\r\n                }\r\n            }\r\n            if (!inserted) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            return inserted;\r\n        };\r\n        const replaced = replaceVariablesMatches(source, matchReplacer);\r\n        if (containsUnresolvedVar) {\r\n            return null;\r\n        }\r\n        return replaced;\r\n    }\r\n\r\n    const overrides$1 = {\r\n        "background-color": {\r\n            customProp: "--darkreader-inline-bgcolor",\r\n            cssProp: "background-color",\r\n            dataAttr: "data-darkreader-inline-bgcolor"\r\n        },\r\n        "background-image": {\r\n            customProp: "--darkreader-inline-bgimage",\r\n            cssProp: "background-image",\r\n            dataAttr: "data-darkreader-inline-bgimage"\r\n        },\r\n        "border-color": {\r\n            customProp: "--darkreader-inline-border",\r\n            cssProp: "border-color",\r\n            dataAttr: "data-darkreader-inline-border"\r\n        },\r\n        "border-bottom-color": {\r\n            customProp: "--darkreader-inline-border-bottom",\r\n            cssProp: "border-bottom-color",\r\n            dataAttr: "data-darkreader-inline-border-bottom"\r\n        },\r\n        "border-left-color": {\r\n            customProp: "--darkreader-inline-border-left",\r\n            cssProp: "border-left-color",\r\n            dataAttr: "data-darkreader-inline-border-left"\r\n        },\r\n        "border-right-color": {\r\n            customProp: "--darkreader-inline-border-right",\r\n            cssProp: "border-right-color",\r\n            dataAttr: "data-darkreader-inline-border-right"\r\n        },\r\n        "border-top-color": {\r\n            customProp: "--darkreader-inline-border-top",\r\n            cssProp: "border-top-color",\r\n            dataAttr: "data-darkreader-inline-border-top"\r\n        },\r\n        "box-shadow": {\r\n            customProp: "--darkreader-inline-boxshadow",\r\n            cssProp: "box-shadow",\r\n            dataAttr: "data-darkreader-inline-boxshadow"\r\n        },\r\n        "color": {\r\n            customProp: "--darkreader-inline-color",\r\n            cssProp: "color",\r\n            dataAttr: "data-darkreader-inline-color"\r\n        },\r\n        "fill": {\r\n            customProp: "--darkreader-inline-fill",\r\n            cssProp: "fill",\r\n            dataAttr: "data-darkreader-inline-fill"\r\n        },\r\n        "stroke": {\r\n            customProp: "--darkreader-inline-stroke",\r\n            cssProp: "stroke",\r\n            dataAttr: "data-darkreader-inline-stroke"\r\n        },\r\n        "outline-color": {\r\n            customProp: "--darkreader-inline-outline",\r\n            cssProp: "outline-color",\r\n            dataAttr: "data-darkreader-inline-outline"\r\n        },\r\n        "stop-color": {\r\n            customProp: "--darkreader-inline-stopcolor",\r\n            cssProp: "stop-color",\r\n            dataAttr: "data-darkreader-inline-stopcolor"\r\n        }\r\n    };\r\n    const shorthandOverrides = {\r\n        background: {\r\n            customProp: "--darkreader-inline-bg",\r\n            cssProp: "background",\r\n            dataAttr: "data-darkreader-inline-bg"\r\n        }\r\n    };\r\n    const overridesList = Object.values(overrides$1);\r\n    const normalizedPropList = {};\r\n    overridesList.forEach(\r\n        ({cssProp, customProp}) => (normalizedPropList[customProp] = cssProp)\r\n    );\r\n    const INLINE_STYLE_ATTRS = [\r\n        "style",\r\n        "fill",\r\n        "stop-color",\r\n        "stroke",\r\n        "bgcolor",\r\n        "color",\r\n        "background"\r\n    ];\r\n    const INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(\r\n        (attr) => \`[\${attr}]\`\r\n    ).join(", ");\r\n    function getInlineOverrideStyle() {\r\n        const allOverrides = overridesList.concat(\r\n            Object.values(shorthandOverrides)\r\n        );\r\n        return allOverrides\r\n            .map(({dataAttr, customProp, cssProp}) => {\r\n                return [\r\n                    \`[\${dataAttr}] {\`,\r\n                    \`  \${cssProp}: var(\${customProp}) !important;\`,\r\n                    "}"\r\n                ].join("\\n");\r\n            })\r\n            .join("\\n");\r\n    }\r\n    function getInlineStyleElements(root) {\r\n        const results = [];\r\n        if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\r\n            results.push(root);\r\n        }\r\n        if (\r\n            root instanceof Element ||\r\n            (isShadowDomSupported && root instanceof ShadowRoot) ||\r\n            root instanceof Document\r\n        ) {\r\n            push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        }\r\n        return results;\r\n    }\r\n    const treeObservers = new Map();\r\n    const attrObservers = new Map();\r\n    function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\r\n        deepWatchForInlineStyles(\r\n            document,\r\n            elementStyleDidChange,\r\n            shadowRootDiscovered\r\n        );\r\n        iterateShadowHosts(document.documentElement, (host) => {\r\n            deepWatchForInlineStyles(\r\n                host.shadowRoot,\r\n                elementStyleDidChange,\r\n                shadowRootDiscovered\r\n            );\r\n        });\r\n    }\r\n    function deepWatchForInlineStyles(\r\n        root,\r\n        elementStyleDidChange,\r\n        shadowRootDiscovered\r\n    ) {\r\n        if (treeObservers.has(root)) {\r\n            treeObservers.get(root).disconnect();\r\n            attrObservers.get(root).disconnect();\r\n        }\r\n        const discoveredNodes = new WeakSet();\r\n        function discoverNodes(node) {\r\n            getInlineStyleElements(node).forEach((el) => {\r\n                if (discoveredNodes.has(el)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(el);\r\n                elementStyleDidChange(el);\r\n            });\r\n            iterateShadowHosts(node, (n) => {\r\n                if (discoveredNodes.has(node)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(node);\r\n                shadowRootDiscovered(n.shadowRoot);\r\n                deepWatchForInlineStyles(\r\n                    n.shadowRoot,\r\n                    elementStyleDidChange,\r\n                    shadowRootDiscovered\r\n                );\r\n            });\r\n            variablesStore.matchVariablesAndDependents();\r\n        }\r\n        const treeObserver = createOptimizedTreeObserver(root, {\r\n            onMinorMutations: (_root, {additions}) => {\r\n                additions.forEach((added) => discoverNodes(added));\r\n            },\r\n            onHugeMutations: () => {\r\n                discoverNodes(root);\r\n            }\r\n        });\r\n        treeObservers.set(root, treeObserver);\r\n        let attemptCount = 0;\r\n        let start = null;\r\n        const ATTEMPTS_INTERVAL = getDuration({seconds: 10});\r\n        const RETRY_TIMEOUT = getDuration({seconds: 2});\r\n        const MAX_ATTEMPTS_COUNT = 50;\r\n        let cache = [];\r\n        let timeoutId = null;\r\n        const handleAttributeMutations = throttle((mutations) => {\r\n            const handledTargets = new Set();\r\n            mutations.forEach((m) => {\r\n                const target = m.target;\r\n                if (handledTargets.has(target)) {\r\n                    return;\r\n                }\r\n                if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\r\n                    handledTargets.add(target);\r\n                    elementStyleDidChange(target);\r\n                }\r\n            });\r\n            variablesStore.matchVariablesAndDependents();\r\n        });\r\n        const attrObserver = new MutationObserver((mutations) => {\r\n            if (timeoutId) {\r\n                cache.push(...mutations);\r\n                return;\r\n            }\r\n            attemptCount++;\r\n            const now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            } else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(() => {\r\n                        start = null;\r\n                        attemptCount = 0;\r\n                        timeoutId = null;\r\n                        const attributeCache = cache;\r\n                        cache = [];\r\n                        handleAttributeMutations(attributeCache);\r\n                    }, RETRY_TIMEOUT);\r\n                    cache.push(...mutations);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attemptCount = 1;\r\n            }\r\n            handleAttributeMutations(mutations);\r\n        });\r\n        attrObserver.observe(root, {\r\n            attributes: true,\r\n            attributeFilter: INLINE_STYLE_ATTRS.concat(\r\n                overridesList.map(({dataAttr}) => dataAttr)\r\n            ),\r\n            subtree: true\r\n        });\r\n        attrObservers.set(root, attrObserver);\r\n    }\r\n    function stopWatchingForInlineStyles() {\r\n        treeObservers.forEach((o) => o.disconnect());\r\n        attrObservers.forEach((o) => o.disconnect());\r\n        treeObservers.clear();\r\n        attrObservers.clear();\r\n    }\r\n    const inlineStyleCache = new WeakMap();\r\n    const themeProps = ["brightness", "contrast", "grayscale", "sepia", "mode"];\r\n    function getInlineStyleCacheKey(el, theme) {\r\n        return INLINE_STYLE_ATTRS.map(\r\n            (attr) => \`\${attr}="\${el.getAttribute(attr)}"\`\r\n        )\r\n            .concat(themeProps.map((prop) => \`\${prop}="\${theme[prop]}"\`))\r\n            .join(" ");\r\n    }\r\n    function shouldIgnoreInlineStyle(element, selectors) {\r\n        for (let i = 0, len = selectors.length; i < len; i++) {\r\n            const ingnoredSelector = selectors[i];\r\n            if (element.matches(ingnoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function overrideInlineStyle(\r\n        element,\r\n        theme,\r\n        ignoreInlineSelectors,\r\n        ignoreImageSelectors\r\n    ) {\r\n        const cacheKey = getInlineStyleCacheKey(element, theme);\r\n        if (cacheKey === inlineStyleCache.get(element)) {\r\n            return;\r\n        }\r\n        const unsetProps = new Set(Object.keys(overrides$1));\r\n        function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\r\n            const mod = getModifiableCSSDeclaration(\r\n                modifierCSSProp,\r\n                cssVal,\r\n                {style: element.style},\r\n                variablesStore,\r\n                ignoreImageSelectors,\r\n                null\r\n            );\r\n            if (!mod) {\r\n                return;\r\n            }\r\n            function setStaticValue(value) {\r\n                const {customProp, dataAttr} =\r\n                    overrides$1[targetCSSProp] ??\r\n                    shorthandOverrides[targetCSSProp];\r\n                element.style.setProperty(customProp, value);\r\n                if (!element.hasAttribute(dataAttr)) {\r\n                    element.setAttribute(dataAttr, "");\r\n                }\r\n                unsetProps.delete(targetCSSProp);\r\n            }\r\n            function setVarDeclaration(mod) {\r\n                let prevDeclarations = [];\r\n                function setProps(declarations) {\r\n                    prevDeclarations.forEach(({property}) => {\r\n                        element.style.removeProperty(property);\r\n                    });\r\n                    declarations.forEach(({property, value}) => {\r\n                        if (!(value instanceof Promise)) {\r\n                            element.style.setProperty(property, value);\r\n                        }\r\n                    });\r\n                    prevDeclarations = declarations;\r\n                }\r\n                setProps(mod.declarations);\r\n                mod.onTypeChange.addListener(setProps);\r\n            }\r\n            function setAsyncValue(promise, sourceValue) {\r\n                promise.then((value) => {\r\n                    if (\r\n                        value &&\r\n                        targetCSSProp === "background" &&\r\n                        value.startsWith("var(--darkreader-bg--")\r\n                    ) {\r\n                        setStaticValue(value);\r\n                    }\r\n                    if (value && targetCSSProp === "background-image") {\r\n                        if (\r\n                            (element === document.documentElement ||\r\n                                element === document.body) &&\r\n                            value === sourceValue\r\n                        ) {\r\n                            value = "none";\r\n                        }\r\n                        setStaticValue(value);\r\n                    }\r\n                    inlineStyleCache.set(\r\n                        element,\r\n                        getInlineStyleCacheKey(element, theme)\r\n                    );\r\n                });\r\n            }\r\n            const value =\r\n                typeof mod.value === "function" ? mod.value(theme) : mod.value;\r\n            if (typeof value === "string") {\r\n                setStaticValue(value);\r\n            } else if (value instanceof Promise) {\r\n                setAsyncValue(value, cssVal);\r\n            } else if (typeof value === "object") {\r\n                setVarDeclaration(value);\r\n            }\r\n        }\r\n        if (ignoreInlineSelectors.length > 0) {\r\n            if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\r\n                unsetProps.forEach((cssProp) => {\r\n                    element.removeAttribute(overrides$1[cssProp].dataAttr);\r\n                });\r\n                return;\r\n            }\r\n        }\r\n        if (element.hasAttribute("bgcolor")) {\r\n            let value = element.getAttribute("bgcolor");\r\n            if (\r\n                value.match(/^[0-9a-f]{3}$/i) ||\r\n                value.match(/^[0-9a-f]{6}$/i)\r\n            ) {\r\n                value = \`#\${value}\`;\r\n            }\r\n            setCustomProp("background-color", "background-color", value);\r\n        }\r\n        if (\r\n            (element === document.documentElement ||\r\n                element === document.body) &&\r\n            element.hasAttribute("background")\r\n        ) {\r\n            const url = getAbsoluteURL(\r\n                location.href,\r\n                element.getAttribute("background") ?? ""\r\n            );\r\n            const value = \`url("\${url}")\`;\r\n            setCustomProp("background-image", "background-image", value);\r\n        }\r\n        if (element.hasAttribute("color") && element.rel !== "mask-icon") {\r\n            let value = element.getAttribute("color");\r\n            if (\r\n                value.match(/^[0-9a-f]{3}$/i) ||\r\n                value.match(/^[0-9a-f]{6}$/i)\r\n            ) {\r\n                value = \`#\${value}\`;\r\n            }\r\n            setCustomProp("color", "color", value);\r\n        }\r\n        if (element instanceof SVGElement) {\r\n            if (element.hasAttribute("fill")) {\r\n                const SMALL_SVG_LIMIT = 32;\r\n                const value = element.getAttribute("fill");\r\n                if (value !== "none") {\r\n                    if (!(element instanceof SVGTextElement)) {\r\n                        const handleSVGElement = () => {\r\n                            const {width, height} =\r\n                                element.getBoundingClientRect();\r\n                            const isBg =\r\n                                width > SMALL_SVG_LIMIT ||\r\n                                height > SMALL_SVG_LIMIT;\r\n                            setCustomProp(\r\n                                "fill",\r\n                                isBg ? "background-color" : "color",\r\n                                value\r\n                            );\r\n                        };\r\n                        if (isReadyStateComplete()) {\r\n                            handleSVGElement();\r\n                        } else {\r\n                            addReadyStateCompleteListener(handleSVGElement);\r\n                        }\r\n                    } else {\r\n                        setCustomProp("fill", "color", value);\r\n                    }\r\n                }\r\n            }\r\n            if (element.hasAttribute("stop-color")) {\r\n                setCustomProp(\r\n                    "stop-color",\r\n                    "background-color",\r\n                    element.getAttribute("stop-color")\r\n                );\r\n            }\r\n        }\r\n        if (element.hasAttribute("stroke")) {\r\n            const value = element.getAttribute("stroke");\r\n            setCustomProp(\r\n                "stroke",\r\n                element instanceof SVGLineElement ||\r\n                    element instanceof SVGTextElement\r\n                    ? "border-color"\r\n                    : "color",\r\n                value\r\n            );\r\n        }\r\n        element.style &&\r\n            iterateCSSDeclarations(element.style, (property, value) => {\r\n                if (property === "background-image" && value.includes("url")) {\r\n                    if (\r\n                        element === document.documentElement ||\r\n                        element === document.body\r\n                    ) {\r\n                        setCustomProp(property, property, value);\r\n                    }\r\n                    return;\r\n                }\r\n                if (\r\n                    overrides$1.hasOwnProperty(property) ||\r\n                    (property.startsWith("--") && !normalizedPropList[property])\r\n                ) {\r\n                    setCustomProp(property, property, value);\r\n                } else if (\r\n                    property === "background" &&\r\n                    value.includes("var(")\r\n                ) {\r\n                    setCustomProp("background", "background", value);\r\n                } else {\r\n                    const overriddenProp = normalizedPropList[property];\r\n                    if (\r\n                        overriddenProp &&\r\n                        !element.style.getPropertyValue(overriddenProp) &&\r\n                        !element.hasAttribute(overriddenProp)\r\n                    ) {\r\n                        if (\r\n                            overriddenProp === "background-color" &&\r\n                            element.hasAttribute("bgcolor")\r\n                        ) {\r\n                            return;\r\n                        }\r\n                        element.style.setProperty(property, "");\r\n                    }\r\n                }\r\n            });\r\n        if (\r\n            element.style &&\r\n            element instanceof SVGTextElement &&\r\n            element.style.fill\r\n        ) {\r\n            setCustomProp(\r\n                "fill",\r\n                "color",\r\n                element.style.getPropertyValue("fill")\r\n            );\r\n        }\r\n        if (element.getAttribute("style")?.includes("--")) {\r\n            variablesStore.addInlineStyleForMatching(element.style);\r\n        }\r\n        forEach(unsetProps, (cssProp) => {\r\n            element.removeAttribute(overrides$1[cssProp].dataAttr);\r\n        });\r\n        inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\r\n    }\r\n\r\n    const metaThemeColorName = "theme-color";\r\n    const metaThemeColorSelector = \`meta[name="\${metaThemeColorName}"]\`;\r\n    let srcMetaThemeColor = null;\r\n    let observer = null;\r\n    function changeMetaThemeColor(meta, theme) {\r\n        srcMetaThemeColor = srcMetaThemeColor || meta.content;\r\n        const color = parseColorWithCache(srcMetaThemeColor);\r\n        if (!color) {\r\n            return;\r\n        }\r\n        meta.content = modifyBackgroundColor(color, theme);\r\n    }\r\n    function changeMetaThemeColorWhenAvailable(theme) {\r\n        const meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta) {\r\n            changeMetaThemeColor(meta, theme);\r\n        } else {\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = new MutationObserver((mutations) => {\r\n                loop: for (let i = 0; i < mutations.length; i++) {\r\n                    const {addedNodes} = mutations[i];\r\n                    for (let j = 0; j < addedNodes.length; j++) {\r\n                        const node = addedNodes[j];\r\n                        if (\r\n                            node instanceof HTMLMetaElement &&\r\n                            node.name === metaThemeColorName\r\n                        ) {\r\n                            observer.disconnect();\r\n                            observer = null;\r\n                            changeMetaThemeColor(node, theme);\r\n                            break loop;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            observer.observe(document.head, {childList: true});\r\n        }\r\n    }\r\n    function restoreMetaThemeColor() {\r\n        if (observer) {\r\n            observer.disconnect();\r\n            observer = null;\r\n        }\r\n        const meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta && srcMetaThemeColor) {\r\n            meta.content = srcMetaThemeColor;\r\n        }\r\n    }\r\n\r\n    const cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\r\n    function removeCSSComments(cssText) {\r\n        return cssText.replace(cssCommentsRegex, "");\r\n    }\r\n\r\n    const themeCacheKeys = [\r\n        "mode",\r\n        "brightness",\r\n        "contrast",\r\n        "grayscale",\r\n        "sepia",\r\n        "darkSchemeBackgroundColor",\r\n        "darkSchemeTextColor",\r\n        "lightSchemeBackgroundColor",\r\n        "lightSchemeTextColor"\r\n    ];\r\n    function getThemeKey(theme) {\r\n        let resultKey = "";\r\n        themeCacheKeys.forEach((key) => {\r\n            resultKey += \`\${key}:\${theme[key]};\`;\r\n        });\r\n        return resultKey;\r\n    }\r\n    const asyncQueue = createAsyncTasksQueue();\r\n    function createStyleSheetModifier() {\r\n        let renderId = 0;\r\n        function getStyleRuleHash(rule) {\r\n            let cssText = rule.cssText;\r\n            if (isMediaRule(rule.parentRule)) {\r\n                cssText = \`\${rule.parentRule.media.mediaText} { \${cssText} }\`;\r\n            }\r\n            return getHashCode(cssText);\r\n        }\r\n        const rulesTextCache = new Set();\r\n        const rulesModCache = new Map();\r\n        const varTypeChangeCleaners = new Set();\r\n        let prevFilterKey = null;\r\n        let hasNonLoadedLink = false;\r\n        let wasRebuilt = false;\r\n        function shouldRebuildStyle() {\r\n            return hasNonLoadedLink && !wasRebuilt;\r\n        }\r\n        function modifySheet(options) {\r\n            const rules = options.sourceCSSRules;\r\n            const {\r\n                theme,\r\n                ignoreImageAnalysis,\r\n                force,\r\n                prepareSheet,\r\n                isAsyncCancelled\r\n            } = options;\r\n            let rulesChanged = rulesModCache.size === 0;\r\n            const notFoundCacheKeys = new Set(rulesModCache.keys());\r\n            const themeKey = getThemeKey(theme);\r\n            const themeChanged = themeKey !== prevFilterKey;\r\n            if (hasNonLoadedLink) {\r\n                wasRebuilt = true;\r\n            }\r\n            const modRules = [];\r\n            iterateCSSRules(\r\n                rules,\r\n                (rule) => {\r\n                    const hash = getStyleRuleHash(rule);\r\n                    let textDiffersFromPrev = false;\r\n                    notFoundCacheKeys.delete(hash);\r\n                    if (!rulesTextCache.has(hash)) {\r\n                        rulesTextCache.add(hash);\r\n                        textDiffersFromPrev = true;\r\n                    }\r\n                    if (textDiffersFromPrev) {\r\n                        rulesChanged = true;\r\n                    } else {\r\n                        modRules.push(rulesModCache.get(hash));\r\n                        return;\r\n                    }\r\n                    if (rule.style.all === "revert") {\r\n                        return;\r\n                    }\r\n                    const modDecs = [];\r\n                    rule.style &&\r\n                        iterateCSSDeclarations(\r\n                            rule.style,\r\n                            (property, value) => {\r\n                                const mod = getModifiableCSSDeclaration(\r\n                                    property,\r\n                                    value,\r\n                                    rule,\r\n                                    variablesStore,\r\n                                    ignoreImageAnalysis,\r\n                                    isAsyncCancelled\r\n                                );\r\n                                if (mod) {\r\n                                    modDecs.push(mod);\r\n                                }\r\n                            }\r\n                        );\r\n                    let modRule = null;\r\n                    if (modDecs.length > 0) {\r\n                        const parentRule = rule.parentRule;\r\n                        modRule = {\r\n                            selector: rule.selectorText,\r\n                            declarations: modDecs,\r\n                            parentRule\r\n                        };\r\n                        modRules.push(modRule);\r\n                    }\r\n                    rulesModCache.set(hash, modRule);\r\n                },\r\n                () => {\r\n                    hasNonLoadedLink = true;\r\n                }\r\n            );\r\n            notFoundCacheKeys.forEach((key) => {\r\n                rulesTextCache.delete(key);\r\n                rulesModCache.delete(key);\r\n            });\r\n            prevFilterKey = themeKey;\r\n            if (!force && !rulesChanged && !themeChanged) {\r\n                return;\r\n            }\r\n            renderId++;\r\n            function setRule(target, index, rule) {\r\n                const {selector, declarations} = rule;\r\n                let selectorText = selector;\r\n                const emptyIsWhereSelector =\r\n                    isChromium &&\r\n                    selector.startsWith(":is(") &&\r\n                    (selector.includes(":is()") ||\r\n                        selector.includes(":where()") ||\r\n                        (selector.includes(":where(") &&\r\n                            selector.includes(":-moz")));\r\n                const viewTransitionSelector =\r\n                    selector.includes("::view-transition-");\r\n                if (emptyIsWhereSelector || viewTransitionSelector) {\r\n                    selectorText = ".darkreader-unsupported-selector";\r\n                }\r\n                let ruleText = \`\${selectorText} {\`;\r\n                for (const dec of declarations) {\r\n                    const {property, value, important} = dec;\r\n                    if (value) {\r\n                        ruleText += \` \${property}: \${value}\${important ? " !important" : ""};\`;\r\n                    }\r\n                }\r\n                ruleText += " }";\r\n                target.insertRule(ruleText, index);\r\n            }\r\n            const asyncDeclarations = new Map();\r\n            const varDeclarations = new Map();\r\n            let asyncDeclarationCounter = 0;\r\n            let varDeclarationCounter = 0;\r\n            const rootReadyGroup = {rule: null, rules: [], isGroup: true};\r\n            const groupRefs = new WeakMap();\r\n            function getGroup(rule) {\r\n                if (rule == null) {\r\n                    return rootReadyGroup;\r\n                }\r\n                if (groupRefs.has(rule)) {\r\n                    return groupRefs.get(rule);\r\n                }\r\n                const group = {rule, rules: [], isGroup: true};\r\n                groupRefs.set(rule, group);\r\n                const parentGroup = getGroup(rule.parentRule);\r\n                parentGroup.rules.push(group);\r\n                return group;\r\n            }\r\n            varTypeChangeCleaners.forEach((clear) => clear());\r\n            varTypeChangeCleaners.clear();\r\n            modRules\r\n                .filter((r) => r)\r\n                .forEach(({selector, declarations, parentRule}) => {\r\n                    const group = getGroup(parentRule);\r\n                    const readyStyleRule = {\r\n                        selector,\r\n                        declarations: [],\r\n                        isGroup: false\r\n                    };\r\n                    const readyDeclarations = readyStyleRule.declarations;\r\n                    group.rules.push(readyStyleRule);\r\n                    function handleAsyncDeclaration(\r\n                        property,\r\n                        modified,\r\n                        important,\r\n                        sourceValue\r\n                    ) {\r\n                        const asyncKey = ++asyncDeclarationCounter;\r\n                        const asyncDeclaration = {\r\n                            property,\r\n                            value: null,\r\n                            important,\r\n                            asyncKey,\r\n                            sourceValue\r\n                        };\r\n                        readyDeclarations.push(asyncDeclaration);\r\n                        const currentRenderId = renderId;\r\n                        modified.then((asyncValue) => {\r\n                            if (\r\n                                !asyncValue ||\r\n                                isAsyncCancelled() ||\r\n                                currentRenderId !== renderId\r\n                            ) {\r\n                                return;\r\n                            }\r\n                            asyncDeclaration.value = asyncValue;\r\n                            asyncQueue.add(() => {\r\n                                if (\r\n                                    isAsyncCancelled() ||\r\n                                    currentRenderId !== renderId\r\n                                ) {\r\n                                    return;\r\n                                }\r\n                                rebuildAsyncRule(asyncKey);\r\n                            });\r\n                        });\r\n                    }\r\n                    function handleVarDeclarations(\r\n                        property,\r\n                        modified,\r\n                        important,\r\n                        sourceValue\r\n                    ) {\r\n                        const {declarations: varDecs, onTypeChange} = modified;\r\n                        const varKey = ++varDeclarationCounter;\r\n                        const currentRenderId = renderId;\r\n                        const initialIndex = readyDeclarations.length;\r\n                        let oldDecs = [];\r\n                        if (varDecs.length === 0) {\r\n                            const tempDec = {\r\n                                property,\r\n                                value: sourceValue,\r\n                                important,\r\n                                sourceValue,\r\n                                varKey\r\n                            };\r\n                            readyDeclarations.push(tempDec);\r\n                            oldDecs = [tempDec];\r\n                        }\r\n                        varDecs.forEach((mod) => {\r\n                            if (mod.value instanceof Promise) {\r\n                                handleAsyncDeclaration(\r\n                                    mod.property,\r\n                                    mod.value,\r\n                                    important,\r\n                                    sourceValue\r\n                                );\r\n                            } else {\r\n                                const readyDec = {\r\n                                    property: mod.property,\r\n                                    value: mod.value,\r\n                                    important,\r\n                                    sourceValue,\r\n                                    varKey\r\n                                };\r\n                                readyDeclarations.push(readyDec);\r\n                                oldDecs.push(readyDec);\r\n                            }\r\n                        });\r\n                        onTypeChange.addListener((newDecs) => {\r\n                            if (\r\n                                isAsyncCancelled() ||\r\n                                currentRenderId !== renderId\r\n                            ) {\r\n                                return;\r\n                            }\r\n                            const readyVarDecs = newDecs.map((mod) => {\r\n                                return {\r\n                                    property: mod.property,\r\n                                    value: mod.value,\r\n                                    important,\r\n                                    sourceValue,\r\n                                    varKey\r\n                                };\r\n                            });\r\n                            const index = readyDeclarations.indexOf(\r\n                                oldDecs[0],\r\n                                initialIndex\r\n                            );\r\n                            readyDeclarations.splice(\r\n                                index,\r\n                                oldDecs.length,\r\n                                ...readyVarDecs\r\n                            );\r\n                            oldDecs = readyVarDecs;\r\n                            rebuildVarRule(varKey);\r\n                        });\r\n                        varTypeChangeCleaners.add(() =>\r\n                            onTypeChange.removeListeners()\r\n                        );\r\n                    }\r\n                    declarations.forEach(\r\n                        ({property, value, important, sourceValue}) => {\r\n                            if (typeof value === "function") {\r\n                                const modified = value(theme);\r\n                                if (modified instanceof Promise) {\r\n                                    handleAsyncDeclaration(\r\n                                        property,\r\n                                        modified,\r\n                                        important,\r\n                                        sourceValue\r\n                                    );\r\n                                } else if (property.startsWith("--")) {\r\n                                    handleVarDeclarations(\r\n                                        property,\r\n                                        modified,\r\n                                        important,\r\n                                        sourceValue\r\n                                    );\r\n                                } else {\r\n                                    readyDeclarations.push({\r\n                                        property,\r\n                                        value: modified,\r\n                                        important,\r\n                                        sourceValue\r\n                                    });\r\n                                }\r\n                            } else {\r\n                                readyDeclarations.push({\r\n                                    property,\r\n                                    value,\r\n                                    important,\r\n                                    sourceValue\r\n                                });\r\n                            }\r\n                        }\r\n                    );\r\n                });\r\n            const sheet = prepareSheet();\r\n            function buildStyleSheet() {\r\n                function createTarget(group, parent) {\r\n                    const {rule} = group;\r\n                    if (isMediaRule(rule)) {\r\n                        const {media} = rule;\r\n                        const index = parent.cssRules.length;\r\n                        parent.insertRule(\r\n                            \`@media \${media.mediaText} {}\`,\r\n                            index\r\n                        );\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    if (isLayerRule(rule)) {\r\n                        const {name} = rule;\r\n                        const index = parent.cssRules.length;\r\n                        parent.insertRule(\`@layer \${name} {}\`, index);\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    return parent;\r\n                }\r\n                function iterateReadyRules(group, target, styleIterator) {\r\n                    group.rules.forEach((r) => {\r\n                        if (r.isGroup) {\r\n                            const t = createTarget(r, target);\r\n                            iterateReadyRules(r, t, styleIterator);\r\n                        } else {\r\n                            styleIterator(r, target);\r\n                        }\r\n                    });\r\n                }\r\n                iterateReadyRules(rootReadyGroup, sheet, (rule, target) => {\r\n                    const index = target.cssRules.length;\r\n                    rule.declarations.forEach(({asyncKey, varKey}) => {\r\n                        if (asyncKey != null) {\r\n                            asyncDeclarations.set(asyncKey, {\r\n                                rule,\r\n                                target,\r\n                                index\r\n                            });\r\n                        }\r\n                        if (varKey != null) {\r\n                            varDeclarations.set(varKey, {rule, target, index});\r\n                        }\r\n                    });\r\n                    setRule(target, index, rule);\r\n                });\r\n            }\r\n            function rebuildAsyncRule(key) {\r\n                const {rule, target, index} = asyncDeclarations.get(key);\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n                asyncDeclarations.delete(key);\r\n            }\r\n            function rebuildVarRule(key) {\r\n                const {rule, target, index} = varDeclarations.get(key);\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n            }\r\n            buildStyleSheet();\r\n        }\r\n        return {modifySheet, shouldRebuildStyle};\r\n    }\r\n\r\n    let canUseSheetProxy$1 = false;\r\n    document.addEventListener(\r\n        "__darkreader__inlineScriptsAllowed",\r\n        () => (canUseSheetProxy$1 = true),\r\n        {once: true}\r\n    );\r\n    function createSheetWatcher(\r\n        element,\r\n        safeGetSheetRules,\r\n        callback,\r\n        isCancelled\r\n    ) {\r\n        let rafSheetWatcher = null;\r\n        function watchForSheetChanges() {\r\n            watchForSheetChangesUsingProxy();\r\n            if (!(canUseSheetProxy$1 && element.sheet)) {\r\n                rafSheetWatcher = createRAFSheetWatcher(\r\n                    element,\r\n                    safeGetSheetRules,\r\n                    callback,\r\n                    isCancelled\r\n                );\r\n                rafSheetWatcher.start();\r\n            }\r\n        }\r\n        let areSheetChangesPending = false;\r\n        function onSheetChange() {\r\n            canUseSheetProxy$1 = true;\r\n            rafSheetWatcher?.stop();\r\n            if (areSheetChangesPending) {\r\n                return;\r\n            }\r\n            function handleSheetChanges() {\r\n                areSheetChangesPending = false;\r\n                if (isCancelled()) {\r\n                    return;\r\n                }\r\n                callback();\r\n            }\r\n            areSheetChangesPending = true;\r\n            queueMicrotask(handleSheetChanges);\r\n        }\r\n        function watchForSheetChangesUsingProxy() {\r\n            element.addEventListener(\r\n                "__darkreader__updateSheet",\r\n                onSheetChange\r\n            );\r\n        }\r\n        function stopWatchingForSheetChangesUsingProxy() {\r\n            element.removeEventListener(\r\n                "__darkreader__updateSheet",\r\n                onSheetChange\r\n            );\r\n        }\r\n        function stopWatchingForSheetChanges() {\r\n            stopWatchingForSheetChangesUsingProxy();\r\n            rafSheetWatcher?.stop();\r\n        }\r\n        return {\r\n            start: watchForSheetChanges,\r\n            stop: stopWatchingForSheetChanges\r\n        };\r\n    }\r\n    function createRAFSheetWatcher(\r\n        element,\r\n        safeGetSheetRules,\r\n        callback,\r\n        isCancelled\r\n    ) {\r\n        let rulesChangeKey = null;\r\n        let rulesCheckFrameId = null;\r\n        function getRulesChangeKey() {\r\n            const rules = safeGetSheetRules();\r\n            return rules ? rules.length : null;\r\n        }\r\n        function didRulesKeyChange() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        function watchForSheetChangesUsingRAF() {\r\n            rulesChangeKey = getRulesChangeKey();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            const checkForUpdate = () => {\r\n                const cancelled = isCancelled();\r\n                if (!cancelled && didRulesKeyChange()) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    callback();\r\n                }\r\n                if (cancelled || (canUseSheetProxy$1 && element.sheet)) {\r\n                    stopWatchingForSheetChangesUsingRAF();\r\n                    return;\r\n                }\r\n                rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\r\n            };\r\n            checkForUpdate();\r\n        }\r\n        function stopWatchingForSheetChangesUsingRAF() {\r\n            rulesCheckFrameId && cancelAnimationFrame(rulesCheckFrameId);\r\n        }\r\n        return {\r\n            start: watchForSheetChangesUsingRAF,\r\n            stop: stopWatchingForSheetChangesUsingRAF\r\n        };\r\n    }\r\n\r\n    const STYLE_SELECTOR = 'style, link[rel*="stylesheet" i]:not([disabled])';\r\n    function isFontsGoogleApiStyle(element) {\r\n        if (!element.href) {\r\n            return false;\r\n        }\r\n        try {\r\n            const elementURL = new URL(element.href);\r\n            return elementURL.hostname === "fonts.googleapis.com";\r\n        } catch (err) {\r\n            logInfo(\`Couldn't construct \${element.href} as URL\`);\r\n            return false;\r\n        }\r\n    }\r\n    const hostsBreakingOnSVGStyleOverride = ["www.onet.pl"];\r\n    function shouldManageStyle(element) {\r\n        return (\r\n            (element instanceof HTMLStyleElement ||\r\n                (element instanceof SVGStyleElement &&\r\n                    !hostsBreakingOnSVGStyleOverride.includes(\r\n                        location.hostname\r\n                    )) ||\r\n                (element instanceof HTMLLinkElement &&\r\n                    Boolean(element.rel) &&\r\n                    element.rel.toLowerCase().includes("stylesheet") &&\r\n                    Boolean(element.href) &&\r\n                    !element.disabled &&\r\n                    (isFirefox\r\n                        ? !element.href.startsWith("moz-extension://")\r\n                        : true) &&\r\n                    !isFontsGoogleApiStyle(element))) &&\r\n            !element.classList.contains("darkreader") &&\r\n            element.media.toLowerCase() !== "print" &&\r\n            !element.classList.contains("stylus")\r\n        );\r\n    }\r\n    function getManageableStyles(node, results = [], deep = true) {\r\n        if (shouldManageStyle(node)) {\r\n            results.push(node);\r\n        } else if (\r\n            node instanceof Element ||\r\n            (isShadowDomSupported && node instanceof ShadowRoot) ||\r\n            node === document\r\n        ) {\r\n            forEach(node.querySelectorAll(STYLE_SELECTOR), (style) =>\r\n                getManageableStyles(style, results, false)\r\n            );\r\n            if (deep) {\r\n                iterateShadowHosts(node, (host) =>\r\n                    getManageableStyles(host.shadowRoot, results, false)\r\n                );\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    const syncStyleSet = new WeakSet();\r\n    const corsStyleSet = new WeakSet();\r\n    let loadingLinkCounter = 0;\r\n    const rejectorsForLoadingLinks = new Map();\r\n    function cleanLoadingLinks() {\r\n        rejectorsForLoadingLinks.clear();\r\n    }\r\n    function manageStyle(element, {update, loadingStart, loadingEnd}) {\r\n        const prevStyles = [];\r\n        let next = element;\r\n        while (\r\n            (next = next.nextElementSibling) &&\r\n            next.matches(".darkreader")\r\n        ) {\r\n            prevStyles.push(next);\r\n        }\r\n        let corsCopy =\r\n            prevStyles.find(\r\n                (el) => el.matches(".darkreader--cors") && !corsStyleSet.has(el)\r\n            ) || null;\r\n        let syncStyle =\r\n            prevStyles.find(\r\n                (el) => el.matches(".darkreader--sync") && !syncStyleSet.has(el)\r\n            ) || null;\r\n        let corsCopyPositionWatcher = null;\r\n        let syncStylePositionWatcher = null;\r\n        let cancelAsyncOperations = false;\r\n        let isOverrideEmpty = true;\r\n        const isAsyncCancelled = () => cancelAsyncOperations;\r\n        const sheetModifier = createStyleSheetModifier();\r\n        const observer = new MutationObserver((mutations) => {\r\n            if (\r\n                mutations.some((m) => m.type === "characterData") &&\r\n                containsCSSImport()\r\n            ) {\r\n                const cssText = (element.textContent ?? "").trim();\r\n                createOrUpdateCORSCopy(cssText, location.href).then(update);\r\n            } else {\r\n                update();\r\n            }\r\n        });\r\n        const observerOptions = {\r\n            attributes: true,\r\n            childList: true,\r\n            subtree: true,\r\n            characterData: true\r\n        };\r\n        function containsCSSImport() {\r\n            if (!(element instanceof HTMLStyleElement)) {\r\n                return false;\r\n            }\r\n            const cssText = removeCSSComments(element.textContent ?? "").trim();\r\n            return cssText.match(cssImportRegex);\r\n        }\r\n        function hasImports(cssRules, checkCrossOrigin) {\r\n            let result = false;\r\n            if (cssRules) {\r\n                let rule;\r\n                cssRulesLoop: for (\r\n                    let i = 0, len = cssRules.length;\r\n                    i < len;\r\n                    i++\r\n                ) {\r\n                    rule = cssRules[i];\r\n                    if (rule.href) {\r\n                        if (checkCrossOrigin) {\r\n                            if (\r\n                                !rule.href.startsWith(\r\n                                    "https://fonts.googleapis.com/"\r\n                                ) &&\r\n                                rule.href.startsWith("http") &&\r\n                                !rule.href.startsWith(location.origin)\r\n                            ) {\r\n                                result = true;\r\n                                break cssRulesLoop;\r\n                            }\r\n                        } else {\r\n                            result = true;\r\n                            break cssRulesLoop;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        function getRulesSync() {\r\n            if (corsCopy) {\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            if (containsCSSImport()) {\r\n                return null;\r\n            }\r\n            const cssRules = safeGetSheetRules();\r\n            if (\r\n                element instanceof HTMLLinkElement &&\r\n                !isRelativeHrefOnAbsolutePath(element.href) &&\r\n                hasImports(cssRules, false)\r\n            ) {\r\n                return null;\r\n            }\r\n            if (hasImports(cssRules, true)) {\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function insertStyle() {\r\n            if (corsCopy) {\r\n                if (element.nextSibling !== corsCopy) {\r\n                    element.parentNode.insertBefore(\r\n                        corsCopy,\r\n                        element.nextSibling\r\n                    );\r\n                }\r\n                if (corsCopy.nextSibling !== syncStyle) {\r\n                    element.parentNode.insertBefore(\r\n                        syncStyle,\r\n                        corsCopy.nextSibling\r\n                    );\r\n                }\r\n            } else if (element.nextSibling !== syncStyle) {\r\n                element.parentNode.insertBefore(syncStyle, element.nextSibling);\r\n            }\r\n        }\r\n        function createSyncStyle() {\r\n            syncStyle =\r\n                element instanceof SVGStyleElement\r\n                    ? document.createElementNS(\r\n                          "http://www.w3.org/2000/svg",\r\n                          "style"\r\n                      )\r\n                    : document.createElement("style");\r\n            syncStyle.classList.add("darkreader");\r\n            syncStyle.classList.add("darkreader--sync");\r\n            syncStyle.media = "screen";\r\n            if (element.title) {\r\n                syncStyle.title = element.title;\r\n            }\r\n            syncStyleSet.add(syncStyle);\r\n        }\r\n        let isLoadingRules = false;\r\n        let wasLoadingError = false;\r\n        const loadingLinkId = ++loadingLinkCounter;\r\n        async function getRulesAsync() {\r\n            let cssText;\r\n            let cssBasePath;\r\n            if (element instanceof HTMLLinkElement) {\r\n                let [cssRules, accessError] = getRulesOrError();\r\n                if (\r\n                    (isSafari && !element.sheet) ||\r\n                    (!isSafari && !cssRules && !accessError) ||\r\n                    isStillLoadingError(accessError)\r\n                ) {\r\n                    try {\r\n                        logInfo(\r\n                            \`Linkelement \${loadingLinkId} is not loaded yet and thus will be await for\`,\r\n                            element\r\n                        );\r\n                        await linkLoading(element, loadingLinkId);\r\n                    } catch (err) {\r\n                        wasLoadingError = true;\r\n                    }\r\n                    if (cancelAsyncOperations) {\r\n                        return null;\r\n                    }\r\n                    [cssRules, accessError] = getRulesOrError();\r\n                }\r\n                if (cssRules) {\r\n                    if (!hasImports(cssRules, false)) {\r\n                        return cssRules;\r\n                    }\r\n                }\r\n                cssText = await loadText(element.href);\r\n                cssBasePath = getCSSBaseBath(element.href);\r\n                if (cancelAsyncOperations) {\r\n                    return null;\r\n                }\r\n            } else if (containsCSSImport()) {\r\n                cssText = element.textContent.trim();\r\n                cssBasePath = getCSSBaseBath(location.href);\r\n            } else {\r\n                return null;\r\n            }\r\n            await createOrUpdateCORSCopy(cssText, cssBasePath);\r\n            if (corsCopy) {\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            return null;\r\n        }\r\n        async function createOrUpdateCORSCopy(cssText, cssBasePath) {\r\n            if (cssText) {\r\n                try {\r\n                    const fullCSSText = await replaceCSSImports(\r\n                        cssText,\r\n                        cssBasePath\r\n                    );\r\n                    if (corsCopy) {\r\n                        if (\r\n                            (corsCopy.textContent?.length ?? 0) <\r\n                            fullCSSText.length\r\n                        ) {\r\n                            corsCopy.textContent = fullCSSText;\r\n                        }\r\n                    } else {\r\n                        corsCopy = createCORSCopy(element, fullCSSText);\r\n                    }\r\n                } catch (err) {}\r\n                if (corsCopy) {\r\n                    corsCopyPositionWatcher = watchForNodePosition(\r\n                        corsCopy,\r\n                        "prev-sibling"\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        function details(options) {\r\n            const rules = getRulesSync();\r\n            if (!rules) {\r\n                if (options.secondRound) {\r\n                    return null;\r\n                }\r\n                if (isLoadingRules || wasLoadingError) {\r\n                    return null;\r\n                }\r\n                isLoadingRules = true;\r\n                loadingStart();\r\n                getRulesAsync()\r\n                    .then((results) => {\r\n                        isLoadingRules = false;\r\n                        loadingEnd();\r\n                        if (results) {\r\n                            update();\r\n                        }\r\n                    })\r\n                    .catch((err) => {\r\n                        isLoadingRules = false;\r\n                        loadingEnd();\r\n                    });\r\n                return null;\r\n            }\r\n            return {rules};\r\n        }\r\n        let forceRenderStyle = false;\r\n        function render(theme, ignoreImageAnalysis) {\r\n            const rules = getRulesSync();\r\n            if (!rules) {\r\n                return;\r\n            }\r\n            cancelAsyncOperations = false;\r\n            function removeCSSRulesFromSheet(sheet) {\r\n                if (!sheet) {\r\n                    return;\r\n                }\r\n                for (let i = sheet.cssRules.length - 1; i >= 0; i--) {\r\n                    sheet.deleteRule(i);\r\n                }\r\n            }\r\n            function prepareOverridesSheet() {\r\n                if (!syncStyle) {\r\n                    createSyncStyle();\r\n                }\r\n                syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n                insertStyle();\r\n                if (syncStyle.sheet == null) {\r\n                    syncStyle.textContent = "";\r\n                }\r\n                const sheet = syncStyle.sheet;\r\n                removeCSSRulesFromSheet(sheet);\r\n                if (syncStylePositionWatcher) {\r\n                    syncStylePositionWatcher.run();\r\n                } else {\r\n                    syncStylePositionWatcher = watchForNodePosition(\r\n                        syncStyle,\r\n                        "prev-sibling",\r\n                        () => {\r\n                            forceRenderStyle = true;\r\n                            buildOverrides();\r\n                        }\r\n                    );\r\n                }\r\n                return syncStyle.sheet;\r\n            }\r\n            function buildOverrides() {\r\n                const force = forceRenderStyle;\r\n                forceRenderStyle = false;\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme,\r\n                    ignoreImageAnalysis,\r\n                    force,\r\n                    isAsyncCancelled\r\n                });\r\n                isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\r\n                if (sheetModifier.shouldRebuildStyle()) {\r\n                    addReadyStateCompleteListener(() => update());\r\n                }\r\n            }\r\n            buildOverrides();\r\n        }\r\n        function getRulesOrError() {\r\n            try {\r\n                if (element.sheet == null) {\r\n                    return [null, null];\r\n                }\r\n                return [element.sheet.cssRules, null];\r\n            } catch (err) {\r\n                return [null, err];\r\n            }\r\n        }\r\n        function isStillLoadingError(error) {\r\n            return error && error.message && error.message.includes("loading");\r\n        }\r\n        function safeGetSheetRules() {\r\n            const [cssRules, err] = getRulesOrError();\r\n            if (err) {\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        const sheetChangeWatcher = createSheetWatcher(\r\n            element,\r\n            safeGetSheetRules,\r\n            update,\r\n            isAsyncCancelled\r\n        );\r\n        function pause() {\r\n            observer.disconnect();\r\n            cancelAsyncOperations = true;\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n            sheetChangeWatcher.stop();\r\n        }\r\n        function destroy() {\r\n            pause();\r\n            removeNode(corsCopy);\r\n            removeNode(syncStyle);\r\n            loadingEnd();\r\n            if (rejectorsForLoadingLinks.has(loadingLinkId)) {\r\n                const reject = rejectorsForLoadingLinks.get(loadingLinkId);\r\n                rejectorsForLoadingLinks.delete(loadingLinkId);\r\n                reject && reject();\r\n            }\r\n        }\r\n        function watch() {\r\n            observer.observe(element, observerOptions);\r\n            if (element instanceof HTMLStyleElement) {\r\n                sheetChangeWatcher.start();\r\n            }\r\n        }\r\n        const maxMoveCount = 10;\r\n        let moveCount = 0;\r\n        function restore() {\r\n            if (!syncStyle) {\r\n                return;\r\n            }\r\n            moveCount++;\r\n            if (moveCount > maxMoveCount) {\r\n                return;\r\n            }\r\n            insertStyle();\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.skip();\r\n            if (!isOverrideEmpty) {\r\n                forceRenderStyle = true;\r\n                update();\r\n            }\r\n        }\r\n        return {\r\n            details,\r\n            render,\r\n            pause,\r\n            destroy,\r\n            watch,\r\n            restore\r\n        };\r\n    }\r\n    async function linkLoading(link, loadingId) {\r\n        return new Promise((resolve, reject) => {\r\n            const cleanUp = () => {\r\n                link.removeEventListener("load", onLoad);\r\n                link.removeEventListener("error", onError);\r\n                rejectorsForLoadingLinks.delete(loadingId);\r\n            };\r\n            const onLoad = () => {\r\n                cleanUp();\r\n                resolve();\r\n            };\r\n            const onError = () => {\r\n                cleanUp();\r\n                reject(\r\n                    \`Linkelement \${loadingId} couldn't be loaded. \${link.href}\`\r\n                );\r\n            };\r\n            rejectorsForLoadingLinks.set(loadingId, () => {\r\n                cleanUp();\r\n                reject();\r\n            });\r\n            link.addEventListener("load", onLoad, {passive: true});\r\n            link.addEventListener("error", onError, {passive: true});\r\n            if (!link.href) {\r\n                onError();\r\n            }\r\n        });\r\n    }\r\n    function getCSSImportURL(importDeclaration) {\r\n        return getCSSURLValue(\r\n            importDeclaration\r\n                .substring(7)\r\n                .trim()\r\n                .replace(/;$/, "")\r\n                .replace(/screen$/, "")\r\n        );\r\n    }\r\n    async function loadText(url) {\r\n        if (url.startsWith("data:")) {\r\n            return await (await fetch(url)).text();\r\n        }\r\n        const parsedURL = new URL(url);\r\n        if (parsedURL.origin === location.origin) {\r\n            return await loadAsText(url, "text/css", location.origin);\r\n        }\r\n        return await bgFetch({\r\n            url,\r\n            responseType: "text",\r\n            mimeType: "text/css",\r\n            origin: location.origin\r\n        });\r\n    }\r\n    async function replaceCSSImports(cssText, basePath, cache = new Map()) {\r\n        cssText = removeCSSComments(cssText);\r\n        cssText = replaceCSSFontFace(cssText);\r\n        cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\r\n        const importMatches = getMatches(cssImportRegex, cssText);\r\n        for (const match of importMatches) {\r\n            const importURL = getCSSImportURL(match);\r\n            const absoluteURL = getAbsoluteURL(basePath, importURL);\r\n            let importedCSS;\r\n            if (cache.has(absoluteURL)) {\r\n                importedCSS = cache.get(absoluteURL);\r\n            } else {\r\n                try {\r\n                    importedCSS = await loadText(absoluteURL);\r\n                    cache.set(absoluteURL, importedCSS);\r\n                    importedCSS = await replaceCSSImports(\r\n                        importedCSS,\r\n                        getCSSBaseBath(absoluteURL),\r\n                        cache\r\n                    );\r\n                } catch (err) {\r\n                    importedCSS = "";\r\n                }\r\n            }\r\n            cssText = cssText.split(match).join(importedCSS);\r\n        }\r\n        cssText = cssText.trim();\r\n        return cssText;\r\n    }\r\n    function createCORSCopy(srcElement, cssText) {\r\n        if (!cssText) {\r\n            return null;\r\n        }\r\n        const cors = document.createElement("style");\r\n        cors.classList.add("darkreader");\r\n        cors.classList.add("darkreader--cors");\r\n        cors.media = "screen";\r\n        cors.textContent = cssText;\r\n        srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\r\n        cors.sheet.disabled = true;\r\n        corsStyleSet.add(cors);\r\n        return cors;\r\n    }\r\n\r\n    const definedCustomElements = new Set();\r\n    const undefinedGroups = new Map();\r\n    let elementsDefinitionCallback;\r\n    function isCustomElement(element) {\r\n        if (element.tagName.includes("-") || element.getAttribute("is")) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    function recordUndefinedElement(element) {\r\n        let tag = element.tagName.toLowerCase();\r\n        if (!tag.includes("-")) {\r\n            const extendedTag = element.getAttribute("is");\r\n            if (extendedTag) {\r\n                tag = extendedTag;\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        if (!undefinedGroups.has(tag)) {\r\n            undefinedGroups.set(tag, new Set());\r\n            customElementsWhenDefined(tag).then(() => {\r\n                if (elementsDefinitionCallback) {\r\n                    const elements = undefinedGroups.get(tag);\r\n                    undefinedGroups.delete(tag);\r\n                    elementsDefinitionCallback(Array.from(elements));\r\n                }\r\n            });\r\n        }\r\n        undefinedGroups.get(tag).add(element);\r\n    }\r\n    function collectUndefinedElements(root) {\r\n        if (!isDefinedSelectorSupported) {\r\n            return;\r\n        }\r\n        forEach(\r\n            root.querySelectorAll(":not(:defined)"),\r\n            recordUndefinedElement\r\n        );\r\n    }\r\n    let canOptimizeUsingProxy = false;\r\n    document.addEventListener(\r\n        "__darkreader__inlineScriptsAllowed",\r\n        () => {\r\n            canOptimizeUsingProxy = true;\r\n        },\r\n        {once: true, passive: true}\r\n    );\r\n    const resolvers = new Map();\r\n    function handleIsDefined(e) {\r\n        canOptimizeUsingProxy = true;\r\n        const tag = e.detail.tag;\r\n        definedCustomElements.add(tag);\r\n        if (resolvers.has(tag)) {\r\n            const r = resolvers.get(tag);\r\n            resolvers.delete(tag);\r\n            r.forEach((r) => r());\r\n        }\r\n    }\r\n    async function customElementsWhenDefined(tag) {\r\n        if (definedCustomElements.has(tag)) {\r\n            return;\r\n        }\r\n        return new Promise((resolve) => {\r\n            if (\r\n                window.customElements &&\r\n                typeof customElements.whenDefined === "function"\r\n            ) {\r\n                customElements.whenDefined(tag).then(() => resolve());\r\n            } else if (canOptimizeUsingProxy) {\r\n                if (resolvers.has(tag)) {\r\n                    resolvers.get(tag).push(resolve);\r\n                } else {\r\n                    resolvers.set(tag, [resolve]);\r\n                }\r\n                document.dispatchEvent(\r\n                    new CustomEvent("__darkreader__addUndefinedResolver", {\r\n                        detail: {tag}\r\n                    })\r\n                );\r\n            } else {\r\n                const checkIfDefined = () => {\r\n                    const elements = undefinedGroups.get(tag);\r\n                    if (elements && elements.size > 0) {\r\n                        if (\r\n                            elements.values().next().value.matches(":defined")\r\n                        ) {\r\n                            resolve();\r\n                        } else {\r\n                            requestAnimationFrame(checkIfDefined);\r\n                        }\r\n                    }\r\n                };\r\n                requestAnimationFrame(checkIfDefined);\r\n            }\r\n        });\r\n    }\r\n    function watchWhenCustomElementsDefined(callback) {\r\n        elementsDefinitionCallback = callback;\r\n    }\r\n    function unsubscribeFromDefineCustomElements() {\r\n        elementsDefinitionCallback = null;\r\n        undefinedGroups.clear();\r\n        document.removeEventListener(\r\n            "__darkreader__isDefined",\r\n            handleIsDefined\r\n        );\r\n    }\r\n\r\n    const observers = [];\r\n    let observedRoots;\r\n    function watchForStylePositions(\r\n        currentStyles,\r\n        update,\r\n        shadowRootDiscovered\r\n    ) {\r\n        stopWatchingForStylePositions();\r\n        const prevStylesByRoot = new WeakMap();\r\n        const getPrevStyles = (root) => {\r\n            if (!prevStylesByRoot.has(root)) {\r\n                prevStylesByRoot.set(root, new Set());\r\n            }\r\n            return prevStylesByRoot.get(root);\r\n        };\r\n        currentStyles.forEach((node) => {\r\n            let root = node;\r\n            while ((root = root.parentNode)) {\r\n                if (\r\n                    root === document ||\r\n                    root.nodeType === Node.DOCUMENT_FRAGMENT_NODE\r\n                ) {\r\n                    const prevStyles = getPrevStyles(root);\r\n                    prevStyles.add(node);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n        const prevStyleSiblings = new WeakMap();\r\n        const nextStyleSiblings = new WeakMap();\r\n        function saveStylePosition(style) {\r\n            prevStyleSiblings.set(style, style.previousElementSibling);\r\n            nextStyleSiblings.set(style, style.nextElementSibling);\r\n        }\r\n        function forgetStylePosition(style) {\r\n            prevStyleSiblings.delete(style);\r\n            nextStyleSiblings.delete(style);\r\n        }\r\n        function didStylePositionChange(style) {\r\n            return (\r\n                style.previousElementSibling !== prevStyleSiblings.get(style) ||\r\n                style.nextElementSibling !== nextStyleSiblings.get(style)\r\n            );\r\n        }\r\n        currentStyles.forEach(saveStylePosition);\r\n        function handleStyleOperations(root, operations) {\r\n            const {createdStyles, removedStyles, movedStyles} = operations;\r\n            createdStyles.forEach((s) => saveStylePosition(s));\r\n            movedStyles.forEach((s) => saveStylePosition(s));\r\n            removedStyles.forEach((s) => forgetStylePosition(s));\r\n            const prevStyles = getPrevStyles(root);\r\n            createdStyles.forEach((s) => prevStyles.add(s));\r\n            removedStyles.forEach((s) => prevStyles.delete(s));\r\n            if (\r\n                createdStyles.size + removedStyles.size + movedStyles.size >\r\n                0\r\n            ) {\r\n                update({\r\n                    created: Array.from(createdStyles),\r\n                    removed: Array.from(removedStyles),\r\n                    moved: Array.from(movedStyles),\r\n                    updated: []\r\n                });\r\n            }\r\n        }\r\n        function handleMinorTreeMutations(root, {additions, moves, deletions}) {\r\n            const createdStyles = new Set();\r\n            const removedStyles = new Set();\r\n            const movedStyles = new Set();\r\n            additions.forEach((node) =>\r\n                getManageableStyles(node).forEach((style) =>\r\n                    createdStyles.add(style)\r\n                )\r\n            );\r\n            deletions.forEach((node) =>\r\n                getManageableStyles(node).forEach((style) =>\r\n                    removedStyles.add(style)\r\n                )\r\n            );\r\n            moves.forEach((node) =>\r\n                getManageableStyles(node).forEach((style) =>\r\n                    movedStyles.add(style)\r\n                )\r\n            );\r\n            handleStyleOperations(root, {\r\n                createdStyles,\r\n                removedStyles,\r\n                movedStyles\r\n            });\r\n            additions.forEach((n) => {\r\n                deepObserve(n);\r\n                collectUndefinedElements(n);\r\n            });\r\n            additions.forEach(\r\n                (node) => isCustomElement(node) && recordUndefinedElement(node)\r\n            );\r\n        }\r\n        function handleHugeTreeMutations(root) {\r\n            const styles = new Set(getManageableStyles(root));\r\n            const createdStyles = new Set();\r\n            const removedStyles = new Set();\r\n            const movedStyles = new Set();\r\n            const prevStyles = getPrevStyles(root);\r\n            styles.forEach((s) => {\r\n                if (!prevStyles.has(s)) {\r\n                    createdStyles.add(s);\r\n                }\r\n            });\r\n            prevStyles.forEach((s) => {\r\n                if (!styles.has(s)) {\r\n                    removedStyles.add(s);\r\n                }\r\n            });\r\n            styles.forEach((s) => {\r\n                if (\r\n                    !createdStyles.has(s) &&\r\n                    !removedStyles.has(s) &&\r\n                    didStylePositionChange(s)\r\n                ) {\r\n                    movedStyles.add(s);\r\n                }\r\n            });\r\n            handleStyleOperations(root, {\r\n                createdStyles,\r\n                removedStyles,\r\n                movedStyles\r\n            });\r\n            deepObserve(root);\r\n            collectUndefinedElements(root);\r\n        }\r\n        function handleAttributeMutations(mutations) {\r\n            const updatedStyles = new Set();\r\n            const removedStyles = new Set();\r\n            mutations.forEach((m) => {\r\n                const {target} = m;\r\n                if (target.isConnected) {\r\n                    if (shouldManageStyle(target)) {\r\n                        updatedStyles.add(target);\r\n                    } else if (\r\n                        target instanceof HTMLLinkElement &&\r\n                        target.disabled\r\n                    ) {\r\n                        removedStyles.add(target);\r\n                    }\r\n                }\r\n            });\r\n            if (updatedStyles.size + removedStyles.size > 0) {\r\n                update({\r\n                    updated: Array.from(updatedStyles),\r\n                    created: [],\r\n                    removed: Array.from(removedStyles),\r\n                    moved: []\r\n                });\r\n            }\r\n        }\r\n        function observe(root) {\r\n            if (observedRoots.has(root)) {\r\n                return;\r\n            }\r\n            const treeObserver = createOptimizedTreeObserver(root, {\r\n                onMinorMutations: handleMinorTreeMutations,\r\n                onHugeMutations: handleHugeTreeMutations\r\n            });\r\n            const attrObserver = new MutationObserver(handleAttributeMutations);\r\n            attrObserver.observe(root, {\r\n                attributeFilter: ["rel", "disabled", "media", "href"],\r\n                subtree: true\r\n            });\r\n            observers.push(treeObserver, attrObserver);\r\n            observedRoots.add(root);\r\n        }\r\n        function subscribeForShadowRootChanges(node) {\r\n            const {shadowRoot} = node;\r\n            if (shadowRoot == null || observedRoots.has(shadowRoot)) {\r\n                return;\r\n            }\r\n            observe(shadowRoot);\r\n            shadowRootDiscovered(shadowRoot);\r\n        }\r\n        function deepObserve(node) {\r\n            iterateShadowHosts(node, subscribeForShadowRootChanges);\r\n        }\r\n        observe(document);\r\n        deepObserve(document.documentElement);\r\n        watchWhenCustomElementsDefined((hosts) => {\r\n            const newStyles = [];\r\n            hosts.forEach((host) =>\r\n                push(newStyles, getManageableStyles(host.shadowRoot))\r\n            );\r\n            update({created: newStyles, updated: [], removed: [], moved: []});\r\n            hosts.forEach((host) => {\r\n                const {shadowRoot} = host;\r\n                if (shadowRoot == null) {\r\n                    return;\r\n                }\r\n                subscribeForShadowRootChanges(host);\r\n                deepObserve(shadowRoot);\r\n                collectUndefinedElements(shadowRoot);\r\n            });\r\n        });\r\n        document.addEventListener("__darkreader__isDefined", handleIsDefined);\r\n        collectUndefinedElements(document);\r\n    }\r\n    function resetObservers() {\r\n        observers.forEach((o) => o.disconnect());\r\n        observers.splice(0, observers.length);\r\n        observedRoots = new WeakSet();\r\n    }\r\n    function stopWatchingForStylePositions() {\r\n        resetObservers();\r\n        unsubscribeFromDefineCustomElements();\r\n    }\r\n\r\n    function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\r\n        watchForStylePositions(currentStyles, update, shadowRootDiscovered);\r\n    }\r\n    function stopWatchingForStyleChanges() {\r\n        stopWatchingForStylePositions();\r\n    }\r\n\r\n    let canUseSheetProxy = false;\r\n    document.addEventListener(\r\n        "__darkreader__inlineScriptsAllowed",\r\n        () => (canUseSheetProxy = true),\r\n        {once: true}\r\n    );\r\n    const overrides = new WeakSet();\r\n    const overridesBySource = new WeakMap();\r\n    function canHaveAdoptedStyleSheets(node) {\r\n        return Array.isArray(node.adoptedStyleSheets);\r\n    }\r\n    function createAdoptedStyleSheetOverride(node) {\r\n        let cancelAsyncOperations = false;\r\n        function iterateSourceSheets(iterator) {\r\n            node.adoptedStyleSheets.forEach((sheet) => {\r\n                if (!overrides.has(sheet)) {\r\n                    iterator(sheet);\r\n                }\r\n            });\r\n        }\r\n        function injectSheet(sheet, override) {\r\n            const newSheets = [...node.adoptedStyleSheets];\r\n            const sheetIndex = newSheets.indexOf(sheet);\r\n            const overrideIndex = newSheets.indexOf(override);\r\n            if (overrideIndex >= 0) {\r\n                newSheets.splice(overrideIndex, 1);\r\n            }\r\n            newSheets.splice(sheetIndex + 1, 0, override);\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function clear() {\r\n            const newSheets = [...node.adoptedStyleSheets];\r\n            for (let i = newSheets.length - 1; i >= 0; i--) {\r\n                const sheet = newSheets[i];\r\n                if (overrides.has(sheet)) {\r\n                    newSheets.splice(i, 1);\r\n                    overrides.delete(sheet);\r\n                }\r\n            }\r\n            if (node.adoptedStyleSheets.length !== newSheets.length) {\r\n                node.adoptedStyleSheets = newSheets;\r\n            }\r\n            sourceSheets = new WeakSet();\r\n            sourceDeclarations = new WeakSet();\r\n        }\r\n        const cleaners = [];\r\n        function destroy() {\r\n            cleaners.forEach((c) => c());\r\n            cleaners.splice(0);\r\n            cancelAsyncOperations = true;\r\n            clear();\r\n            if (frameId) {\r\n                cancelAnimationFrame(frameId);\r\n                frameId = null;\r\n            }\r\n        }\r\n        let rulesChangeKey = 0;\r\n        function getRulesChangeKey() {\r\n            let count = 0;\r\n            iterateSourceSheets((sheet) => {\r\n                count += sheet.cssRules.length;\r\n            });\r\n            if (count === 1) {\r\n                const rule = node.adoptedStyleSheets[0].cssRules[0];\r\n                return rule instanceof CSSStyleRule ? rule.style.length : count;\r\n            }\r\n            return count;\r\n        }\r\n        let sourceSheets = new WeakSet();\r\n        let sourceDeclarations = new WeakSet();\r\n        function render(theme, ignoreImageAnalysis) {\r\n            clear();\r\n            for (let i = node.adoptedStyleSheets.length - 1; i >= 0; i--) {\r\n                const sheet = node.adoptedStyleSheets[i];\r\n                if (overrides.has(sheet)) {\r\n                    continue;\r\n                }\r\n                sourceSheets.add(sheet);\r\n                const readyOverride = overridesBySource.get(sheet);\r\n                if (readyOverride) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    injectSheet(sheet, readyOverride);\r\n                    continue;\r\n                }\r\n                const rules = sheet.cssRules;\r\n                const override = new CSSStyleSheet();\r\n                overridesBySource.set(sheet, override);\r\n                iterateCSSRules(rules, (rule) =>\r\n                    sourceDeclarations.add(rule.style)\r\n                );\r\n                const prepareSheet = () => {\r\n                    for (let i = override.cssRules.length - 1; i >= 0; i--) {\r\n                        override.deleteRule(i);\r\n                    }\r\n                    override.insertRule("#__darkreader__adoptedOverride {}");\r\n                    injectSheet(sheet, override);\r\n                    overrides.add(override);\r\n                    return override;\r\n                };\r\n                const sheetModifier = createStyleSheetModifier();\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme,\r\n                    ignoreImageAnalysis,\r\n                    force: false,\r\n                    isAsyncCancelled: () => cancelAsyncOperations\r\n                });\r\n            }\r\n            rulesChangeKey = getRulesChangeKey();\r\n        }\r\n        let callbackRequested = false;\r\n        function handleArrayChange(callback) {\r\n            if (callbackRequested) {\r\n                return;\r\n            }\r\n            callbackRequested = true;\r\n            queueMicrotask(() => {\r\n                callbackRequested = false;\r\n                const sheets = node.adoptedStyleSheets.filter(\r\n                    (s) => !overrides.has(s)\r\n                );\r\n                sheets.forEach((sheet) => overridesBySource.delete(sheet));\r\n                callback(sheets);\r\n            });\r\n        }\r\n        function checkForUpdates() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        let frameId = null;\r\n        function watchUsingRAF(callback) {\r\n            frameId = requestAnimationFrame(() => {\r\n                if (canUseSheetProxy) {\r\n                    return;\r\n                }\r\n                if (checkForUpdates()) {\r\n                    handleArrayChange(callback);\r\n                }\r\n                watchUsingRAF(callback);\r\n            });\r\n        }\r\n        function addSheetChangeEventListener(type, listener) {\r\n            node.addEventListener(type, listener);\r\n            cleaners.push(() => node.removeEventListener(type, listener));\r\n        }\r\n        function watch(callback) {\r\n            const onAdoptedSheetsChange = () => {\r\n                canUseSheetProxy = true;\r\n                handleArrayChange(callback);\r\n            };\r\n            addSheetChangeEventListener(\r\n                "__darkreader__adoptedStyleSheetsChange",\r\n                onAdoptedSheetsChange\r\n            );\r\n            addSheetChangeEventListener(\r\n                "__darkreader__adoptedStyleSheetChange",\r\n                onAdoptedSheetsChange\r\n            );\r\n            addSheetChangeEventListener(\r\n                "__darkreader__adoptedStyleDeclarationChange",\r\n                onAdoptedSheetsChange\r\n            );\r\n            if (canUseSheetProxy) {\r\n                return;\r\n            }\r\n            watchUsingRAF(callback);\r\n        }\r\n        return {\r\n            render,\r\n            destroy,\r\n            watch\r\n        };\r\n    }\r\n    class StyleSheetCommandBuilder {\r\n        constructor(onChange) {\r\n            this.cssRules = [];\r\n            this.commands = [];\r\n            this.onChange = onChange;\r\n        }\r\n        insertRule(cssText, index = 0) {\r\n            this.commands.push({type: "insert", index, cssText});\r\n            this.cssRules.splice(\r\n                index,\r\n                0,\r\n                new StyleSheetCommandBuilder(this.onChange)\r\n            );\r\n            this.onChange();\r\n            return index;\r\n        }\r\n        deleteRule(index) {\r\n            this.commands.push({type: "delete", index});\r\n            this.cssRules.splice(index, 1);\r\n            this.onChange();\r\n        }\r\n        replaceSync(cssText) {\r\n            this.commands.splice(0);\r\n            this.commands.push({type: "replace", cssText});\r\n            if (cssText === "") {\r\n                this.cssRules.splice(0);\r\n            } else {\r\n                throw new Error(\r\n                    "StyleSheetCommandBuilder.replaceSync() is not fully supported"\r\n                );\r\n            }\r\n            this.onChange();\r\n        }\r\n        getDeepCSSCommands() {\r\n            const deep = [];\r\n            this.commands.forEach((command) => {\r\n                deep.push({\r\n                    type: command.type,\r\n                    cssText: command.type !== "delete" ? command.cssText : "",\r\n                    path: command.type === "replace" ? [] : [command.index]\r\n                });\r\n            });\r\n            this.cssRules.forEach((rule, i) => {\r\n                const childCommands = rule.getDeepCSSCommands();\r\n                childCommands.forEach((c) => c.path.unshift(i));\r\n            });\r\n            return deep;\r\n        }\r\n        clearDeepCSSCommands() {\r\n            this.commands.splice(0);\r\n            this.cssRules.forEach((rule) => rule.clearDeepCSSCommands());\r\n        }\r\n    }\r\n    function createAdoptedStyleSheetFallback(onChange) {\r\n        let cancelAsyncOperations = false;\r\n        let sourceCSSRules = [];\r\n        let lastTheme;\r\n        let lastIgnoreImageAnalysis;\r\n        function updateCSS(cssRules) {\r\n            sourceCSSRules = cssRules;\r\n            if (lastTheme && lastIgnoreImageAnalysis) {\r\n                render(lastTheme, lastIgnoreImageAnalysis);\r\n            }\r\n        }\r\n        const builder = new StyleSheetCommandBuilder(onChange);\r\n        function render(theme, ignoreImageAnalysis) {\r\n            lastTheme = theme;\r\n            lastIgnoreImageAnalysis = ignoreImageAnalysis;\r\n            const prepareSheet = () => {\r\n                builder.replaceSync("");\r\n                return builder;\r\n            };\r\n            const sheetModifier = createStyleSheetModifier();\r\n            sheetModifier.modifySheet({\r\n                prepareSheet,\r\n                sourceCSSRules,\r\n                theme,\r\n                ignoreImageAnalysis,\r\n                force: false,\r\n                isAsyncCancelled: () => cancelAsyncOperations\r\n            });\r\n        }\r\n        function commands() {\r\n            const commands = builder.getDeepCSSCommands();\r\n            builder.clearDeepCSSCommands();\r\n            return commands;\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n        }\r\n        return {render, destroy, updateCSS, commands};\r\n    }\r\n\r\n    function injectProxy(\r\n        enableStyleSheetsProxy,\r\n        enableCustomElementRegistryProxy\r\n    ) {\r\n        document.dispatchEvent(\r\n            new CustomEvent("__darkreader__inlineScriptsAllowed")\r\n        );\r\n        const cleaners = [];\r\n        function cleanUp() {\r\n            cleaners.forEach((clean) => clean());\r\n            cleaners.splice(0);\r\n        }\r\n        function documentEventListener(type, listener, options) {\r\n            document.addEventListener(type, listener, options);\r\n            cleaners.push(() => document.removeEventListener(type, listener));\r\n        }\r\n        documentEventListener("__darkreader__cleanUp", cleanUp);\r\n        function overrideProperty(cls, prop, overrides) {\r\n            const proto = cls.prototype;\r\n            const oldDescriptor = Object.getOwnPropertyDescriptor(proto, prop);\r\n            const newDescriptor = {...oldDescriptor};\r\n            Object.keys(overrides).forEach((key) => {\r\n                const factory = overrides[key];\r\n                newDescriptor[key] = factory(oldDescriptor[key]);\r\n            });\r\n            Object.defineProperty(proto, prop, newDescriptor);\r\n            cleaners.push(() =>\r\n                Object.defineProperty(proto, prop, oldDescriptor)\r\n            );\r\n        }\r\n        function override(cls, prop, factory) {\r\n            overrideProperty(cls, prop, {value: factory});\r\n        }\r\n        function isDRElement(element) {\r\n            return element?.classList?.contains("darkreader");\r\n        }\r\n        function isDRSheet(sheet) {\r\n            return isDRElement(sheet.ownerNode);\r\n        }\r\n        const updateSheetEvent = new CustomEvent("__darkreader__updateSheet");\r\n        const adoptedSheetChangeEvent = new CustomEvent(\r\n            "__darkreader__adoptedStyleSheetChange"\r\n        );\r\n        const adoptedSheetOwners = new WeakMap();\r\n        const adoptedDeclarationSheets = new WeakMap();\r\n        function onAdoptedSheetChange(sheet) {\r\n            const owners = adoptedSheetOwners.get(sheet);\r\n            owners?.forEach((node) => {\r\n                if (node.isConnected) {\r\n                    node.dispatchEvent(adoptedSheetChangeEvent);\r\n                } else {\r\n                    owners.delete(node);\r\n                }\r\n            });\r\n        }\r\n        function reportSheetChange(sheet) {\r\n            if (sheet.ownerNode && !isDRSheet(sheet)) {\r\n                sheet.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            if (adoptedSheetOwners.has(sheet)) {\r\n                onAdoptedSheetChange(sheet);\r\n            }\r\n        }\r\n        function reportSheetChangeAsync(sheet, promise) {\r\n            const {ownerNode} = sheet;\r\n            if (\r\n                ownerNode &&\r\n                !isDRSheet(sheet) &&\r\n                promise &&\r\n                promise instanceof Promise\r\n            ) {\r\n                promise.then(() => ownerNode.dispatchEvent(updateSheetEvent));\r\n            }\r\n            if (adoptedSheetOwners.has(sheet)) {\r\n                if (promise && promise instanceof Promise) {\r\n                    promise.then(() => onAdoptedSheetChange(sheet));\r\n                }\r\n            }\r\n        }\r\n        override(\r\n            CSSStyleSheet,\r\n            "addRule",\r\n            (native) =>\r\n                function (selector, style, index) {\r\n                    native.call(this, selector, style, index);\r\n                    reportSheetChange(this);\r\n                    return -1;\r\n                }\r\n        );\r\n        override(\r\n            CSSStyleSheet,\r\n            "insertRule",\r\n            (native) =>\r\n                function (rule, index) {\r\n                    const returnValue = native.call(this, rule, index);\r\n                    reportSheetChange(this);\r\n                    return returnValue;\r\n                }\r\n        );\r\n        override(\r\n            CSSStyleSheet,\r\n            "deleteRule",\r\n            (native) =>\r\n                function (index) {\r\n                    native.call(this, index);\r\n                    reportSheetChange(this);\r\n                }\r\n        );\r\n        override(\r\n            CSSStyleSheet,\r\n            "removeRule",\r\n            (native) =>\r\n                function (index) {\r\n                    native.call(this, index);\r\n                    reportSheetChange(this);\r\n                }\r\n        );\r\n        override(\r\n            CSSStyleSheet,\r\n            "replace",\r\n            (native) =>\r\n                function (cssText) {\r\n                    const returnValue = native.call(this, cssText);\r\n                    reportSheetChangeAsync(this, returnValue);\r\n                    return returnValue;\r\n                }\r\n        );\r\n        override(\r\n            CSSStyleSheet,\r\n            "replaceSync",\r\n            (native) =>\r\n                function (cssText) {\r\n                    native.call(this, cssText);\r\n                    reportSheetChange(this);\r\n                }\r\n        );\r\n        const shouldWrapHTMLElement =\r\n            location.hostname === "baidu.com" ||\r\n            location.hostname.endsWith(".baidu.com");\r\n        if (shouldWrapHTMLElement) {\r\n            override(\r\n                Element,\r\n                "getElementsByTagName",\r\n                (native) =>\r\n                    function (tagName) {\r\n                        if (tagName !== "style") {\r\n                            return native.call(this, tagName);\r\n                        }\r\n                        const getCurrentElementValue = () => {\r\n                            const elements = native.call(this, tagName);\r\n                            return Object.setPrototypeOf(\r\n                                [...elements].filter(\r\n                                    (element) =>\r\n                                        element && !isDRElement(element)\r\n                                ),\r\n                                NodeList.prototype\r\n                            );\r\n                        };\r\n                        let elements = getCurrentElementValue();\r\n                        const nodeListBehavior = {\r\n                            get: function (_, property) {\r\n                                return getCurrentElementValue()[\r\n                                    Number(property) || property\r\n                                ];\r\n                            }\r\n                        };\r\n                        elements = new Proxy(elements, nodeListBehavior);\r\n                        return elements;\r\n                    }\r\n            );\r\n        }\r\n        const shouldProxyChildNodes = ["brilliant.org", "www.vy.no"].includes(\r\n            location.hostname\r\n        );\r\n        if (shouldProxyChildNodes) {\r\n            overrideProperty(Node, "childNodes", {\r\n                get: (native) =>\r\n                    function () {\r\n                        const childNodes = native.call(this);\r\n                        return Object.setPrototypeOf(\r\n                            [...childNodes].filter((element) => {\r\n                                return !isDRElement(element);\r\n                            }),\r\n                            NodeList.prototype\r\n                        );\r\n                    }\r\n            });\r\n        }\r\n        function resolveCustomElement(tag) {\r\n            customElements.whenDefined(tag).then(() => {\r\n                document.dispatchEvent(\r\n                    new CustomEvent("__darkreader__isDefined", {detail: {tag}})\r\n                );\r\n            });\r\n        }\r\n        documentEventListener("__darkreader__addUndefinedResolver", (e) =>\r\n            resolveCustomElement(e.detail.tag)\r\n        );\r\n        if (enableCustomElementRegistryProxy) {\r\n            override(\r\n                CustomElementRegistry,\r\n                "define",\r\n                (native) =>\r\n                    function (name, constructor, options) {\r\n                        resolveCustomElement(name);\r\n                        native.call(this, name, constructor, options);\r\n                    }\r\n            );\r\n        }\r\n        async function checkBlobURLSupport() {\r\n            const svg =\r\n                '<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><rect width="1" height="1" fill="transparent"/></svg>';\r\n            const bytes = new Uint8Array(svg.length);\r\n            for (let i = 0; i < svg.length; i++) {\r\n                bytes[i] = svg.charCodeAt(i);\r\n            }\r\n            const blob = new Blob([bytes], {type: "image/svg+xml"});\r\n            const objectURL = URL.createObjectURL(blob);\r\n            let blobURLAllowed;\r\n            try {\r\n                const image = new Image();\r\n                await new Promise((resolve, reject) => {\r\n                    image.onload = () => resolve();\r\n                    image.onerror = () => reject();\r\n                    image.src = objectURL;\r\n                });\r\n                blobURLAllowed = true;\r\n            } catch (err) {\r\n                blobURLAllowed = false;\r\n            }\r\n            document.dispatchEvent(\r\n                new CustomEvent("__darkreader__blobURLCheckResponse", {\r\n                    detail: {blobURLAllowed}\r\n                })\r\n            );\r\n        }\r\n        documentEventListener(\r\n            "__darkreader__blobURLCheckRequest",\r\n            checkBlobURLSupport,\r\n            {once: true}\r\n        );\r\n        if (enableStyleSheetsProxy) {\r\n            overrideProperty(Document, "styleSheets", {\r\n                get: (native) =>\r\n                    function () {\r\n                        const getCurrentValue = () => {\r\n                            const docSheets = native.call(this);\r\n                            const filteredSheets = [...docSheets].filter(\r\n                                (styleSheet) =>\r\n                                    styleSheet.ownerNode &&\r\n                                    !isDRSheet(styleSheet)\r\n                            );\r\n                            filteredSheets.item = (item) =>\r\n                                filteredSheets[item];\r\n                            return Object.setPrototypeOf(\r\n                                filteredSheets,\r\n                                StyleSheetList.prototype\r\n                            );\r\n                        };\r\n                        let elements = getCurrentValue();\r\n                        const styleSheetListBehavior = {\r\n                            get: function (_, property) {\r\n                                return getCurrentValue()[property];\r\n                            }\r\n                        };\r\n                        elements = new Proxy(elements, styleSheetListBehavior);\r\n                        return elements;\r\n                    }\r\n            });\r\n        }\r\n        {\r\n            const adoptedSheetsSourceProxies = new WeakMap();\r\n            const adoptedSheetsProxySources = new WeakMap();\r\n            const adoptedSheetsChangeEvent = new CustomEvent(\r\n                "__darkreader__adoptedStyleSheetsChange"\r\n            );\r\n            const adoptedSheetOverrideCache = new WeakSet();\r\n            const adoptedSheetsSnapshots = new WeakMap();\r\n            const isDRAdoptedSheetOverride = (sheet) => {\r\n                if (!sheet || !sheet.cssRules) {\r\n                    return false;\r\n                }\r\n                if (adoptedSheetOverrideCache.has(sheet)) {\r\n                    return true;\r\n                }\r\n                if (\r\n                    sheet.cssRules.length > 0 &&\r\n                    sheet.cssRules[0].cssText.startsWith(\r\n                        "#__darkreader__adoptedOverride"\r\n                    )\r\n                ) {\r\n                    adoptedSheetOverrideCache.add(sheet);\r\n                    return true;\r\n                }\r\n                return false;\r\n            };\r\n            const areArraysEqual = (a, b) => {\r\n                return a.length === b.length && a.every((x, i) => x === b[i]);\r\n            };\r\n            const onAdoptedSheetsChange = (node) => {\r\n                const prev = adoptedSheetsSnapshots.get(node);\r\n                const curr = (node.adoptedStyleSheets || []).filter(\r\n                    (s) => !isDRAdoptedSheetOverride(s)\r\n                );\r\n                adoptedSheetsSnapshots.set(node, curr);\r\n                if (!prev || !areArraysEqual(prev, curr)) {\r\n                    curr.forEach((sheet) => {\r\n                        if (!adoptedSheetOwners.has(sheet)) {\r\n                            adoptedSheetOwners.set(sheet, new Set());\r\n                        }\r\n                        adoptedSheetOwners.get(sheet).add(node);\r\n                        for (const rule of sheet.cssRules) {\r\n                            const declaration = rule.style;\r\n                            if (declaration) {\r\n                                adoptedDeclarationSheets.set(\r\n                                    declaration,\r\n                                    sheet\r\n                                );\r\n                            }\r\n                        }\r\n                    });\r\n                    node.dispatchEvent(adoptedSheetsChangeEvent);\r\n                }\r\n            };\r\n            const proxyAdoptedSheetsArray = (node, source) => {\r\n                if (adoptedSheetsProxySources.has(source)) {\r\n                    return source;\r\n                }\r\n                if (adoptedSheetsSourceProxies.has(source)) {\r\n                    return adoptedSheetsSourceProxies.get(source);\r\n                }\r\n                const proxy = new Proxy(source, {\r\n                    deleteProperty(target, property) {\r\n                        delete target[property];\r\n                        return true;\r\n                    },\r\n                    set(target, property, value) {\r\n                        target[property] = value;\r\n                        if (property === "length") {\r\n                            onAdoptedSheetsChange(node);\r\n                        }\r\n                        return true;\r\n                    }\r\n                });\r\n                adoptedSheetsSourceProxies.set(source, proxy);\r\n                adoptedSheetsProxySources.set(proxy, source);\r\n                return proxy;\r\n            };\r\n            [Document, ShadowRoot].forEach((ctor) => {\r\n                overrideProperty(ctor, "adoptedStyleSheets", {\r\n                    get: (native) =>\r\n                        function () {\r\n                            const source = native.call(this);\r\n                            return proxyAdoptedSheetsArray(this, source);\r\n                        },\r\n                    set: (native) =>\r\n                        function (source) {\r\n                            if (adoptedSheetsProxySources.has(source)) {\r\n                                source = adoptedSheetsProxySources.get(source);\r\n                            }\r\n                            native.call(this, source);\r\n                            onAdoptedSheetsChange(this);\r\n                        }\r\n                });\r\n            });\r\n            const adoptedDeclarationChangeEvent = new CustomEvent(\r\n                "__darkreader__adoptedStyleDeclarationChange"\r\n            );\r\n            ["setProperty", "removeProperty"].forEach((key) => {\r\n                override(CSSStyleDeclaration, key, (native) => {\r\n                    return function (...args) {\r\n                        const returnValue = native.apply(this, args);\r\n                        const sheet = adoptedDeclarationSheets.get(this);\r\n                        if (sheet) {\r\n                            const owners = adoptedSheetOwners.get(sheet);\r\n                            if (owners) {\r\n                                owners.forEach((node) => {\r\n                                    node.dispatchEvent(\r\n                                        adoptedDeclarationChangeEvent\r\n                                    );\r\n                                });\r\n                            }\r\n                        }\r\n                        return returnValue;\r\n                    };\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    let documentVisibilityListener = null;\r\n    let documentIsVisible_ = !document.hidden;\r\n    const listenerOptions = {\r\n        capture: true,\r\n        passive: true\r\n    };\r\n    function watchForDocumentVisibility() {\r\n        document.addEventListener(\r\n            "visibilitychange",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.addEventListener(\r\n            "pageshow",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.addEventListener(\r\n            "focus",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n    }\r\n    function stopWatchingForDocumentVisibility() {\r\n        document.removeEventListener(\r\n            "visibilitychange",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.removeEventListener(\r\n            "pageshow",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n        window.removeEventListener(\r\n            "focus",\r\n            documentVisibilityListener,\r\n            listenerOptions\r\n        );\r\n    }\r\n    function setDocumentVisibilityListener(callback) {\r\n        const alreadyWatching = Boolean(documentVisibilityListener);\r\n        documentVisibilityListener = () => {\r\n            if (!document.hidden) {\r\n                removeDocumentVisibilityListener();\r\n                callback();\r\n                documentIsVisible_ = true;\r\n            }\r\n        };\r\n        if (!alreadyWatching) {\r\n            watchForDocumentVisibility();\r\n        }\r\n    }\r\n    function removeDocumentVisibilityListener() {\r\n        stopWatchingForDocumentVisibility();\r\n        documentVisibilityListener = null;\r\n    }\r\n    function documentIsVisible() {\r\n        return documentIsVisible_;\r\n    }\r\n\r\n    const INSTANCE_ID = generateUID();\r\n    const styleManagers = new Map();\r\n    const adoptedStyleManagers = [];\r\n    const adoptedStyleFallbacks = new Map();\r\n    const adoptedStyleNodeIds = new WeakMap();\r\n    const adoptedStyleChangeTokens = new WeakMap();\r\n    let theme = null;\r\n    let fixes = null;\r\n    let isIFrame$1 = null;\r\n    let ignoredImageAnalysisSelectors = [];\r\n    let ignoredInlineSelectors = [];\r\n    function createOrUpdateStyle(className, root = document.head || document) {\r\n        let element = root.querySelector(\`.\${className}\`);\r\n        if (!element) {\r\n            element = document.createElement("style");\r\n            element.classList.add("darkreader");\r\n            element.classList.add(className);\r\n            element.media = "screen";\r\n            element.textContent = "";\r\n        }\r\n        return element;\r\n    }\r\n    function createOrUpdateScript(className, root = document.head || document) {\r\n        let element = root.querySelector(\`.\${className}\`);\r\n        if (!element) {\r\n            element = document.createElement("script");\r\n            element.classList.add("darkreader");\r\n            element.classList.add(className);\r\n        }\r\n        return element;\r\n    }\r\n    const nodePositionWatchers = new Map();\r\n    function setupNodePositionWatcher(node, alias) {\r\n        nodePositionWatchers.has(alias) &&\r\n            nodePositionWatchers.get(alias).stop();\r\n        nodePositionWatchers.set(alias, watchForNodePosition(node, "head"));\r\n    }\r\n    function stopStylePositionWatchers() {\r\n        forEach(nodePositionWatchers.values(), (watcher) => watcher.stop());\r\n        nodePositionWatchers.clear();\r\n    }\r\n    function createStaticStyleOverrides() {\r\n        const fallbackStyle = createOrUpdateStyle(\r\n            "darkreader--fallback",\r\n            document\r\n        );\r\n        fallbackStyle.textContent = getModifiedFallbackStyle(theme, {\r\n            strict: true\r\n        });\r\n        document.head.insertBefore(fallbackStyle, document.head.firstChild);\r\n        setupNodePositionWatcher(fallbackStyle, "fallback");\r\n        const userAgentStyle = createOrUpdateStyle("darkreader--user-agent");\r\n        userAgentStyle.textContent = getModifiedUserAgentStyle(\r\n            theme,\r\n            isIFrame$1,\r\n            theme.styleSystemControls\r\n        );\r\n        document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(userAgentStyle, "user-agent");\r\n        const textStyle = createOrUpdateStyle("darkreader--text");\r\n        if (theme.useFont || theme.textStroke > 0) {\r\n            textStyle.textContent = createTextStyle(theme);\r\n        } else {\r\n            textStyle.textContent = "";\r\n        }\r\n        document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(textStyle, "text");\r\n        const invertStyle = createOrUpdateStyle("darkreader--invert");\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                \`\${fixes.invert.join(", ")} {\`,\r\n                \`    filter: \${getCSSFilterValue({\r\n                    ...theme,\r\n                    contrast:\r\n                        theme.mode === 0\r\n                            ? theme.contrast\r\n                            : clamp(theme.contrast - 10, 0, 100)\r\n                })} !important;\`,\r\n                "}"\r\n            ].join("\\n");\r\n        } else {\r\n            invertStyle.textContent = "";\r\n        }\r\n        document.head.insertBefore(invertStyle, textStyle.nextSibling);\r\n        setupNodePositionWatcher(invertStyle, "invert");\r\n        const inlineStyle = createOrUpdateStyle("darkreader--inline");\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\r\n        setupNodePositionWatcher(inlineStyle, "inline");\r\n        const overrideStyle = createOrUpdateStyle("darkreader--override");\r\n        overrideStyle.textContent =\r\n            fixes && fixes.css ? replaceCSSTemplates(fixes.css) : "";\r\n        document.head.appendChild(overrideStyle);\r\n        setupNodePositionWatcher(overrideStyle, "override");\r\n        const variableStyle = createOrUpdateStyle("darkreader--variables");\r\n        const selectionColors = getSelectionColor(theme);\r\n        const {\r\n            darkSchemeBackgroundColor,\r\n            darkSchemeTextColor,\r\n            lightSchemeBackgroundColor,\r\n            lightSchemeTextColor,\r\n            mode\r\n        } = theme;\r\n        let schemeBackgroundColor =\r\n            mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\r\n        let schemeTextColor =\r\n            mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\r\n        schemeBackgroundColor = modifyBackgroundColor(\r\n            parseColorWithCache(schemeBackgroundColor),\r\n            theme\r\n        );\r\n        schemeTextColor = modifyForegroundColor(\r\n            parseColorWithCache(schemeTextColor),\r\n            theme\r\n        );\r\n        variableStyle.textContent = [\r\n            \`:root {\`,\r\n            \`   --darkreader-neutral-background: \${schemeBackgroundColor};\`,\r\n            \`   --darkreader-neutral-text: \${schemeTextColor};\`,\r\n            \`   --darkreader-selection-background: \${selectionColors.backgroundColorSelection};\`,\r\n            \`   --darkreader-selection-text: \${selectionColors.foregroundColorSelection};\`,\r\n            \`}\`\r\n        ].join("\\n");\r\n        document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\r\n        setupNodePositionWatcher(variableStyle, "variables");\r\n        const rootVarsStyle = createOrUpdateStyle("darkreader--root-vars");\r\n        document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\r\n        const enableStyleSheetsProxy = !(\r\n            fixes && fixes.disableStyleSheetsProxy\r\n        );\r\n        const enableCustomElementRegistryProxy = !(\r\n            fixes && fixes.disableCustomElementRegistryProxy\r\n        );\r\n        document.dispatchEvent(new CustomEvent("__darkreader__cleanUp"));\r\n        {\r\n            const proxyScript = createOrUpdateScript("darkreader--proxy");\r\n            proxyScript.append(\r\n                \`(\${injectProxy})(\${enableStyleSheetsProxy}, \${enableCustomElementRegistryProxy})\`\r\n            );\r\n            document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\r\n            proxyScript.remove();\r\n        }\r\n    }\r\n    const shadowRootsWithOverrides = new Set();\r\n    function createShadowStaticStyleOverridesInner(root) {\r\n        const inlineStyle = createOrUpdateStyle("darkreader--inline", root);\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        root.insertBefore(inlineStyle, root.firstChild);\r\n        const overrideStyle = createOrUpdateStyle("darkreader--override", root);\r\n        overrideStyle.textContent =\r\n            fixes && fixes.css ? replaceCSSTemplates(fixes.css) : "";\r\n        root.insertBefore(overrideStyle, inlineStyle.nextSibling);\r\n        const invertStyle = createOrUpdateStyle("darkreader--invert", root);\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                \`\${fixes.invert.join(", ")} {\`,\r\n                \`    filter: \${getCSSFilterValue({\r\n                    ...theme,\r\n                    contrast:\r\n                        theme.mode === 0\r\n                            ? theme.contrast\r\n                            : clamp(theme.contrast - 10, 0, 100)\r\n                })} !important;\`,\r\n                "}"\r\n            ].join("\\n");\r\n        } else {\r\n            invertStyle.textContent = "";\r\n        }\r\n        root.insertBefore(invertStyle, overrideStyle.nextSibling);\r\n        shadowRootsWithOverrides.add(root);\r\n    }\r\n    function delayedCreateShadowStaticStyleOverrides(root) {\r\n        const observer = new MutationObserver((mutations, observer) => {\r\n            observer.disconnect();\r\n            for (const {type, removedNodes} of mutations) {\r\n                if (type === "childList") {\r\n                    for (const {nodeName, className} of removedNodes) {\r\n                        if (\r\n                            nodeName === "STYLE" &&\r\n                            [\r\n                                "darkreader darkreader--inline",\r\n                                "darkreader darkreader--override",\r\n                                "darkreader darkreader--invert"\r\n                            ].includes(className)\r\n                        ) {\r\n                            createShadowStaticStyleOverridesInner(root);\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        observer.observe(root, {childList: true});\r\n    }\r\n    function createShadowStaticStyleOverrides(root) {\r\n        const delayed = root.firstChild === null;\r\n        createShadowStaticStyleOverridesInner(root);\r\n        if (delayed) {\r\n            delayedCreateShadowStaticStyleOverrides(root);\r\n        }\r\n    }\r\n    function replaceCSSTemplates($cssText) {\r\n        return $cssText.replace(/\\\${(.+?)}/g, (_, $color) => {\r\n            const color = parseColorWithCache($color);\r\n            if (color) {\r\n                return modifyColor(color, theme);\r\n            }\r\n            return $color;\r\n        });\r\n    }\r\n    function cleanFallbackStyle() {\r\n        const fallback = document.querySelector(".darkreader--fallback");\r\n        if (fallback) {\r\n            fallback.textContent = "";\r\n        }\r\n    }\r\n    function createDynamicStyleOverrides() {\r\n        cancelRendering();\r\n        const allStyles = getManageableStyles(document);\r\n        const newManagers = allStyles\r\n            .filter((style) => !styleManagers.has(style))\r\n            .map((style) => createManager(style));\r\n        newManagers\r\n            .map((manager) => manager.details({secondRound: false}))\r\n            .filter((detail) => detail && detail.rules.length > 0)\r\n            .forEach((detail) => {\r\n                variablesStore.addRulesForMatching(detail.rules);\r\n            });\r\n        variablesStore.matchVariablesAndDependents();\r\n        variablesStore.setOnRootVariableChange(() => {\r\n            const rootVarsStyle = createOrUpdateStyle("darkreader--root-vars");\r\n            variablesStore.putRootVars(rootVarsStyle, theme);\r\n        });\r\n        const rootVarsStyle = createOrUpdateStyle("darkreader--root-vars");\r\n        variablesStore.putRootVars(rootVarsStyle, theme);\r\n        styleManagers.forEach((manager) =>\r\n            manager.render(theme, ignoredImageAnalysisSelectors)\r\n        );\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n        }\r\n        newManagers.forEach((manager) => manager.watch());\r\n        const inlineStyleElements = toArray(\r\n            document.querySelectorAll(INLINE_STYLE_SELECTOR)\r\n        );\r\n        iterateShadowHosts(document.documentElement, (host) => {\r\n            createShadowStaticStyleOverrides(host.shadowRoot);\r\n            const elements = host.shadowRoot.querySelectorAll(\r\n                INLINE_STYLE_SELECTOR\r\n            );\r\n            if (elements.length > 0) {\r\n                push(inlineStyleElements, elements);\r\n            }\r\n        });\r\n        inlineStyleElements.forEach((el) =>\r\n            overrideInlineStyle(\r\n                el,\r\n                theme,\r\n                ignoredInlineSelectors,\r\n                ignoredImageAnalysisSelectors\r\n            )\r\n        );\r\n        handleAdoptedStyleSheets(document);\r\n        variablesStore.matchVariablesAndDependents();\r\n        if (isFirefox) {\r\n            const MATCH_VAR = Symbol();\r\n            const onAdoptedCSSChange = (e) => {\r\n                const {node, id, cssRules, entries} = e.detail;\r\n                if (Array.isArray(entries)) {\r\n                    entries.forEach((e) => {\r\n                        const cssRules = e[2];\r\n                        variablesStore.addRulesForMatching(cssRules);\r\n                    });\r\n                    variablesStore.matchVariablesAndDependents();\r\n                } else if (cssRules) {\r\n                    variablesStore.addRulesForMatching(cssRules);\r\n                    requestAnimationFrameOnce(MATCH_VAR, () =>\r\n                        variablesStore.matchVariablesAndDependents()\r\n                    );\r\n                }\r\n                const tuples = Array.isArray(entries)\r\n                    ? entries\r\n                    : node && cssRules\r\n                      ? [[node, id, cssRules]]\r\n                      : [];\r\n                tuples.forEach(([node, id, cssRules]) => {\r\n                    adoptedStyleNodeIds.set(node, id);\r\n                    const fallback = getAdoptedStyleSheetFallback(node);\r\n                    fallback.updateCSS(cssRules);\r\n                });\r\n            };\r\n            document.addEventListener(\r\n                "__darkreader__adoptedStyleSheetsChange",\r\n                onAdoptedCSSChange\r\n            );\r\n            cleaners.push(() =>\r\n                document.removeEventListener(\r\n                    "__darkreader__adoptedStyleSheetsChange",\r\n                    onAdoptedCSSChange\r\n                )\r\n            );\r\n            document.dispatchEvent(\r\n                new CustomEvent("__darkreader__startAdoptedStyleSheetsWatcher")\r\n            );\r\n        }\r\n    }\r\n    let loadingStylesCounter = 0;\r\n    const loadingStyles = new Set();\r\n    function createManager(element) {\r\n        const loadingStyleId = ++loadingStylesCounter;\r\n        function loadingStart() {\r\n            if (!isDOMReady() || !documentIsVisible()) {\r\n                loadingStyles.add(loadingStyleId);\r\n                logInfo(\r\n                    \`Current amount of styles loading: \${loadingStyles.size}\`\r\n                );\r\n                const fallbackStyle = document.querySelector(\r\n                    ".darkreader--fallback"\r\n                );\r\n                if (!fallbackStyle.textContent) {\r\n                    fallbackStyle.textContent = getModifiedFallbackStyle(\r\n                        theme,\r\n                        {strict: false}\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        function loadingEnd() {\r\n            loadingStyles.delete(loadingStyleId);\r\n            logInfo(\r\n                \`Removed loadingStyle \${loadingStyleId}, now awaiting: \${loadingStyles.size}\`\r\n            );\r\n            if (loadingStyles.size === 0 && isDOMReady()) {\r\n                cleanFallbackStyle();\r\n            }\r\n        }\r\n        function update() {\r\n            const details = manager.details({secondRound: true});\r\n            if (!details) {\r\n                return;\r\n            }\r\n            variablesStore.addRulesForMatching(details.rules);\r\n            variablesStore.matchVariablesAndDependents();\r\n            manager.render(theme, ignoredImageAnalysisSelectors);\r\n        }\r\n        const manager = manageStyle(element, {\r\n            update,\r\n            loadingStart,\r\n            loadingEnd\r\n        });\r\n        styleManagers.set(element, manager);\r\n        return manager;\r\n    }\r\n    function removeManager(element) {\r\n        const manager = styleManagers.get(element);\r\n        if (manager) {\r\n            manager.destroy();\r\n            styleManagers.delete(element);\r\n        }\r\n    }\r\n    const throttledRenderAllStyles = throttle((callback) => {\r\n        styleManagers.forEach((manager) =>\r\n            manager.render(theme, ignoredImageAnalysisSelectors)\r\n        );\r\n        adoptedStyleManagers.forEach((manager) =>\r\n            manager.render(theme, ignoredImageAnalysisSelectors)\r\n        );\r\n        callback && callback();\r\n    });\r\n    const cancelRendering = function () {\r\n        throttledRenderAllStyles.cancel();\r\n    };\r\n    function onDOMReady() {\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n            return;\r\n        }\r\n    }\r\n    function runDynamicStyle() {\r\n        createDynamicStyleOverrides();\r\n        watchForUpdates();\r\n    }\r\n    function createThemeAndWatchForUpdates() {\r\n        createStaticStyleOverrides();\r\n        if (!documentIsVisible() && !theme.immediateModify) {\r\n            setDocumentVisibilityListener(runDynamicStyle);\r\n        } else {\r\n            runDynamicStyle();\r\n        }\r\n        changeMetaThemeColorWhenAvailable(theme);\r\n    }\r\n    function handleAdoptedStyleSheets(node) {\r\n        if (isFirefox) {\r\n            const fallback = getAdoptedStyleSheetFallback(node);\r\n            fallback.render(theme, ignoredImageAnalysisSelectors);\r\n            return;\r\n        }\r\n        if (canHaveAdoptedStyleSheets(node)) {\r\n            node.adoptedStyleSheets.forEach((s) => {\r\n                variablesStore.addRulesForMatching(s.cssRules);\r\n            });\r\n            const newManger = createAdoptedStyleSheetOverride(node);\r\n            adoptedStyleManagers.push(newManger);\r\n            newManger.render(theme, ignoredImageAnalysisSelectors);\r\n            newManger.watch((sheets) => {\r\n                sheets.forEach((s) => {\r\n                    variablesStore.addRulesForMatching(s.cssRules);\r\n                });\r\n                variablesStore.matchVariablesAndDependents();\r\n                newManger.render(theme, ignoredImageAnalysisSelectors);\r\n            });\r\n        }\r\n    }\r\n    function getAdoptedStyleChangeToken(node) {\r\n        if (adoptedStyleChangeTokens.has(node)) {\r\n            return adoptedStyleChangeTokens.get(node);\r\n        }\r\n        const token = Symbol();\r\n        adoptedStyleChangeTokens.set(node, token);\r\n        return token;\r\n    }\r\n    function getAdoptedStyleSheetFallback(node) {\r\n        let fallback = adoptedStyleFallbacks.get(node);\r\n        if (!fallback) {\r\n            fallback = createAdoptedStyleSheetFallback(() => {\r\n                const token = getAdoptedStyleChangeToken(node);\r\n                requestAnimationFrameOnce(token, () => {\r\n                    const id = adoptedStyleNodeIds.get(node);\r\n                    const commands = fallback?.commands();\r\n                    if (!id || !commands) {\r\n                        return;\r\n                    }\r\n                    const data = {id, commands};\r\n                    document.dispatchEvent(\r\n                        new CustomEvent(\r\n                            "__darkreader__adoptedStyleSheetCommands",\r\n                            {detail: JSON.stringify(data)}\r\n                        )\r\n                    );\r\n                });\r\n            });\r\n            adoptedStyleFallbacks.set(node, fallback);\r\n        }\r\n        return fallback;\r\n    }\r\n    function watchForUpdates() {\r\n        const managedStyles = Array.from(styleManagers.keys());\r\n        watchForStyleChanges(\r\n            managedStyles,\r\n            ({created, updated, removed, moved}) => {\r\n                const stylesToRemove = removed;\r\n                const stylesToManage = created\r\n                    .concat(updated)\r\n                    .concat(moved)\r\n                    .filter((style) => !styleManagers.has(style));\r\n                const stylesToRestore = moved.filter((style) =>\r\n                    styleManagers.has(style)\r\n                );\r\n                stylesToRemove.forEach((style) => removeManager(style));\r\n                const newManagers = stylesToManage.map((style) =>\r\n                    createManager(style)\r\n                );\r\n                newManagers\r\n                    .map((manager) => manager.details({secondRound: false}))\r\n                    .filter((detail) => detail && detail.rules.length > 0)\r\n                    .forEach((detail) => {\r\n                        variablesStore.addRulesForMatching(detail.rules);\r\n                    });\r\n                variablesStore.matchVariablesAndDependents();\r\n                newManagers.forEach((manager) =>\r\n                    manager.render(theme, ignoredImageAnalysisSelectors)\r\n                );\r\n                newManagers.forEach((manager) => manager.watch());\r\n                stylesToRestore.forEach((style) =>\r\n                    styleManagers.get(style).restore()\r\n                );\r\n            },\r\n            (shadowRoot) => {\r\n                createShadowStaticStyleOverrides(shadowRoot);\r\n                handleAdoptedStyleSheets(shadowRoot);\r\n            }\r\n        );\r\n        watchForInlineStyles(\r\n            (element) => {\r\n                overrideInlineStyle(\r\n                    element,\r\n                    theme,\r\n                    ignoredInlineSelectors,\r\n                    ignoredImageAnalysisSelectors\r\n                );\r\n                if (element === document.documentElement) {\r\n                    const styleAttr = element.getAttribute("style") || "";\r\n                    if (styleAttr.includes("--")) {\r\n                        variablesStore.matchVariablesAndDependents();\r\n                        const rootVarsStyle = createOrUpdateStyle(\r\n                            "darkreader--root-vars"\r\n                        );\r\n                        variablesStore.putRootVars(rootVarsStyle, theme);\r\n                    }\r\n                }\r\n            },\r\n            (root) => {\r\n                createShadowStaticStyleOverrides(root);\r\n                const inlineStyleElements = root.querySelectorAll(\r\n                    INLINE_STYLE_SELECTOR\r\n                );\r\n                if (inlineStyleElements.length > 0) {\r\n                    forEach(inlineStyleElements, (el) =>\r\n                        overrideInlineStyle(\r\n                            el,\r\n                            theme,\r\n                            ignoredInlineSelectors,\r\n                            ignoredImageAnalysisSelectors\r\n                        )\r\n                    );\r\n                }\r\n            }\r\n        );\r\n        addDOMReadyListener(onDOMReady);\r\n    }\r\n    function stopWatchingForUpdates() {\r\n        styleManagers.forEach((manager) => manager.pause());\r\n        stopStylePositionWatchers();\r\n        stopWatchingForStyleChanges();\r\n        stopWatchingForInlineStyles();\r\n        removeDOMReadyListener(onDOMReady);\r\n        cleanReadyStateCompleteListeners();\r\n    }\r\n    let metaObserver;\r\n    function addMetaListener() {\r\n        metaObserver = new MutationObserver(() => {\r\n            if (document.querySelector('meta[name="darkreader-lock"]')) {\r\n                metaObserver.disconnect();\r\n                removeDynamicTheme();\r\n            }\r\n        });\r\n        metaObserver.observe(document.head, {childList: true, subtree: true});\r\n    }\r\n    function createDarkReaderInstanceMarker() {\r\n        const metaElement = document.createElement("meta");\r\n        metaElement.name = "darkreader";\r\n        metaElement.content = INSTANCE_ID;\r\n        document.head.appendChild(metaElement);\r\n    }\r\n    function isAnotherDarkReaderInstanceActive() {\r\n        if (document.querySelector('meta[name="darkreader-lock"]')) {\r\n            return true;\r\n        }\r\n        const meta = document.querySelector('meta[name="darkreader"]');\r\n        if (meta) {\r\n            if (meta.content !== INSTANCE_ID) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        createDarkReaderInstanceMarker();\r\n        addMetaListener();\r\n        return false;\r\n    }\r\n    function createOrUpdateDynamicThemeInternal(\r\n        themeConfig,\r\n        dynamicThemeFixes,\r\n        iframe\r\n    ) {\r\n        theme = themeConfig;\r\n        fixes = dynamicThemeFixes;\r\n        if (fixes) {\r\n            ignoredImageAnalysisSelectors = Array.isArray(\r\n                fixes.ignoreImageAnalysis\r\n            )\r\n                ? fixes.ignoreImageAnalysis\r\n                : [];\r\n            ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle)\r\n                ? fixes.ignoreInlineStyle\r\n                : [];\r\n        } else {\r\n            ignoredImageAnalysisSelectors = [];\r\n            ignoredInlineSelectors = [];\r\n        }\r\n        if (theme.immediateModify) {\r\n            setIsDOMReady(() => {\r\n                return true;\r\n            });\r\n        }\r\n        isIFrame$1 = iframe;\r\n        if (document.head) {\r\n            if (isAnotherDarkReaderInstanceActive()) {\r\n                removeDynamicTheme();\r\n                return;\r\n            }\r\n            document.documentElement.setAttribute(\r\n                "data-darkreader-mode",\r\n                "dynamic"\r\n            );\r\n            document.documentElement.setAttribute(\r\n                "data-darkreader-scheme",\r\n                theme.mode ? "dark" : "dimmed"\r\n            );\r\n            createThemeAndWatchForUpdates();\r\n        } else {\r\n            if (!isFirefox) {\r\n                const fallbackStyle = createOrUpdateStyle(\r\n                    "darkreader--fallback"\r\n                );\r\n                document.documentElement.appendChild(fallbackStyle);\r\n                fallbackStyle.textContent = getModifiedFallbackStyle(theme, {\r\n                    strict: true\r\n                });\r\n            }\r\n            const headObserver = new MutationObserver(() => {\r\n                if (document.head) {\r\n                    headObserver.disconnect();\r\n                    if (isAnotherDarkReaderInstanceActive()) {\r\n                        removeDynamicTheme();\r\n                        return;\r\n                    }\r\n                    createThemeAndWatchForUpdates();\r\n                }\r\n            });\r\n            headObserver.observe(document, {childList: true, subtree: true});\r\n        }\r\n    }\r\n    function removeProxy() {\r\n        document.dispatchEvent(new CustomEvent("__darkreader__cleanUp"));\r\n        removeNode(document.head.querySelector(".darkreader--proxy"));\r\n    }\r\n    const cleaners = [];\r\n    function removeDynamicTheme() {\r\n        document.documentElement.removeAttribute(\`data-darkreader-mode\`);\r\n        document.documentElement.removeAttribute(\`data-darkreader-scheme\`);\r\n        cleanDynamicThemeCache();\r\n        removeNode(document.querySelector(".darkreader--fallback"));\r\n        if (document.head) {\r\n            restoreMetaThemeColor();\r\n            removeNode(document.head.querySelector(".darkreader--user-agent"));\r\n            removeNode(document.head.querySelector(".darkreader--text"));\r\n            removeNode(document.head.querySelector(".darkreader--invert"));\r\n            removeNode(document.head.querySelector(".darkreader--inline"));\r\n            removeNode(document.head.querySelector(".darkreader--override"));\r\n            removeNode(document.head.querySelector(".darkreader--variables"));\r\n            removeNode(document.head.querySelector(".darkreader--root-vars"));\r\n            removeNode(document.head.querySelector('meta[name="darkreader"]'));\r\n            removeProxy();\r\n        }\r\n        shadowRootsWithOverrides.forEach((root) => {\r\n            removeNode(root.querySelector(".darkreader--inline"));\r\n            removeNode(root.querySelector(".darkreader--override"));\r\n        });\r\n        shadowRootsWithOverrides.clear();\r\n        forEach(styleManagers.keys(), (el) => removeManager(el));\r\n        loadingStyles.clear();\r\n        cleanLoadingLinks();\r\n        forEach(document.querySelectorAll(".darkreader"), removeNode);\r\n        adoptedStyleManagers.forEach((manager) => manager.destroy());\r\n        adoptedStyleManagers.splice(0);\r\n        adoptedStyleFallbacks.forEach((fallback) => fallback.destroy());\r\n        adoptedStyleFallbacks.clear();\r\n        metaObserver && metaObserver.disconnect();\r\n        cleaners.forEach((clean) => clean());\r\n        cleaners.splice(0);\r\n    }\r\n    function cleanDynamicThemeCache() {\r\n        variablesStore.clear();\r\n        parsedURLCache.clear();\r\n        removeDocumentVisibilityListener();\r\n        cancelRendering();\r\n        stopWatchingForUpdates();\r\n        cleanModificationCache();\r\n        clearColorCache();\r\n    }\r\n\r\n    function parseCSS(cssText) {\r\n        cssText = removeCSSComments(cssText);\r\n        cssText = cssText.trim();\r\n        if (!cssText) {\r\n            return [];\r\n        }\r\n        const rules = [];\r\n        const excludeRanges = getTokenExclusionRanges(cssText);\r\n        const bracketRanges = getAllOpenCloseRanges(\r\n            cssText,\r\n            "{",\r\n            "}",\r\n            excludeRanges\r\n        );\r\n        let ruleStart = 0;\r\n        bracketRanges.forEach((brackets) => {\r\n            const key = cssText.substring(ruleStart, brackets.start).trim();\r\n            const content = cssText.substring(\r\n                brackets.start + 1,\r\n                brackets.end - 1\r\n            );\r\n            if (key.startsWith("@")) {\r\n                const typeEndIndex = key.search(/[\\s\\(]/);\r\n                const rule = {\r\n                    type:\r\n                        typeEndIndex < 0 ? key : key.substring(0, typeEndIndex),\r\n                    query:\r\n                        typeEndIndex < 0\r\n                            ? ""\r\n                            : key.substring(typeEndIndex).trim(),\r\n                    rules: parseCSS(content)\r\n                };\r\n                rules.push(rule);\r\n            } else {\r\n                const rule = {\r\n                    selectors: parseSelectors(key),\r\n                    declarations: parseDeclarations(content)\r\n                };\r\n                rules.push(rule);\r\n            }\r\n            ruleStart = brackets.end;\r\n        });\r\n        return rules;\r\n    }\r\n    function getAllOpenCloseRanges(\r\n        input,\r\n        openToken,\r\n        closeToken,\r\n        excludeRanges = []\r\n    ) {\r\n        const ranges = [];\r\n        let i = 0;\r\n        let range;\r\n        while (\r\n            (range = getOpenCloseRange(\r\n                input,\r\n                i,\r\n                openToken,\r\n                closeToken,\r\n                excludeRanges\r\n            ))\r\n        ) {\r\n            ranges.push(range);\r\n            i = range.end;\r\n        }\r\n        return ranges;\r\n    }\r\n    function getTokenExclusionRanges(cssText) {\r\n        const singleQuoteGoesFirst =\r\n            cssText.indexOf("'") < cssText.indexOf('"');\r\n        const firstQuote = singleQuoteGoesFirst ? "'" : '"';\r\n        const secondQuote = singleQuoteGoesFirst ? '"' : "'";\r\n        const excludeRanges = getAllOpenCloseRanges(\r\n            cssText,\r\n            firstQuote,\r\n            firstQuote\r\n        );\r\n        excludeRanges.push(\r\n            ...getAllOpenCloseRanges(\r\n                cssText,\r\n                secondQuote,\r\n                secondQuote,\r\n                excludeRanges\r\n            )\r\n        );\r\n        excludeRanges.push(\r\n            ...getAllOpenCloseRanges(cssText, "[", "]", excludeRanges)\r\n        );\r\n        excludeRanges.push(\r\n            ...getAllOpenCloseRanges(cssText, "(", ")", excludeRanges)\r\n        );\r\n        return excludeRanges;\r\n    }\r\n    function parseSelectors(selectorText) {\r\n        const excludeRanges = getTokenExclusionRanges(selectorText);\r\n        return splitExcluding(selectorText, ",", excludeRanges);\r\n    }\r\n    function parseDeclarations(cssDeclarationsText) {\r\n        const declarations = [];\r\n        const excludeRanges = getTokenExclusionRanges(cssDeclarationsText);\r\n        splitExcluding(cssDeclarationsText, ";", excludeRanges).forEach(\r\n            (part) => {\r\n                const colonIndex = part.indexOf(":");\r\n                if (colonIndex > 0) {\r\n                    const importantIndex = part.indexOf("!important");\r\n                    declarations.push({\r\n                        property: part.substring(0, colonIndex).trim(),\r\n                        value: part\r\n                            .substring(\r\n                                colonIndex + 1,\r\n                                importantIndex > 0\r\n                                    ? importantIndex\r\n                                    : part.length\r\n                            )\r\n                            .trim(),\r\n                        important: importantIndex > 0\r\n                    });\r\n                }\r\n            }\r\n        );\r\n        return declarations;\r\n    }\r\n    function isParsedStyleRule(rule) {\r\n        return "selectors" in rule;\r\n    }\r\n\r\n    function formatCSS(cssText) {\r\n        const parsed = parseCSS(cssText);\r\n        return formatParsedCSS(parsed);\r\n    }\r\n    function formatParsedCSS(parsed) {\r\n        const lines = [];\r\n        const tab = "    ";\r\n        function formatRule(rule, indent) {\r\n            if (isParsedStyleRule(rule)) {\r\n                formatStyleRule(rule, indent);\r\n            } else {\r\n                formatAtRule(rule, indent);\r\n            }\r\n        }\r\n        function formatAtRule({type, query, rules}, indent) {\r\n            lines.push(\`\${indent}\${type} \${query} {\`);\r\n            rules.forEach((child) => formatRule(child, \`\${indent}\${tab}\`));\r\n            lines.push(\`\${indent}}\`);\r\n        }\r\n        function formatStyleRule({selectors, declarations}, indent) {\r\n            const lastSelectorIndex = selectors.length - 1;\r\n            selectors.forEach((selector, i) => {\r\n                lines.push(\r\n                    \`\${indent}\${selector}\${i < lastSelectorIndex ? "," : " {"}\`\r\n                );\r\n            });\r\n            const sorted = sortDeclarations(declarations);\r\n            sorted.forEach(({property, value, important}) => {\r\n                lines.push(\r\n                    \`\${indent}\${tab}\${property}: \${value}\${important ? " !important" : ""};\`\r\n                );\r\n            });\r\n            lines.push(\`\${indent}}\`);\r\n        }\r\n        clearEmptyRules(parsed);\r\n        parsed.forEach((rule) => formatRule(rule, ""));\r\n        return lines.join("\\n");\r\n    }\r\n    function sortDeclarations(declarations) {\r\n        const prefixRegex = /^-[a-z]-/;\r\n        return [...declarations].sort((a, b) => {\r\n            const aProp = a.property;\r\n            const bProp = b.property;\r\n            const aPrefix = aProp.match(prefixRegex)?.[0] ?? "";\r\n            const bPrefix = bProp.match(prefixRegex)?.[0] ?? "";\r\n            const aNorm = aPrefix ? aProp.replace(prefixRegex, "") : aProp;\r\n            const bNorm = bPrefix ? bProp.replace(prefixRegex, "") : bProp;\r\n            if (aNorm === bNorm) {\r\n                return aPrefix.localeCompare(bPrefix);\r\n            }\r\n            return aNorm.localeCompare(bNorm);\r\n        });\r\n    }\r\n    function clearEmptyRules(rules) {\r\n        for (let i = rules.length - 1; i >= 0; i--) {\r\n            const rule = rules[i];\r\n            if (isParsedStyleRule(rule)) {\r\n                if (rule.declarations.length === 0) {\r\n                    rules.splice(i, 1);\r\n                }\r\n            } else {\r\n                clearEmptyRules(rule.rules);\r\n                if (rule.rules.length === 0) {\r\n                    rules.splice(i, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const blobRegex = /url\\(\\"(blob\\:.*?)\\"\\)/g;\r\n    async function replaceBlobs(text) {\r\n        const promises = [];\r\n        getMatches(blobRegex, text, 1).forEach((url) => {\r\n            const promise = loadAsDataURL(url);\r\n            promises.push(promise);\r\n        });\r\n        const data = await Promise.all(promises);\r\n        return text.replace(blobRegex, () => \`url("\${data.shift()}")\`);\r\n    }\r\n    const banner = \`/*\r\n                        _______\r\n                       /       \\\\\r\n                      .==.    .==.\r\n                     ((  ))==((  ))\r\n                    / "=="    "=="\\\\\r\n                   /____|| || ||___\\\\\r\n       ________     ____    ________  ___    ___\r\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\r\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\r\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\r\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\r\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\r\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\r\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\r\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\r\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\r\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\r\n                https://darkreader.org\r\n*/\r\n\r\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/main/LICENSE */\r\n\`;\r\n    async function collectCSS() {\r\n        const css = [banner];\r\n        function addStaticCSS(selector, comment) {\r\n            const staticStyle = document.querySelector(selector);\r\n            if (staticStyle && staticStyle.textContent) {\r\n                css.push(\`/* \${comment} */\`);\r\n                css.push(staticStyle.textContent);\r\n                css.push("");\r\n            }\r\n        }\r\n        addStaticCSS(".darkreader--fallback", "Fallback Style");\r\n        addStaticCSS(".darkreader--user-agent", "User-Agent Style");\r\n        addStaticCSS(".darkreader--text", "Text Style");\r\n        addStaticCSS(".darkreader--invert", "Invert Style");\r\n        addStaticCSS(".darkreader--variables", "Variables Style");\r\n        const modifiedCSS = [];\r\n        document.querySelectorAll(".darkreader--sync").forEach((element) => {\r\n            forEach(element.sheet.cssRules, (rule) => {\r\n                rule && rule.cssText && modifiedCSS.push(rule.cssText);\r\n            });\r\n        });\r\n        if (modifiedCSS.length) {\r\n            const formattedCSS = formatCSS(modifiedCSS.join("\\n"));\r\n            css.push("/* Modified CSS */");\r\n            css.push(await replaceBlobs(formattedCSS));\r\n            css.push("");\r\n        }\r\n        addStaticCSS(".darkreader--override", "Override Style");\r\n        return css.join("\\n");\r\n    }\r\n\r\n    let isDarkReaderEnabled = false;\r\n    const isIFrame = (() => {\r\n        try {\r\n            return window.self !== window.top;\r\n        } catch (err) {\r\n            console.warn(err);\r\n            return true;\r\n        }\r\n    })();\r\n    function enable(themeOptions = {}, fixes = null) {\r\n        const theme = {...DEFAULT_THEME, ...themeOptions};\r\n        if (theme.engine !== ThemeEngine.dynamicTheme) {\r\n            throw new Error("Theme engine is not supported.");\r\n        }\r\n        createOrUpdateDynamicThemeInternal(theme, fixes, isIFrame);\r\n        isDarkReaderEnabled = true;\r\n    }\r\n    function isEnabled() {\r\n        return isDarkReaderEnabled;\r\n    }\r\n    function disable() {\r\n        removeDynamicTheme();\r\n        isDarkReaderEnabled = false;\r\n    }\r\n    const darkScheme = matchMedia("(prefers-color-scheme: dark)");\r\n    let store = {\r\n        themeOptions: null,\r\n        fixes: null\r\n    };\r\n    function handleColorScheme() {\r\n        if (darkScheme.matches) {\r\n            enable(store.themeOptions, store.fixes);\r\n        } else {\r\n            disable();\r\n        }\r\n    }\r\n    function auto(themeOptions = {}, fixes = null) {\r\n        if (themeOptions) {\r\n            store = {themeOptions, fixes};\r\n            handleColorScheme();\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.addEventListener("change", handleColorScheme);\r\n            } else {\r\n                darkScheme.addListener(handleColorScheme);\r\n            }\r\n        } else {\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.removeEventListener("change", handleColorScheme);\r\n            } else {\r\n                darkScheme.removeListener(handleColorScheme);\r\n            }\r\n            disable();\r\n        }\r\n    }\r\n    async function exportGeneratedCSS() {\r\n        return await collectCSS();\r\n    }\r\n    const setFetchMethod = setFetchMethod$1;\r\n\r\n    exports.auto = auto;\r\n    exports.disable = disable;\r\n    exports.enable = enable;\r\n    exports.exportGeneratedCSS = exportGeneratedCSS;\r\n    exports.isEnabled = isEnabled;\r\n    exports.setFetchMethod = setFetchMethod;\r\n\r\n    Object.defineProperty(exports, "__esModule", {value: true});\r\n});\r\n }`)}let e=this._iframeWindow.DarkReader;"light"===this._themeColorScheme&&"light"===this._theme.id?e.disable():e.enable({mode:"light"===this._themeColorScheme?0:1,darkSchemeBackgroundColor:this._theme.background,darkSchemeTextColor:this._theme.foreground,lightSchemeBackgroundColor:this._theme.background,lightSchemeTextColor:this._theme.foreground},{invert:[".mw-invert"]})}else{var e;this._iframeDocument.body.classList.toggle("force-static-theme","light"!==(null===(e=this._theme)||void 0===e?void 0:e.id))}}_handleInternalLinkClick(e){this._iframeDocument.location.hash=e.getAttribute("href"),this._updateViewState()}_handleScroll(e){super._handleScroll(e),this._updateViewState(),this._pushHistoryPoint(!0)}_handleVisibilityChange(){"visible"===this._iframeDocument.visibilityState&&this._handleViewUpdate()}async setFindState(e){let t=this._findState;if(this._findState=e,!e.active&&t&&t.active!==e.active)console.log("Closing find popup"),this._find&&(this._find=null,this._handleViewUpdate());else if(e.active){var n;t&&t.query===e.query&&t.caseSensitive===e.caseSensitive&&t.entireWord===e.entireWord&&t.active===e.active?t&&t.highlightAll!==e.highlightAll&&(this._find.findState.highlightAll=e.highlightAll,this._renderAnnotations()):(console.log("Initiating new search",e),this._find=new ms({findState:{...e},onSetFindState:t=>{var n;this._options.onSetFindState({...e,result:{total:t.total,index:t.index,snippets:t.snippets,annotation:null!==(n=t.range&&this._getAnnotationFromRange(t.range.toRange(),"highlight"))&&void 0!==n?n:void 0,currentPageLabel:null,currentSnippet:t.snippets[t.index]}}),t.range&&(this._a11yVirtualCursorTarget=ls(t.range))}}),await this._find.run(this._searchContext,null!==(n=this._lastSelectionRange)&&void 0!==n?n:void 0),this.findNext())}}findNext(){if(console.log("Find next"),this._find){let e=this._find.next();e&&_c(e.range.toRange(),{block:"center"}),this._renderAnnotations()}}findPrevious(){if(console.log("Find previous"),this._find){let e=this._find.prev();e&&_c(e.range.toRange(),{block:"center"}),this._renderAnnotations()}}_setScale(e){if(this.scale=e,this._options.onSetZoom)this._options.onSetZoom(this._iframe,e),this._iframeCoordScaleFactor=e;else{if(1==e)return void(this._iframeDocument.documentElement.style.fontSize="");this._iframeDocument.documentElement.style.fontSize="";let t=parseFloat(getComputedStyle(this._iframeDocument.documentElement).fontSize);this._iframeDocument.documentElement.style.fontSize=t*e+"px"}}navigate(e,t={}){console.log("Navigating to",e),t.behavior||(t.behavior="smooth"),e.scrollCoords?this._iframeWindow.scrollTo(...e.scrollCoords):super.navigate(e,t),t.skipHistory||this._pushHistoryPoint()}async print(){"function"==typeof this._iframeWindow.zoteroPrint?await this._iframeWindow.zoteroPrint({overrideSettings:{docURL:this._options.data.importedFromURL||""}}):this._iframeWindow.print()}setSidebarOpen(e){}};function Ac(e,t,n){function r(e){return e.split("").reverse().join("")}function i(e,t){for(var n=0;n<e.length;n+=1)e[n]=t;return e}function o(e,t,n,r){var i=e.P[t],o=e.M[t],a=e.peq[n][t],s=0,l=a|o;r<0&&(a|=1);var u=(a&i)+i^i|a,c=o|~(u|i),d=i&u;return c&e.lastRowMask[t]?s+=1:d&e.lastRowMask[t]&&(s-=1),c<<=1,d<<=1,r<0?d|=1:r>0&&(c|=1),i=d|~(l|c),o=c&l,e.P[t]=i,e.M[t]=o,s}function a(e,t,n){if(0===t.length)return[];n=Math.min(n,t.length);var r=[],a=32,s=Math.ceil(t.length/a)-1,l={bMax:s,P:i(Array(s+1),0),M:i(Array(s+1),0),peq:[],lastRowMask:i(Array(s+1),1<<31)};l.lastRowMask[s]=1<<(t.length-1)%a;for(var u=0;u<e.length;u+=1){var c=e.charCodeAt(u);if(!l.peq[c]){l.peq[c]=Array(s+1);for(var d=0;d<=s;d+=1){l.peq[c][d]=0;for(var h=0;h<a;h+=1){var p=d*a+h;p>=t.length||t.charCodeAt(p)===c&&(l.peq[c][d]|=1<<h)}}}}var f=Math.max(0,Math.ceil(n/a)-1),m=[];for(d=0;d<=f;d+=1)m[d]=(d+1)*a;for(m[s]=t.length,d=0;d<=f;d+=1)l.P[d]=-1,l.M[d]=0;for(var g=0;g<e.length;g+=1){var v=e.charCodeAt(g),y=0;for(d=0;d<=f;d+=1)y=o(l,d,v,y),m[d]+=y;if(m[f]-y<=n&&f<l.bMax&&(1&l.peq[v][f+1]||y<0)){f+=1,l.P[f]=-1,l.M[f]=0;var b=f===s&&t.length%a||a;m[f]=m[f-1]+b-y+o(l,f,v,y)}else for(;f>0&&m[f]>=n+a;)f-=1;f===l.bMax&&m[f]<=n&&r.push({end:g+1,errors:m[f],start:-1})}return r}return function(e,t,n,i){var o=Math.min.apply(Math,n.map((function(e){return e.errors})));return n.filter((function(e){return e.errors===o})).map((function(n){var o=Math.max(0,n.end-t.length-n.errors),a=r(e.slice(o,n.end)),s=r(t);return{start:i(a,s,n.errors).reduce((function(e,t){return n.end-t.end<e?n.end-t.end:e}),n.end),end:n.end,errors:n.errors}}))}(e,t,a(e,t,n),a)}function kc(e,t,n){let r=document.createElement("textarea");e=e||"A",r.value=e,r.style.fontFamily='"Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, -apple-system, sans-serif',r.style.fontSize=n+"px",r.style.wordBreak="break-word",r.style.pointerEvents="none",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.overflow="hidden",r.style.visibility="hidden",r.style.height=n+"px",r.style.width=t+"px",r.style.padding=0,r.style.margin=0,r.style.outline="none",r.style.border="none",document.body.append(r),r.offsetWidth;let i=r.scrollHeight;return r.remove(),i}function Dc(e,t){let n=document.createElement("textarea");e=e||"A",n.value=e,n.style.fontFamily='"Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, -apple-system, sans-serif',n.style.fontSize=t+"px",n.style.wordBreak="break-word",n.style.pointerEvents="none",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.overflow="hidden",n.style.visibility="hidden",n.style.height=0,n.style.width=0,n.style.padding=0,n.style.margin=0,n.style.outline="none",n.style.border="none",n.style.whiteSpace="nowrap",document.body.append(n),n.offsetWidth;let r=n.scrollWidth;return n.remove(),r+1}function Pc(e,t={}){let n,r=e.position,i=r.rects[0],o=!1;i[3]-i[1]>=2*r.fontSize||!t.adjustSingleLineWidth?(o=!0,n=r.rects[0][2]-r.rects[0][0]):n=Dc(e.comment,r.fontSize);let a=kc(e.comment,n,r.fontSize);a<2*r.fontSize&&!o&&(n=Dc(e.comment,r.fontSize),n+=5,n>300&&t.enableSingleLineMaxWidth&&(n=300,a=kc(e.comment,300,r.fontSize))),e.position.pageIndex;let s=[[0,0,n,a]];n=s[0][2]-s[0][0],a=s[0][3]-s[0][1];let l=JSON.parse(JSON.stringify(e.position));l.rects[0][2]=l.rects[0][0]+n,l.rects[0][3]=l.rects[0][1]+a,i=l.rects[0];let u=e.position.rects[0],c=Su(u,e.position.rotation),d=i,h=Su(d,e.position.rotation),p=vu(h,Cu(u,d,c,h,"br"));return p=Au(p),d=[...yu(d,h),...yu(d.slice(2),h)],i=[...yu(d,p),...yu(d.slice(2),p)],i=i.map((e=>parseFloat(e.toFixed(3)))),l.rects=[i],l}const Tc=class{constructor(e){this._filter={query:"",colors:[],tags:[],authors:[]},this._readOnly=e.readOnly,this._authorName=e.authorName,this._annotations=e.annotations,this._onChangeFilter=e.onChangeFilter,this._onSave=e.onSave,this._onDelete=e.onDelete,this.render=()=>{e.onRender([...this._annotations])},this._unsavedAnnotations=new Map,this._highVolatilityAnnotationIDs=new Set,this._lastChangeTime=0,this._lastSaveTime=0,this._undoStack=[],this._redoStack=[],this._annotations.sort(((e,t)=>(e.sortIndex>t.sortIndex)-(e.sortIndex<t.sortIndex))),this.render(),this._onChangeFilter(this._filter)}setReadOnly(e){this._readOnly=e}async setAnnotations(e){for(let t of e)this._annotations=this._annotations.filter((e=>e.id!==t.id)),this._annotations.push(t);this._annotations.sort(((e,t)=>(e.sortIndex>t.sortIndex)-(e.sortIndex<t.sortIndex))),this._clearInterferingHistory(e.map((e=>e.id))),this.render()}unsetAnnotations(e){this._annotations=this._annotations.filter((t=>!e.includes(t.id))),this.render()}addAnnotation(e){if(this._readOnly)return null;let{color:t,sortIndex:n}=e;if(!t)throw new Error("Missing 'color' property");if(!n)throw new Error("Missing 'sortIndex' property");e.pageLabel=e.pageLabel||"",e.text=e.text||"",e.comment=e.comment||"",e.tags=e.tags||[],e.id=this._generateObjectKey(),e.dateCreated=(new Date).toISOString(),e.dateModified=e.dateCreated,e.authorName=this._authorName,this._authorName&&(e.isAuthorNameAuthoritative=!0),e.position.rects&&(e.position.rects=e.position.rects.map((e=>e.map((e=>parseFloat(e.toFixed(3)))))));let r=new Map([[e.id,e]]);return this._applyChanges(r),e}updateAnnotations(e){let t=new Map;for(let t of e){if(t.position&&!t.sortIndex)throw new Error("If updating 'position', 'sortIndex' has to be provided as well");if(this._getAnnotationByID(t.id).readOnly&&(!t.image||2!==Object.keys(t).length))throw new Error("Cannot update read-only annotation");if(this._readOnly&&(!t.image||2!==Object.keys(t).length))throw new Error("Cannot update annotations for read-only file");if(t.image){if(e.length>1)throw new Error("Only one image can be updated at the time");if(2!==Object.keys(t).length)throw new Error("Only image property can be updated at the time");return void this._applyImageChange(t.id,t.image)}}for(let i of e){var n,r;2===Object.keys(i).length&&(i.text||i.comment)&&this._highVolatilityAnnotationIDs.add(i.id);let e=this._getAnnotationByID(i.id);(i.position||i.color)&&(i.image=void 0);let o=(null===(n=i.position)||void 0===n?void 0:n.rects)&&!(null!==(r=i.position)&&void 0!==r&&r.nextPageRects);i={...e,...i,position:{...e.position,...i.position}},i.image||delete i.image,o&&delete i.position.nextPageRects,"text"===i.type&&e.comment!==i.comment&&(i.position=Pc(i,{adjustSingleLineWidth:!0,enableSingleLineMaxWidth:!0})),i.dateModified=(new Date).toISOString(),i.rects&&(i.position.rects=i.position.rects.map((e=>e.map((e=>parseFloat(e.toFixed(3))))))),t.set(i.id,i)}this._applyChanges(t),this.render()}deleteAnnotations(e){let t=this._annotations.some((t=>e.includes(t.id)&&t.isExternal));if(!e.length||this._readOnly||t)return;let n=new Map(e.map((e=>[e,null])));this._applyChanges(n)}convertAnnotations(e,t){let n=new Map,r=[];for(let n of e){let e=this._getAnnotationByID(n);if(e){if(!["highlight","underline"].includes(e.type))throw new Error("Only highlight  underline conversion is supported");if(e.type===t)continue;r.push(e)}}for(let e of r){let r=(new Date).toISOString();n.set(e.id,null),e={...e,type:t,dateModified:r,id:this._generateObjectKey()},n.set(e.id,e)}this._applyChanges(n)}mergeAnnotations(e){let t=[];for(let n of e){let e=this._getAnnotationByID(n);if(e){if("ink"!==e.type)throw new Error("Only ink annotations can be merged");if(e.readOnly)throw new Error("Cannot update read-only annotation");if(this._readOnly)throw new Error("Cannot update annotations for read-only file")}t.push(e)}if(t.length<2)throw new Error("At least two annotations must be provided");if(1!==new Set(t.map((e=>e.color))).size)throw new Error("Annotations must have the same color");if(1!==new Set(t.map((e=>e.position.pageIndex))).size)throw new Error("Annotations must be in the same page");let{color:n,pageLabel:r}=t[0],i={type:"ink",color:n,pageLabel:r};this._authorName&&(i.authorName=this._authorName,i.isAuthorNameAuthoritative=!0),i.id=this._generateObjectKey(),i.sortIndex=t.sort(((e,t)=>e.sortIndex-t.sortIndex))[0].sortIndex,i.dateCreated=t.sort(((e,t)=>e.dateCreated-t.dateCreated))[0].dateCreated,i.dateModified=(new Date).toISOString(),i.tags=[];for(let e of t)for(let t of e.tags)i.tags.find((e=>e.name===t.name))||i.tags.push({...t});!function(e){let t=new Intl.Collator(["en-US"],{numeric:!0,sensitivity:"base"});e.sort(((e,n)=>e.color||n.color?e.color||n.color?!e.color&&n.color?1:e.position-n.position:-1:t.compare(e.name,n.name)))}(i.tags);let o=new Map;for(let e of t){let{width:t,paths:n}=e.position,r=o.get(t)||0;r+=n.flat().length,o.set(t,r)}let a=[...o.entries()].sort(((e,t)=>t[1]-e[1]))[0][0];if(i.position={...t[0].position,width:a,paths:t.flatMap((e=>e.position.paths))},JSON.stringify(i.position).length>65e3)throw new Error("Merged annotation 'position' exceeds 65000");let s=new Map(t.map((e=>[e.id,null])));return s.set(i.id,i),this._applyChanges(s),i}_generateObjectKey(){for(var e="",t=0;t<8;t++){var n=Math.floor(33*Math.random());e+="23456789ABCDEFGHIJKLMNPQRSTUVWXYZ".substring(n,n+1)}return e}_applyChanges(e){if(!e.size)return;this._lastChangeTime=Date.now();let t=new Map(this._annotations.map((e=>[e.id,e])));for(let[t,r]of e){var n;r=r&&{...r},!r||null!==(n=this._unsavedAnnotations.get(t))&&void 0!==n&&n.image||delete r.image,this._unsavedAnnotations.set(t,r)}this._historySave(e),t=new Map([...t,...e]),this._annotations=[...t.values()].filter((e=>e)),this._annotations.sort(((e,t)=>(e.sortIndex>t.sortIndex)-(e.sortIndex<t.sortIndex))),this._triggerSaving(),this.render()}_applyImageChange(e,t){this._lastChangeTime=Date.now();let n=this._annotations.findIndex((t=>t.id===e));if(-1===n)return;let r=this._annotations[n];r={...r,image:t},this._annotations.splice(n,1,r),this._unsavedAnnotations.set(e,r),this._triggerSaving(),this.render()}async _triggerSaving(){if(!this._unsavedAnnotations.size||this._savingInProgress)return;if(Date.now()-this._lastChangeTime<1e3&&Date.now()-this._lastSaveTime<1e4&&!this._skipAnnotationSavingDebounce)return void setTimeout(this._triggerSaving.bind(this),1e3);this._lastSaveTime=Date.now(),this._savingInProgress=!0;let e=[],t=[];for(let[n,r]of this._unsavedAnnotations)r?e.push(r):t.push(n);this._unsavedAnnotations.clear(),this._onDelete(t);let n=e.map((e=>JSON.parse(JSON.stringify(e))));for(let e of n)this._highVolatilityAnnotationIDs.has(e.id)&&(e.onlyTextOrComment=!0);this._highVolatilityAnnotationIDs.clear(),await this._onSave(n),this._savingInProgress=!1,this._triggerSaving()}_getAnnotationByID(e){return this._annotations.find((t=>t.id===e))}async setFilter(e){this._filter={...this._filter,...e},this._onChangeFilter(this._filter),this._annotations.forEach((e=>e._hidden=!0)),this._annotations.forEach((e=>delete e._score));let t=this._annotations.slice(),{tags:n,colors:r,authors:i}=this._filter;if((n.length||r.length||i.length)&&(t=t.filter((e=>n&&e.tags.some((e=>n.includes(e.name)))||r&&r.includes(e.color)||i&&i.includes(e.authorName)))),this._filter.query){t=t.slice();let e=this._filter.query.toLowerCase(),n=[];for(let r of t){let t=null,i=null;if(r.text&&(i=Ac(r.text.toLowerCase(),e,Math.floor(e.length/5)),i.length&&(t=Math.min(...i.map((e=>e.errors))))),r.comment&&(i=Ac(r.comment.toLowerCase(),e,Math.floor(e.length/5)),i.length)){let e=Math.min(...i.map((e=>e.errors)));t=null!==t?Math.min(t,e):e}null!==t&&n.push({errors:t,annotation:r})}let r=Math.max(...n.map((e=>e.errors)),0);n.forEach((e=>e.annotation._score=r-e.errors)),t=n.map((e=>e.annotation))}t.forEach((e=>delete e._hidden)),this.render()}_historySave(e){if(!e.size)return;let t=new Map(this._annotations.map((e=>[e.id,e]))),n=new Map;for(let[r,i]of e){let e=t.get(r);n.set(r,e)}let r=this._undoStack[this._undoStack.length-1],i=this._undoStack[this._undoStack.length-2],o=!0,a=!0;if(i&&r&&1===i.size&&1===r.size&&1===n.size){let[e,t]=[...i][0],[s,l]=[...r][0],[u,c]=[...n][0];e===s&&s===u&&(o=!1);let d={...l},h={...c};delete d.text,delete h.text,delete d.comment,delete h.comment,delete d.dateModified,delete h.dateModified,delete d.image,delete h.image,_r(d,h)&&(a=!1)}(!r||o||Date.now()-this._lastChange>500&&a)&&(r=new Map,this._undoStack.push(r));for(let[e,t]of n)t&&(t=JSON.parse(JSON.stringify(t)),delete t.image),r.set(e,t);this._lastChange=Date.now(),this._redoStack=[]}remapHistory(e){for(let[t,n]of e){for(let e of this._undoStack)if(e.has(t)){let r=e.get(t);r&&(r.id=n),e.delete(t),e.set(n,r)}for(let e of this._redoStack)if(e.has(t)){let r=e.get(t);r&&(r.id=n),e.delete(t),e.set(n,r)}}}undo(){let e=this._undoStack.pop();if(!e)return!1;let t=new Map,n=new Map,r=new Map(this._annotations.map((e=>[e.id,e])));for(let[i,o]of e){o=o&&{...o};let e=r.get(i);if(n.set(i,e),o&&(o.dateModified=(new Date).toISOString()),!e){let e=this._generateObjectKey();t.set(o.id,e),o.id=e}r.set(i,o),this._unsavedAnnotations.set(i,o)}return this._redoStack.push(n),this.remapHistory(t),this._annotations=[...r.values()].filter((e=>e)),this._annotations.sort(((e,t)=>(e.sortIndex>t.sortIndex)-(e.sortIndex<t.sortIndex))),this._triggerSaving(),this.render(),!0}redo(){let e=this._redoStack.pop();if(!e)return!1;let t=new Map,n=new Map,r=new Map(this._annotations.map((e=>[e.id,e])));for(let[i,o]of e){o=o&&{...o};let e=r.get(i);if(n.set(i,e),o&&(o.dateModified=(new Date).toISOString()),!e){let e=this._generateObjectKey();t.set(o.id,e),o.id=e}r.set(i,o),this._unsavedAnnotations.set(i,o)}return this._undoStack.push(n),this.remapHistory(t),this._annotations=[...r.values()].filter((e=>e)),this._annotations.sort(((e,t)=>(e.sortIndex>t.sortIndex)-(e.sortIndex<t.sortIndex))),this._triggerSaving(),this.render(),!0}_clearInterferingHistory(e){for(let t=this._undoStack.length-1;t>=0;t--)if(e.some((e=>this._undoStack[t].has(e)))){this._undoStack=this._undoStack.slice(t+1);break}for(let t=0;t<this._redoStack.length;t++)if(e.some((e=>this._redoStack[t].has(e)))){this._redoStack=this._redoStack.slice(0,Math.max(0,t-1));break}}};function Fc(e,t,n){let r=t.split(" "),i=[],o="";for(let t=0;t<r.length;t++){let a=o+r[t]+" ";if(e.measureText(a).width>n)if(""===o.trim()){let a="";for(let o=0;o<r[t].length;o++){let s=a+r[t][o];e.measureText(s).width>n?(i.push(a),a=r[t][o]):a=s}o=a+" "}else i.push(o.trim()),o=r[t]+" ";else o=a}return i.push(o.trim()),i}function Rc(e,t){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Ic(e){if(e.length<4)return e;const t=[e[0],e[1]];for(let n=0;n<e.length-2;n+=2){const r=e[n],i=e[n+1],o=e[n+2],a=e[n+3],s=[.75*r+.25*o,.75*i+.25*a],l=[.25*r+.75*o,.25*i+.75*a];t.push(s[0],s[1],l[0],l[1])}return t.push(e[e.length-2],e[e.length-1]),t}function Oc(e,t){const{paths:n,width:r}=t,i=e[0],o=e[1],a=e[2],s=e[3],l=e[4],u=e[5],c=n.map((e=>{const t=[];for(let n=0;n<e.length;n+=2){const r=e[n],c=e[n+1],d=i*r+a*c+l,h=o*r+s*c+u;t.push(d,h)}return t})),d=r*Math.sqrt(Math.abs(i*s-o*a));return{...t,paths:c,width:d}}function Bc(e,t,n,r){const i=[];return r.forEach((r=>{const o=r.position.paths.reduce(((e,t)=>e+t.length),0);let{position:a}=r;a=function(e,t,n,r){const i=(e,t,n,r,i)=>{const o=e-n,a=t-r;return Math.sqrt(o*o+a*a)<=i},o=[];let a=[];return r.paths.forEach((r=>{for(let s=0;s<r.length;s+=2){const l=r[s],u=r[s+1];i(l,u,e,t,n/2)?a.length>0&&(o.push(a),a=[]):a.push(l,u)}a.length>0&&(o.push(a),a=[])})),{...r,paths:o}}(e,t,n,a);const s=a.paths.reduce(((e,t)=>e+t.length),0);s!==o&&i.push({...r,position:a,image:void 0})})),i}Promise.withResolvers||(Promise.withResolvers=function(){var e,t,n=new this((function(n,r){e=n,t=r}));return{resolve:e,reject:t,promise:n}});function Mc(e){return function(e){return e<11904}(e)?function(e){return!(65408&e)}(e)?function(e){return 32===e||9===e||13===e||10===e}(e)?0:function(e){return e>=97&&e<=122||e>=65&&e<=90}(e)||function(e){return e>=48&&e<=57}(e)||95===e?1:2:function(e){return 3584==(65408&e)}(e)?7:160===e?0:1:function(e){return e>=13312&&e<=40959||e>=63744&&e<=64255}(e)?3:function(e){return e>=12448&&e<=12543}(e)?4:function(e){return e>=12352&&e<=12447}(e)?5:function(e){return e>=65376&&e<=65439}(e)?6:1}let Lc;function Nc(e,t,n=0){let r=n,i=e.length-1;if(i<0||!t(e[i]))return e.length;if(t(e[r]))return r;for(;r<i;){const n=r+i>>1;t(e[n])?i=n:r=n+1}return r}const Vc={"":"-","":"'","":"'","":"'","":"'","":'"',"":'"',"":'"',"":'"',"":"1/4","":"1/2","":"3/4"},zc=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let Uc;const Hc=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]+/gu,Wc=/([.*+?^${}()|[\]\\])|([!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65\u{10100}-\u{10102}\u{1039F}\u{103D0}\u{1056F}\u{10857}\u{1091F}\u{1093F}\u{10A50}-\u{10A58}\u{10A7F}\u{10AF0}-\u{10AF6}\u{10B39}-\u{10B3F}\u{10B99}-\u{10B9C}\u{10EAD}\u{10F55}-\u{10F59}\u{10F86}-\u{10F89}\u{11047}-\u{1104D}\u{110BB}\u{110BC}\u{110BE}-\u{110C1}\u{11140}-\u{11143}\u{11174}\u{11175}\u{111C5}-\u{111C8}\u{111CD}\u{111DB}\u{111DD}-\u{111DF}\u{11238}-\u{1123D}\u{112A9}\u{1144B}-\u{1144F}\u{1145A}\u{1145B}\u{1145D}\u{114C6}\u{115C1}-\u{115D7}\u{11641}-\u{11643}\u{11660}-\u{1166C}\u{116B9}\u{1173C}-\u{1173E}\u{1183B}\u{11944}-\u{11946}\u{119E2}\u{11A3F}-\u{11A46}\u{11A9A}-\u{11A9C}\u{11A9E}-\u{11AA2}\u{11B00}-\u{11B09}\u{11C41}-\u{11C45}\u{11C70}\u{11C71}\u{11EF7}\u{11EF8}\u{11F43}-\u{11F4F}\u{11FFF}\u{12470}-\u{12474}\u{12FF1}\u{12FF2}\u{16A6E}\u{16A6F}\u{16AF5}\u{16B37}-\u{16B3B}\u{16B44}\u{16E97}-\u{16E9A}\u{16FE2}\u{1BC9F}\u{1DA87}-\u{1DA8B}\u{1E95E}\u{1E95F}])|(\s+)|([\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}])|([A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{1031F}\u{1032D}-\u{10340}\u{10342}-\u{10349}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{103A0}-\u{103C3}\u{103C8}-\u{103CF}\u{10400}-\u{1049D}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{10570}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10860}-\u{10876}\u{10880}-\u{1089E}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{10900}-\u{10915}\u{10920}-\u{10939}\u{10980}-\u{109B7}\u{109BE}\u{109BF}\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A60}-\u{10A7C}\u{10A80}-\u{10A9C}\u{10AC0}-\u{10AC7}\u{10AC9}-\u{10AE4}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B60}-\u{10B72}\u{10B80}-\u{10B91}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10D00}-\u{10D23}\u{10E80}-\u{10EA9}\u{10EB0}\u{10EB1}\u{10F00}-\u{10F1C}\u{10F27}\u{10F30}-\u{10F45}\u{10F70}-\u{10F81}\u{10FB0}-\u{10FC4}\u{10FE0}-\u{10FF6}\u{11003}-\u{11037}\u{11071}\u{11072}\u{11075}\u{11083}-\u{110AF}\u{110D0}-\u{110E8}\u{11103}-\u{11126}\u{11144}\u{11147}\u{11150}-\u{11172}\u{11176}\u{11183}-\u{111B2}\u{111C1}-\u{111C4}\u{111DA}\u{111DC}\u{11200}-\u{11211}\u{11213}-\u{1122B}\u{1123F}\u{11240}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A8}\u{112B0}-\u{112DE}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}\u{11350}\u{1135D}-\u{11361}\u{11400}-\u{11434}\u{11447}-\u{1144A}\u{1145F}-\u{11461}\u{11480}-\u{114AF}\u{114C4}\u{114C5}\u{114C7}\u{11580}-\u{115AE}\u{115D8}-\u{115DB}\u{11600}-\u{1162F}\u{11644}\u{11680}-\u{116AA}\u{116B8}\u{11700}-\u{1171A}\u{11740}-\u{11746}\u{11800}-\u{1182B}\u{118A0}-\u{118DF}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{1192F}\u{1193F}\u{11941}\u{119A0}-\u{119A7}\u{119AA}-\u{119D0}\u{119E1}\u{119E3}\u{11A00}\u{11A0B}-\u{11A32}\u{11A3A}\u{11A50}\u{11A5C}-\u{11A89}\u{11A9D}\u{11AB0}-\u{11AF8}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2E}\u{11C40}\u{11C72}-\u{11C8F}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D89}\u{11D98}\u{11EE0}-\u{11EF2}\u{11F02}\u{11F04}-\u{11F10}\u{11F12}-\u{11F33}\u{11FB0}\u{12000}-\u{12399}\u{12480}-\u{12543}\u{12F90}-\u{12FF0}\u{13000}-\u{1342F}\u{13441}-\u{13446}\u{14400}-\u{14646}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A70}-\u{16ABE}\u{16AD0}-\u{16AED}\u{16B00}-\u{16B2F}\u{16B40}-\u{16B43}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16E40}-\u{16E7F}\u{16F00}-\u{16F4A}\u{16F50}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18D00}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E030}-\u{1E06D}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E14E}\u{1E290}-\u{1E2AD}\u{1E2C0}-\u{1E2EB}\u{1E4D0}-\u{1E4EB}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1E800}-\u{1E8C4}\u{1E900}-\u{1E943}\u{1E94B}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}])/gu,jc=/([^\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}])[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]*$/u,$c=/^[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]*([^\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}])/u,Gc=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,qc=new Map,Kc=new Map;let Yc=null,Xc=null;function Zc(e){const t=[];let n,r;for(;null!==(n=Gc.exec(e));){let{index:e}=n;for(const r of n[0]){let n=qc.get(r);n||(n=r.normalize("NFD").length,qc.set(r,n)),t.push([n,e++])}}if(0===t.length&&Yc)r=Yc;else if(t.length>0&&Xc)r=Xc;else{const e=`([${Object.keys(Vc).join("")}])|([${function(){if(Lc||(Lc="---------------------------------------------------------------------------------------------------"),"undefined"==typeof PDFJSDev||PDFJSDev.test("TESTING")){const e=[],t=[],n=/^[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10EAB}\u{10EAC}\u{10EFD}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{13440}\u{13447}-\u{13455}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]$/u;for(let r=0;r<65536;r++){const i=String.fromCharCode(r);if(i.normalize("NFKC")!==i&&!n.test(i)){if(2!==t.length){t[0]=t[1]=r;continue}t[1]+1!==r?(t[0]===t[1]?e.push(String.fromCharCode(t[0])):e.push(`${String.fromCharCode(t[0])}-${String.fromCharCode(t[1])}`),t[0]=t[1]=r):t[1]=r}}if(e.join("")!==Lc)throw new Error("getNormalizeWithNFKC - update the `NormalizeWithNFKC` string.")}return Lc}()}])|((?:|)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[-])\\n)|(\\n)`;r=0===t.length?Yc=new RegExp(e+"|(\\u0000)","gum"):Xc=new RegExp(e+"|([\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f])","gum")}const i=[];for(;null!==(n=Hc.exec(e));)i.push([n[0].length,n.index]);let o=e.normalize("NFD");const a=[[0,0]];let s=0,l=0,u=0,c=0,d=0,h=!1;return o=o.replace(r,((e,n,r,o,p,f,m,g,v,y)=>{var b,_;if(y-=c,n){const e=Vc[n],t=e.length;for(let e=1;e<t;e++)a.push([y-u+e,u-e]);return u-=t-1,e}if(r){let e=Kc.get(r);e||(e=r.normalize("NFKC"),Kc.set(r,e));const t=e.length;for(let e=1;e<t;e++)a.push([y-u+e,u-e]);return u-=t-1,e}if(o)return h=!0,y+d===(null===(_=i[s])||void 0===_?void 0:_[1])?++s:(a.push([y-1-u+1,u-1]),u-=1,c+=1),a.push([y-u+1,u]),c+=1,d+=1,o.charAt(0);if(p){var w;const e=p.endsWith("\n"),t=e?p.length-2:p.length;h=!0;let n=t;y+d===(null===(w=i[s])||void 0===w?void 0:w[1])&&(n-=i[s][0],++s);for(let e=1;e<=n;e++)a.push([y-1-u+e,u-e]);return u-=n,c+=n,e?(y+=t-1,a.push([y-u+1,1+u]),u+=1,c+=1,d+=1,p.slice(0,t)):p}if(f){const e=f.length-2;return a.push([y-u+e,1+u]),u+=1,c+=1,d+=1,f.slice(0,-2)}if(m){const e=m.length-1;return a.push([y-u+e,u]),c+=1,d+=1,m.slice(0,-1)}if(g)return a.push([y-u+1,u-1]),u-=1,c+=1,d+=1," ";if(y+d===(null===(b=t[l])||void 0===b?void 0:b[1])){const e=t[l][0]-1;++l;for(let t=1;t<=e;t++)a.push([y-(u-t),u-t]);u-=e,c+=e}return v})),a.push([o.length,u]),[o,a,h]}function Qc(e,t,n){if(!e)return[t,n];const r=t,i=t+n-1;let o=Nc(e,(e=>e[0]>=r));e[o][0]>r&&--o;let a=Nc(e,(e=>e[0]>=i),o);e[a][0]>i&&--a;const s=r+e[o][1];return[s,i+e[a][1]+1-s]}function Jc(e,t,n,r){if(t<0||n>e.length||t>=n)return"";let i=e.substring(t,n),o=e.substring(0,t).trim(),a=e.substring(n).trim(),s=o?o.split(/\s+/):[],l=a?a.split(/\s+/):[],u=s.slice(-r),c=l.slice(0,r),d=u.join(" "),h=c.join(" "),p=s.length>r?"":"",f=l.length>r?"":"",m=t>0&&!/\s/.test(e.charAt(t-1)),g=n<e.length&&!/\s/.test(e.charAt(n)),v="";return p&&(v+=p),d&&(v+=d,m||(v+=" ")),v+=i,h&&(g||(v+=" "),v+=h),f&&(v+=f),v}class ed{constructor({linkService:e,onNavigate:t,onUpdateMatches:r,onUpdateState:i}){n(this,"_state",null),n(this,"_visitedPagesCount",0),this._linkService=e,this._onNavigate=t,this._onUpdateMatches=r,this._onUpdateState=i,this._charMapping=[],this.onIsPageVisible=null,this._reset()}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(e){this._pdfDocument&&this._reset(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}find(e){if(!e)return;const t=this._pdfDocument,{type:n}=e;(null===this._state||this._shouldDirtyMatch(e))&&(this._dirtyMatch=!0),this._state=e,"highlightallchange"!==n&&this._updateUIState(3),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this._extractText(),this._highlightMatches;const e=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch||"again"===n?this._nextMatch():"highlightallchange"===n?e?this._nextMatch():this._highlightMatches=!0:this._nextMatch():this._findTimeout=setTimeout((()=>{this._nextMatch(),this._findTimeout=null}),250)}))}getMatchPositions(e,t){let n=[],r=this._pageMatches[e],i=this._pageMatchesLength[e];if(!r||!r.length)return[];let o=t.chars;for(let t=0;t<r.length;t++){let a=r[t],s=i[t],l=null,u=null,c=0;for(let e=0;e<o.length;e++){let t=o[e];if(c++,c+=t.u.length-1,(t.spaceAfter||t.lineBreakAfter||t.paragraphBreakAfter)&&c++,c>=a&&null===l&&(l=e,0!==e&&l++),c>=a+s){u=e;break}}let d={pageIndex:e,rects:Bu(o,l,u)};n.push(d)}return n}async getMatchPositionsAsync(e){let t=this._pageMatches[e];if(!t||!t.length)return[];let n=await this._pdfDocument.getPageData({pageIndex:e});return this.getMatchPositions(e,n)}_reset(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._visitedPagesCount=0,this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get _query(){const{query:e}=this._state;return"string"==typeof e?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=Zc(e)),this._normalizedQuery):(e||[]).filter((e=>!!e)).map((e=>Zc(e)[0]))}_shouldDirtyMatch(e){var t,n;const r=e.query,i=this._state.query,o=typeof r;if(o!==typeof i)return!0;if("string"===o){if(r!==i)return!0}else if(JSON.stringify(r)!==JSON.stringify(i))return!0;switch(e.type){case"again":const e=this._selected.pageIdx+1,r=this._linkService;return e>=1&&e<=r.pagesCount&&e!==r.page&&!(null===(t=null===(n=this.onIsPageVisible)||void 0===n?void 0:n.call(this,e))||void 0===t||t);case"highlightallchange":return!1}return!0}_isEntireWord(e,t,n){let r=e.slice(0,t).match(jc);if(r){const n=e.charCodeAt(t),i=r[1].charCodeAt(0);if(Mc(n)===Mc(i))return!1}if(r=e.slice(t+n).match($c),r){const i=e.charCodeAt(t+n-1),o=r[1].charCodeAt(0);if(Mc(i)===Mc(o))return!1}return!0}_calculateRegExpMatch(e,t,n,r){const i=this._pageMatches[n]=[],o=this._pageMatchesLength[n]=[];if(!e)return;const a=this._pageDiffs[n];let s;for(;null!==(s=e.exec(r));){if(t&&!this._isEntireWord(r,s.index,s[0].length))continue;let[e,n]=Qc(a,s.index,s[0].length);n&&(i.push(e),o.push(n))}}_convertToRegExpString(e,t){const{matchDiacritics:n}=this._state;let r=!1;return(e=e.replaceAll(Wc,((e,i,o,a,s,l)=>i?`[ ]*\\${i}[ ]*`:o?`[ ]*${o}[ ]*`:a?"[ ]+":n?s||l:s?zc.has(s.charCodeAt(0))?s:"":t?(r=!0,`${l}\\p{M}*`):l))).endsWith("[ ]*")&&(e=e.slice(0,e.length-4)),n&&t&&(Uc||(Uc=String.fromCharCode(...zc)),r=!0,e=`${e}(?=[${Uc}]|[^\\p{M}]|$)`),[r,e]}async _calculateMatch(e){let t=this._query;if(0===t.length)return;const{caseSensitive:n,entireWord:r}=this._state,i=this._pageContents[e],o=this._hasDiacritics[e];let a=!1;"string"==typeof t?[a,t]=this._convertToRegExpString(t,o):t=t.sort().reverse().map((e=>{const[t,n]=this._convertToRegExpString(e,o);return a||(a=t),`(${n})`})).join("|"),t=t?new RegExp(t,`g${a?"u":""}${n?"":"i"}`):null,this._calculateRegExpMatch(t,r,e,i),this._resumePageIdx===e&&(this._resumePageIdx=null,this._nextPageMatch());const s=this._pageMatches[e].length;this._matchesCountTotal+=s,s>0&&this._onUpdateMatches({matchesCount:this._requestMatchesCount()})}_extractText(){if(this._extractTextPromises.length>0)return;let e=[];for(let t=0,n=this._linkService.pagesCount;t<n;t++){const{promise:n,resolve:r}=Promise.withResolvers();this._extractTextPromises[t]=n,e.push(r)}(async()=>{for(let t=0;t<e.length;t++){let n=e[t],r=[];try{await new Promise((e=>setTimeout(e)));let e=await this._pdfDocument.getPageData({pageIndex:t});this._charMapping[t]||(this._charMapping[t]=[]);for(let n=0;n<e.chars.length;n++){let i=e.chars[n];r.push(i.u);for(let e=0;e<i.u.length;e++)this._charMapping[t].push(n);(i.spaceAfter||i.lineBreakAfter||i.paragraphBreakAfter)&&(r.push(" "),this._charMapping[t].push(n))}}catch(e){console.log(e)}r=r.join("").trim(),[this._pageContents[t],this._pageDiffs[t],this._hasDiacritics[t]]=Zc(r),n()}})()}_nextMatch(){const e=this._state.findPrevious,t=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._visitedPagesCount=0,this._matchesCountTotal=0;for(let e=0;e<n;e++)this._pendingFindMatches.has(e)||(this._pendingFindMatches.add(e),this._extractTextPromises[e].then((()=>{this._pendingFindMatches.delete(e),this._calculateMatch(e)})))}if(0===this._query.length)return void this._updateUIState(0);if(this._resumePageIdx)return;const r=this._offset;if(this._pagesToSearch=n,null!==r.matchIdx){const t=this._pageMatches[r.pageIdx].length;if(!e&&r.matchIdx+1<t||e&&r.matchIdx>0)return r.matchIdx=e?r.matchIdx-1:r.matchIdx+1,void this._updateMatch(!0);this._advanceOffsetPage(e)}this._nextPageMatch()}_matchesReady(e){const t=this._offset,n=e.length,r=this._state.findPrevious;return n?(t.matchIdx=r?n-1:0,this._updateMatch(!0),!0):(this._advanceOffsetPage(r),!!(t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0))&&(this._updateMatch(!1),!0))}_nextPageMatch(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let e=null;do{const t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this._matchesReady(e))}_advanceOffsetPage(e){const t=this._offset,n=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=n||t.pageIdx<0)&&(t.pageIdx=e?n-1:0,t.wrapped=!0)}_updateMatch(e=!1){let t=1;const n=this._offset.wrapped;this._offset.wrapped=!1,e&&(this._selected.pageIdx,this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=n?2:0),this._updateUIState(t,this._state.findPrevious),-1!==this._selected.pageIdx&&this._onNavigate(this._selected.pageIdx,this._selected.matchIdx)}onClose(){const e=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||e&&this._pdfDocument!==e||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this._highlightMatches=!1,this._updateUIState(0))}))}_requestMatchesCount(){const{pageIdx:e,matchIdx:t}=this._selected;let n=0,r=this._matchesCountTotal;if(-1!==t){for(let t=0;t<e;t++){var i;n+=(null===(i=this._pageMatches[t])||void 0===i?void 0:i.length)||0}n+=t+1}let o=[];for(let e=0;e<this._pageMatches.length;e++){let t=this._pageMatches[e];if(t)for(let n=0;n<t.length;n++){let t=this._pageMatches[e][n],r=t+this._pageMatchesLength[e][n],i=Jc(this._pageContents[e],t,r,5);o.push(i)}}(n<1||n>r)&&(n=r=0);let a=-1,s=-1,l=-1;return r&&this._pageMatches[e]&&(a=this._pageMatches[e][t],s=a+this._pageMatchesLength[e][t],l=e),a>=0&&(a=this._charMapping[e][a],s=this._charMapping[e][s-1]),{current:n,total:r,currentPageIndex:l,currentOffsetStart:a,currentOffsetEnd:s,snippets:o}}_updateUIState(e,t=!1){var n,r,i,o;this._onUpdateState({state:e,previous:t,entireWord:null!==(n=null===(r=this._state)||void 0===r?void 0:r.entireWord)&&void 0!==n?n:null,matchesCount:this._requestMatchesCount(),rawQuery:null!==(i=null===(o=this._state)||void 0===o?void 0:o.query)&&void 0!==i?i:null})}}const td=class{constructor(e){n(this,"a11yWillPlaceVirtCursorOnSearchResult",Ti((async()=>{var e,t,n;if(null===(e=this._findState.result)||void 0===e||!e.annotation)return;let{position:r}=this._findState.result.annotation,i=Qu(this._pdfPages,r),o=this._iframeWindow.PDFViewerApplication.pdfViewer.getPageView(r.pageIndex),a=0;for(;!o.div.querySelector(".textLayer")&&a<5;)await new Promise((e=>setTimeout(e,250))),a+=1;let s=o.div.querySelector(".textLayer");if(!s)return;let l=null===(t=nc(s,i[0].anchorOffset))||void 0===t?void 0:t.node,u=null===(n=nc(s,i[0].to))||void 0===n?void 0:n.node,c=u.textContent.includes(this._findState.query)?u:l;this._a11yVirtualCursorTarget=c.parentNode}),500)),n(this,"a11yRecordCurrentPage",Ti((()=>{var e;if(null!==(e=this._findState)&&void 0!==e&&e.active)return;let{currentPageNumber:t}=this._iframeWindow.PDFViewerApplication.pdfViewer,n=this._iframeWindow.PDFViewerApplication.pdfViewer.getPageView(t-1);this._a11yVirtualCursorTarget=n.div,this._a11yShouldFocusVirtualCursorTarget&&(this._a11yShouldFocusVirtualCursorTarget=!1,Er(this._a11yVirtualCursorTarget))}),500)),n(this,"_handlePointerMove",function(e,t,n){var r,i,o,a=null,s=0;n||(n={});var l=function(){return t()},u=function(){s=!1===n.leading?0:Date.now(),a=null,o=e.apply(r,i),a||(r=i=null)};return function(){var t=Date.now();s||!1!==n.leading||(s=t);var c=l()-(t-s);return r=this,i=arguments,c<=0||c>l()?(a&&(clearTimeout(a),a=null),s=t,o=e.apply(r,i),a||(r=i=null)):a||!1===n.trailing||(a=setTimeout(u,c)),o}}((e=>{let t=!!e.dataTransfer;if(!this.pointerDownPosition){this._hover=null;let t=this.pointerEventToPosition(e);if(t){let{action:n,selectAnnotations:r}=this.getActionAtPosition(t,e),i=this._getSelectableOverlay(t),o=!1,a=!1;if(i)(["citation","reference"].includes(i.type)||"internal-link"===i.type)&&(o=!0),["internal-link","external-link","citation"].includes(i.type)&&(a=!0),"external-link"===i.type&&(this._iframeWindow.PDFViewerApplication.pdfViewer._pages[i.position.pageIndex].div.title=i.url),this._hover=i.position;else for(let e of this._iframeWindow.PDFViewerApplication.pdfViewer._pages)e.div.title&&(e.div.title="");a?this.updateCursor({type:"overlay"}):this.updateCursor(n),o?this._selectedOverlay!==i&&this._overlayPopupDelayer.open(i,(async()=>{this._selectedOverlay=i;let e=this.getClientRect(i.position.rects[0],i.position.pageIndex),t={...i,rect:e};if("internal-link"===t.type){var n;let{image:e,width:r,height:o,x:a,y:s}=await(null===(n=this._pdfRenderer)||void 0===n?void 0:n.renderPreviewPage(i.destinationPosition));t.image=e,t.width=r,t.height=o,t.x=a,t.y=s,this._onSetOverlayPopup(t)}else["citation","reference"].includes(i.type)&&this._onSetOverlayPopup(t)})):this._overlayPopupDelayer.close((()=>{this._selectedOverlay=null,this._onSetOverlayPopup(null)}))}else this.updateCursor();return void this._render()}this._selectedOverlay=null,this._onSetOverlayPopup(null);let n=this.action;if(!n)return;let r=this.pointerEventToAltPosition(e,this.pointerDownPosition.pageIndex),i=this.pointerEventToPosition(e);if(!i&&"moveAndDrag"===n.type)return n.position=null,n.triggered=!1,void this._render();i||(i=r);let o=i&&this.getPageByIndex(i.pageIndex);if("updateAnnotationRange"===n.type){n.selectionRanges=Ku(this._pdfPages,n.selectionRanges,i);let{sortIndex:e,position:t,text:r}=this._getAnnotationFromSelectionRanges(n.selectionRanges);n.annotation={...n.annotation,sortIndex:e,position:t,text:r},this.updateCursor(n),n.triggered=!0}else if("resize"===n.type){if("ink"===n.annotation.type){let[e,t]=r.rects[0],i=fu(n.annotation.position);n.dir.includes("l")?i[0]=e:n.dir.includes("r")&&(i[2]=e),n.dir.includes("b")?i[1]=t:n.dir.includes("t")&&(i[3]=t);let o=fu(n.annotation.position),a=(o[2]-o[0])/(o[3]-o[1]);2===n.dir.length&&(i=_u(i,a,n.dir));let s=Pu(o,i);n.position=Oc(s,n.annotation.position),n.triggered=!0}else if("image"===n.annotation.type){let e=n.annotation.position.rects[0].slice(),[t,i]=r.rects[0],a=o.originalPage.viewport.viewBox;n.dir.includes("l")?t=t>e[2]-ti&&e[2]-ti||t>a[0]&&t||a[0]:n.dir.includes("r")&&(t=t<e[0]+ti&&e[0]+ti||t<a[2]&&t||a[2]),n.dir.includes("b")?i=i>e[3]-ti&&e[3]-ti||i>a[1]&&i||a[1]:n.dir.includes("t")&&(i=i<e[1]+ti&&e[1]+ti||i<a[3]&&i||a[3]),n.dir.includes("l")?e[0]=t:n.dir.includes("r")&&(e[2]=t),n.dir.includes("b")?e[1]=i:n.dir.includes("t")&&(e[3]=i),n.position=JSON.parse(JSON.stringify(n.annotation.position)),n.position.rects=[e],n.triggered=!0}else if("text"===n.annotation.type){let e=n.annotation.position.rects[0].slice(),[t,i]=r.rects[0];if(n.annotation.position.rotation){let r=Su(e,n.annotation.position.rotation);[t,i]=bu([t,i],r)}n.dir.includes("l")?e[0]=t:n.dir.includes("r")&&(e[2]=t),n.dir.includes("b")?e[1]=i:n.dir.includes("t")&&(e[3]=i);let o=0,a=n.annotation.position.rects[0],s=Su(a,n.annotation.position.rotation),l=(a[2]-a[0])/(a[3]-a[1]);2===n.dir.length&&(e=_u(e,l,n.dir));let u=e,c=Su(u,n.annotation.position.rotation),d=vu(c,Cu(a,u,s,c,n.dir));d=Au(d),u=[...yu(u,c),...yu(u.slice(2),c)],e=[...yu(u,d),...yu(u.slice(2),d)];let h=ku(n.annotation.position.rects[0],e);2!==n.dir.length&&(h=1),o=n.annotation.position.fontSize*h,o=Math.floor(2*o)/2,n.position=JSON.parse(JSON.stringify(n.annotation.position)),n.position.rects=[e],o&&(n.position.fontSize=o),2!==n.dir.length&&(n.position=Pc({...n.annotation,position:n.position})),n.triggered=!0}}else if("rotate"===n.type){let e=n.annotation.position.rects[0],t=i.rects[0];t=wu(t,Au(Su(e,n.annotation.position.rotation)));let r=e[0]+(e[2]-e[0])/2,o=e[1]+(e[3]-e[1])/2;const a=-Math.atan2(t[0]-r,t[1]-o)*(180/Math.PI);let s=n.annotation.position.rotation+a;s=Tu(s);const l=[0,90,180,270,360],u=7;for(const e of l)if(Math.abs(s-e)<=u){s=e;break}360===s&&(s=0),n.position=JSON.parse(JSON.stringify(n.annotation.position)),n.position.rotation=s,n.triggered=!0}else if("selectText"===n.type)"chars"===n.mode?this._selectionRanges=Ku(this._pdfPages,this._selectionRanges,i):"words"===n.mode?this._selectionRanges=Yu(this._pdfPages,this.pointerDownPosition,i):"lines"===n.mode&&(this._selectionRanges=Xu(this._pdfPages,this.pointerDownPosition,i)),this._selectionRanges.length&&!this._selectionRanges[0].collapsed&&(n.triggered=!0);else if("moveAndDrag"===n.type&&t){let e=fu(n.annotation.position),t=r.rects[0][0],i=r.rects[0][1],a=o.originalPage.viewport.viewBox;const s=5;t=t>a[2]-s&&a[2]-s||t<a[0]+s&&a[0]+s||t,i=i>a[3]-s&&a[3]-s||i<a[1]+s&&a[1]+s||i;let l=[t-e[0]-n.x,i-e[1]-n.y];if("ink"===n.annotation.type){let e=Oc([1,0,0,1,l[0],l[1]],n.annotation.position);n.position=e}else e=n.annotation.position.rects[0],n.position={pageIndex:r.pageIndex,rects:[[e[0]+l[0],e[1]+l[1],e[2]+l[0],e[3]+l[1]]]};n.triggered=!0}else if("drag"===n.type&&t)n.triggered=!0;else if("image"===n.type){let e=this.pointerDownPosition.rects[0],t=r.rects[0],[i,a,s,l]=o.originalPage.viewport.viewBox;n.annotation={type:"image",color:this._tool.color,pageLabel:this._getPageLabel(this.pointerDownPosition.pageIndex,!0),position:{pageIndex:this.pointerDownPosition.pageIndex,rects:[[Math.max(Math.min(e[0],t[0]),i),Math.max(Math.min(e[1],t[1]),a),Math.min(Math.max(e[0],t[0]),s),Math.min(Math.max(e[1],t[1]),l)]]}},n.triggered=!0}else if("ink"===n.type){let e=r.rects[0].slice(0,2);n.annotation.position.paths[0].push(...e)}else if("erase"===n.type){let e=[];for(let t of this._annotations)"ink"!==t.type||t.position.pageIndex!==i.pageIndex||n.annotations.has(t.id)||e.push(t);e.push(...n.annotations.values());let[t,o]=r.rects[0],a=Bc(t,o,this._tool.size,e);for(let e of a)n.annotations.set(e.id,e);a.length&&(n.triggered=!0)}n.triggered&&(this._onSetAnnotationPopup(),this._onSetSelectionPopup()),this._render()}),(()=>["ink","eraser"].includes(this._tool.type)?0:50))),n(this,"_handleViewAreaUpdate",(e=>{let{scale:t,top:n,left:r}=e.location,i=e.location.pageNumber-1;this._onChangeViewState({pageIndex:i,scale:t,top:n,left:r,scrollMode:this._iframeWindow.PDFViewerApplication.pdfViewer.scrollMode,spreadMode:this._iframeWindow.PDFViewerApplication.pdfViewer.spreadMode}),this._suspendHistorySaving||this._history.save({dest:[i,{name:"XYZ"},r,n,null]},!0),this._updateViewStats()})),this._options=e,this._primary=e.primary,this._readOnly=e.readOnly,this._preview=e.preview,this._container=e.container,this._password=e.password,this._tools=e.tools,this._outline=e.outline,this._lightTheme=e.lightTheme,this._darkTheme=e.darkTheme,this._preferedColorTheme=e.colorScheme,this._onRequestPassword=e.onRequestPassword,this._onSetThumbnails=e.onSetThumbnails,this._onSetOutline=e.onSetOutline,this._onSetPageLabels=e.onSetPageLabels,this._onChangeViewState=e.onChangeViewState,this._onChangeViewStats=e.onChangeViewStats,this._onSetDataTransferAnnotations=e.onSetDataTransferAnnotations,this._onAddAnnotation=e.onAddAnnotation,this._onUpdateAnnotations=e.onUpdateAnnotations,this._onDeleteAnnotations=e.onDeleteAnnotations,this._onOpenLink=e.onOpenLink,this._onSelectAnnotations=e.onSelectAnnotations,this._onSetSelectionPopup=e.onSetSelectionPopup,this._onSetAnnotationPopup=e.onSetAnnotationPopup,this._onSetOverlayPopup=e.onSetOverlayPopup,this._onSetFindState=e.onSetFindState,this._onOpenViewContextMenu=e.onOpenViewContextMenu,this._onOpenAnnotationContextMenu=e.onOpenAnnotationContextMenu,this._onKeyUp=e.onKeyUp,this._onKeyDown=e.onKeyDown,this._onFocusAnnotation=e.onFocusAnnotation,this._onTabOut=e.onTabOut,this._viewState=e.viewState||{pageIndex:0,scale:"page-width",scrollMode:0,spreadMode:0},this._location=e.location,this._tool=e.tool,this._pageLabels=e.pageLabels,this._selectedAnnotationIDs=e.selectedAnnotationIDs,this._annotations=e.annotations,this._pages=[],this._pdfPages={},this._focusedObject=null,this._lastFocusedObject=null,this._lastNavigationTime=0,this._findState=e.findState;let t=window.matchMedia("(prefers-color-scheme: dark)");this._preferedColorTheme="dark"===localStorage.getItem("theme")?"dark":"light",t.addEventListener("change",(e=>{localStorage.getItem("theme")?this._preferedColorTheme="dark"===localStorage.getItem("theme")?"dark":"light":this._preferedColorTheme=e.matches?"dark":"light",this._updateColorScheme()})),window.addEventListener("storage",(e=>{"theme"===e.key&&(this._preferedColorTheme="dark"===e.newValue?"dark":"light",this._updateColorScheme())})),this._updateColorScheme(),this._history=new Rs({onUpdate:()=>this._updateViewStats(),onNavigate:e=>this.navigate(e,{skipHistory:!0})}),this._overlayPopupDelayer=new vs({open:!!this._overlayPopup}),this._selectionRanges=[],this._iframe=document.createElement("iframe"),this._iframe.addEventListener("load",(()=>this._iframe.classList.add("loaded"))),this._iframe.src="pdf/web/viewer.html",this._iframeWindow=null,this.initializedPromise=new Promise((e=>this._resolveInitializedPromise=e)),this._pageLabelsPromise=new Promise((e=>this._resolvePageLabelsPromise=e)),this._a11yVirtualCursorTarget=null,this._a11yShouldFocusVirtualCursorTarget=!1;let r=()=>{var e;null!==(e=this._iframeWindow)&&void 0!==e&&e.PDFViewerApplicationOptions&&(this._iframeWindow.PDFViewerApplicationOptions.set("isEvalSupported",!1),this._iframeWindow.PDFViewerApplicationOptions.set("defaultUrl",""),this._iframeWindow.PDFViewerApplicationOptions.set("historyUpdateUrl",!1),this._iframeWindow.PDFViewerApplicationOptions.set("textLayerMode",this._preview?0:1),this._iframeWindow.PDFViewerApplicationOptions.set("sidebarViewOnLoad",0),this._iframeWindow.PDFViewerApplicationOptions.set("ignoreDestinationZoom",!0),this._iframeWindow.PDFViewerApplicationOptions.set("renderInteractiveForms",!1),this._iframeWindow.PDFViewerApplicationOptions.set("printResolution",300),this._iframeWindow.PDFViewerApplicationOptions.set("enableScripting",!1),this._iframeWindow.PDFViewerApplicationOptions.set("disablePreferences",!0),this._iframeWindow.PDFViewerApplicationOptions.set("disableHistory",!0),this._iframeWindow.PDFViewerApplicationOptions.set("enableXfa",!1))};window.addEventListener("webviewerloaded",(()=>{this._iframeWindow=this._iframe.contentWindow,r()})),this._iframe.addEventListener("load",(()=>{this._updateColorScheme(),setTimeout((()=>{try{localStorage.removeItem("pdfjs.history")}catch(e){}try{this._iframeWindow.localStorage.removeItem("pdfjs.history")}catch(e){}r(),this._iframeWindow.onAttachPage=this._attachPage.bind(this),this._iframeWindow.onDetachPage=this._detachPage.bind(this),this._preview?setTimeout(this._resolveInitializedPromise):this._init(),e.data.buf?this._iframeWindow.PDFViewerApplication.open({data:e.data.buf,password:this._password}):this._iframeWindow.PDFViewerApplication.open({url:e.data.url,password:this._password}),window.PDFViewerApplication=this._iframeWindow.PDFViewerApplication,window.if=this._iframeWindow,this._iframeWindow.document.getElementById("viewerContainer").addEventListener("scroll",(e=>{let t=e.target.scrollLeft,n=e.target.scrollTop;if(this._overlayPopup&&(this._overlayPopupDelayer.close((()=>{})),this._selectedOverlay=null,this._onSetOverlayPopup(null)),this._annotationPopup){let e=this.getSelectedAnnotations();if(1===e.length){let r=e[0],i=this.getClientRectForPopup(r.position,t,n);this._onSetAnnotationPopup({rect:i,annotation:r})}}if(this._selectionPopup){let e=this._selectionRanges[0];if(e){let t=this.getClientRectForPopup(e.position);this._onSetSelectionPopup({...this._selectionPopup,rect:t})}}})),this._iframeWindow.addEventListener("focus",(t=>{e.onFocus(),Er(this._a11yVirtualCursorTarget)}))}))})),this._options.container.append(this._iframe)}async _init(){this._iframeWindow.addEventListener("contextmenu",this._handleContextMenu.bind(this)),this._iframeWindow.addEventListener("keyup",this._onKeyUp),this._iframeWindow.addEventListener("keydown",this._handleKeyDown.bind(this),!0),this._iframeWindow.addEventListener("pointerdown",this._handlePointerDown.bind(this),!0),this._iframeWindow.addEventListener("mousedown",this._handlePointerDown.bind(this),!0),this._iframeWindow.addEventListener("touchmove",this._handleTouchMove.bind(this),{passive:!1}),this._iframeWindow.addEventListener("touchend",this._handleTouchEnd.bind(this),{passive:!1}),this._iframeWindow.addEventListener("pointermove",this._handlePointerMove.bind(this),{passive:!0}),this._iframeWindow.addEventListener("pointerup",this._handlePointerUp.bind(this)),this._iframeWindow.addEventListener("dragstart",this._handleDragStart.bind(this),{capture:!0}),this._iframeWindow.addEventListener("dragend",this._handleDragEnd.bind(this)),this._iframeWindow.addEventListener("dragover",this._handlePointerMove.bind(this),{passive:!0}),this._iframeWindow.addEventListener("dragover",this._handleDragOver.bind(this)),this._iframeWindow.addEventListener("drop",this._handleDrop.bind(this),{capture:!0}),this._iframeWindow.addEventListener("copy",this._handleCopy.bind(this),!0),this._iframeWindow.addEventListener("input",this._handleInput.bind(this)),this._dragCanvas=this._iframeWindow.document.createElement("canvas"),this._dragCanvas.style.position="absolute",this._dragCanvas.style.left="-100%",this._iframeWindow.document.body.append(this._dragCanvas),this._autoScroll=new sc({container:this._iframeWindow.document.getElementById("viewerContainer")}),this._iframeWindow.PDFViewerApplication.onPassword=()=>{this._onRequestPassword()},await this._iframeWindow.PDFViewerApplication.initializedPromise,this._iframeWindow.PDFViewerApplication.eventBus.on("documentinit",this._handleDocumentInit.bind(this)),this._findController=new ed({linkService:this._iframeWindow.PDFViewerApplication.pdfViewer.linkService,onNavigate:async(e,t)=>{let n=await this._findController.getMatchPositionsAsync(e);this.navigateToPosition(n[t])},onUpdateMatches:({matchesCount:e})=>{let t={total:e.total,index:e.current-1,pageIndex:e.currentPageIndex,snippets:e.snippets};3===this._pdfjsFindState?t=null:e.current&&(async()=>{await this._ensureBasicPageData(e.currentPageIndex);let n=Zu(this._pdfPages,{pageIndex:e.currentPageIndex,offset:e.currentOffsetStart},{pageIndex:e.currentPageIndex,offset:e.currentOffsetEnd+1});t.annotation=this._getAnnotationFromSelectionRanges(n,"highlight"),t.currentPageLabel=t.annotation.pageLabel,t.currentSnippet=t.snippets[e.current-1]})(),this._onSetFindState({...this._findState,result:t}),this._render()},onUpdateState:({matchesCount:e,state:t,rawQuery:n})=>{this._pdfjsFindState=t;let r={total:e.total,index:e.current-1,snippets:e.snippets};3!==this._pdfjsFindState&&n.length?e.current&&(async()=>{await this._ensureBasicPageData(e.currentPageIndex);let t=Zu(this._pdfPages,{pageIndex:e.currentPageIndex,offset:e.currentOffsetStart},{pageIndex:e.currentPageIndex,offset:e.currentOffsetEnd+1});r.annotation=this._getAnnotationFromSelectionRanges(t,"highlight"),r.currentPageLabel=r.annotation.pageLabel,r.currentSnippet=r.snippets[e.current-1]})():r=null,this._onSetFindState({...this._findState,result:r}),this._render()}})}async _init2(){var e;this._pdfRenderer=new bc({pdfView:this}),this._primary&&!this._preview&&(null===(e=this._pdfRenderer)||void 0===e||e.start()),this._init2=null,this._iframeWindow.PDFViewerApplication.eventBus.on("updateviewarea",this._handleViewAreaUpdate.bind(this)),this._updateViewStats()}async _handleDocumentInit(){this.setTool(this._tool),this._viewState?await this._setState(this._viewState,!!this._location):this._iframeWindow.PDFViewerApplication.pdfViewer.currentScaleValue="page-width",this._location&&this.navigate(this._location),this._resolveInitializedPromise(),await this._initProcessedData(),this._findController.setDocument(this._iframeWindow.PDFViewerApplication.pdfDocument)}async _setState(e,t){if(Number.isInteger(e.scrollMode)&&(this._iframeWindow.PDFViewerApplication.pdfViewer.scrollMode=e.scrollMode),Number.isInteger(e.spreadMode)&&(this._iframeWindow.PDFViewerApplication.pdfViewer.spreadMode=e.spreadMode),!t){let t=[null,{name:"XYZ"},e.left||null,void 0===e.top?null:e.top,parseInt(e.scale)?e.scale/100:e.scale];this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:(e.pageIndex||0)+1,destArray:t,allowNegativeOffset:!0})}if(await Promise.race([this._iframeWindow.PDFViewerApplication.pdfViewer.pagesPromise,new Promise((e=>{setTimeout(e,1e4)}))]),!t){let t=[null,{name:"XYZ"},e.left||null,void 0===e.top?null:e.top,parseInt(e.scale)?e.scale/100:e.scale];this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:(e.pageIndex||0)+1,destArray:t,allowNegativeOffset:!0})}}async _initThumbnails(){this._pdfThumbnails=new vc({pdfView:this,window:this._iframeWindow,onUpdate:e=>{this._onSetThumbnails(e)}})}async _updateColorScheme(){if("light"===this._forcedColorScheme?this._colorScheme="light":"dark"===this._forcedColorScheme?this._colorScheme="dark":this._colorScheme=this._preferedColorTheme,this._iframeWindow){var e;this._iframeWindow.document.documentElement.dataset.colorScheme=this._colorScheme;let t=this._iframeWindow.document.documentElement;"light"===this._colorScheme&&this._lightTheme?(this._iframeWindow.theme=this._lightTheme,t.style.setProperty("--background-color",this._lightTheme.background),this._themeColorScheme=Cr(this._lightTheme.background,this._lightTheme.foreground)):"dark"===this._colorScheme&&this._darkTheme?(this._iframeWindow.theme=this._darkTheme,t.style.setProperty("--background-color",this._darkTheme.background),this._themeColorScheme=Cr(this._darkTheme.background,this._darkTheme.foreground)):(this._iframeWindow.theme=null,t.style.setProperty("--background-color","#FFFFFF"),this._themeColorScheme="light");for(let e of this._pages)e.originalPage.reset();await this._iframeWindow.PDFViewerApplication.initializedPromise,this._iframeWindow.PDFViewerApplication.pdfViewer.update(),null===(e=this._pdfThumbnails)||void 0===e||e.clear()}}async _initProcessedData(){let e=await this._iframeWindow.PDFViewerApplication.pdfDocument.getPageLabels2();this._onSetPageLabels(e),this._resolvePageLabelsPromise(),this._render(),this._updateViewStats();let{pages:t}=await this._iframeWindow.PDFViewerApplication.pdfDocument.getProcessedData();for(let e in t)this._pdfPages[e]=t[e];this._render(),this._updateViewStats()}async _ensureBasicPageData(e){if(!this._pdfPages[e]){let t=await this._iframeWindow.PDFViewerApplication.pdfDocument.getPageData({pageIndex:e});this._pdfPages[e]||(this._pdfPages[e]=t)}}async _attachPage(e){if(this._init2&&this._init2(),this._preview){this._detachPage(e,!0);let t=new ic(this,e);return this._pages.push(t),void this._render()}this._primary&&!this._pdfThumbnails&&this._initThumbnails(),this._detachPage(e,!0),e.textLayerPromise.then((()=>{let t=e.div.querySelector(".textLayer");t&&(t.draggable=!0)}));let t=new ic(this,e),n=e.id-1;if(this._pages.push(t),this._render(),!this._pdfPages[n]){let e=await this._iframeWindow.PDFViewerApplication.pdfDocument.getPageData({pageIndex:n});this._pdfPages[n]||(this._pdfPages[n]=e,this._render())}}_detachPage(e,t){let n=e.id-1;this._pages=this._pages.filter((t=>t.originalPage!==e)),t||delete this._pdfPages[n]}_getPageLabel(e,t){let n=this._pageLabels[e]||(e+1).toString();if(t){let t=this._annotations.slice().reverse();for(let r of t)if(!r.readOnly&&"-"!==r.pageLabel&&r.position.pageIndex<=e){(parseInt(r.pageLabel)==r.pageLabel||/[0-9]+[-\u2013][0-9]+/.test(r.pageLabel))&&(n=(e+(parseInt(r.pageLabel)-r.position.pageIndex)).toString());break}}return n}_clearFocus(){this._focusedObject=null,this._render()}_focusNext(e){let t,n,r=this._iframeWindow.PDFViewerApplication.pdfViewer._getVisiblePages(),i=[],o=this._iframeWindow.PDFViewerApplication.pdfViewer.scroll.lastY,a=this._iframeWindow.PDFViewerApplication.pdfViewer.scroll.lastX;for(let e of r.views){let t=[a,o,a+this._iframeWindow.innerWidth,o+this._iframeWindow.innerHeight],n=e.id-1,r=[],s=this._pdfPages[n];s&&(r=s.overlays);let l=[];for(let e of this._annotations)(e.position.pageIndex===n||e.position.nextPageRects&&e.position.pageIndex+1===n)&&l.push({type:"annotation",object:e});for(let e of r)l.push({type:"overlay",object:e});for(let r of l){let o=fu(oc(r.object.position,e.view.viewport,n),n),a=[e.x+o[0],e.y+o[1],e.x+o[2],e.y+o[3]];r.rect=a,r.pageIndex=n,mu(a,t)&&i.push(r)}}if(this._focusedObject)for(let e of i)e.object===this._focusedObject.object&&e.pageIndex===this._focusedObject.pageIndex&&(n=e);if(n&&e){let r=i.filter((e=>e!==n));t=Ou(n.rect,r,e)}else t=Ou([a,o,a,o],i);return t&&(this._focusedObject=t,this._onFocusAnnotation(t.object),this._lastFocusedObject=this._focusedObject,this._render(),this._selectedOverlay&&(this._selectedOverlay=null,this._onSetOverlayPopup(null))),!!this._focusedObject}getPageByIndex(e){return this._pages.find((t=>t.pageIndex===e))}_render(e){for(let t of this._pages)e&&!e.includes(t.pageIndex)||t.render()}destroy(){this._overlayPopupDelayer.destroy()}focus(){this._iframe.focus()}async renderPageAnnotationsOnCanvas(e,t,n){this._annotations.find((e=>e.position.pageIndex===n&&"underline"===e.type))&&await this._ensureBasicPageData(n),function(e,t,n,r,i){let o=e.getContext("2d",{alpha:!1}),a=e.width/t.width;o.transform(a,0,0,a,0,0),o.globalCompositeOperation="multiply";for(let e of n){if(!(e.position.pageIndex===r||e.position.nextPageRects&&e.position.pageIndex+1===r))continue;let{color:n}=e,a=oc(e.position,t,r);if(o.save(),"highlight"===e.type){let e;e=a.nextPageRects&&a.pageIndex+1===r?a.nextPageRects:a.rects,o.fillStyle=n+"80";for(let t of e)o.fillRect(t[0],t[1],t[2]-t[0],t[3]-t[1])}else if("underline"===e.type){let n,s,l=e.color,u=i[r];o.fillStyle=l,a.nextPageRects&&a.pageIndex+1===r?(n=a.nextPageRects,s=e.position.nextPageRects[0]):(n=a.rects,s=e.position.rects[0]);let c=1;c*=t.scale;for(let e of n){let n=0;if(u){let{chars:e}=u;n=tc(e,s)}n+=Fu(t.transform),n=Tu(n);let[r,i,a,l]=e,d=0===n&&[r,l-c,a,l]||90===n&&[a-c,l,a,i]||180===n&&[r,i,a,i-c]||270===n&&[r,l,r-c,i];o.fillRect(d[0],d[1],d[2]-d[0],d[3]-d[1])}}else if("note"===e.type){o.save();let[e,t]=a.rects[0],r=1/devicePixelRatio;o.transform(r,0,0,r,e,t),o.fillStyle="#000";var s=new Path2D("M0,0V12.707L11.293,24H24V0ZM11,22.293,1.707,13H11ZM23,23H12V12H1V1H23Z");o.fill(s),o.fillStyle=n,o.beginPath(),o.moveTo(.5,.5),o.lineTo(23.5,.5),o.lineTo(23.5,23.5),o.lineTo(11.5,23.5),o.lineTo(.5,12.5),o.closePath(),o.fill(),o.fillStyle="rgba(255, 255, 255, 0.4)",o.beginPath(),o.moveTo(.5,12.5),o.lineTo(11.5,12.5),o.lineTo(11.5,23.5),o.closePath(),o.fill(),o.restore()}else if("image"===e.type){let e=a.rects[0];o.lineWidth=2,o.strokeStyle=n,o.strokeRect(e[0],e[1],e[2]-e[0],e[3]-e[1])}else if("ink"===e.type){o.lineCap="round",o.lineJoin="round",o.lineWidth=a.width,o.beginPath(),o.strokeStyle=n;for(let e of a.paths)for(let t=0;t<e.length-1;t+=2){let n=e[t],r=e[t+1];0===t&&o.moveTo(n,r),o.lineTo(n,r)}o.stroke()}else if("text"===e.type){let n=e.position,r=n.rects[0],i=r[2]-r[0],a=1.2*n.fontSize;o.fillStyle=e.color,o.font=n.fontSize+"px "+window.computedFontFamily;let s=r[0],l=r[1],u=vu(t.transform,[1,0,0,1,s,l]),c=-n.rotation*Math.PI/180,d=Math.cos(c),h=Math.sin(c),p=vu([1,0,0,-1,0,0],[d,h,-h,d,0,0]),f=(r[2]-r[0])/2,m=(r[3]-r[1])/2,[g,v]=yu([f,m],u),[y,b]=yu([f,m],vu(u,p)),_=g-y,w=v-b,S=t.transform.slice();S[4]=S[5]=0,[_,w]=bu([_,w],S),p[4]=_,p[5]=w;let C=vu(u,p);o.transform(...C);let E=0,x=Fc(o,e.comment,i);for(let e of x)o.fillText(e,0,E*a+a),E++}o.restore()}}(e,t,this._annotations,n,this._pdfPages)}navigateToPosition(e,t={}){let n=this._iframeWindow.document.getElementById("viewerContainer"),r=this.getPositionBoundingViewRect(e),{clientWidth:i,clientHeight:o,scrollWidth:a,scrollHeight:s}=n,l=r[0]-i/2,u=r[1]-("start"===t.block?0:o/2)-5;l=Math.max(0,Math.min(l,a-i)),u=Math.max(0,Math.min(u,s-o));let{first:c,last:d}=this._iframeWindow.PDFViewerApplication.pdfViewer._getVisiblePages(),h=c.id-1,p=d.id-1;h--,p++;let f=h<=e.pageIndex&&e.pageIndex<=p;n.scrollTo({left:l,top:u,behavior:f?"smooth":"instant"})}setPageLabels(e){this._pageLabels=e;for(let t=0;t<this._iframeWindow.PDFViewerApplication.pdfViewer._pages.length;t++){let n=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],r=e[t];r!=t+1?n.div.setAttribute("aria-label",`Page: ${r}. Index: ${t+1}`):n.div.setAttribute("aria-label",`Page: cd ${t+1}`)}}setReadOnly(e){this._readOnly=e}setTool(e){"hand"===e.type?this._iframeWindow.PDFViewerApplication.pdfCursorTools.switchTool(1):this._iframeWindow.PDFViewerApplication.pdfCursorTools.switchTool(0),this._iframeWindow.document.getElementById("viewerContainer").style.touchAction="pointer"!==e.type?"none":"auto",this._tool=e}setAnnotations(e){var t,n;let r=function(e,t,n){let r=[],i=new Set(t.map((e=>e.id)));for(let t of e)i.has(t.id)||r.push(t);let o=[],a=[],s=new Map(e.map((e=>[e.id,e])));for(let e of t){let t=s.get(e.id);t?e!==t&&(e.color===t.color&&e.comment===t.comment&&_r(e.position,t.position)||a.push(e)):o.push(e)}return{created:o,updated:a,deleted:r}}(this._annotations,e),{created:i,updated:o,deleted:a}=r;this._annotations=e,"annotation"===(null===(t=this._focusedObject)||void 0===t?void 0:t.type)&&(o.find((e=>e.id===this._focusedObject.object.id))?this._focusedObject.object=o.find((e=>e.id===this._focusedObject.object.id)):a.find((e=>e.id===this._focusedObject.object.id))&&(this._focusedObject=null)),"annotation"===(null===(n=this._lastFocusedObject)||void 0===n?void 0:n.type)&&(o.find((e=>e.id===this._lastFocusedObject.object.id))?this._lastFocusedObject.object=o.find((e=>e.id===this._lastFocusedObject.object.id)):a.find((e=>e.id===this._lastFocusedObject.object.id))&&(this._lastFocusedObject=null));let s=function(e){let t=new Set;for(let n of e)t.add(n.position.pageIndex),n.position.nextPageRects&&t.add(n.position.pageIndex+1);return Array.from(t).sort()}([...i,...o,...a]);var l,u;this._render(s),this._primary&&!this._preview&&(null===(l=this._pdfThumbnails)||void 0===l||l.render(s,!0),null===(u=this._pdfRenderer)||void 0===u||u.start())}setLightTheme(e){this._lightTheme=e,this._updateColorScheme()}setDarkTheme(e){this._darkTheme=e,this._updateColorScheme()}setColorScheme(e){this._forcedColorScheme=e,this._updateColorScheme()}setAnnotationPopup(e){this._annotationPopup=e}setSelectionPopup(e){this._selectionPopup=e}setOverlayPopup(e){this._overlayPopup=e,this._overlayPopupDelayer.setOpen(!!e)}setFindState(e){e.active||this._findState.active===e.active||this._findController.onClose(),e.active?(this._findState.query===e.query&&this._findState.highlightAll===e.highlightAll&&this._findState.caseSensitive===e.caseSensitive&&this._findState.entireWord===e.entireWord&&this._findState.active===e.active||(this._findState=e,this._findController.find({type:"find",query:e.query,phraseSearch:!0,caseSensitive:e.caseSensitive,entireWord:e.entireWord,highlightAll:e.highlightAll,findPrevious:!1})),this._findState=e,this.a11yWillPlaceVirtCursorOnSearchResult()):this._findState=e}findNext(){this._findController.find({type:"again",query:this._findState.query,phraseSearch:!0,caseSensitive:this._findState.caseSensitive,entireWord:this._findState.entireWord,highlightAll:this._findState.highlightAll,findPrevious:!1})}findPrevious(){this._findController.find({source:this._iframeWindow,type:"again",query:this._findState.query,phraseSearch:!0,caseSensitive:this._findState.caseSensitive,entireWord:this._findState.entireWord,highlightAll:this._findState.highlightAll,findPrevious:!0})}setSelectedAnnotationIDs(e){this._selectedAnnotationIDs=e,this._setSelectionRanges(),this._render(),this._onSetAnnotationPopup()}_openAnnotationPopup(){let e=this.getSelectedAnnotations();if(1===e.length){let t=e[0],n=this._iframeWindow.document.getElementById("viewerContainer"),r=this.getClientRectForPopup(t.position,n.scrollLeft,n.scrollTop);this._onSetAnnotationPopup({rect:r,annotation:t})}}_setSelectionRanges(e){this._selectionRanges=e||[];let t=this._selectionRanges[0];if(t&&!t.collapsed){let e=this.getClientRectForPopup(t.position),n=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");this._onSetSelectionPopup({rect:e,annotation:n})}else this._onSetSelectionPopup()}_isSelectionCollapsed(){return!this._selectionRanges.length||!!this._selectionRanges[0].collapsed}showAnnotations(e){}zoomReset(){this.zoomPageWidth()}zoomIn(){this._iframeWindow.PDFViewerApplication.zoomIn()}zoomOut(){this._iframeWindow.PDFViewerApplication.zoomOut()}zoomPageWidth(){this._iframeWindow.PDFViewerApplication.pdfViewer.currentScaleValue="page-width"}zoomPageHeight(){this._iframeWindow.PDFViewerApplication.pdfViewer.currentScaleValue="page-fit"}zoomAuto(){this._iframeWindow.PDFViewerApplication.pdfViewer.currentScaleValue="auto"}async _pushHistoryPoint(){this._suspendHistorySaving=!0;let e=this._iframeWindow.document.getElementById("viewerContainer");await wr(e,100),this._suspendHistorySaving=!1;let{pageNumber:t,top:n,left:r}=this._iframeWindow.PDFViewerApplication.pdfViewer._location,i=t-1;this._history.save({dest:[i,{name:"XYZ"},r,n,null]})}_highlightPosition(e){this._highlightedPosition=e,this._render(),setTimeout((()=>{this._highlightedPosition=null,this._render()}),2e3)}async navigate(e,t={}){if(t.block||(t.block="center"),this._lastNavigationTime=Date.now(),e.annotationID&&this._annotations.find((t=>t.id===e.annotationID))){let n=this._annotations.find((t=>t.id===e.annotationID));this.navigateToPosition(n.position,t)}else if(e.dest)this._iframeWindow.PDFViewerApplication.pdfLinkService.goToDestination(e.dest);else if(e.position)this.navigateToPosition(e.position,t),this._highlightPosition(e.position);else if(Number.isInteger(e.pageIndex))this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:e.pageIndex+1});else if(e.pageLabel){await this._pageLabelsPromise;let t=this._pageLabels.findIndex((t=>t===e.pageLabel));-1!==t&&this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:t+1})}else if(e.pageNumber){await this._pageLabelsPromise;let t=this._pageLabels.findIndex((t=>t===e.pageNumber));if(-1!==t)this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:t+1});else{let t=parseInt(e.pageNumber)-1;-1!==t&&this._iframeWindow.PDFViewerApplication.pdfViewer.scrollPageIntoView({pageNumber:t+1})}}t.skipHistory||this._pushHistoryPoint()}navigateBack(){this._history.navigateBack()}navigateForward(){this._history.navigateForward()}navigateToNextPage(){this._iframeWindow.PDFViewerApplication.pdfViewer.nextPage()}navigateToPreviousPage(){this._iframeWindow.PDFViewerApplication.pdfViewer.previousPage()}navigateToFirstPage(){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("firstpage")}navigateToLastPage(){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("lastpage")}rotateLeft(){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("rotateccw")}rotateRight(){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("rotatecw")}setSidebarOpen(e){}getViewPoint(e,t,n=[1,0,0,1,0,0]){let r=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],i=[r.outputScale.sx,0,0,r.outputScale.sy,0,0];return i=vu(i,r.viewport.transform),i=vu(i,n),yu(e,i)}getPdfPoint(e,t,n){let r=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],i=[r.outputScale.sx,0,0,r.outputScale.sy,0,0];return i=vu(i,r.viewport.transform),i=vu(i,n),bu(e,i)}getViewRect(e,t){let n=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],r=[n.outputScale.sx,0,0,n.outputScale.sy,0,0];r=vu(r,n.viewport.transform);let[i,o]=yu(e.slice(0,2),r),[a,s]=yu(e.slice(2,4),r);return[Math.min(i,a),Math.min(s,o),Math.max(i,a),Math.max(s,o)]}getViewportRotation(e){return Fu(this._iframeWindow.PDFViewerApplication.pdfViewer._pages[e].viewport.transform)}getPositionBoundingViewRect(e){let{pageIndex:t}=e,n=fu(e,t),r=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t].viewport,i=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],[o,a]=r.convertToViewportPoint(...n),[s,l]=r.convertToViewportPoint(...n.slice(2,4)),u=[Math.min(o,s),Math.min(l,a),Math.max(o,s),Math.max(l,a)],c=i.div.getBoundingClientRect(),d=this._iframeWindow.document.getElementById("viewerContainer"),h=d.scrollLeft,p=d.scrollTop;return[c.x+u[0]+h,c.y+u[1]+p,c.x+u[2]+h,c.y+u[3]+p]}getClientRectForPopup(e,t,n){let r=e.nextPageRects?e.pageIndex+1:e.pageIndex,i=fu(e,r),o=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[r],[a,s]=o.viewport.convertToViewportPoint(...i),[l,u]=o.viewport.convertToViewportPoint(...i.slice(2,4)),c=[Math.min(a,l),Math.min(u,s),Math.max(a,l),Math.max(u,s)];this._pp;{let e=o.div.getBoundingClientRect();return this._pp={pr:e,scrollLeft:t,scrollTop:n},[e.x+c[0],e.y+c[1],e.x+c[2],e.y+c[3]]}}getClientRect(e,t){let n=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],[r,i]=n.viewport.convertToViewportPoint(...e),[o,a]=n.viewport.convertToViewportPoint(...e.slice(2,4)),s=[Math.min(r,o),Math.min(a,i),Math.max(r,o),Math.max(a,i)],l=this._pr;return l||(l=n.div.getBoundingClientRect()),[l.x+s[0],l.y+s[1],l.x+s[2],l.y+s[3]]}getSelectedAnnotationAction(e,t){if("ink"===e.type){let t=fu(e.position);if(t[0]===t[2]||t[1]===t[3])return null}if(!e.position.nextPageRects&&e.position.pageIndex!==t.pageIndex||e.position.nextPageRects&&!this._pdfPages[e.position.pageIndex+1])return null;if(this._readOnly||e.readOnly){if(gu(e.position,t)){let n=t.rects[0],r=fu(e.position);return{type:"drag",annotation:e,x:n[0]-r[0],y:n[1]-r[1]}}return null}if(!this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t.pageIndex].outputScale)return null;let n=5*devicePixelRatio,r=this.getViewPoint(t.rects[0],t.pageIndex);if(r=[r[0],r[1],r[0],r[1]],["highlight","underline"].includes(e.type)){if(this._pdfPages[e.position.pageIndex]&&(!e.position.nextPageRects||this._pdfPages[e.position.pageIndex+1])){let n,i,{chars:o}=this._pdfPages[e.position.pageIndex],a=3;if(e.position.nextPageRects)if(e.position.pageIndex+1===t.pageIndex){let{chars:t}=this._pdfPages[e.position.pageIndex+1],n=tc(t,e.position.nextPageRects.at(-1));n+=this.getViewportRotation(e.position.pageIndex+1),n=Tu(n);let r=this.getViewRect(e.position.nextPageRects.at(-1),e.position.pageIndex+1),[o,s,l,u]=r;r=0===n&&[l-a,s,l+a,u]||90===n&&[o,s-a,l,s+a]||180===n&&[o-a,s,o+a,u]||270===n&&[o,u-a,l,u+a],i={rect:r,vertical:[90,270].includes(n)}}else{let t=tc(o,e.position.rects[0]);t+=this.getViewportRotation(e.position.pageIndex),t=Tu(t);let r=this.getViewRect(e.position.rects[0],e.position.pageIndex),[i,s,l,u]=r;r=0===t&&[i-a,s,i+a,u]||90===t&&[i,u-a,l,u+a]||180===t&&[l-a,s,l+a,u]||270===t&&[i,s-a,l,s+a],n={rect:r,vertical:[90,270].includes(t)}}else{let t=tc(o,e.position.rects[0]);t+=this.getViewportRotation(e.position.pageIndex),t=Tu(t);let r=this.getViewRect(e.position.rects[0],e.position.pageIndex),[s,l,u,c]=r;r=0===t&&[s-a,l,s+a,c]||90===t&&[s,c-a,u,c+a]||180===t&&[u-a,l,u+a,c]||270===t&&[s,l-a,u,l+a],n={rect:r,vertical:[90,270].includes(t)},t=tc(o,e.position.rects.at(-1)),t+=this.getViewportRotation(e.position.pageIndex),t=Tu(t),r=this.getViewRect(e.position.rects.at(-1),e.position.pageIndex),[s,l,u,c]=r,r=0===t&&[u-a,l,u+a,c]||90===t&&[s,l-a,u,l+a]||180===t&&[s-a,l,s+a,c]||270===t&&[s,c-a,u,c+a],i={rect:r,vertical:[90,270].includes(t)}}if(n){let{rect:t,vertical:i}=n;if(mu(t,r)){let t=Qu(this._pdfPages,e.position);return t=Ju(t),{type:"updateAnnotationRange",selectionRanges:t,annotation:e,vertical:i}}}if(i){let{rect:t,vertical:n}=i;if(mu(t,r))return{type:"updateAnnotationRange",selectionRanges:Qu(this._pdfPages,e.position),annotation:e,vertical:n}}}}else if(["image","text","ink"].includes(e.type)){let i=fu(e.position);"text"===e.type&&(i=e.position.rects[0]);let o=[1,0,0,1,0,0];"text"===e.type&&e.position.rotation&&(o=Su(i,e.position.rotation||0));let a=this.getViewPoint([i[0],i[1]],t.pageIndex,o),s=this.getViewPoint([i[2],i[1]],t.pageIndex,o),l=this.getViewPoint([i[0],i[3]],t.pageIndex,o),u=this.getViewPoint([i[2],i[3]],t.pageIndex,o),c=this.getViewPoint([i[0],i[1]+(i[3]-i[1])/2],t.pageIndex,o),d=this.getViewPoint([i[2],i[1]+(i[3]-i[1])/2],t.pageIndex,o),h=this.getViewPoint([i[0]+(i[2]-i[0])/2,i[3]],t.pageIndex,o),p=this.getViewPoint([i[0]+(i[2]-i[0])/2,i[1]],t.pageIndex,o),f=16,m=this.getViewPoint([i[0]+(i[2]-i[0])/2,i[3]+f],t.pageIndex,o),g=10*devicePixelRatio;["text","ink"].includes(e.type)&&([a,s,l,u,c,d,h,p]=Eu([a,s,u,l],[a,s,l,u,c,d,h,p],g));let v,y=[a[0]-n,a[1]-n,a[0]+n,a[1]+n],b=[s[0]-n,s[1]-n,s[0]+n,s[1]+n],_=[l[0]-n,l[1]-n,l[0]+n,l[1]+n],w=[u[0]-n,u[1]-n,u[0]+n,u[1]+n],S=(a[0],l[1],l[0],a[1],s[0],u[1],u[0],s[1],l[0],l[1],u[0],u[1],a[0],a[1],s[0],s[1],[c[0]-n,c[1]-n,c[0]+n,c[1]+n]),C=[d[0]-n,d[1]-n,d[0]+n,d[1]+n],E=[h[0]-n,h[1]-n,h[0]+n,h[1]+n],x=[p[0]-n,p[1]-n,p[0]+n,p[1]+n],A=[m[0]-n,m[1]-n,m[0]+n,m[1]+n];if("text"===e.type&&mu(A,r))return{type:"rotate",annotation:e};if(mu(w,r)?v="tr":mu(_,r)?v="tl":mu(b,r)?v="br":mu(y,r)?v="bl":["image","text"].includes(e.type)&&mu(S,r)?v="l":["image","text"].includes(e.type)&&mu(C,r)?v="r":"image"===e.type&&mu(E,r)?v="t":"image"===e.type&&mu(x,r)&&(v="b"),v)return{type:"resize",annotation:e,dir:v};l[0],l[1],s[0],s[1];let k=!1,D=[this.getPdfPoint(a,t.pageIndex,o),this.getPdfPoint(s,t.pageIndex,o),this.getPdfPoint(l,t.pageIndex,o),this.getPdfPoint(u,t.pageIndex,o)],P=[Math.min(...D.map((e=>e[0]))),Math.min(...D.map((e=>e[1]))),Math.max(...D.map((e=>e[0]))),Math.max(...D.map((e=>e[1])))],T=this.getPdfPoint(r,t.pageIndex,o);if(T=[T[0],T[1],T[0],T[1]],mu(P,T)&&(k=!0),k&&!this._textAnnotationFocused()){let n=t.rects[0],r=fu(e.position);return{type:["text","ink"].includes(e.type)?"moveAndDrag":"drag",annotation:e,x:n[0]-r[0],y:n[1]-r[1]}}}if(["highlight","underline","note"].includes(e.type)&&gu(e.position,t)){let n=t.rects[0],r=fu(e.position);return{type:["note","text","ink"].includes(e.type)?"moveAndDrag":"drag",annotation:e,x:n[0]-r[0],y:n[1]-r[1]}}return null}getMoveAction(e,t){let n=t.rects[0],r=fu(e.position);return{type:"move",annotation:e,x:n[0]-r[0],y:n[1]-r[1]}}_getSelectableOverlay(e){if(!e)return;let t=this._pdfPages[e.pageIndex];if(!t)return;let n=[];for(let r of t.overlays)gu(r.position,e)&&n.push(r);return n.sort(((e,t)=>{let n,r;return e.position.rects?n=Iu(e.position.rects):e.position.paths&&(n=0),t.position.rects?r=Iu(t.position.rects):t.position.paths&&(r=0),n-r})),n[0]}_getPageAnnotations(e){return this._annotations.filter((t=>t.position.pageIndex===e||t.position.nextPageRects&&t.position.pageIndex+1===e))}getSelectableAnnotations(e){if(!this.getPageByIndex(e.pageIndex))return null;let t=this._getPageAnnotations(e.pageIndex),n=[];for(let r of t)if("text"===r.type&&r.position.rotation){let t=Su(r.position.rects[0],r.position.rotation);mu(xu(e.rects[0],Au(t)),r.position.rects[0])&&n.push(r)}else gu(r.position,e)&&n.push(r);let r=n.find((e=>"text"===e.type&&e.id===this._selectedAnnotationIDs[0]));return r?[r]:(n.sort(((e,t)=>{let n,r;return e.position.rects?n=Iu(e.position.rects):e.position.paths&&(n=0),t.position.rects?r=Iu(t.position.rects):t.position.paths&&(r=0),n-r})),n)}getSelectedAnnotations(){return this._annotations.filter((e=>this._selectedAnnotationIDs.includes(e.id)))}getActionAtPosition(e,t){let n=!t.pointerType||"mouse"===t.pointerType;if(n&&t.button>=1||"hand"===this._tool.type)return{action:{type:"none"},selectAnnotations:[]};if(t.altKey)return{action:{type:"selectText"},selectAnnotations:[]};if("ink"===this._tool.type)return{action:{type:"ink"},selectAnnotations:[]};if("eraser"===this._tool.type)return{action:{type:"erase",annotations:new Map},selectAnnotations:[]};if(this._selectionRanges.length&&![2,3].includes(t.detail)){let t=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");if(t&&gu(t.position,e)){let n=e.rects[0],r=fu(t.position);return{action:{type:"drag",annotation:t,x:n[0]-r[0],y:n[1]-r[1],selection:!0},selectAnnotations:null}}}let r=this.getSelectedAnnotations(),i=r;if(1===r.length){let t=i[0],n=this.getSelectedAnnotationAction(t,e);if(n)return{action:n,selectAnnotations:null}}let o=(this.getSelectableAnnotations(e)||[])[0],a=null;if(o)if(r.includes(o))a={type:"drag",annotation:o,multiple:!0},i=null;else{i=[o];let t=o;if(this._readOnly||t.readOnly||!["note","text","ink"].includes(t.type)){let n=e.rects[0],r=fu(t.position);a={type:"drag",annotation:t,x:n[0]-r[0],y:n[1]-r[1]}}else{let n=e.rects[0],r=fu(t.position);a={type:"moveAndDrag",annotation:t,x:n[0]-r[0],y:n[1]-r[1]}}}else if(i=[],"note"===this._tool.type)a={type:"note"};else if("image"===this._tool.type)a={type:"image"};else if("text"===this._tool.type)a={type:"text"};else{if(!n&&"pen"!==t.pointerType&&!["highlight","underline"].includes(this._tool.type))return{action:{type:"none"},selectAnnotations:[]};a={type:"selectText"}}return{action:a,selectAnnotations:i}}updateCursor(e){let t="default";if(e)if("overlay"===e.type)t="pointer";else if("updateAnnotationRange"===e.type)t=e.triggered?"text":e.vertical?"ns-resize":"ew-resize";else if("resize"===e.type)e.annotation.position.rotation?t="move":["l","r"].includes(e.dir)?t="ew-resize":["t","b"].includes(e.dir)?t="ns-resize":["tl","br"].includes(e.dir)?t="nwse-resize":["bl","tr"].includes(e.dir)&&(t="nesw-resize");else if("move"===e.type)t="grab";else if("rotate"===e.type)t="move";else if("ink"===e.type)t="crosshair";else if("erase"===e.type){let e=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[0].viewport.transform,[n,r]=e,i=Math.hypot(n,r),o=this._tool.size*i,a=o*window.devicePixelRatio,s=1*window.devicePixelRatio;t=`url('${['data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg"',`     width="${o}"`,`     height="${o}"`,`     viewBox="0 0 ${a} ${a}">`,`    <circle cx="${a/2}"`,`            cy="${a/2}"`,`            r="${(a-s)/2}"`,`            stroke="${"dark"===localStorage.getItem("theme")?"dark":"white"}"`,`            stroke-width="${s}"`,'            fill="none" />',"</svg>"].join("")}') ${o/2} ${o/2}, auto`}else["selectText"].includes(e.type)&&(t="text");this._iframeWindow.document.getElementById("viewerContainer").style.cursor=t}_updateScrollVector(){}_handlePointerDown(e){if("mouse"===e.pointerType)return;if(this._pointerDownTriggered)return;if(this._pointerDownTriggered=!0,this._highlightedPosition=null,e.target.classList.contains("textAnnotation")||this._iframeWindow.getSelection().removeAllRanges(),this._lastFocusedObject=null,this._a11yVirtualCursorTarget=null,!e.target.closest("#viewerContainer"))return;this._clearFocus();let t=e.shiftKey,n=this.pointerEventToPosition(e);if("web"!==this._options.platform&&2===e.button){this._pointerDownTriggered=!1;let t,r=this._iframe.getBoundingClientRect();n&&(t=(this.getSelectableAnnotations(n)||[])[0]);let i=this.getSelectedAnnotations();if(t)i.includes(t)||this._textAnnotationFocused()?this._textAnnotationFocused()||this._onOpenAnnotationContextMenu({ids:i.map((e=>e.id)),x:r.x+e.clientX,y:r.y+e.clientY,view:!0}):(this._onSelectAnnotations([t.id],e),this._onOpenAnnotationContextMenu({ids:[t.id],x:r.x+e.clientX,y:r.y+e.clientY,view:!0}));else{let t;if(0!==this._selectedAnnotationIDs.length&&this._onSelectAnnotations([],e),n&&(t=this._getSelectableOverlay(n)),6===e.mozInputSource&&this._selectionRanges.length){const e=10;let n=this.getClientRectForPopup(this._selectionRanges[0].position);this._onOpenViewContextMenu({x:r.x+n[0],y:r.y+n[3]+e,overlay:t})}else this._onOpenViewContextMenu({x:r.x+e.clientX,y:r.y+e.clientY,overlay:t})}return void this._render()}if(!n)return this._setSelectionRanges(),this._onSelectAnnotations([],e),void this._render();this.getPageByIndex(n.pageIndex);let{action:r,selectAnnotations:i}=this.getActionAtPosition(n,e);if(this.action=r,this.pointerDownPosition=n,!i||0===i.length&&0===this._selectedAnnotationIDs.length||(this._onSelectAnnotations(i.map((e=>e.id)),e),i.length&&(r.alreadySelectedAnnotations=!0),this._openAnnotationPopup()),!i||i.length||t||this._onSelectAnnotations([],e),"note"===r.type){let e=n.rects[0],t={pageIndex:n.pageIndex,rects:[[e[0]-11,e[1]-11,e[2]+11,e[3]+11]]};this._onAddAnnotation({type:"note",color:this._tool.color,pageLabel:this._getPageLabel(this.pointerDownPosition.pageIndex,!0),sortIndex:qu(this._pdfPages,t),position:t},!0)}else if("text"===r.type){let e=n.rects[0],t=this._tool.size,r={pageIndex:n.pageIndex,fontSize:t,rotation:0,rects:[[e[0]-t/2,e[1]-t/2,e[2]+t/2,e[3]+t/2]]};this._onAddAnnotation({type:"text",color:this._tool.color,pageLabel:this._getPageLabel(this.pointerDownPosition.pageIndex,!0),sortIndex:qu(this._pdfPages,r),position:r},!0)}else if("ink"===r.type){let e=n.rects[0].slice(0,2);r.annotation={type:"ink",color:this._tool.color,pageLabel:this._getPageLabel(this.pointerDownPosition.pageIndex,!0),position:{pageIndex:this.pointerDownPosition.pageIndex,width:this._tool.size,paths:[[...e]]}},r.triggered=!0}else if("erase"===r.type){let e=[];for(let t of this._annotations)"ink"!==t.type||t.position.pageIndex!==n.pageIndex||r.annotations.has(t.id)||e.push(t);e.push(...r.annotations.values());let[t,i]=n.rects[0],o=Bc(t,i,this._tool.size,e);for(let e of o)r.annotations.set(e.id,e);o.length&&(r.triggered=!0)}if("selectText"===r.type&&(1!==e.detail&&e.detail?2===e.detail?(this._selectionRanges=Yu(this._pdfPages,n,n),this.action.mode="words"):3===e.detail&&(this._selectionRanges=Xu(this._pdfPages,n,n),this.action.mode="lines"):(t&&this._selectionRanges.length?this._selectionRanges=Ku(this._pdfPages,this._selectionRanges,n):this._selectionRanges=Zu(this._pdfPages,n,n),this.action.mode="chars"),this._selectionRanges.length&&!this._selectionRanges[0].collapsed&&(r.triggered=!0)),r.selection){let e=this._selectionRanges[0];if(e&&!e.collapsed){let t=this.getClientRectForPopup(e.position),n=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");this._onSetSelectionPopup({rect:t,annotation:n})}}else this._onSetSelectionPopup();this._autoScroll.enable(),this._render()}_handleTouchMove(e){var t;("pointer"!==this._tool.type||"selectText"===(null===(t=this.action)||void 0===t?void 0:t.type)&&"viewer"!==e.target.id)&&e.preventDefault()}_handleTouchEnd(e){e.preventDefault(),this._pointerDownTriggered=!1}_getAnnotationFromSelectionRanges(e,t,n){if(e[0].collapsed)return null;(e=e.slice()).sort(((e,t)=>e.pageIndex-t.pageIndex));let r=(e=e.slice(0,2))[0],i={type:t,color:n,sortIndex:r.sortIndex,pageLabel:this._getPageLabel(r.position.pageIndex,!0),position:r.position,text:r.text};if(2===e.length){let t=e[1];i.position.nextPageRects=t.position.rects,i.text+=" "+t.text}return i}_handlePointerUp(e){var t;if(this._pointerDownTriggered=!1,!this.action&&null!==(t=e.target.classList)&&void 0!==t&&t.contains("textAnnotation"))return;this._overlayPopupDelayer.close((()=>{this._selectedOverlay=null,this._onSetOverlayPopup(null)}));let n=this.pointerEventToPosition(e);if(this.pointerDownPosition){if(!this.action.triggered&&n){let e=this._getSelectableOverlay(n),t=this._getSelectableOverlay(this.pointerDownPosition);e&&e===t&&("internal-link"===e.type?this.navigate({position:e.destinationPosition}):"external-link"===e.type?this._onOpenLink(e.url):"citation"===e.type&&this.navigate({position:e.references[0].position}))}let t=this.action;if(t){if(t.triggered){if("updateAnnotationRange"===t.type)t.annotation.sortIndex=qu(this._pdfPages,t.annotation.position),this._onUpdateAnnotations([t.annotation]);else if("resize"===t.type){"text"===t.annotation.type&&2!==t.dir.length&&(t.position=Pc({...t.annotation,position:t.position},{adjustSingleLineWidth:!0}));let e=qu(this._pdfPages,t.position);this._onUpdateAnnotations([{id:t.annotation.id,position:t.position,sortIndex:e}])}else if("rotate"===t.type){let e=qu(this._pdfPages,t.position);this._onUpdateAnnotations([{id:t.annotation.id,position:t.position,sortIndex:e}])}else if("moveAndDrag"===t.type){let e=qu(this._pdfPages,t.position);this._onUpdateAnnotations([{id:t.annotation.id,position:t.position,sortIndex:e}])}else if("image"===t.type&&t.annotation){let e=t.annotation.position.rects[0],n=e[2]-e[0],r=e[3]-e[1];n>=ti&&r>=ti&&(t.annotation.sortIndex=qu(this._pdfPages,t.annotation.position),this._onAddAnnotation(t.annotation))}else if("ink"===t.type&&t.annotation){let e,n=this._annotations.find((e=>e.id===this._lastAddedInkAnnotationID)),r=t.annotation.position.paths[0];if(r=function(e){for(let t=0;t<2;t++)e=Ic(e);return function(e,t){const n=[e[0],e[1]];for(let t=2;t<e.length;t+=2){const r=[n[n.length-2],n[n.length-1]],i=[e[t],e[t+1]];Rc(r,i)>=1&&n.push(i[0],i[1])}return n}(e)}(r),r=r.map((e=>parseFloat(e.toFixed(3)))),t.annotation.position.paths[0]=r,n&&(e=Du(fu(n.position),fu(t.annotation.position))),n&&n.position.pageIndex===t.annotation.position.pageIndex&&n.position.width===t.annotation.position.width&&n.color===t.annotation.color&&Date.now()-Date.parse(n.dateModified)<1e4&&e<50){let{id:e,position:r}=n,i=n.position.paths.slice();i.push(t.annotation.position.paths[0]),r={...r,paths:i};let o=qu(this._pdfPages,r);this._onUpdateAnnotations([{id:e,position:r,sortIndex:o}])}else{t.annotation.sortIndex=qu(this._pdfPages,t.annotation.position);let{id:e}=this._onAddAnnotation(t.annotation);this._lastAddedInkAnnotationID=e}}else if("erase"===t.type&&t.triggered){let e=[...t.annotations.values()],n=e.filter((e=>e.position.paths.length)),r=e.filter((e=>!e.position.paths.length));n.length&&this._onUpdateAnnotations(n),r.length&&this._onDeleteAnnotations(r.map((e=>e.id)))}}else if(n&&!this.action.alreadySelectedAnnotations&&"eraser"!==this._tool.type){let t,r=this.getSelectableAnnotations(n),i=this._selectedAnnotationIDs.slice(-1)[0],o=r.find((e=>e.id===i));if("text"===(null==o?void 0:o.type)){let t=this._iframeWindow.document.querySelector(`[data-id="${o.id}"]`);t.classList.contains("focusable")||(t.classList.add("focusable"),t.focus(),e.preventDefault(),e.stopPropagation())}let a=r.indexOf(o);-1!==a&&a<r.length-1?t=r[a+1].id:r.length&&(t=r[0].id),t&&(this._onSelectAnnotations([t],e),this._openAnnotationPopup())}if(t.selection&&"drag"===t.type&&!t.triggered&&this._onSelectAnnotations([],e),"selectText"===t.type)if(["highlight","underline"].includes(this._tool.type)){if(this._selectionRanges.length&&!this._selectionRanges[0].collapsed){let e=this._getAnnotationFromSelectionRanges(this._selectionRanges,this._tool.type,this._tool.color);e.sortIndex=qu(this._pdfPages,e.position),this._onAddAnnotation(e),this._setSelectionRanges()}}else{let e=this._selectionRanges[0];if(e&&!e.collapsed){let t=this.getClientRectForPopup(e.position),n=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");n.pageLabel=this._getPageLabel(n.position.pageIndex,!0),this._onSetSelectionPopup({rect:t,annotation:n}),rc(this._iframeWindow,this._selectionRanges)}}}this.action=null,this.pointerDownPosition=null}if(n){let{action:t}=this.getActionAtPosition(n,e);this.updateCursor(t)}else this.updateCursor();1===this._selectionRanges.length&&this._selectionRanges[0].collapsed&&(this._selectionRanges=[]),this._render(),this._updateViewStats()}cancel(){this.setSelection(),this._hover=null,this.action=null,this.updateCursor(),this._render()}_updateViewStats(){let{currentPageNumber:e,currentScaleValue:t,pagesCount:n,scrollMode:r,spreadMode:i}=this._iframeWindow.PDFViewerApplication.pdfViewer,o=e-1,a=null;this._outline&&Date.now()-this._lastNavigationTime>1500&&(a=function(e,t){let n={path:null,pageIndex:-1/0};return function e(r,i){for(let l=0;l<r.length;l++){var o;let u=r[l],c=i.concat(l);var a,s;(null===(o=u.location)||void 0===o||null===(o=o.position)||void 0===o?void 0:o.pageIndex)<=t&&(null===(a=u.location)||void 0===a||null===(a=a.position)||void 0===a?void 0:a.pageIndex)>n.pageIndex&&(n={path:c,pageIndex:null===(s=u.location)||void 0===s||null===(s=s.position)||void 0===s?void 0:s.pageIndex}),u.items&&u.items.length>0&&e(u.items,c)}}(e,[]),n.path}(this._outline,o)),this._onChangeViewStats({pageIndex:o,pageLabel:this._getPageLabel(o),pagesCount:n,outlinePath:a,canCopy:!this._isSelectionCollapsed()||this._selectedAnnotationIDs.length,canZoomOut:!0,canZoomIn:!0,canZoomReset:"page-width"!==t,canNavigateBack:this._history.canNavigateBack,canNavigateForward:this._history.canNavigateForward,canNavigateToFirstPage:e>1,canNavigateToLastPage:e<n,canNavigateToPreviousPage:e>1,canNavigateToNextPage:e<n,zoomAutoEnabled:"auto"===t,zoomPageWidthEnabled:"page-width"===t,zoomPageHeightEnabled:"page-fit"===t,scrollMode:r,spreadMode:i}),this.a11yRecordCurrentPage()}_handleContextMenu(e){5!==e.mozInputSource&&6!==e.mozInputSource||this._handlePointerDown(e),"web"===this._options.platform||this._textAnnotationFocused()||e.preventDefault()}_handleKeyDown(e){var t;if(this._textAnnotationFocused())return;let n=e.altKey,r=gr(e),i=vr(e);if(!e.target.classList.contains("textAnnotation")){if(n&&this._selectionRanges.length&&rc(this._iframeWindow,this._selectionRanges),["Cmd-o","Ctrl-o","Cmd-s","Ctrl-s"].includes(r))e.stopPropagation(),e.preventDefault();else if(["Ctrl-Alt-p","Ctrl-Alt-p"].includes(r))e.stopPropagation();else if("r"===r)e.stopPropagation();else if(["n","j","p","k"].includes(r))e.stopPropagation();else if(["Alt-ArrowUp"].includes(r))this.navigateToPreviousPage(),e.stopPropagation(),e.preventDefault();else if(["Alt-ArrowDown"].includes(r))this.navigateToNextPage(),e.stopPropagation(),e.preventDefault();else if(r.startsWith("Shift")&&this._selectionRanges.length)e.stopPropagation(),e.preventDefault(),"Shift-ArrowLeft"===r?this._setSelectionRanges(Ku(this._pdfPages,this._selectionRanges,"left")):"Shift-ArrowRight"===r?this._setSelectionRanges(Ku(this._pdfPages,this._selectionRanges,"right")):"Shift-ArrowUp"===r?this._setSelectionRanges(Ku(this._pdfPages,this._selectionRanges,"up")):"Shift-ArrowDown"===r&&this._setSelectionRanges(Ku(this._pdfPages,this._selectionRanges,"down")),this._render();else if(this._readOnly||1!==this._selectedAnnotationIDs.length||null!==(t=this._annotations.find((e=>e.id===this._selectedAnnotationIDs[0])))&&void 0!==t&&t.readOnly)if("Ctrl-Alt-Digit1"!==i||!this._selectionRanges.length||this._selectionRanges[0].collapsed||this._readOnly)if("Ctrl-Alt-Digit2"!==i||!this._selectionRanges.length||this._selectionRanges[0].collapsed||this._readOnly)if("Ctrl-Alt-Digit3"!==i||this._readOnly)if("Ctrl-Alt-Digit4"!==i||this._readOnly){if("Ctrl-Alt-Digit5"===i&&!this._readOnly){let e=this._iframeWindow.PDFViewerApplication.pdfViewer.currentPageNumber-1,t=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[e].viewport.viewBox,n=(t[0]+t[2])/2,r=(t[1]+t[3])/2,i=40,o={pageIndex:e,rects:[[n-i/2,r-i/2,n+i/2,r+i/2]]};this._onAddAnnotation({type:"image",pageLabel:this._getPageLabel(e,!0),sortIndex:qu(this._pdfPages,o),color:this._tools.image.color,position:o},!0)&&this.navigateToPosition(o)}}else{let e=this._iframeWindow.PDFViewerApplication.pdfViewer.currentPageNumber-1,t=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[e].viewport.viewBox,n=(t[0]+t[2])/2,r=(t[1]+t[3])/2,i=this._tools.text.size,o={pageIndex:e,fontSize:i,rotation:0,rects:[[n-i/2,r-i/2,n+i/2,r+i/2]]},a=this._onAddAnnotation({type:"text",pageLabel:this._getPageLabel(e,!0),sortIndex:qu(this._pdfPages,o),color:this._tools.text.color,position:o});a&&(this.navigateToPosition(o),this.setSelectedAnnotationIDs([a.id]),setTimeout((()=>{var e;null===(e=this._iframeWindow.document.querySelector(`[data-id="${a.id}"]`))||void 0===e||e.focus()}),100))}else{let t=this._iframeWindow.PDFViewerApplication.pdfViewer.currentPageNumber-1,n=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t].viewport.viewBox,r=(n[0]+n[2])/2,i=(n[1]+n[3])/2,o={pageIndex:t,rects:[[r-11,i-11,r+11,i+11]]},a=this._onAddAnnotation({type:"note",pageLabel:this._getPageLabel(t,!0),sortIndex:qu(this._pdfPages,o),color:this._tools.note.color,position:o});a&&(this.navigateToPosition(o),this._onSelectAnnotations([a.id],e),this._openAnnotationPopup(),this._focusedObject={type:"annotation",object:a,rect:a.position.rects[0],pageIndex:a.position.pageIndex},this._render())}else{let e=this._getAnnotationFromSelectionRanges(this._selectionRanges,"underline");e.sortIndex=qu(this._pdfPages,e.position),e.color=this._tools.underline.color,this._onAddAnnotation(e,!0),this.navigateToPosition(e.position),this._setSelectionRanges()}else{let e=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");e.sortIndex=qu(this._pdfPages,e.position),e.color=this._tools.highlight.color,this._onAddAnnotation(e,!0),this.navigateToPosition(e.position),this._setSelectionRanges()}else{let t=this._annotations.find((e=>e.id===this._selectedAnnotationIDs[0])),n=!1,{id:i,type:o,position:a}=t;const s=5,l=5;let u=this._pdfPages[a.pageIndex].viewBox;if(["note","text","image","ink"].includes(o)&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(r)){let n;n="ink"===t.type?fu(a):a.rects[0].slice();let o=0,c=0;if("ArrowLeft"===r&&n[0]>=s+l?o=-s:"ArrowRight"===r&&n[2]<=u[2]-s-l?o=s:"ArrowDown"===r&&n[1]>=s+l?c=-s:"ArrowUp"===r&&n[3]<=u[3]-s-l&&(c=s),o||c){a=JSON.parse(JSON.stringify(a)),"ink"===t.type?a=Oc([1,0,0,1,o,c],a):(n[0]+=o,n[1]+=c,n[2]+=o,n[3]+=c,a={...a,rects:[n]});let e=qu(this._pdfPages,a);this._onUpdateAnnotations([{id:i,position:a,sortIndex:e}]),this._render(),this._onSetAnnotationPopup()}e.stopPropagation(),e.preventDefault()}else if(["highlight","underline"].includes(o)&&["Shift-ArrowLeft","Shift-ArrowRight","Shift-ArrowUp","Shift-ArrowDown"].includes(r)){let n=Qu(this._pdfPages,t.position);if("Shift-ArrowLeft"===r?n=Ku(this._pdfPages,n,"left"):"Shift-ArrowRight"===r?n=Ku(this._pdfPages,n,"right"):"Shift-ArrowUp"===r?n=Ku(this._pdfPages,n,"up"):"Shift-ArrowDown"===r&&(n=Ku(this._pdfPages,n,"down")),!(1===n.length&&n[0].anchorOffset>=n[0].headOffset)){let e=this._getAnnotationFromSelectionRanges(n,"highlight"),{text:t,sortIndex:r,position:o}=e;this._onUpdateAnnotations([{id:i,text:t,sortIndex:r,position:o}]),this._onSetAnnotationPopup()}e.stopPropagation(),e.preventDefault()}else if(["highlight","underline"].includes(o)&&(lr()&&["Cmd-Shift-ArrowLeft","Cmd-Shift-ArrowRight","Cmd-Shift-ArrowUp","Cmd-Shift-ArrowDown"].includes(r)||(cr()||ur())&&["Alt-Shift-ArrowLeft","Alt-Shift-ArrowRight","Alt-Shift-ArrowUp","Alt-Shift-ArrowDown"].includes(r))){let n=Qu(this._pdfPages,t.position);if(n=Ju(n),lr()&&"Cmd-Shift-ArrowLeft"===r||(cr()||ur())&&"Alt-Shift-ArrowLeft"===r?n=Ku(this._pdfPages,n,"left"):lr()&&"Cmd-Shift-ArrowRight"===r||(cr()||ur())&&"Alt-Shift-ArrowRight"===r?n=Ku(this._pdfPages,n,"right"):lr()&&"Cmd-Shift-ArrowUp"===r||(cr()||ur())&&"Alt-Shift-ArrowUp"===r?n=Ku(this._pdfPages,n,"up"):(lr()&&"Cmd-Shift-ArrowDown"===r||(cr()||ur())&&"Cmd-Shift-ArrowDown"===r)&&(n=Ku(this._pdfPages,n,"down")),!(1===n.length&&n[0].anchorOffset<=n[0].headOffset)){let e=this._getAnnotationFromSelectionRanges(n,"highlight"),{text:t,sortIndex:r,position:o}=e;this._onUpdateAnnotations([{id:i,text:t,sortIndex:r,position:o}]),this._onSetAnnotationPopup()}e.stopPropagation(),e.preventDefault()}else if(["text","image","ink"].includes(o)&&(lr()&&["Shift-ArrowLeft","Shift-ArrowRight","Shift-ArrowUp","Shift-ArrowDown"].includes(r)||(cr()||ur())&&["Shift-ArrowLeft","Shift-ArrowRight","Shift-ArrowUp","Shift-ArrowDown"].includes(r))){if("ink"===o){let e=fu(a),i=e.slice(),o=(e[2]-e[0])/(e[3]-e[1]),[,l]=e;"Shift-ArrowLeft"===r?(e[2]-=s,e[1]+=s/o,n=!0):"Shift-ArrowRight"===r?(e[2]+=s,e[1]-=s/o,n=!0):"Shift-ArrowDown"===r?(n=!0,l-=s,e[2]+=s*o,e[1]=l):"Shift-ArrowUp"===r&&(l+=s,e[2]-=s*o,e[1]=l,n=!0),n&&(a=Oc(Pu(i,e),t.position))}else if("image"===o){let e=a.rects[0].slice(),[,t,i]=e;"Shift-ArrowLeft"===r?(i-=s,e[2]=i<e[0]+ti&&e[0]+ti||i,n=!0):"Shift-ArrowRight"===r?(i+=s,e[2]=i<u[2]&&i||u[2],n=!0):"Shift-ArrowDown"===r?(t-=s,e[1]=t>u[1]&&t||u[1],n=!0):"Shift-ArrowUp"===r&&(t+=s,e[1]=t>e[3]-ti&&e[3]-ti||t,n=!0),n&&(a={...a,rects:[e]})}else if("text"===o){let e=a.rects[0].slice();const i=10;let o;if("Shift-ArrowLeft"===r){let t=e[2]-s;e[2]=t<e[0]+i&&e[0]+i||t,n=!0,o="r"}else"Shift-ArrowRight"===r?(e[2]+=s,n=!0,o="r"):"Shift-ArrowUp"===r?(e[2]-=s,e[1]-=s,n=!0,o="br"):"Shift-ArrowDown"===r&&(e[2]+=s,e[1]+=s,n=!0,o="br");if(n){let n=0,r=t.position.rects[0],i=Su(r,t.position.rotation),s=(r[2]-r[0])/(r[3]-r[1]);2===o.length&&(e=_u(e,s,o));let l=e,u=Su(l,t.position.rotation),c=vu(u,Cu(r,l,i,u,o));c=Au(c),l=[...yu(l,u),...yu(l.slice(2),u)],e=[...yu(l,c),...yu(l.slice(2),c)];let d=ku(t.position.rects[0],e);2!==o.length&&(d=1),n=t.position.fontSize*d,n=Math.round(2*n)/2,a={...a,fontSize:n,rects:[e]},a.rects=[e],n&&(a.fontSize=n),2!==o.length&&(a=Pc({...t,position:a}))}}if(n){let e=qu(this._pdfPages,a);this._onUpdateAnnotations([{id:i,position:a,sortIndex:e}]),this._render(),this._onSetAnnotationPopup()}e.stopPropagation(),e.preventDefault()}}if("Escape"===r){if(this.action||this.pointerDownPosition||this._selectionRanges.length)return e.preventDefault(),this.action=null,this.pointerDownPosition=null,this._setSelectionRanges(),void this._render();if(this._selectedAnnotationIDs.length)return e.preventDefault(),this._onSelectAnnotations([],e),void(this._lastFocusedObject&&(this._focusedObject=this._lastFocusedObject,this._render()));if(this._selectedOverlay)return this._selectedOverlay=null,this._onSetOverlayPopup(null),void e.preventDefault();if(this._focusedObject)return e.preventDefault(),void this._clearFocus()}if("Shift-Tab"===r?(this._focusedObject?this._clearFocus():this._onTabOut(!0),e.preventDefault()):"Tab"===r&&(this._focusedObject||!this._isSelectionCollapsed()||this._selectedAnnotationIDs.length?this._onTabOut():this._focusNext()||this._onTabOut(),e.preventDefault()),this._focusedObject&&!this._selectedAnnotationIDs.length){if("ArrowLeft"===r?(this._focusNext("left"),e.preventDefault(),e.stopPropagation()):"ArrowRight"===r&&(this._focusNext("right"),e.preventDefault(),e.stopPropagation()),"ArrowUp"===r&&(this._focusNext("top"),e.preventDefault(),e.stopPropagation()),"ArrowDown"===r)this._focusNext("bottom"),e.preventDefault(),e.stopPropagation();else if(["Enter","Space"].includes(r)&&this._focusedObject){if("annotation"===this._focusedObject.type)this._onSelectAnnotations([this._focusedObject.object.id],e),this._openAnnotationPopup();else if("overlay"===this._focusedObject.type){let e=this._focusedObject.object;this._selectedOverlay=e;let t=this.getClientRect(e.position.rects[0],e.position.pageIndex),n={...e,rect:t};"internal-link"===n.type?(async t=>{let{image:r,width:i,height:o,x:a,y:s}=await(null===(t=this._pdfRenderer)||void 0===t?void 0:t.renderPreviewPage(e.destinationPosition));n.image=r,n.width=i,n.height=o,n.x=a,n.y=s,this._onSetOverlayPopup(n)})():["citation","reference"].includes(e.type)?this._onSetOverlayPopup(n):"external-link"===e.type&&this._onOpenLink(e.url)}e.preventDefault(),e.stopPropagation()}}else if(1===this._selectedAnnotationIDs.length){let t=this._annotations.find((e=>e.id===this._selectedAnnotationIDs[0]));["Enter"].includes(r)&&(this._annotationPopup||(this._openAnnotationPopup(),e.preventDefault(),e.stopPropagation()),"text"===t.type&&setTimeout((()=>{var e;null===(e=this._iframeWindow.document.querySelector(`[data-id="${t.id}"]`))||void 0===e||e.focus()}),100))}!e.shiftKey&&["PageUp","PageDown","Home","End"].includes(r)&&(this._a11yShouldFocusVirtualCursorTarget=!0),this._onKeyDown(e)}}_handleDragStart(e){if(!this._textAnnotationFocused())if(this.action&&["moveAndDrag","drag"].includes(this.action.type)){if(!this.action.multiple){let t=this.action.annotation,n=this._dragCanvas;if("text"===t.type){n.getContext("2d");let t=window.devicePixelRatio;n.width=12*t,n.height=12*t,n.style.width="12px",n.style.height="12px",e.dataTransfer.setDragImage(n,12,6)}else{this.getPageByIndex(t.position.pageIndex).renderAnnotationOnCanvas(t,n);let r=window.devicePixelRatio,i=fu(t.position),o=i[2]-i[0],a=n.width/r/o;e.dataTransfer.setDragImage(n,this.action.x*a,n.height/r-this.action.y*a)}}if(this._selectionRanges.length<=2)this._onSetDataTransferAnnotations(e.dataTransfer,this.action.annotation);else{let t=ec(this._selectionRanges);e.dataTransfer.clearData(),e.dataTransfer.setData("text/plain",t)}}else e.preventDefault()}_handleDragOver(e){this._textAnnotationFocused()||(e.preventDefault(),e.dataTransfer.dropEffect="copy"===e.dataTransfer.effectAllowed?"copy":"move")}_handleDragEnd(e){"none"===e.dataTransfer.dropEffect&&(this.action=null),this._handlePointerUp(e)}_handleDrop(e){}_handleCopy(e){if(!this._textAnnotationFocused()&&(e.preventDefault(),e.stopPropagation(),e.clipboardData))if(this._selectedAnnotationIDs.length){let t=this._annotations.find((e=>e.id===this._selectedAnnotationIDs[0]));if(!t)return;this._onSetDataTransferAnnotations(e.clipboardData,t)}else if(this._selectionRanges.length<=2){let t=this._getAnnotationFromSelectionRanges(this._selectionRanges,"highlight");if(!t)return;this._onSetDataTransferAnnotations(e.clipboardData,t,!0)}else{let t=ec(this._selectionRanges);e.clipboardData.setData("text/plain",t)}}_handleInput(e){let t=e.target;if(t.classList.contains("textAnnotation")){let e=t.getAttribute("data-id"),n=t.value;t.setAttribute("data-comment",n),this._onUpdateAnnotations([{id:e,comment:n}])}}getDragMultiIcon(){let e=this._dragCanvas,t=e.getContext("2d");return e.width=100,e.height=20,t.fillStyle="#333333",t.fillRect(0,0,e.width,e.height),t.fillStyle="#999999",t.font="bold 13px Arial",t.fillText("DRAGGING...",5,15),e}pointerEventToPosition(e){let t=this._iframeWindow.document.elementFromPoint(e.clientX,e.clientY);if(!t)return null;let n=t.closest(".page");if(!n)return null;let r=this._iframeWindow.PDFViewerApplication.pdfViewer._pages.findIndex((e=>e.div===n));if(r<0)return null;let i=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[r],o=i.div.getBoundingClientRect(),a=e.clientX+i.div.scrollLeft-o.left,s=e.clientY+i.div.scrollTop-o.top;return l={pageIndex:r,rects:[[a,s,a,s]]},u=i.viewport,{pageIndex:l.pageIndex,rects:l.rects.map((e=>{let[t,n]=u.convertToPdfPoint(e[0],e[1]),[r,i]=u.convertToPdfPoint(e[2],e[3]);return[Math.min(t,r),Math.min(i,n),Math.max(t,r),Math.max(i,n)]}))};var l,u}pointerEventToAltPosition(e,t,n){let r=this._iframeWindow.PDFViewerApplication.pdfViewer._pages[t],i=r.div.getBoundingClientRect(),o=e.clientX+r.div.scrollLeft-i.left,a=e.clientY+r.div.scrollTop-i.top;if(r.pdfPage.view,n){let e=Su(n.annotation.position.rects[0],n.annotation.position.rotation);[o,a]=this.getPdfPoint([o,a],t,e)}else[o,a]=r.viewport.convertToPdfPoint(o,a);return{pageIndex:t,rects:[[o,a,o,a]]}}_textAnnotationFocused(){return this._iframeWindow.document.activeElement.classList.contains("textAnnotation")}setScrollMode(e){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("switchscrollmode",{mode:e})}setSpreadMode(e){this._iframeWindow.PDFViewerApplication.eventBus.dispatch("switchspreadmode",{mode:e})}async setSidebarView(e){if(this._primary&&"outline"===e&&!this._outline){if(await this._iframeWindow.PDFViewerApplication.initializedPromise,!this._iframeWindow.PDFViewerApplication.pdfDocument)return void setTimeout((()=>this.setSidebarView("outline")),1e3);let e=await this._iframeWindow.PDFViewerApplication.pdfDocument.getOutline2();this._onSetOutline(e)}}setOutline(e){this._outline=e}async _getPositionFromDestination(e){const t=this._iframeWindow.PDFViewerApplication.pdfDocument;if(!t||!e)throw new Error("No PDF document available or invalid destination provided.");let n;if("string"==typeof e){if(n=await t.getDestination(e),!n)throw new Error(`Unable to resolve named destination: "${e}"`)}else n=e;const r=n[0],i=await t.getPageIndex(r)+1,o=this._iframeWindow.PDFViewerApplication.pdfViewer.getPageView(i-1);if(!o)throw new Error(`"${i}" is not a valid pageNumber.`);let a=0,s=0;const l=(o.rotation%180!=0?o.width:o.height)/o.scale/(96/72);switch(n[1].name){case"XYZ":a=null!==n[2]?n[2]:0,s=null!==n[3]?n[3]:l;break;case"Fit":case"FitB":break;case"FitH":case"FitBH":s=null!==n[2]?n[2]:l;break;case"FitV":case"FitBV":a=null!==n[2]?n[2]:0;break;case"FitR":a=n[2],s=n[5];break;default:return void console.error(`"${n[1].name}" is not a valid destination type.`)}return{pageIndex:i-1,x:a,y:s}}};function nd(e,t,n){let r=[],i=!1,o=new CustomEvent("customEvent",{detail:{type:e,reader:t,append:(...e)=>{if(i)throw new Error("Append must be called directly and synchronously in the event");r.push(e)},params:n}});return window.dispatchEvent(o),i=!0,r}function rd(e){return e.map((e=>e.filter((e=>e)).filter((e=>!e.disabled||e.persistent)))).filter((e=>e.length))}function id(e,t){let n=e._state.annotations.filter((e=>t.ids.includes(e.id))),r=e._state.readOnly||n.some((e=>e.readOnly)),i=1===n.length&&n[0].color,o=Qr.slice();return n.every((e=>["text","ink"].includes(e.type)))&&o.push(...Jr),{internal:!0,x:t.x,y:t.y,itemGroups:rd([[("zotero"===e._platform||window.dev)&&{label:e._getString("pdfReader.addToNote"),disabled:!e._state.enableAddToNote,persistent:!0,onCommand:()=>e._onAddToNote(n)}],o.map((([n,o])=>({label:e._getString(n),disabled:r,persistent:!0,checked:o===i,color:o,onCommand:()=>{let n=t.ids.map((e=>({id:e,color:o})));e._annotationManager.updateAnnotations(n)}}))),[n.every((e=>"ink"===e.type))&&{slider:!0,size:n[0].position.width,disabled:r,persistent:!0,steps:ni,onCommand:t=>{e._annotationManager.updateAnnotations(n.map((({id:e,sortIndex:n})=>({id:e,sortIndex:n,position:{width:t}}))))}},n.every((e=>"text"===e.type))&&{slider:!0,size:n[0].position.fontSize,disabled:r,persistent:!0,steps:ri,onCommand:t=>{e._annotationManager.updateAnnotations(n.map((({id:e,sortIndex:n,comment:r,position:i})=>({id:e,sortIndex:n,position:i=Pc({comment:r,position:{...i,fontSize:t}})}))))}}],[(!t.view||t.popup)&&{label:e._getString("pdfReader.editPageNumber"),disabled:r||"pdf"!==e._type,persistent:"pdf"===e._type,onCommand:()=>e._handleOpenPageLabelPopup(t.currentID)},!t.view&&{label:e._getString("pdfReader.editAnnotationText"),disabled:r||!(1===t.ids.length&&e._state.annotations.find((e=>e.id===t.ids[0]&&["highlight","underline"].includes(e.type)))&&!t.popup),persistent:!0,onCommand:()=>e._sidebarEditAnnotationText(t.ids[0])}],[("zotero"===e._platform||window.dev)&&{label:e._getString("pdfReader.copyImage"),disabled:!(1===t.ids.length&&e._state.annotations.find((e=>e.id===t.ids[0]&&"image"===e.type))),onCommand:()=>{let n=e._state.annotations.find((e=>t.ids.includes(e.id)));n&&e._onCopyImage(n.image)}},("zotero"===e._platform||window.dev)&&{label:e._getString("pdfReader.saveImageAs"),disabled:!(1===t.ids.length&&e._state.annotations.find((e=>e.id===t.ids[0]&&"image"===e.type))),onCommand:()=>{let n=e._state.annotations.find((e=>t.ids.includes(e.id)));n&&e._onSaveImageAs(n.image)}}],[n.every((e=>["highlight","underline"].includes(e.type)))&&n.some((e=>"underline"===e.type))&&{label:e._getString("pdfReader.convertToHighlight"),disabled:r,persistent:!0,onCommand:()=>e.convertAnnotations(t.ids,"highlight")},n.every((e=>["highlight","underline"].includes(e.type)))&&n.some((e=>"highlight"===e.type))&&{label:e._getString("pdfReader.convertToUnderline"),disabled:r,persistent:!0,onCommand:()=>e.convertAnnotations(t.ids,"underline")}],[n.length>=2&&n.every((e=>"ink"===e.type))&&{label:e._getString("pdfReader.merge"),disabled:r||1!==new Set(n.map((e=>e.color))).size||1!==new Set(n.map((e=>e.position.pageIndex))).size,persistent:!0,onCommand:()=>{let n=e.mergeAnnotations(t.ids);n&&e._updateState({selectedAnnotationIDs:[n.id]})}}],[{label:e._getString("general.delete"),disabled:r,persistent:!0,onCommand:()=>e.deleteAnnotations(t.ids)}],...nd("createAnnotationContextMenu",e,t)])}}const od=96/72;class ad{constructor(e,t,n,r,i,o,a=null,s,l){this._pdfView=e,this.active=!0,this.pdfDocument=n,this.pagesOverview=r,this.printContainer=i,this._printResolution=o||150,this._optionalContentConfigPromise=a||n.getOptionalContentConfig(),this._printAnnotationStoragePromise=Promise.resolve(),this.currentPage=-1,this.onProgress=s,this.onFinish=l,this.scratchCanvas=t.document.createElement("canvas")}async renderPage(e,t,n,r,i){const o=i/72;this.scratchCanvas.width=Math.floor(r.width*o),this.scratchCanvas.height=Math.floor(r.height*o);const a=Math.floor(r.width*od)+"px",s=Math.floor(r.height*od)+"px",l=this.scratchCanvas.getContext("2d");l.save(),l.fillStyle="rgb(255, 255, 255)",l.fillRect(0,0,this.scratchCanvas.width,this.scratchCanvas.height),l.restore();let u=await t.getPage(n);const c={canvasContext:l,transform:[o,0,0,o,0,0],viewport:u.getViewport({scale:1,rotation:r.rotation}),intent:"print",annotationStorage:t.annotationStorage};return await u.render(c).promise,this._includeAnnotations&&this._pdfView.renderPageAnnotationsOnCanvas(this.scratchCanvas,c.viewport,n-1),{width:a,height:s}}layout(){this.throwIfInactive();const e=document.querySelector("body");e.setAttribute("data-pdfjsprinting",!0);const{width:t,height:n}=this.pagesOverview[0];this.pagesOverview.every((e=>e.width===t&&e.height===n))||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style"),this.pageStyleSheet.textContent=`@page { size: ${t}pt ${n}pt;}`,e.append(this.pageStyleSheet)}destroy(){this.active=!1,this.printContainer.textContent="",document.querySelector("body").removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,this.onFinish()}renderPages(){const e=this.pagesOverview.length,t=(n,r)=>{if(this.throwIfInactive(),++this.currentPage>=e)return this.onProgress(100),void n();const i=this.currentPage;this.onProgress(Math.round(i/e*100)),this.renderPage(this,this.pdfDocument,i+1,this.pagesOverview[i],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then((function(){t(n,r)}),r)};return new Promise(t)}useRenderedPage(e){this.throwIfInactive();const t=document.createElement("img");t.style.width=e.width,t.style.height=e.height;const n=this.scratchCanvas;t.src=n.toDataURL();const r=document.createElement("div");return r.appendChild(t),this.printContainer.appendChild(r),new Promise((function(e,n){t.onload=e,t.onerror=n}))}performPrint(){return this.throwIfInactive(),new Promise((e=>{setTimeout((()=>{this.active?"undefined"!=typeof zoteroPrint?zoteroPrint().then(e):(window._print(),setTimeout(e,20)):e()}),0)}))}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}function sd(e){const t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,"custom"),window.dispatchEvent(t)}if("onbeforeprint"in window){const e=function(e){"custom"!==e.detail&&e.stopImmediatePropagation&&e.stopImmediatePropagation()};window.addEventListener("beforeprint",e),window.addEventListener("afterprint",e)}class ld{constructor({onProgress:e,onFinish:t,pdfView:r}){n(this,"beforePrint",(()=>{if(this._activeTask)return;if(!this._pdfView._iframeWindow.PDFViewerApplication.supportsPrinting)throw new Error("Printing is not supported");if(!this._pdfView._iframeWindow.PDFViewerApplication.pdfViewer.pageViewsReady)throw new Error("Printing is not ready");const e=this._pdfView._iframeWindow.PDFViewerApplication.pdfViewer.getPagesOverview(),t=document.getElementById("printContainer"),n=this._pdfView._iframeWindow.PDFViewerApplication.pdfViewer.optionalContentConfigPromise;this._activeTask=new ad(this._pdfView,this._pdfView._iframeWindow,this._pdfView._iframeWindow.PDFViewerApplication.pdfDocument,e,t,300,n,this._onProgress,this._onFinish),this._pdfView._iframeWindow.PDFViewerApplication.forceRendering(),this._activeTask.layout()})),n(this,"afterPrint",(()=>{this._activeTask&&(this._activeTask.destroy(),this._activeTask=null),this._pdfView._iframeWindow.PDFViewerApplication.forceRendering()})),this._onProgress=e,this._onFinish=t,this._pdfView=r,this._activeTask=null,window.addEventListener("beforeprint",this.beforePrint),window.addEventListener("afterprint",this.afterPrint)}abort(){this._activeTask?(this._activeTask.destroy(),this._activeTask=null,sd("afterprint")):this._onFinish()}}let ud;class cd{constructor(e){this._reader=e.reader,this._onDeselectAnnotations=e.onDeselectAnnotations,this._onToolbarShiftTab=e.onToolbarShiftTab,this._onIframeTab=e.onIframeTab,window.addEventListener("focusin",this._handleFocus.bind(this)),window.addEventListener("pointerdown",this._handlePointerDown.bind(this)),window.addEventListener("keydown",this._handleKeyDown.bind(this),!0),window.addEventListener("copy",this._handleCopy.bind(this),!0),setInterval((()=>{document.activeElement===document.body||document.activeElement.closest(".context-menu-overlay")||(this._lastActiveElement=document.activeElement)}),100),dr&&this._initFirefoxActivePseudoClassFix()}restoreFocus(){var e;let t=this._reader._state.selectedAnnotationIDs.slice();null===(e=this._lastActiveElement)||void 0===e||e.focus(),t.length>1&&this._reader._updateState({selectedAnnotationIDs:t})}focusToolbar(){document.querySelector(".toolbar .start .toolbar-button").focus()}_initFirefoxActivePseudoClassFix(){window.addEventListener("pointerdown",(e=>{let t=e.target.closest("button");t&&t.classList.add("active-pseudo-class-fix")})),window.addEventListener("pointerup",(()=>{document.querySelectorAll("button.active-pseudo-class-fix").forEach((e=>e.classList.remove("active-pseudo-class-fix")))})),window.addEventListener("pointerout",(e=>{0===e.buttons&&document.querySelectorAll("button.active-pseudo-class-fix").forEach((e=>e.classList.remove("active-pseudo-class-fix")))}))}_closeFindPopupIfEmpty(){let e=this._reader._state.primaryViewFindState;e&&!e.query&&this._reader._updateState({primaryViewFindState:{...e,popupOpen:!1}}),e=this._reader._state.secondaryViewState,e&&!e.query&&this._reader._updateState({secondaryViewState:{...e,popupOpen:!1}})}_handleFocus(e){"closest"in e.target&&(e.target.closest(".annotation, .annotation-popup, .selection-popup, .label-popup, .appearance-popup, .context-menu, iframe")||this._onDeselectAnnotations(),e.target.closest(".find-popup")||this._closeFindPopupIfEmpty())}_handlePointerDown(e){"closest"in e.target&&(e.target.closest('input, textarea, [contenteditable="true"], .annotation, .thumbnails-view, .outline-view, .error-bar, .reference-row, .preview-popup, .appearance-popup, #selector')?e.target.closest(".annotation")&&e.target.closest(".more, .page, .tags")&&e.preventDefault():e.preventDefault())}_handleKeyDown(e){let t=!0,n=this._reader._state.selectedAnnotationIDs;if(1===n.length){let e=this._reader._state.annotations.find((e=>e.id===n[0]));null!=e&&e.comment&&(t=!1)}if(this._reader._annotationSelectionTriggeredFromView&&e.target.closest('.comment [contenteditable="true"]')&&t&&e.shiftKey&&e.key.startsWith("Arrow"))return this._reader._lastView.focus(),e.preventDefault(),void e.stopPropagation();if(e.shiftKey&&"Tab"===e.key?(this.tabToGroup(!0),e.preventDefault()):"Tab"===e.key&&(this.tabToGroup(),e.preventDefault()),(e.target.closest(".outline-view")||e.target.closest('input[type="range"]'))&&["ArrowLeft","ArrowRight"].includes(e.key))return;fr(e)&&!e.target.closest('[contenteditable], input[type="text"], .preview-popup')?(e.preventDefault(),this.tabToItem()):mr(e)&&!e.target.closest('[contenteditable], input[type="text"], .preview-popup')&&(e.preventDefault(),this.tabToItem(!0));let r=document.querySelector(".context-menu");if(r&&1==e.key.length&&!e.forwardedToContextMenu&&!r.contains(e.target)){let t=new KeyboardEvent("keydown",{key:e.key,bubbles:!0});t.forwardedToContextMenu=!0,r.dispatchEvent(t)}}tabToGroup(e){if(document.querySelector(".context-menu"))return;let t=document.activeElement,n=t.closest("[data-tabstop]")||t,r=document,i=Array.from(document.querySelectorAll(".overlay")).at(-1);i&&(r=i);let o=Array.from(r.querySelectorAll("[data-tabstop]:not(.hidden)"));o=o.map((e=>{let t=e.getAttribute("data-proxy");return t?(t=document.querySelector(t),t):e})).filter((e=>!e.closest(".viewWrapper.hidden"))),e&&o.reverse();let a=o.findIndex((e=>e===n));if(a===o.length-1)return void(e?this._onToolbarShiftTab():this._onIframeTab());if(-1===a?a=0:a++,n=o[a],n.classList.contains("annotations")&&this._reader._lastSelectedAnnotationID&&this._reader._state.annotations.length>=2&&this._reader._state.annotations.find((e=>e.id===this._reader._lastSelectedAnnotationID)))return this._reader._updateState({selectedAnnotationIDs:[this._reader._lastSelectedAnnotationID]}),void setTimeout((()=>{var e;return null===(e=n.querySelector(`[data-sidebar-annotation-id="${this._reader._lastSelectedAnnotationID}"]`))||void 0===e?void 0:e.focus()}),100);let s=t.parentNode.closest('[tabindex="-1"]');t=n.hasAttribute("tabindex")?n:e&&s?s:n.querySelector('[tabindex="-1"]:not(:disabled):not(.hidden)'),t||(t=n),t.focus()}tabToItem(e){let t=document.activeElement,n=t.closest("[data-tabstop]"),r=document.querySelector(".context-menu");if(r&&(n=r),!n)return;if(t===n)return;let i=Array.from(n.querySelectorAll('[tabindex="-1"]:not(:disabled):not([data-tabstop]):not(.hidden)'));if(!i)return;e&&i.reverse();let o=i.findIndex((e=>e===document.activeElement));-1===o?o=0:o++,o!==i.length&&(t=i[o],t.focus(),"INPUT"===t.nodeName&&"text"===t.type&&setTimeout((()=>t.setSelectionRange(t.value.length,t.value.length))))}_handleCopy(e){var t;if(null!==(t=document.activeElement)&&void 0!==t&&t.closest(".error-bar"))return;let n=this._reader._state.selectedAnnotationIDs;if(n.length>0){var r,i;let t=this._reader._state.annotations.find((e=>e.id===n[0]));(null===(r=document.activeElement)||void 0===r||!r.closest(".text, .comment")||null!==(i=document.activeElement)&&void 0!==i&&i.closest(".comment")&&!t.comment&&this._reader._annotationSelectionTriggeredFromView)&&(this._reader._handleSetDataTransferAnnotations(e.clipboardData,t),e.preventDefault())}}}class dd{constructor(e){this._reader=e.reader,window.addEventListener("keydown",this._handleKeyDown.bind(this),!0),window.addEventListener("keyup",this._handleKeyUp.bind(this),!0),window.addEventListener("pointerdown",this._handlePointerDown.bind(this),!0),window.addEventListener("pointerup",this._handlePointerUp.bind(this),!0)}_handleKeyUp(e,t){let{key:n}=e,r=e.ctrlKey,i=e.metaKey&&lr(),o=r||i,a=(e.altKey,e.shiftKey);this.shift=a,this.mod=o}_handleKeyDown(e,t){var n;let r=e.ctrlKey,i=e.metaKey&&lr(),o=r||i,a=e.shiftKey;if(this.shift=a,this.mod=o,e.repeat)return;let s=gr(e),l=vr(e);if(!pr(e.target)){if("Cmd-["===s||"Cmd-ArrowLeft"===s||ur()&&"Ctrl-["===s||(ur()||cr())&&"Alt-ArrowLeft"==s)return this._reader.navigateBack(),void e.preventDefault();if("Cmd-]"===s||"Cmd-ArrowRight"===s||ur()&&"Ctrl-]"===s||(ur()||cr())&&"Alt-ArrowRight"==s)return this._reader.navigateForward(),void e.preventDefault()}let u=null===(n=document.activeElement)||void 0===n?void 0:n.closest(".comment .content");if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(s)&&u&&!u.innerText&&this._reader._annotationSelectionTriggeredFromView&&setTimeout((()=>this._reader._lastView.focus())),"Escape"===s&&(document.activeElement.closest(".annotation .content")?this._reader._annotationSelectionTriggeredFromView?(this._reader._updateState({selectedAnnotationIDs:[]}),setTimeout((()=>this._reader._lastView.focus()))):setTimeout((()=>document.activeElement.closest(".annotation").focus())):this._reader._state.printPopup?(e.preventDefault(),this._reader.abortPrint(),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.contextMenu?(e.preventDefault(),this._reader._updateState({contextMenu:null}),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.labelPopup?(e.preventDefault(),this._reader._updateState({labelPopup:null}),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.primaryViewOverlayPopup||this._reader._state.secondaryViewOverlayPopup?(e.preventDefault(),this._reader._updateState({primaryViewOverlayPopup:null,secondaryViewOverlayPopup:null}),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.themePopup?(e.preventDefault(),this._reader._updateState({themePopup:null})):this._reader._state.appearancePopup?(e.preventDefault(),this._reader._updateState({appearancePopup:null}),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.selectedAnnotationIDs.length?(e.preventDefault(),this._reader._updateState({selectedAnnotationIDs:[]}),setTimeout((()=>this._reader._lastView.focus()))):this._reader._state.tool!==this._reader._tools.pointer?(this._reader._updateState({tool:this._reader._tools.pointer}),e.preventDefault(),setTimeout((()=>this._reader._lastView.focus()))):setTimeout((()=>this._reader._lastView.focus()))),"Enter"===s&&document.activeElement.classList.contains("annotation")&&setTimeout((()=>{let e=document.activeElement.querySelector(".comment .content");e&&(e.focus(),yr(e))})),["Cmd-a","Ctrl-a"].includes(s)){if(!pr(e.target)&&(e.preventDefault(),this._reader._state.sidebarOpen&&"annotations"===this._reader._state.sidebarView&&(t||e.target.closest("#annotationsView")))){let e=this._reader._state.annotations.filter((e=>!e._hidden)).map((e=>e.id));this._reader._updateState({selectedAnnotationIDs:e})}}else if(t&&["Cmd-z","Ctrl-z"].includes(s))e.preventDefault(),this._reader._annotationManager.undo(),this._reader.setSelectedAnnotations([]);else if(t&&["Cmd-Shift-z","Ctrl-Shift-z"].includes(s))e.preventDefault(),this._reader._annotationManager.redo(),this._reader.setSelectedAnnotations([]);else if(["Cmd-f","Ctrl-f"].includes(s))e.preventDefault(),this._reader.toggleFindPopup({open:!0});else if(["Cmd-Shift-g","Ctrl-Shift-g"].includes(s))e.preventDefault(),e.stopPropagation(),this._reader.findPrevious();else if(["Cmd-g","Ctrl-g"].includes(s))e.preventDefault(),e.stopPropagation(),this._reader.findNext();else if(["Cmd-Alt-g","Ctrl-Alt-g"].includes(s)){e.preventDefault();let t=document.getElementById("pageNumber");t.focus(),t.select()}else if(["Cmd-p","Ctrl-p"].includes(s))e.preventDefault(),e.stopPropagation(),this._reader.print();else if(["Cmd-=","Ctrl-="].includes(s))e.preventDefault(),e.stopPropagation(),this._reader.zoomIn();else if(["Cmd--","Ctrl--"].includes(s))e.preventDefault(),e.stopPropagation(),this._reader.zoomOut();else if(["Cmd-0","Ctrl-0"].includes(s)||["Cmd-Digit0","Ctrl-Digit0"].includes(l))e.preventDefault(),e.stopPropagation(),this._reader.zoomReset();else if(["Delete","Backspace"].includes(s)){if(e.target.closest("input, .label-popup"))return;let t=this._reader._state.selectedAnnotationIDs,n=!!this._reader._state.annotations.find((e=>t.includes(e.id)&&e.readOnly));if(n)return;if(1===t.length){let n=this._reader._state.annotations.find((e=>e.id===t[0]));if(e.target.closest(".content")&&(e.target.closest(".text")||n.comment||!this._reader._enableAnnotationDeletionFromComment))return}if(t.length>=1&&!this._reader._annotationSelectionTriggeredFromView){let e,{annotations:n}=this._reader._state,r=n.findIndex((e=>t.includes(e.id))),i=n.findLastIndex((e=>t.includes(e.id)));if(i+1<n.length&&(e=n[i+1].id),r-1>=0&&(e=n[r-1].id),this._reader.deleteAnnotations(this._reader._state.selectedAnnotationIDs),e){let t=document.querySelector(`[data-sidebar-annotation-id="${e}"]`);t&&setTimeout((()=>t.focus()))}}else this._reader.deleteAnnotations(this._reader._state.selectedAnnotationIDs),this._reader._lastView.focus()}if(!pr(e.target))if("Alt-Digit1"===l)this._reader.toggleTool("highlight");else if("Alt-Digit2"===l)this._reader.toggleTool("underline");else if("Alt-Digit3"===l)this._reader.toggleTool("note");else if("pdf"===this._reader._type&&"Alt-Digit4"===l)this._reader.toggleTool("text");else if("pdf"===this._reader._type&&"Alt-Digit5"===l)this._reader.toggleTool("image");else if("pdf"===this._reader._type&&"Alt-Digit6"===l)this._reader.toggleTool("ink");else if("pdf"===this._reader._type&&"Alt-Digit7"===l)this._reader.toggleTool("eraser");else if(("pdf"===this._reader._type&&"Alt-Digit8"===l||["epub","snapshot"].includes(this._reader._type)&&"Alt-Digit4"===l)&&this._reader._state.tool.color){let e=Qr.findIndex((e=>e[1]===this._reader._state.tool.color));e===Qr.length-1?e=0:e++,this._reader.setTool({color:Qr[e][1]})}else if(l.startsWith("Digit")&&this._reader._state.tool.color){let e=parseInt(l.slice(5))-1;Qr[e]&&this._reader.setTool({color:Qr[e][1]})}}_handlePointerDown(e){this.pointerDown=!0;let t=e.ctrlKey,n=e.metaKey&&lr();this.mod=t||n,this.shift=e.shiftKey}_handlePointerUp(e){this.pointerDown=!1;let t=e.ctrlKey,n=e.metaKey&&lr();this.mod=t||n,this.shift=e.shiftKey}handleViewKeyDown(e){this._handleKeyDown(e,!0)}handleViewKeyUp(e){this._handleKeyUp(e,!0)}}window.computedFontFamily=window.getComputedStyle(document.body).getPropertyValue("font-family"),window.computedColorFocusBorder=window.getComputedStyle(document.body).getPropertyValue("--color-focus-border"),window.computedWidthFocusBorder=window.getComputedStyle(document.body).getPropertyValue("--width-focus-border");const hd=(0,o.createContext)({}),pd=class{constructor(e){var t;n(this,"a11yAnnounceSearchMessage",Ti((e=>{if(!e)return;let{index:t,total:n,currentPageLabel:r,currentSnippet:i}=e;if(0==n)return void this.setA11yMessage(this._getString("pdfReader.phraseNotFound"));let o=`${this._getString("pdfReader.searchResultIndex")}: ${t+1}.`,a=`${this._getString("pdfReader.searchResultTotal")}: ${n}.`,s=r?`${this._getString("pdfReader.page")}: ${r}.`:"";this.setA11yMessage(`${o} ${a} ${s} ${i||""}`)}),100)),n(this,"_handleDeleteAnnotations",(e=>{let t=this._state.primaryViewAnnotationPopup;t&&e.includes(t.annotation.id)&&(t=null);let n=this._state.secondaryViewAnnotationPopup;n&&e.includes(n.annotation.id)&&(n=null),this._updateState({primaryViewAnnotationPopup:t,secondaryViewAnnotationPopup:n}),this._onDeleteAnnotations(e)})),window.rtl=e.rtl,document.getElementsByTagName("html")[0].dir=e.rtl?"rtl":"ltr",this._type=e.type,this._platform=e.platform,this._data=e.data,this._password=e.password,this._preview=e.preview,this._readerContext={type:this._type,platform:this._platform},this._onSaveAnnotations=e.onSaveAnnotations,this._onDeleteAnnotations=e.onDeleteAnnotations,this._onOpenTagsPopup=e.onOpenTagsPopup,this._onAddToNote=e.onAddToNote,this._onOpenContextMenu=e.onOpenContextMenu,this._onToggleSidebar=e.onToggleSidebar,this._onChangeSidebarWidth=e.onChangeSidebarWidth,this._onChangeViewState=e.onChangeViewState,this._onOpenLink=e.onOpenLink,this._onCopyImage=e.onCopyImage,this._onSaveImageAs=e.onSaveImageAs,this._onConfirm=e.onConfirm,this._onRotatePages=e.onRotatePages,this._onDeletePages=e.onDeletePages,this._onToggleContextPane=e.onToggleContextPane,this._onToolbarShiftTab=e.onToolbarShiftTab,this._onIframeTab=e.onIframeTab,this._onBringReaderToFront=e.onBringReaderToFront,this._onTextSelectionAnnotationModeChange=e.onTextSelectionAnnotationModeChange,this._onSaveCustomThemes=e.onSaveCustomThemes,this._onSetLightTheme=e.onSetLightTheme,this._onSetDarkTheme=e.onSetDarkTheme,this._onSetDataTransferAnnotations=e.onSetDataTransferAnnotations,this._onSetZoom=e.onSetZoom,this._onContentSelect=e.onContentSelect,this._onClickContent=e.onClickContent,this._localizedStrings=e.localizedStrings,this._readerRef=o.createRef(),this._primaryView=null,this._secondaryView=null,this._lastViewPrimary=!0,this.initializedPromise=new Promise((e=>this._resolveInitializedPromise=e)),this._splitViewContainer=document.getElementById("split-view"),this._primaryViewContainer=document.getElementById("primary-view"),this._secondaryViewContainer=document.getElementById("secondary-view"),this._enableAnnotationDeletionFromComment=!1,this._annotationSelectionTriggeredFromView=!1,this._tools={pointer:{type:"pointer"},hand:{type:"hand"},highlight:{type:"highlight",color:Qr[0][1]},underline:{type:"underline",color:Qr[0][1]},note:{type:"note",color:Qr[0][1]},image:{type:"image",color:Qr[0][1]},text:{type:"text",color:Qr[0][1],size:14},ink:{type:"ink",color:Qr[3][1],size:2},eraser:{type:"eraser",size:16}};let r=[...ii,...e.customThemes||[]];r=new Map(r.map((e=>[e.id,e])));let a,s=e.lightTheme&&r.get(e.lightTheme)||null,l=void 0===e.darkTheme?ii.find((e=>"dark"===e.id)):r.get(e.darkTheme)||null;if(this._state={splitType:null,splitSize:"50%",primary:!0,freeze:!1,errorMessage:"",annotations:[],selectedAnnotationIDs:[],filter:{query:"",colors:[],tags:[],authors:[]},categories:e.categories||[],readOnly:void 0!==e.readOnly&&e.readOnly,authorName:"string"==typeof e.authorName?e.authorName:"",fontSize:e.fontSize||1,fontFamily:e.fontFamily,hyphenate:e.hyphenate,showAnnotations:void 0===e.showAnnotations||e.showAnnotations,customThemes:e.customThemes||[],lightTheme:s,darkTheme:l,autoDisableNoteTool:void 0===e.autoDisableNoteTool||e.autoDisableNoteTool,autoDisableTextTool:void 0===e.autoDisableTextTool||e.autoDisableTextTool,autoDisableImageTool:void 0===e.autoDisableImageTool||e.autoDisableImageTool,textSelectionAnnotationMode:e.textSelectionAnnotationMode||"highlight",colorScheme:e.colorScheme,tool:this._tools.pointer,thumbnails:[],outline:null,outlineQuery:"",pageLabels:[],sidebarOpen:void 0===e.sidebarOpen||e.sidebarOpen,sidebarWidth:void 0!==e.sidebarWidth?e.sidebarWidth:240,sidebarView:"annotations",bottomPlaceholderHeight:e.bottomPlaceholderHeight||null,toolbarPlaceholderWidth:e.toolbarPlaceholderWidth||0,showContextPaneToggle:e.showContextPaneToggle,enableAddToNote:!1,labelPopup:null,passwordPopup:null,printPopup:null,appearancePopup:null,themePopup:null,contextMenu:null,primaryViewState:e.primaryViewState,primaryViewStats:{},primaryViewAnnotationPopup:null,primaryViewSelectionPopup:null,primaryViewOverlayPopup:null,primaryViewFindState:{popupOpen:!1,active:!1,query:"",highlightAll:!0,caseSensitive:!1,entireWord:!1,result:null},secondaryViewState:null,secondaryViewStats:{},secondaryViewAnnotationPopup:null,secondaryViewSelectionPopup:null,secondaryViewOverlayPopup:null,secondaryViewFindState:{popupOpen:!1,active:!1,query:"",highlightAll:!0,caseSensitive:!1,entireWord:!1,result:null}},e.secondaryViewState){let t={...e.secondaryViewState};this._state.splitType=t.splitType,this._state.splitSize=t.splitSize,delete t.splitType,delete t.splitSize,this._state.secondaryViewState=t}this._focusManager=new cd({reader:this,onDeselectAnnotations:()=>{this.setSelectedAnnotations([])},onToolbarShiftTab:()=>{var e;null===(e=this._onToolbarShiftTab)||void 0===e||e.call(this)},onIframeTab:()=>{var e;null===(e=this._onIframeTab)||void 0===e||e.call(this)}}),this._keyboardManager=new dd({reader:this}),this._annotationManager=new Tc({readOnly:this._state.readOnly,authorName:e.authorName,annotations:e.annotations,tools:this._tools,onSave:this._onSaveAnnotations,onDelete:this._handleDeleteAnnotations,onRender:e=>{this._updateState({annotations:e})},onChangeFilter:e=>{this._updateState({filter:e})}}),null!==(t=e.location)&&void 0!==t&&t.annotationID&&e.annotations.find((t=>t.id===e.location.annotationID))&&(a=e.location.annotationID,delete e.location),this._primaryView=this._createView(!0,e.location),a&&(async()=>{await this._primaryView.initializedPromise,this.setSelectedAnnotations([a])})(),this._preview||(0,i.s)(document.getElementById("reader-ui")).render(o.createElement(kt,{locale:window.navigator.language,messages:this._localizedStrings,onError:window.development&&(()=>{})},o.createElement(hd.Provider,{value:this._readerContext},o.createElement(hu,{type:this._type,state:this._state,ref:this._readerRef,tools:this._tools,onSelectAnnotations:this.setSelectedAnnotations.bind(this),onZoomIn:this.zoomIn.bind(this),onZoomOut:this.zoomOut.bind(this),onZoomReset:this.zoomReset.bind(this),onNavigateBack:this.navigateBack.bind(this),onNavigateToPreviousPage:this.navigateToPreviousPage.bind(this),onNavigateToNextPage:this.navigateToNextPage.bind(this),onChangePageNumber:e=>this._lastView.navigate({pageNumber:e}),onChangeTool:this.setTool.bind(this),onToggleAppearancePopup:this.toggleAppearancePopup.bind(this),onToggleFind:this.toggleFindPopup.bind(this),onChangeFilter:this.setFilter.bind(this),onChangeSidebarView:this.setSidebarView.bind(this),onContentSelect:this._onContentSelect,onClickContent:this._onClickContent,onToggleSidebar:e=>{this.toggleSidebar(e),this._onToggleSidebar(e)},onResizeSidebar:e=>{this.setSidebarWidth(e),this._onChangeSidebarWidth(e)},onChangeTheme:e=>{"dark"===Sr(this._state.colorScheme)?this._onSetDarkTheme?this._onSetDarkTheme(e):this.setDarkTheme(e):this._onSetLightTheme?this._onSetLightTheme(e):this.setLightTheme(e)},onResizeSplitView:this.setSplitViewSize.bind(this),onAddAnnotation:(e,t)=>{e=this._annotationManager.addAnnotation(e),setTimeout((async()=>{if(!document.l10n)return;let t=await document.l10n.formatValue(`pdfReader-${e.type}Annotation`),n=await document.l10n.formatValue("pdfReader-a11yAnnotationCreated",{type:t});this.setA11yMessage(n)}),100),t?this.setSelectedAnnotations([e.id]):this.setSelectedAnnotations([])},onUpdateAnnotations:e=>{this._annotationManager.updateAnnotations(e),this._enableAnnotationDeletionFromComment=!1},onDeleteAnnotations:this._annotationManager.deleteAnnotations.bind(this._annotationManager),onOpenTagsPopup:this._onOpenTagsPopup,onOpenPageLabelPopup:this._handleOpenPageLabelPopup.bind(this),onOpenColorContextMenu:e=>this._onOpenContextMenu(function(e,t){let n=Qr.slice();return["text","ink","eraser"].includes(e._state.tool.type)&&n.push(...Jr),{internal:!0,x:t.x,y:t.y,itemGroups:rd(["eraser"===e._state.tool.type?n.map((([t,n])=>({label:e._getString(t),disabled:e._state.readOnly,checked:n===e._state.tool.color,color:n,onCommand:()=>e.setTool({type:"ink",color:n})}))):n.map((([t,n])=>({label:e._getString(t),disabled:e._state.readOnly,checked:n===e._state.tool.color,color:n,onCommand:()=>e.setTool({color:n})}))),[["ink","eraser"].includes(e._state.tool.type)&&{eraser:!0,label:e._getString("pdfReader.eraser"),disabled:e._state.readOnly,checked:"eraser"===e._state.tool.type,onCommand:()=>"ink"===e._state.tool.type?e.setTool({type:"eraser"}):e.setTool({type:"ink"})}],["text"===e._state.tool.type&&{slider:!0,size:e._state.tool.size,steps:ri,onCommand:t=>e.setTool({size:t})},"ink"===e._state.tool.type&&{slider:!0,size:e._state.tool.size,steps:ni,onCommand:t=>e.setTool({size:t})},"eraser"===e._state.tool.type&&{slider:!0,size:e._state.tool.size,steps:ni,onCommand:t=>e.setTool({size:t})}],...nd("createColorContextMenu",e,t)])}}(this,e)),onOpenAnnotationContextMenu:e=>this._onOpenContextMenu(id(this,e)),onOpenSelectorContextMenu:e=>this._onOpenContextMenu(function(e,t){return{x:t.x,y:t.y,itemGroups:rd([[{label:e._getString("general.clearSelection"),disabled:!t.enableClearSelection,persistent:!0,onCommand:()=>e.setFilter({colors:[],tags:[],authors:[]})}],...nd("createSelectorContextMenu",e,t)])}}(this,e)),onOpenThumbnailContextMenu:e=>this._onOpenContextMenu(function(e,t){return{x:t.x,y:t.y,itemGroups:rd([[{label:e._getString("pdfReader.rotateLeft"),disabled:e._state.readOnly,persistent:!0,onCommand:()=>e.rotatePages(t.pageIndexes,270)},{label:e._getString("pdfReader.rotateRight"),disabled:e._state.readOnly,persistent:!0,onCommand:()=>e.rotatePages(t.pageIndexes,90)}],["zotero"===e._platform&&{label:e._getString("general.delete"),disabled:e._state.readOnly,persistent:!0,onCommand:()=>e.deletePages(t.pageIndexes)}],...nd("createThumbnailContextMenu",e,t)])}}(this,e)),onCloseContextMenu:this.closeContextMenu.bind(this),onCloseLabelPopup:this._handleLabelPopupClose.bind(this),onEnterPassword:this.enterPassword.bind(this),onAddToNote:e=>{this._onAddToNote(e),this.setSelectedAnnotations([])},onNavigate:this.navigate.bind(this),onUpdateOutline:e=>this._updateState({outline:e}),onUpdateOutlineQuery:e=>this._updateState({outlineQuery:e}),onRenderThumbnails:e=>this._primaryView._pdfThumbnails.render(e),onSetDataTransferAnnotations:this._handleSetDataTransferAnnotations.bind(this),onOpenLink:this._onOpenLink,onChangeAppearance:this._handleAppearanceChange.bind(this),onChangeFindState:this._handleFindStateChange.bind(this),onFindNext:this.findNext.bind(this),onFindPrevious:this.findPrevious.bind(this),onToggleContextPane:this._onToggleContextPane,onChangeTextSelectionAnnotationMode:this.setTextSelectionAnnotationMode.bind(this),onCloseOverlayPopup:this._handleOverlayPopupClose.bind(this),onChangeSplitType:e=>{"horizontal"===e?this.toggleHorizontalSplit(!0):"vertical"===e?this.toggleVerticalSplit(!0):this.disableSplitView()},onChangeScrollMode:e=>this.scrollMode=e,onChangeSpreadMode:e=>this.spreadMode=e,onChangeFlowMode:e=>this.flowMode=e,onAddTheme:()=>this._updateState({themePopup:{}}),onOpenThemeContextMenu:e=>this._onOpenContextMenu(function(e,t){let n=ii.some((e=>e.id===t.theme.id));return{x:t.x,y:t.y,itemGroups:rd([[{label:e._getString("general.edit"),disabled:n,persistent:!0,onCommand:()=>e._updateState({themePopup:{theme:t.theme}})},{label:e._getString("general.delete"),disabled:n,persistent:!0,onCommand:()=>{let{customThemes:n}=e._state;n=n.filter((e=>e.id!==t.theme.id)),e._onSaveCustomThemes(n)}}],...nd("createThemeContextMenu",e,t)])}}(this,e)),onCloseThemePopup:()=>this._updateState({themePopup:null}),onSaveCustomThemes:e=>{this._onSaveCustomThemes(e);let t=[...ii,...e||[]],n=new Map(t.map((e=>[e.id,e]))),{lightTheme:r,darkTheme:i}=this._state;r&&!n.has(r.id)&&(r=null),i&&!n.has(i.id)&&(i=null),this._updateState({themePopup:null,customThemes:e,lightTheme:r,darkTheme:i})}})))),this._updateState(this._state,!0),"web"!==this._platform&&window.addEventListener("contextmenu",(e=>{"INPUT"===e.target.nodeName||e.target.hasAttribute("contenteditable")||e.preventDefault()}))}_ensureType(){if(!Array.from(arguments).includes(this._type))throw new Error(`The operation is not supported for '${this._type}'`)}get _lastView(){return this._lastViewPrimary?this._primaryView:this._secondaryView}_updateState(e,t){var n;let r=this._state;if(this._state={...this._state,...e},null===(n=this._readerRef.current)||void 0===n||n.setState(this._state),this._state.annotations!==r.annotations){var i,o;let e=this._state.annotations.filter((e=>!e._hidden));null===(i=this._primaryView)||void 0===i||i.setAnnotations(e),null===(o=this._secondaryView)||void 0===o||o.setAnnotations(e)}var a,s,l,u,c,d,h,p,f,m,g,v,y,b,_,w,S,C,E,x,A,k,D,P,T,F,R,I,O,B,M,L,N,V,z,U,H,W;(this._state.selectedAnnotationIDs!==r.selectedAnnotationIDs&&(null===(a=this._primaryView)||void 0===a||a.setSelectedAnnotationIDs(this._state.selectedAnnotationIDs),null===(s=this._secondaryView)||void 0===s||s.setSelectedAnnotationIDs(this._state.selectedAnnotationIDs)),this._state.tool!==r.tool&&(null===(l=this._primaryView)||void 0===l||l.setTool(this._state.tool),null===(u=this._secondaryView)||void 0===u||u.setTool(this._state.tool)),this._state.showAnnotations!==r.showAnnotations&&(null===(c=this._primaryView)||void 0===c||c.setShowAnnotations(this._state.showAnnotations),null===(d=this._secondaryView)||void 0===d||d.setShowAnnotations(this._state.showAnnotations)),this._state.outline!==r.outline&&(null===(h=this._primaryView)||void 0===h||h.setOutline(this._state.outline),null===(p=this._secondaryView)||void 0===p||p.setOutline(this._state.outline)),(t||this._state.lightTheme!==r.lightTheme)&&(t||(null===(f=this._primaryView)||void 0===f||f.setLightTheme(this._state.lightTheme),null===(m=this._secondaryView)||void 0===m||m.setLightTheme(this._state.lightTheme))),(t||this._state.darkTheme!==r.darkTheme)&&(t||(null===(g=this._primaryView)||void 0===g||g.setDarkTheme(this._state.darkTheme),null===(v=this._secondaryView)||void 0===v||v.setDarkTheme(this._state.darkTheme))),(t||this._state.colorScheme!==r.colorScheme)&&(this._state.colorScheme?document.documentElement.dataset.colorScheme=this._state.colorScheme:delete document.documentElement.dataset.colorScheme,t||(null===(y=this._primaryView)||void 0===y||y.setColorScheme(this._state.colorScheme),null===(b=this._secondaryView)||void 0===b||b.setColorScheme(this._state.colorScheme))),this._state.readOnly!==r.readOnly&&(this._annotationManager.setReadOnly(this._state.readOnly),null===(_=this._primaryView)||void 0===_||null===(w=_.setReadOnly)||void 0===w||w.call(_,this._state.readOnly),null===(S=this._secondaryView)||void 0===S||null===(C=S.setReadOnly)||void 0===C||C.call(S,this._state.readOnly)),this._state.pageLabels!==r.pageLabels&&(null===(E=this._primaryView)||void 0===E||E.setPageLabels(this._state.pageLabels),null===(x=this._secondaryView)||void 0===x||x.setPageLabels(this._state.pageLabels)),this._state.primaryViewAnnotationPopup!==r.primaryViewAnnotationPopup&&(null===(A=this._primaryView)||void 0===A||A.setAnnotationPopup(this._state.primaryViewAnnotationPopup)),this._state.secondaryViewAnnotationPopup!==r.secondaryViewAnnotationPopup&&(null===(k=this._secondaryView)||void 0===k||k.setAnnotationPopup(this._state.secondaryViewAnnotationPopup)),this._state.primaryViewSelectionPopup!==r.primaryViewSelectionPopup&&(null===(D=this._primaryView)||void 0===D||D.setSelectionPopup(this._state.primaryViewSelectionPopup)),this._state.secondaryViewSelectionPopup!==r.secondaryViewSelectionPopup&&(null===(P=this._secondaryView)||void 0===P||P.setSelectionPopup(this._state.secondaryViewSelectionPopup)),this._state.primaryViewOverlayPopup!==r.primaryViewOverlayPopup&&(null===(T=this._primaryView)||void 0===T||T.setOverlayPopup(this._state.primaryViewOverlayPopup)),this._state.secondaryViewOverlayPopup!==r.secondaryViewOverlayPopup&&(null===(F=this._secondaryView)||void 0===F||F.setOverlayPopup(this._state.secondaryViewOverlayPopup)),this._state.primaryViewFindState!==r.primaryViewFindState&&(null===(R=this._primaryView)||void 0===R||R.setFindState(this._state.primaryViewFindState)),this._state.secondaryViewFindState!==r.secondaryViewFindState&&(null===(I=this._secondaryView)||void 0===I||I.setFindState(this._state.secondaryViewFindState)),"epub"===this._type)&&(this._state.fontFamily!==r.fontFamily&&(null===(z=this._primaryView)||void 0===z||z.setFontFamily(this._state.fontFamily),null===(U=this._secondaryView)||void 0===U||U.setFontFamily(this._state.fontFamily)),this._state.hyphenate!==r.hyphenate&&(null===(H=this._primaryView)||void 0===H||H.setHyphenate(this._state.hyphenate),null===(W=this._secondaryView)||void 0===W||W.setHyphenate(this._state.hyphenate)));if((t||this._state.sidebarView!==r.sidebarView)&&(null===(O=this._primaryView)||void 0===O||null===(B=O.setSidebarView)||void 0===B||B.call(O,this._state.sidebarView),null===(M=this._secondaryView)||void 0===M||null===(L=M.setSidebarView)||void 0===L||L.call(M,this._state.sidebarView)),(t||this._state.sidebarOpen!==r.sidebarOpen)&&(this._state.sidebarOpen?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open"),null===(N=this._primaryView)||void 0===N||N.setSidebarOpen(this._state.sidebarOpen),null===(V=this._secondaryView)||void 0===V||V.setSidebarOpen(this._state.sidebarOpen)),t||this._state.splitType!==r.splitType)if(document.body.classList.remove("enable-horizontal-split-view"),document.body.classList.remove("enable-vertical-split-view"),r.splitType&&!t||!this._state.splitType)if(!r.splitType&&!t||this._state.splitType)document.body.classList.add("vertical"===this._state.splitType?"enable-vertical-split-view":"enable-horizontal-split-view");else{var j;null===(j=this._secondaryView)||void 0===j||j.destroy(),this._secondaryView=null,this._secondaryViewContainer.replaceChildren(),this._lastViewPrimary=!0,this._onChangeViewState(null,!1)}else document.body.classList.add("vertical"===this._state.splitType?"enable-vertical-split-view":"enable-horizontal-split-view"),this._updateState({secondaryViewState:{...this._state.primaryViewState}}),this._secondaryView=this._createView(!1);(t||this._state.splitSize!==r.splitSize)&&document.documentElement.style.setProperty("--split-view-size",this._state.splitSize),(t||this._state.sidebarWidth!==r.sidebarWidth)&&document.documentElement.style.setProperty("--sidebar-width",this._state.sidebarWidth+"px"),(t||this._state.bottomPlaceholderHeight!==r.bottomPlaceholderHeight)&&document.documentElement.style.setProperty("--bottom-placeholder-height",(this._state.bottomPlaceholderHeight||0)+"px"),(t||this._state.toolbarPlaceholderWidth!==r.toolbarPlaceholderWidth)&&document.documentElement.style.setProperty("--toolbar-placeholder-width",this._state.toolbarPlaceholderWidth+"px"),(t||this._state.fontSize!==r.fontSize)&&(document.documentElement.style.fontSize=this._state.fontSize+"em"),(t||this._state.freeze!==r.freeze)&&(this._state.freeze?document.body.classList.add("freeze"):document.body.classList.remove("freeze"))}disableSplitView(){this._updateState({splitType:null})}toggleHorizontalSplit(e){void 0===e&&(e=!this._state.splitType||"horizontal"!==this._state.splitType),e?this._updateState({splitType:"horizontal"}):this.disableSplitView()}toggleVerticalSplit(e){void 0===e&&(e=!this._state.splitType||"vertical"!==this._state.splitType),e?this._updateState({splitType:"vertical"}):this.disableSplitView()}get splitType(){return this._state.splitType}setTool(e){if(this._state.readOnly&&!["pointer","hand"].includes(e.type))return;let t=this._state.tool;e.type&&t.type!==e.type&&(t=this._tools[e.type]);for(let n in e)t[n]=e[n];this._updateState({tool:t}),["pointer","hand"].includes(t.type)||this.setSelectedAnnotations([])}toggleTool(e){this._state.tool.type===e?this._updateState({tool:this._tools.pointer}):this._updateState({tool:this._tools[e]}),this.setSelectedAnnotations([])}setFilter(e){this._annotationManager.setFilter(e)}showAnnotations(e){this._updateState({showAnnotations:e})}setAutoDisableNoteTool(e){this._updateState({autoDisableNoteTool:e})}setAutoDisableTextTool(e){this._updateState({autoDisableTextTool:e})}setAutoDisableImageTool(e){this._updateState({autoDisableImageTool:e})}setColorScheme(e){this._updateState({colorScheme:e})}setReadOnly(e){this._updateState({readOnly:e,tool:this._tools.pointer})}toggleHandTool(e){void 0===e&&(e="hand"!==this._state.tool.type),e?this.setTool({type:"hand"}):this.setTool({type:"pointer"})}enableAddToNote(e){this._updateState({enableAddToNote:e})}setAnnotations(e){this._annotationManager.setAnnotations(e)}unsetAnnotations(e){this._annotationManager.unsetAnnotations(e)}openContextMenu(e){var t;null===(t=this._onBringReaderToFront)||void 0===t||t.call(this,!0),this._updateState({contextMenu:e}),setTimeout((()=>{window.focus(),document.activeElement.blur()}))}closeContextMenu(){var e;this._updateState({contextMenu:null}),this._focusManager.restoreFocus(),null===(e=this._onBringReaderToFront)||void 0===e||e.call(this,!1),document.querySelectorAll(".context-menu-open").forEach((e=>e.classList.remove("context-menu-open")))}_handleAppearanceChange(e){var t,n;this._ensureType("epub"),null===(t=this._primaryView)||void 0===t||t.setAppearance(e),null===(n=this._secondaryView)||void 0===n||n.setAppearance(e)}_handleFindStateChange(e,t){this._updateState({[e?"primaryViewFindState":"secondaryViewFindState"]:t})}_handleOverlayPopupClose(e){this._updateState({[e?"primaryViewOverlayPopup":"secondaryViewOverlayPopup"]:null})}setTextSelectionAnnotationMode(e){if(!["highlight","underline"].includes(e))throw new Error(`Invalid 'textSelectionAnnotationMode' value '${e}'`);this._updateState({textSelectionAnnotationMode:e}),this._onTextSelectionAnnotationModeChange(e)}findNext(e){void 0===e&&(e=this._lastViewPrimary),(e?this._primaryView:this._secondaryView).findNext()}findPrevious(e){void 0===e&&(e=this._lastViewPrimary),(e?this._primaryView:this._secondaryView).findPrevious()}toggleAppearancePopup(e){let t="appearancePopup";void 0===e&&(e=!this._state[t]),this._updateState({[t]:e}),e||this._lastView.focus()}toggleFindPopup({primary:e,open:t}={}){void 0===e&&(e=this._lastViewPrimary);let n=e?"primaryViewFindState":"secondaryViewFindState",r=this._state[n];void 0===t&&(t=!r.popupOpen);let i={...r,popupOpen:t};r.popupOpen||(i.active=!1,i.result=null),this._updateState({[n]:i}),t&&setTimeout((()=>{var t,n;let r=(e?".primary-view":".secondary-view")+" .find-popup input";null===(t=document.querySelector(r))||void 0===t||t.select(),null===(n=document.querySelector(r))||void 0===n||n.focus()}),100)}_sidebarScrollAnnotationIntoViev(e){this._readerRef.current.sidebarScrollAnnotationIntoView(e)}_sidebarEditAnnotationText(e){this._readerRef.current.sidebarEditAnnotationText(e)}_getString(e){return this._localizedStrings[e]||e}_createView(e,t){let n,r,i=e?this._primaryViewContainer:this._secondaryViewContainer,o=Ti((t=>{if(this._updateState({[e?"primaryViewState":"secondaryViewState"]:t}),!e){let{splitType:e,splitSize:n}=this._state;t={...t,splitType:e,splitSize:n}}this._onChangeViewState(t,e)}),300),a=Ti((t=>{this._updateState({[e?"primaryViewStats":"secondaryViewStats"]:t})}),100),s=this._onSetZoom&&((e,t)=>{this._onSetZoom(e,t)});"pdf"===this._type?r=this._data:this._primaryView?r=this._primaryView.getData():(r=this._data,delete this._data);let l={primary:e,container:i,data:r,platform:this._platform,readOnly:this._state.readOnly,preview:this._preview,tools:this._tools,tool:this._state.tool,selectedAnnotationIDs:this._state.selectedAnnotationIDs,annotations:this._state.annotations.filter((e=>!e._hidden)),outline:this._state.outline,showAnnotations:this._state.showAnnotations,lightTheme:this._state.lightTheme,darkTheme:this._state.darkTheme,colorScheme:this._state.colorScheme,findState:this._state[e?"primaryViewFindState":"secondaryViewFindState"],viewState:this._state[e?"primaryViewState":"secondaryViewState"],location:t,onChangeViewState:o,onChangeViewStats:a,onSetDataTransferAnnotations:this._handleSetDataTransferAnnotations.bind(this),onAddAnnotation:(e,t)=>(e=this._annotationManager.addAnnotation(e),setTimeout((async()=>{if(!document.l10n)return;let t=await document.l10n.formatValue(`pdfReader-${e.type}Annotation`),n=await document.l10n.formatValue("pdfReader-a11yAnnotationCreated",{type:t});this.setA11yMessage(n)}),100),t&&this.setSelectedAnnotations([e.id],!0),("note"===e.type&&this._state.autoDisableNoteTool||"text"===e.type&&this._state.autoDisableTextTool||"image"===e.type&&this._state.autoDisableImageTool)&&this.setTool({type:"pointer"}),e),onUpdateAnnotations:e=>{this._annotationManager.updateAnnotations(e)},onOpenLink:e=>{this._onOpenLink(e)},onFocus:()=>{this.focusView(e),this._focusManager._closeFindPopupIfEmpty()},onOpenAnnotationContextMenu:e=>{this._onOpenContextMenu(id(this,e))},onOpenViewContextMenu:e=>{setTimeout((()=>this._onOpenContextMenu(function(e,t){return{x:t.x,y:t.y,itemGroups:rd([[{label:e._getString("pdfReader.copyLink"),disabled:!(t.overlay&&"external-link"===t.overlay.type&&!e.canCopy),onCommand:()=>{navigator.clipboard.writeText(t.overlay.url)}}],[{label:e._getString("general.copy"),disabled:!e.canCopy,onCommand:()=>e.copy()}],[{label:e._getString("pdfReader.zoomIn"),disabled:!e.canZoomIn,persistent:!0,onCommand:()=>e.zoomIn()},{label:e._getString("pdfReader.zoomOut"),disabled:!e.canZoomOut,persistent:!0,onCommand:()=>e.zoomOut()},["epub","snapshot"].includes(e._type)&&{label:e._getString("pdfReader.zoomReset"),disabled:!e.canZoomReset,persistent:!0,onCommand:()=>e.zoomReset()},"pdf"===e._type&&{label:e._getString("pdfReader.zoomAuto"),checked:e.zoomAutoEnabled,onCommand:()=>e.zoomAuto()},"pdf"===e._type&&{label:e._getString("pdfReader.zoomPageWidth"),checked:e.zoomPageWidthEnabled,onCommand:()=>e.zoomPageWidth()},"pdf"===e._type&&{label:e._getString("pdfReader.zoomPageHeight"),checked:e.zoomPageHeightEnabled,onCommand:()=>e.zoomPageHeight()}],[{label:e._getString("pdfReader.splitHorizontally"),checked:"horizontal"===e._state.splitType,onCommand:()=>e.toggleHorizontalSplit()},{label:e._getString("pdfReader.splitVertically"),checked:"vertical"===e._state.splitType,onCommand:()=>e.toggleVerticalSplit()}],[{label:e._getString("pdfReader.nextPage"),disabled:!e.canNavigateToNextPage,persistent:!0,onCommand:()=>e.navigateToNextPage()},{label:e._getString("pdfReader.previousPage"),disabled:!e.canNavigateToPreviousPage,persistent:!0,onCommand:()=>e.navigateToPreviousPage()}],...nd("createViewContextMenu",e,t)])}}(this,e))))},onSetSelectionPopup:t=>{this._updateState({[e?"primaryViewSelectionPopup":"secondaryViewSelectionPopup"]:t})},onSetAnnotationPopup:t=>{this._updateState({[e?"primaryViewAnnotationPopup":"secondaryViewAnnotationPopup"]:t})},onSetOverlayPopup:t=>{this._updateState({[e?"primaryViewOverlayPopup":"secondaryViewOverlayPopup"]:t})},onSetFindState:t=>{this._updateState({[e?"primaryViewFindState":"secondaryViewFindState"]:t}),this.a11yAnnounceSearchMessage(t.result)},onSetOutline:e=>{this._updateState({outline:e})},onSelectAnnotations:(e,t)=>{this.setSelectedAnnotations(e,!0,t)},onTabOut:e=>{this._focusManager.tabToGroup(e)},onKeyDown:e=>{this._keyboardManager.handleViewKeyDown(e)},onKeyUp:e=>{this._keyboardManager.handleViewKeyUp(e)},onFocusAnnotation:e=>{if(!e)return;if("external-link"==e.type)return void this.setA11yMessage(e.url);if("citation"==e.type)return void this.setA11yMessage(`${e.references.map((e=>e.text)).join("")}`);let t=`${this._getString(`pdfReader.${e.type}Annotation`)}. ${e.text||e.comment}`;this.setA11yMessage(t)},getLocalizedString:e=>this._getString(e)};return"pdf"===this._type?(n=new td({...l,password:this._password,pageLabels:this._state.pageLabels,onRequestPassword:()=>{e&&this._updateState({passwordPopup:{}})},onSetThumbnails:e=>{this._updateState({thumbnails:e})},onSetPageLabels:e=>{this._updateState({pageLabels:e})},onDeleteAnnotations:e=>{this._annotationManager.deleteAnnotations(e)}}),e&&function({onProgress:e,onFinish:t,pdfView:n}){if(ud)return ud._onProgress=e,ud._onFinish=t,void(ud._pdfView=n);ud=new ld({onProgress:e,onFinish:t,pdfView:n}),window._print=window.print,window.print=function(e){try{sd("beforeprint")}finally{let t=ud._activeTask;t._includeAnnotations=e,t.renderPages().then((function(){return t.performPrint()})).catch((function(){})).then((function(){t===ud._activeTask&&ud.abort()}))}},window.abortPrint=function(){ud.abort()}}({onProgress:e=>{this._handleSetPrintPopup({percent:e})},onFinish:()=>{this._handleSetPrintPopup(null)},pdfView:n})):"epub"===this._type?n=new hl({...l,fontFamily:this._state.fontFamily,hyphenate:this._state.hyphenate,onEPUBEncrypted:()=>{this.setErrorMessage(this._getString("pdfReader.epubEncrypted"))}}):"snapshot"===this._type&&(n=new xc({...l,onSetZoom:s})),e&&n.initializedPromise.then((()=>n.focus())),n}setErrorMessage(e){this._updateState({errorMessage:e})}setA11yMessage(e){document.getElementById("a11yAnnouncement").innerText=e}getUnsavedAnnotations(){}deleteAnnotations(e){if(e.length>1&&!this._onConfirm("",this._getString("pdfReader.deleteAnnotation.plural"),this._getString("general.delete")))return;let t=this._state.selectedAnnotationIDs.filter((t=>!e.includes(t)));this._updateState({selectedAnnotationIDs:t,primaryViewAnnotationPopup:null,secondaryViewAnnotationPopup:null}),this._annotationManager.deleteAnnotations(e)}convertAnnotations(e,t){this._annotationManager.convertAnnotations(e,t)}mergeAnnotations(e){return this._annotationManager.mergeAnnotations(e)}getKOReaderAnnotationStats(e){return this._ensureType("epub"),this._primaryView.getKOReaderAnnotationStats(e)}importAnnotationsFromKOReaderMetadata(e){this._ensureType("epub"),this._primaryView.importAnnotationsFromKOReaderMetadata(e)}getCalibreAnnotationStats(e){return this._ensureType("epub"),this._primaryView.getCalibreAnnotationStats(e)}importAnnotationsFromCalibreMetadata(e){this._ensureType("epub"),this._primaryView.importAnnotationsFromCalibreMetadata(e)}copy(){let{activeElement:e}=document;"IFRAME"===e.nodeName&&e.contentWindow?e.contentWindow.document.execCommand("copy"):document.execCommand("copy")}zoomIn(){this._lastView.zoomIn()}zoomOut(){this._lastView.zoomOut()}zoomReset(){this._lastView.zoomReset()}zoomAuto(){this._ensureType("pdf"),this._lastView.zoomAuto()}zoomPageWidth(){this._ensureType("pdf"),this._lastView.zoomPageWidth()}zoomPageHeight(){this._ensureType("pdf"),this._lastView.zoomPageHeight()}async navigate(e,t){await this._lastView.initializedPromise,e.annotationID&&this._state.annotations.find((t=>t.id===e.annotationID))?this.setSelectedAnnotations([e.annotationID]):this._lastView.navigate(e,t)}navigateBack(){this._lastView.navigateBack()}navigateForward(){this._lastView.navigateForward()}navigateToFirstPage(){this._ensureType("pdf","epub"),this._lastView.navigateToFirstPage()}navigateToLastPage(){this._ensureType("pdf","epub"),this._lastView.navigateToLastPage()}navigateToPreviousPage(){this._ensureType("pdf","epub"),this._lastView.navigateToPreviousPage()}navigateToNextPage(){this._ensureType("pdf","epub"),this._lastView.navigateToNextPage()}navigateToPreviousSection(){this._ensureType("epub"),this._lastView.navigateToPreviousSection()}navigateToNextSection(){this._ensureType("epub"),this._lastView.navigateToNextSection()}setSelectedAnnotations(e,t,n){!e.length&&this._state.selectedAnnotationIDs.some((e=>!this._state.annotations.find((t=>t.id===e))))&&this._updateState({selectedAnnotationIDs:[]});let r=[];for(let t of this._state.annotations)"text"!==t.type||t.comment||e.includes(t.id)||r.push(t.id);this._annotationManager.deleteAnnotations(r);let i=n?n.shiftKey:this._keyboardManager.shift,o=n?n.ctrlKey||n.metaKey&&lr():this._keyboardManager.mod;if((!this._state.selectedAnnotationIDs.length||e.length||!t||!i&&!o)&&(!this._state.selectedAnnotationIDs.length||n||i||!o||this._keyboardManager.pointerDown))if(1===e.length&&this._state.selectedAnnotationIDs.includes(e[0]),e[0]&&(this._lastSelectedAnnotationID=e[0]),this._enableAnnotationDeletionFromComment=!1,this._annotationSelectionTriggeredFromView=t,1===e.length){let r=e[0],a=this._annotationManager._annotations.find((e=>e.id===r));if(a)if(i&&this._state.selectedAnnotationIDs.length){let e=this._state.selectedAnnotationIDs.slice(),t=this._state.annotations.filter((e=>!e._hidden)),n=t.findIndex((e=>e.id===r)),i=t.findIndex((t=>t.id===e.slice(-1)[0])),o=e.map((e=>t.findIndex((t=>t.id===e)))),a=Math.min(...o),s=Math.max(...o);if(n<a)for(let r=n;r<a;r++)e.push(t[r].id);else if(n>s)for(let r=s+1;r<=n;r++)e.push(t[r].id);else for(let r=Math.min(n,i);r<=Math.max(n,i);r++){if(r===i)continue;let n=t[r].id;e.includes(n)||e.push(n)}this._updateState({selectedAnnotationIDs:e})}else if(o&&this._state.selectedAnnotationIDs.length){let e=this._state.selectedAnnotationIDs.slice(),t=e.indexOf(r);t>=0?e.splice(t,1):e.push(r),this._updateState({selectedAnnotationIDs:e})}else this._updateState({selectedAnnotationIDs:e}),n&&2===n.button||(t?!["note","highlight","underline","image"].includes(a.type)||a.comment||n&&"key"in n&&"note"!==a.type||(this._enableAnnotationDeletionFromComment=!0,setTimeout((()=>{var e;let t;t=this._state.sidebarOpen&&"annotations"===this._state.sidebarView?document.querySelector(`[data-sidebar-annotation-id="${r}"] .comment .content`):document.querySelector(".annotation-popup .comment .content"),null===(e=t)||void 0===e||e.focus()}),50)):this._lastView.navigate({annotationID:a.id})),setTimeout((async()=>{if(!document.l10n)return;let e=await document.l10n.formatValue(`pdfReader-${a.type}Annotation`),t=await document.l10n.formatValue("pdfReader-a11yAnnotationSelected",{type:e});document.querySelector(".annotation-popup")&&(t+=" "+await document.l10n.formatValue("pdfReader-a11yAnnotationPopupAppeared")),["highlight","underline"].includes(a.type)?t+=" "+await document.l10n.formatValue("pdfReader-a11yEditTextAnnotation"):["note","text","image"].includes(a.type)&&(t+=" "+await document.l10n.formatValue("pdfReader-a11yMoveAnnotation"),["text","image"].includes(a.type)&&(t+=" "+await document.l10n.formatValue("pdfReader-a11yResizeAnnotation"))),"IFRAME"===document.activeElement.nodeName&&this.setA11yMessage(t)}),100);1===this._state.selectedAnnotationIDs.length&&setTimeout((()=>{let e=document.querySelector(`[data-sidebar-annotation-id="${r}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}),50)}else this._updateState({selectedAnnotationIDs:e})}setFontSize(e){this._updateState({fontSize:e})}setFontFamily(e){this._updateState({fontFamily:e})}setHyphenate(e){this._updateState({hyphenate:e})}setSidebarView(e){this._updateState({sidebarView:e})}setCustomThemes(e){var t,n;this._updateState({customThemes:e});let r=[...ii,...e||[]];r=new Map(r.map((e=>[e.id,e])));let i=null===(t=this._state.lightTheme)||void 0===t?void 0:t.id;if(i){let e=r.get(i)||null;this._updateState({lightTheme:e})}let o=null===(n=this._state.darkTheme)||void 0===n?void 0:n.id;if(o){let e=r.get(o)||null;this._updateState({darkTheme:e})}}setLightTheme(e){let t=[...ii,...this._state.customThemes||[]];t=new Map(t.map((e=>[e.id,e])));let n=t.get(e)||null;this._updateState({lightTheme:n})}setDarkTheme(e){let t=[...ii,...this._state.customThemes||[]];t=new Map(t.map((e=>[e.id,e])));let n=t.get(e)||null;this._updateState({darkTheme:n})}toggleSidebar(e){void 0===e&&(e=!this._state.sidebarOpen),this._updateState({sidebarOpen:e})}setSidebarWidth(e){this._updateState({sidebarWidth:e})}setSplitViewSize(e){this._updateState({splitSize:e})}setBottomPlaceholderHeight(e){this._updateState({bottomPlaceholderHeight:e})}setToolbarPlaceholderWidth(e){this._updateState({toolbarPlaceholderWidth:e})}focusView(e=!0){e=e||!this._secondaryView,this._lastViewPrimary=e,(e?this._primaryView:this._secondaryView).focus(),this._updateState({primary:e}),e?(this._updateState({secondaryViewAnnotationPopup:null}),this._updateState({secondaryViewSelectionPopup:null}),this._updateState({secondaryViewOverlyPopup:null})):(this._updateState({primaryViewAnnotationPopup:null}),this._updateState({primaryViewSelectionPopup:null}),this._updateState({primaryViewOverlayPopup:null}))}focus(){this._focusManager.restoreFocus()}focusToolbar(){this._focusManager.focusToolbar()}freeze(){this._updateState({freeze:!0})}unfreeze(){this._updateState({freeze:!1})}print(){"pdf"===this._type?this._state.annotations.length?this._handleSetPrintPopup({}):window.print():(this._handleSetPrintPopup(null),this._primaryView.print().then((()=>{this._handleSetPrintPopup(null)})))}abortPrint(){"pdf"===this._type&&window.abortPrint()}reload(e){this._data=e,this._primaryViewContainer.replaceChildren(),this._primaryView=this._createView(!0),this._state.splitType&&(this._secondaryViewContainer.replaceChildren(),this._secondaryView=this._createView(!1))}enterPassword(e){this._updateState({passwordPopup:null}),this._password=e,this.reload(this._data)}_handleSetDataTransferAnnotations(e,t,n){let r,i=this._state.selectedAnnotationIDs;r=[t],i.includes(t.id)&&i.length>1&&(r=this._state.annotations.filter((e=>i.includes(e.id)))),r.length>1&&function(e){let t=function(){let e=document.getElementById("drag-multi");return e||(e=document.createElement("div"),e.id="drag-multi",document.body.appendChild(e)),e}();e.setDragImage(t,0,0)}(e);let o=r.map((e=>{var t;let r="";if(e.text){let t=e.text.trim();r=n?t:'"'+t+'"'}let i=null===(t=e.comment)||void 0===t?void 0:t.trim();return i&&(r&&(r+=i.includes("\n")?"\n":" "),r+=i),r})).filter((e=>e)).join("\n\n");r=r.map((({id:e,type:t,text:n,color:r,comment:i,image:o,position:a,pageLabel:s,tags:l})=>{if(o){let t=document.querySelector(`[data-sidebar-annotation-id="${e}"] img`);t&&(o=function(e){var t=document.createElement("canvas");return t.width=e.naturalWidth,t.height=e.naturalHeight,t.getContext("2d").drawImage(e,0,0,e.naturalWidth,e.naturalHeight),t.toDataURL("image/png")}(t))}return{id:e,type:t,text:n?n.trim():n,color:r,comment:i?i.trim():i,image:o,position:a,pageLabel:s,tags:l}})),window._draggingAnnotationIDs=r.map((e=>e.id)),e.clearData(),e.setData("text/plain",o||" "),this._onSetDataTransferAnnotations(e,r,n)}_handleOpenPageLabelPopup(e){var t;this._ensureType("pdf"),null===(t=this._onBringReaderToFront)||void 0===t||t.call(this,!0);let n=this._state.pageLabels,r=this._state.selectedAnnotationIDs,i=this._annotationManager._getAnnotationByID(e),o=this._annotationManager._annotations.filter((e=>r.includes(e.id))),a=this._annotationManager._annotations,s=document.querySelector(`[data-sidebar-annotation-id="${e}"] header .label, .view-popup header .label`),{left:l,top:u,right:c,bottom:d}=s.getBoundingClientRect(),h=[l,u,c,d];this._updateState({labelPopup:{currentAnnotation:i,selectedAnnotations:o,allAnnotations:a,rect:h,selectedIDs:r,pageLabels:n}})}_handleLabelPopupClose(){var e;this._updateState({labelPopup:null}),null===(e=this._onBringReaderToFront)||void 0===e||e.call(this,!1)}_handleSetPrintPopup(e){var t;null===(t=this._onBringReaderToFront)||void 0===t||t.call(this,!!e),this._updateState({printPopup:e})}rotatePageLeft(){this._ensureType("pdf");let{pageIndex:e}=this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats;this.rotatePages([e],270)}rotatePageRight(){this._ensureType("pdf");let{pageIndex:e}=this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats;this.rotatePages([e],90)}rotatePages(e,t){this._ensureType("pdf"),this._onRotatePages(e,t)}deletePages(e,t){this._ensureType("pdf"),this._onDeletePages(e,t)}get toolType(){return this._state.tool.type}get zoomAutoEnabled(){return this._ensureType("pdf"),(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).zoomAutoEnabled}get zoomPageWidthEnabled(){return this._ensureType("pdf"),(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).zoomPageWidthEnabled}get zoomPageHeightEnabled(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).zoomPageHeightEnabled}get scrollMode(){return this._ensureType("pdf"),(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).scrollMode}set scrollMode(e){this._ensureType("pdf"),this._lastView.setScrollMode(e)}get spreadMode(){return this._ensureType("pdf","epub"),(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).spreadMode}set spreadMode(e){this._ensureType("pdf","epub"),this._lastView.setSpreadMode(e)}get canCopy(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canCopy}get canZoomIn(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canZoomIn}get canZoomOut(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canZoomOut}get canZoomReset(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canZoomReset}get canNavigateBack(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateBack}get canNavigateForward(){return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateForward}get canNavigateToFirstPage(){return!!["pdf","epub"].includes(this._type)&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToFirstPage}get canNavigateToLastPage(){return!!["pdf","epub"].includes(this._type)&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToLastPage}get canNavigateToPreviousPage(){return!!["pdf","epub"].includes(this._type)&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToPreviousPage}get canNavigateToNextPage(){return!!["pdf","epub"].includes(this._type)&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToNextPage}get canNavigateToPreviousSection(){return"epub"===this._type&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToPreviousSection}get canNavigateToNextSection(){return"epub"===this._type&&(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).canNavigateToNextSection}get flowMode(){if("epub"===this._type)return(this._state.primary?this._state.primaryViewStats:this._state.secondaryViewStats).flowMode}set flowMode(e){this._ensureType("epub"),this._lastView.setFlowMode(e)}};window.createReader=e=>{if(window._reader)throw new Error("Reader is already initialized");e.platform="web",window.frameElement&&(window.ArrayBuffer=window.top.ArrayBuffer);let t=new pd({onOpenContextMenu:e=>{t.openContextMenu(e)},...e});return window._reader=t,t}})(),(()=>{"use strict";r.r(i)})(),i})()));